import{d as defineComponent,A as computed,a as reactive,r as ref,w as watch,bb as onUnmounted,_ as _objectSpread2,j as createVNode,b_ as classNames,bP as useConfigInject,ct as _objectWithoutProperties,cA as filterEmpty,b$ as cloneElement,c1 as PropTypes,fX as PresetColorTypes,bQ as _defineProperty,bZ as getPropsSlot,bW as flattenChildren,fY as isNumeric,bS as _typeof,c0 as getTransitionProps,aW as Transition,V as withDirectives,Z as vShow}from"./index.js";function UnitNumber(_ref){var style,prefixCls=_ref.prefixCls,value=_ref.value,current=_ref.current,_ref$offset=_ref.offset,offset=void 0===_ref$offset?0:_ref$offset;return offset&&(style={position:"absolute",top:"".concat(offset,"00%"),left:0}),createVNode("p",{style:style,class:classNames("".concat(prefixCls,"-only-unit"),{current:current})},[value])}function getOffset(start,end,unit){for(var index=start,offset=0;(index+10)%10!==end;)index+=unit,offset+=unit;return offset}const SingleNumber=defineComponent({compatConfig:{MODE:3},name:"SingleNumber",props:{prefixCls:String,value:String,count:Number},setup:function(props){var originValue=computed((function(){return Number(props.value)})),originCount=computed((function(){return Math.abs(props.count)})),state=reactive({prevValue:originValue.value,prevCount:originCount.value}),onTransitionEnd=function(){state.prevValue=originValue.value,state.prevCount=originCount.value},timeout=ref();return watch(originValue,(function(){clearTimeout(timeout.value),timeout.value=setTimeout((function(){onTransitionEnd()}),1e3)}),{flush:"post"}),onUnmounted((function(){clearTimeout(timeout.value)})),function(){var unitNodes,offsetStyle={},value=originValue.value;if(state.prevValue===value||Number.isNaN(value)||Number.isNaN(state.prevValue))unitNodes=[UnitNumber(_objectSpread2(_objectSpread2({},props),{},{current:!0}))],offsetStyle={transition:"none"};else{unitNodes=[];for(var end=value+10,unitNumberList=[],index=value;index<=end;index+=1)unitNumberList.push(index);var prevIndex=unitNumberList.findIndex((function(n){return n%10===state.prevValue}));unitNodes=unitNumberList.map((function(n,index2){var singleUnit=n%10;return UnitNumber(_objectSpread2(_objectSpread2({},props),{},{value:singleUnit,offset:index2-prevIndex,current:index2===prevIndex}))}));var unit=state.prevCount<originCount.value?1:-1;offsetStyle={transform:"translateY(".concat(-getOffset(state.prevValue,value,unit),"00%)")}}return createVNode("span",{class:"".concat(props.prefixCls,"-only"),style:offsetStyle,onTransitionend:function(){return onTransitionEnd()}},[unitNodes])}}});var _excluded$1=["prefixCls","count","title","show","component","class","style"];const ScrollNumber=defineComponent({compatConfig:{MODE:3},name:"ScrollNumber",inheritAttrs:!1,props:{prefixCls:String,count:PropTypes.any,component:String,title:PropTypes.any,show:Boolean},setup:function(props,_ref){var attrs=_ref.attrs,slots=_ref.slots,prefixCls=useConfigInject("scroll-number",props).prefixCls;return function(){var _slots$default,_props$attrs=_objectSpread2(_objectSpread2({},props),attrs);_props$attrs.prefixCls;var count=_props$attrs.count,title=_props$attrs.title;_props$attrs.show;var _props$attrs$componen=_props$attrs.component,Tag=void 0===_props$attrs$componen?"sup":_props$attrs$componen,className=_props$attrs.class,style=_props$attrs.style,restProps=_objectWithoutProperties(_props$attrs,_excluded$1),newProps=_objectSpread2(_objectSpread2({},restProps),{},{style:style,"data-show":props.show,class:classNames(prefixCls.value,className),title:title}),numberNodes=count;if(count&&Number(count)%1==0){var numberList=String(count).split("");numberNodes=numberList.map((function(num,i){return createVNode(SingleNumber,{prefixCls:prefixCls.value,count:Number(count),value:num,key:numberList.length-i},null)}))}style&&style.borderColor&&(newProps.style=_objectSpread2(_objectSpread2({},style),{},{boxShadow:"0 0 0 1px ".concat(style.borderColor," inset")}));var children=filterEmpty(null===(_slots$default=slots.default)||void 0===_slots$default?void 0:_slots$default.call(slots));return children&&children.length?cloneElement(children,{class:classNames("".concat(prefixCls.value,"-custom-component"))},!1):createVNode(Tag,newProps,{default:function(){return[numberNodes]}})}}});function isPresetColor(color){return-1!==PresetColorTypes.indexOf(color)}var _excluded=["class","style"];const Ribbon=defineComponent({compatConfig:{MODE:3},name:"ABadgeRibbon",inheritAttrs:!1,props:{prefix:String,color:{type:String},text:PropTypes.any,placement:{type:String,default:"end"}},slots:["text"],setup:function(props,_ref){var attrs=_ref.attrs,slots=_ref.slots,_useConfigInject=useConfigInject("ribbon",props),prefixCls=_useConfigInject.prefixCls,direction=_useConfigInject.direction,colorInPreset=computed((function(){return isPresetColor(props.color)})),ribbonCls=computed((function(){var _ref2;return[prefixCls.value,"".concat(prefixCls.value,"-placement-").concat(props.placement),(_ref2={},_defineProperty(_ref2,"".concat(prefixCls.value,"-rtl"),"rtl"===direction.value),_defineProperty(_ref2,"".concat(prefixCls.value,"-color-").concat(props.color),colorInPreset.value),_ref2)]}));return function(){var _slots$default,_slots$text,className=attrs.class,style=attrs.style,restAttrs=_objectWithoutProperties(attrs,_excluded),colorStyle={},cornerColorStyle={};return props.color&&!colorInPreset.value&&(colorStyle.background=props.color,cornerColorStyle.color=props.color),createVNode("div",_objectSpread2({class:"".concat(prefixCls.value,"-wrapper")},restAttrs),[null===(_slots$default=slots.default)||void 0===_slots$default?void 0:_slots$default.call(slots),createVNode("div",{class:[ribbonCls.value,className],style:_objectSpread2(_objectSpread2({},colorStyle),style)},[createVNode("span",{class:"".concat(prefixCls.value,"-text")},[props.text||(null===(_slots$text=slots.text)||void 0===_slots$text?void 0:_slots$text.call(slots))]),createVNode("div",{class:"".concat(prefixCls.value,"-corner"),style:cornerColorStyle},null)])])}}});const Badge=defineComponent({compatConfig:{MODE:3},name:"ABadge",Ribbon:Ribbon,inheritAttrs:!1,props:{count:PropTypes.any,showZero:{type:Boolean,default:void 0},overflowCount:{type:Number,default:99},dot:{type:Boolean,default:void 0},prefixCls:String,scrollNumberPrefixCls:String,status:{type:String},size:{type:String,default:"default"},color:String,text:PropTypes.any,offset:Array,numberStyle:{type:Object,default:void 0},title:String},slots:["text","count"],setup:function(props,_ref){var slots=_ref.slots,attrs=_ref.attrs,_useConfigInject=useConfigInject("badge",props),prefixCls=_useConfigInject.prefixCls,direction=_useConfigInject.direction,numberedDisplayCount=computed((function(){return props.count>props.overflowCount?"".concat(props.overflowCount,"+"):props.count})),hasStatus=computed((function(){return null!==props.status&&void 0!==props.status||null!==props.color&&void 0!==props.color})),isZero=computed((function(){return"0"===numberedDisplayCount.value||0===numberedDisplayCount.value})),showAsDot=computed((function(){return props.dot&&!isZero.value})),mergedCount=computed((function(){return showAsDot.value?"":numberedDisplayCount.value})),isHidden=computed((function(){return(null===mergedCount.value||void 0===mergedCount.value||""===mergedCount.value||isZero.value&&!props.showZero)&&!showAsDot.value})),livingCount=ref(props.count),displayCount=ref(mergedCount.value),isDotRef=ref(showAsDot.value);watch([function(){return props.count},mergedCount,showAsDot],(function(){isHidden.value||(livingCount.value=props.count,displayCount.value=mergedCount.value,isDotRef.value=showAsDot.value)}),{immediate:!0});var statusCls=computed((function(){var _ref2;return _defineProperty(_ref2={},"".concat(prefixCls.value,"-status-dot"),hasStatus.value),_defineProperty(_ref2,"".concat(prefixCls.value,"-status-").concat(props.status),!!props.status),_defineProperty(_ref2,"".concat(prefixCls.value,"-status-").concat(props.color),isPresetColor(props.color)),_ref2})),statusStyle=computed((function(){return props.color&&!isPresetColor(props.color)?{background:props.color}:{}})),scrollNumberCls=computed((function(){var _ref3;return _defineProperty(_ref3={},"".concat(prefixCls.value,"-dot"),isDotRef.value),_defineProperty(_ref3,"".concat(prefixCls.value,"-count"),!isDotRef.value),_defineProperty(_ref3,"".concat(prefixCls.value,"-count-sm"),"small"===props.size),_defineProperty(_ref3,"".concat(prefixCls.value,"-multiple-words"),!isDotRef.value&&displayCount.value&&displayCount.value.toString().length>1),_defineProperty(_ref3,"".concat(prefixCls.value,"-status-").concat(props.status),!!props.status),_defineProperty(_ref3,"".concat(prefixCls.value,"-status-").concat(props.color),isPresetColor(props.color)),_ref3}));return function(){var _slots$default,_slots$count,_classNames,offset=props.offset,title=props.title,color=props.color,style=attrs.style,text=getPropsSlot(slots,props,"text"),pre=prefixCls.value,count=livingCount.value,children=flattenChildren(null===(_slots$default=slots.default)||void 0===_slots$default?void 0:_slots$default.call(slots));children=children.length?children:null;var visible=!(isHidden.value&&!slots.count),mergedStyle=function(){if(!offset)return _objectSpread2({},style);var offsetStyle={marginTop:isNumeric(offset[1])?"".concat(offset[1],"px"):offset[1]};return"rtl"===direction.value?offsetStyle.left="".concat(parseInt(offset[0],10),"px"):offsetStyle.right="".concat(-parseInt(offset[0],10),"px"),_objectSpread2(_objectSpread2({},offsetStyle),style)}(),titleNode=null!=title?title:"string"==typeof count||"number"==typeof count?count:void 0,statusTextNode=visible||!text?null:createVNode("span",{class:"".concat(pre,"-status-text")},[text]),displayNode="object"===_typeof(count)||void 0===count&&slots.count?cloneElement(null!=count?count:null===(_slots$count=slots.count)||void 0===_slots$count?void 0:_slots$count.call(slots),{style:mergedStyle},!1):null,badgeClassName=classNames(pre,(_defineProperty(_classNames={},"".concat(pre,"-status"),hasStatus.value),_defineProperty(_classNames,"".concat(pre,"-not-a-wrapper"),!children),_defineProperty(_classNames,"".concat(pre,"-rtl"),"rtl"===direction.value),_classNames),attrs.class);if(!children&&hasStatus.value){var statusTextColor=mergedStyle.color;return createVNode("span",_objectSpread2(_objectSpread2({},attrs),{},{class:badgeClassName,style:mergedStyle}),[createVNode("span",{class:statusCls.value,style:statusStyle.value},null),createVNode("span",{style:{color:statusTextColor},class:"".concat(pre,"-status-text")},[text])])}var transitionProps=getTransitionProps(children?"".concat(pre,"-zoom"):"",{appear:!1}),scrollNumberStyle=_objectSpread2(_objectSpread2({},mergedStyle),props.numberStyle);return color&&!isPresetColor(color)&&((scrollNumberStyle=scrollNumberStyle||{}).background=color),createVNode("span",_objectSpread2(_objectSpread2({},attrs),{},{class:badgeClassName}),[children,createVNode(Transition,transitionProps,{default:function(){return[withDirectives(createVNode(ScrollNumber,{prefixCls:props.scrollNumberPrefixCls,show:visible,class:scrollNumberCls.value,count:displayCount.value,title:titleNode,style:scrollNumberStyle,key:"scrollNumber"},{default:function(){return[displayNode]}}),[[vShow,visible]])]}}),statusTextNode])}}});Badge.install=function(app){return app.component(Badge.name,Badge),app.component(Ribbon.name,Ribbon),app};export{Badge as B};
