import{j as createVNode,I as Icon,d as defineComponent,bB as Form,d7 as Input,aa as useI18n,z as useDesign,a5 as useUserStore,r as ref,a as reactive,A as computed,D as unref,o as openBlock,e as createElementBlock,V as withDirectives,Z as vShow,i as withCtx,d8 as Checkbox,k as createTextVNode,m as toDisplayString,O as Button,bA as Divider,E as createBaseVNode,C as normalizeClass,q as withKeys,F as Fragment,by as Col,bM as Row,y as useMessage}from"./index.js";import{u as useLoginState,a as useFormRules,L as LoginStateEnum,_ as _sfc_main$1,b as useFormValid}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang.js";import{G as GithubFilled}from"./GithubFilled.js";var AlipayCircleFilled$1={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.42 0 448 200.58 448 448S759.42 960 512 960 64 759.42 64 512 264.58 64 512 64m32.5 168c-69.67 0-86.06 16.84-86.72 39.08l-.02 1.43v46.62H291.45c-9.92 0-14.28 23.05-14.27 39.3 0 2.7 2.08 4.93 4.77 4.93h175.81v58.3h-116.5c-9.96 0-14.3 23.76-14.27 39.47a4.77 4.77 0 004.77 4.76h233.45c-4.53 41.06-15.43 77.59-30.72 109.32l-1.22 2.5-.32-.28c-60.24-28.47-120.43-52.57-194.4-52.57l-2.62.01c-84.98 1.11-144.71 56.5-145.91 127.04l-.02 1.22.02 2.13c1.24 70.4 63.56 126.45 148.52 126.45 61.25 0 116.38-16.85 163.46-45.02a138.58 138.58 0 0014.07-7.96 345.6 345.6 0 0050.3-41.16l9.45 6.35 12.46 8.32c57.53 38.26 113.76 72.62 169.86 79.27a142.62 142.62 0 0018.31 1.16c43.02 0 55-52.68 57.39-95.51l.14-2.84c.4-8.46-6.2-15.6-14.65-15.86-75.46-2.37-136.45-22.05-192-46.11l-6.27-2.75c35.15-56.8 56.66-121.81 57.15-186.66l.09-1.08c.4-5.51-4-10.2-9.52-10.2H549.33v-58.3h165.73c9.92 0 14.28-22.12 14.27-39.31a4.85 4.85 0 00-4.78-4.92H549.32v-82.35a4.8 4.8 0 00-4.83-4.78M328 583.85c54.63 0 107.08 22.41 158.1 52.19l5.76 3.4c-103.57 119.84-247.17 95.9-261.72 26.37a66.89 66.89 0 01-1.14-9.83l-.06-2.34.02-.9c.97-40.12 45.33-68.9 99.04-68.9"}}]},name:"alipay-circle",theme:"filled"};function _objectSpread$3(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?Object(arguments[i]):{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){_defineProperty$3(target,key,source[key])}))}return target}function _defineProperty$3(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var AlipayCircleFilled=function(props,context){var p=_objectSpread$3({},props,context.attrs);return createVNode(Icon,_objectSpread$3({},p,{icon:AlipayCircleFilled$1}),null)};AlipayCircleFilled.displayName="AlipayCircleFilled",AlipayCircleFilled.inheritAttrs=!1;var GoogleCircleFilled$1={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm167 633.6C638.4 735 583 757 516.9 757c-95.7 0-178.5-54.9-218.8-134.9C281.5 589 272 551.6 272 512s9.5-77 26.1-110.1c40.3-80.1 123.1-135 218.8-135 66 0 121.4 24.3 163.9 63.8L610.6 401c-25.4-24.3-57.7-36.6-93.6-36.6-63.8 0-117.8 43.1-137.1 101-4.9 14.7-7.7 30.4-7.7 46.6s2.8 31.9 7.7 46.6c19.3 57.9 73.3 101 137 101 33 0 61-8.7 82.9-23.4 26-17.4 43.2-43.3 48.9-74H516.9v-94.8h230.7c2.9 16.1 4.4 32.8 4.4 50.1 0 74.7-26.7 137.4-73 180.1z"}}]},name:"google-circle",theme:"filled"};function _objectSpread$2(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?Object(arguments[i]):{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){_defineProperty$2(target,key,source[key])}))}return target}function _defineProperty$2(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var GoogleCircleFilled=function(props,context){var p=_objectSpread$2({},props,context.attrs);return createVNode(Icon,_objectSpread$2({},p,{icon:GoogleCircleFilled$1}),null)};GoogleCircleFilled.displayName="GoogleCircleFilled",GoogleCircleFilled.inheritAttrs=!1;var TwitterCircleFilled$1={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm215.3 337.7c.3 4.7.3 9.6.3 14.4 0 146.8-111.8 315.9-316.1 315.9-63 0-121.4-18.3-170.6-49.8 9 1 17.6 1.4 26.8 1.4 52 0 99.8-17.6 137.9-47.4-48.8-1-89.8-33-103.8-77 17.1 2.5 32.5 2.5 50.1-2a111 111 0 01-88.9-109v-1.4c14.7 8.3 32 13.4 50.1 14.1a111.13 111.13 0 01-49.5-92.4c0-20.7 5.4-39.6 15.1-56a315.28 315.28 0 00229 116.1C492 353.1 548.4 292 616.2 292c32 0 60.8 13.4 81.1 35 25.1-4.7 49.1-14.1 70.5-26.7-8.3 25.7-25.7 47.4-48.8 61.1 22.4-2.4 44-8.6 64-17.3-15.1 22.2-34 41.9-55.7 57.6z"}}]},name:"twitter-circle",theme:"filled"};function _objectSpread$1(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?Object(arguments[i]):{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){_defineProperty$1(target,key,source[key])}))}return target}function _defineProperty$1(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var TwitterCircleFilled=function(props,context){var p=_objectSpread$1({},props,context.attrs);return createVNode(Icon,_objectSpread$1({},p,{icon:TwitterCircleFilled$1}),null)};TwitterCircleFilled.displayName="TwitterCircleFilled",TwitterCircleFilled.inheritAttrs=!1;var WechatFilled$1={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M690.1 377.4c5.9 0 11.8.2 17.6.5-24.4-128.7-158.3-227.1-319.9-227.1C209 150.8 64 271.4 64 420.2c0 81.1 43.6 154.2 111.9 203.6a21.5 21.5 0 019.1 17.6c0 2.4-.5 4.6-1.1 6.9-5.5 20.3-14.2 52.8-14.6 54.3-.7 2.6-1.7 5.2-1.7 7.9 0 5.9 4.8 10.8 10.8 10.8 2.3 0 4.2-.9 6.2-2l70.9-40.9c5.3-3.1 11-5 17.2-5 3.2 0 6.4.5 9.5 1.4 33.1 9.5 68.8 14.8 105.7 14.8 6 0 11.9-.1 17.8-.4-7.1-21-10.9-43.1-10.9-66 0-135.8 132.2-245.8 295.3-245.8zm-194.3-86.5c23.8 0 43.2 19.3 43.2 43.1s-19.3 43.1-43.2 43.1c-23.8 0-43.2-19.3-43.2-43.1s19.4-43.1 43.2-43.1zm-215.9 86.2c-23.8 0-43.2-19.3-43.2-43.1s19.3-43.1 43.2-43.1 43.2 19.3 43.2 43.1-19.4 43.1-43.2 43.1zm586.8 415.6c56.9-41.2 93.2-102 93.2-169.7 0-124-120.8-224.5-269.9-224.5-149 0-269.9 100.5-269.9 224.5S540.9 847.5 690 847.5c30.8 0 60.6-4.4 88.1-12.3 2.6-.8 5.2-1.2 7.9-1.2 5.2 0 9.9 1.6 14.3 4.1l59.1 34c1.7 1 3.3 1.7 5.2 1.7a9 9 0 006.4-2.6 9 9 0 002.6-6.4c0-2.2-.9-4.4-1.4-6.6-.3-1.2-7.6-28.3-12.2-45.3-.5-1.9-.9-3.8-.9-5.7.1-5.9 3.1-11.2 7.6-14.5zM600.2 587.2c-19.9 0-36-16.1-36-35.9 0-19.8 16.1-35.9 36-35.9s36 16.1 36 35.9c0 19.8-16.2 35.9-36 35.9zm179.9 0c-19.9 0-36-16.1-36-35.9 0-19.8 16.1-35.9 36-35.9s36 16.1 36 35.9a36.08 36.08 0 01-36 35.9z"}}]},name:"wechat",theme:"filled"};function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?Object(arguments[i]):{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){_defineProperty(target,key,source[key])}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var WechatFilled=function(props,context){var p=_objectSpread({},props,context.attrs);return createVNode(Icon,_objectSpread({},p,{icon:WechatFilled$1}),null)};WechatFilled.displayName="WechatFilled",WechatFilled.inheritAttrs=!1;const _sfc_main=defineComponent({__name:"LoginForm",setup(__props){const ACol=Col,ARow=Row,FormItem=Form.Item,InputPassword=Input.Password,{t:t}=useI18n(),{notification:notification,createErrorModal:createErrorModal}=useMessage(),{prefixCls:prefixCls}=useDesign("login"),userStore=useUserStore(),{setLoginState:setLoginState,getLoginState:getLoginState}=useLoginState(),{getFormRules:getFormRules}=useFormRules(),formRef=ref(),loading=ref(!1),rememberMe=ref(!1),formData=reactive({account:"admin",password:"123456"}),{validForm:validForm}=useFormValid(formRef),getShow=computed((()=>unref(getLoginState)===LoginStateEnum.LOGIN));function handleLogin(){return __this=this,__arguments=null,generator=function*(){const data=yield validForm();if(data)try{loading.value=!0;const userInfo=yield userStore.login({password:data.password,username:data.account,mode:"none"});userInfo&&notification.success({message:t("sys.login.loginSuccessTitle"),description:`${t("sys.login.loginSuccessDesc")}: ${userInfo.realName}`,duration:3})}catch(error){createErrorModal({title:t("sys.api.errorTip"),content:error.message||t("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${prefixCls}`)||document.body})}finally{loading.value=!1}},new Promise(((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())}));var __this,__arguments,generator}return(_ctx,_cache)=>(openBlock(),createElementBlock(Fragment,null,[withDirectives(createVNode(_sfc_main$1,{class:"enter-x"},null,512),[[vShow,getShow.value]]),withDirectives(createVNode(unref(Form),{class:"p-4 enter-x",model:formData,rules:unref(getFormRules),ref_key:"formRef",ref:formRef,onKeypress:withKeys(handleLogin,["enter"])},{default:withCtx((()=>[createVNode(unref(FormItem),{name:"account",class:"enter-x"},{default:withCtx((()=>[createVNode(unref(Input),{size:"large",value:formData.account,"onUpdate:value":_cache[0]||(_cache[0]=$event=>formData.account=$event),placeholder:unref(t)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])])),_:1}),createVNode(unref(FormItem),{name:"password",class:"enter-x"},{default:withCtx((()=>[createVNode(unref(InputPassword),{size:"large",visibilityToggle:"",value:formData.password,"onUpdate:value":_cache[1]||(_cache[1]=$event=>formData.password=$event),placeholder:unref(t)("sys.login.password")},null,8,["value","placeholder"])])),_:1}),createVNode(unref(ARow),{class:"enter-x"},{default:withCtx((()=>[createVNode(unref(ACol),{span:12},{default:withCtx((()=>[createVNode(unref(FormItem),null,{default:withCtx((()=>[createVNode(unref(Checkbox),{checked:rememberMe.value,"onUpdate:checked":_cache[2]||(_cache[2]=$event=>rememberMe.value=$event),size:"small"},{default:withCtx((()=>[createTextVNode(toDisplayString(unref(t)("sys.login.rememberMe")),1)])),_:1},8,["checked"])])),_:1})])),_:1}),createVNode(unref(ACol),{span:12},{default:withCtx((()=>[createVNode(unref(FormItem),{style:{"text-align":"right"}},{default:withCtx((()=>[createVNode(unref(Button),{type:"link",size:"small",onClick:_cache[3]||(_cache[3]=$event=>unref(setLoginState)(unref(LoginStateEnum).RESET_PASSWORD))},{default:withCtx((()=>[createTextVNode(toDisplayString(unref(t)("sys.login.forgetPassword")),1)])),_:1})])),_:1})])),_:1})])),_:1}),createVNode(unref(FormItem),{class:"enter-x"},{default:withCtx((()=>[createVNode(unref(Button),{type:"primary",size:"large",block:"",onClick:handleLogin,loading:loading.value},{default:withCtx((()=>[createTextVNode(toDisplayString(unref(t)("sys.login.loginButton")),1)])),_:1},8,["loading"])])),_:1}),createVNode(unref(ARow),{class:"enter-x"},{default:withCtx((()=>[createVNode(unref(ACol),{md:8,xs:24},{default:withCtx((()=>[createVNode(unref(Button),{block:"",onClick:_cache[4]||(_cache[4]=$event=>unref(setLoginState)(unref(LoginStateEnum).MOBILE))},{default:withCtx((()=>[createTextVNode(toDisplayString(unref(t)("sys.login.mobileSignInFormTitle")),1)])),_:1})])),_:1}),createVNode(unref(ACol),{md:8,xs:24,class:"!my-2 !md:my-0 xs:mx-0 md:mx-2"},{default:withCtx((()=>[createVNode(unref(Button),{block:"",onClick:_cache[5]||(_cache[5]=$event=>unref(setLoginState)(unref(LoginStateEnum).QR_CODE))},{default:withCtx((()=>[createTextVNode(toDisplayString(unref(t)("sys.login.qrSignInFormTitle")),1)])),_:1})])),_:1}),createVNode(unref(ACol),{md:6,xs:24},{default:withCtx((()=>[createVNode(unref(Button),{block:"",onClick:_cache[6]||(_cache[6]=$event=>unref(setLoginState)(unref(LoginStateEnum).REGISTER))},{default:withCtx((()=>[createTextVNode(toDisplayString(unref(t)("sys.login.registerButton")),1)])),_:1})])),_:1})])),_:1}),createVNode(unref(Divider),{class:"enter-x"},{default:withCtx((()=>[createTextVNode(toDisplayString(unref(t)("sys.login.otherSignIn")),1)])),_:1}),createBaseVNode("div",{class:normalizeClass(["flex justify-evenly enter-x",`${unref(prefixCls)}-sign-in-way`])},[createVNode(unref(GithubFilled)),createVNode(unref(WechatFilled)),createVNode(unref(AlipayCircleFilled)),createVNode(unref(GoogleCircleFilled)),createVNode(unref(TwitterCircleFilled))],2)])),_:1},8,["model","rules"]),[[vShow,getShow.value]])],64))}});export{_sfc_main as default};
