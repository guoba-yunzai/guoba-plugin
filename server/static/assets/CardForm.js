var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value;import{d as defineComponent,p as propTypes,z as useDesign,r as ref,A as computed,J as provide,u as usePrompt,b as _export_sfc,c as resolveComponent,o as openBlock,h as createBlock,i as withCtx,E as createBaseVNode,m as toDisplayString,e as createElementBlock,B as createCommentVNode,j as createVNode,F as Fragment,C as normalizeClass}from"./index.js";import BasicForm from"./BasicForm.js";import"./BasicForm.vue_vue_type_style_index_0_lang.js";import"./index19.js";/* empty css       *//* empty css                                                          */import"./upperFirst.js";import"./uniqBy.js";import"./index21.js";import"./index22.js";import"./useFormItem.js";import"./DeleteOutlined.js";import"./transButton.js";import"./download.js";import"./index23.js";import"./index24.js";import"./useWindowSizeFn.js";import"./FullscreenOutlined.js";const _sfc_main=defineComponent({name:"CardForm",components:{BasicForm:BasicForm},props:{card:propTypes.object.isRequired.type,form:propTypes.object.isRequired.type,isDefault:propTypes.bool.def(!1),allowFold:propTypes.bool.def(!1),defaultFold:propTypes.bool.def(!1)},emits:["redo","submit","addCard","delCard"],setup(props,{emit:emit}){const{createPrompt:createPrompt}=usePrompt(),{prefixCls:prefixCls}=useDesign("card-form"),folded=ref(!!props.defaultFold),cardTitle=computed((()=>{return card=props.card,form=props.form,card.title.replace(/{{([^}]+)}}/g,((_,$1)=>new Function("card","form",`return ${$1}`)(card,form)));var card,form})),addBtnText=computed((()=>{var _a,_b;return null!=(_b=null==(_a=props.card)?void 0:_a.addBtnText)?_b:"新增"}));function onSubmit(){emit("submit",props.form)}return provide("doFormSubmit",onSubmit),{emit:emit,prefixCls:prefixCls,folded:folded,cardTitle:cardTitle,addBtnText:addBtnText,onClickTitle:function(){props.allowFold&&(folded.value=!folded.value)},onSubmit:onSubmit,onAddCard:function(){var _a,a;createPrompt((a=((a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a})({title:addBtnText.value,required:!0},null==(_a=props.card)?void 0:_a.promptProps),__defProps(a,__getOwnPropDescs({onOk(value){return __this=this,__arguments=null,generator=function*(){emit("addCard",{form:props.form,key:value})},new Promise(((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())}));var __this,__arguments,generator}}))))},onRemoveCard:function(){emit("delCard",{form:props.form})}}}}),_hoisted_1={key:0,style:{"margin-left":"8px"}},_hoisted_2={style:{"text-align":"center"}},_hoisted_3=createBaseVNode("span",null,"保存",-1),_hoisted_4=createBaseVNode("span",null,"删除当前配置",-1);const CardForm=_export_sfc(_sfc_main,[["render",function(_ctx,_cache,$props,$setup,$data,$options){const _component_icon=resolveComponent("icon"),_component_a_tooltip=resolveComponent("a-tooltip"),_component_BasicForm=resolveComponent("BasicForm"),_component_a_button=resolveComponent("a-button"),_component_a_divider=resolveComponent("a-divider"),_component_a_popconfirm=resolveComponent("a-popconfirm"),_component_a_spin=resolveComponent("a-spin"),_component_a_card=resolveComponent("a-card");return openBlock(),createBlock(_component_a_card,{class:normalizeClass([_ctx.prefixCls,{"allow-fold":_ctx.allowFold,folded:_ctx.folded}]),bordered:!1},{title:withCtx((()=>[createBaseVNode("div",{class:"card-title",onClick:_cache[0]||(_cache[0]=(...args)=>_ctx.onClickTitle&&_ctx.onClickTitle(...args))},[createBaseVNode("span",null,toDisplayString(_ctx.cardTitle),1),_ctx.allowFold?(openBlock(),createElementBlock("span",_hoisted_1,[_ctx.folded?(openBlock(),createBlock(_component_icon,{key:0,icon:"ant-design:caret-down"})):(openBlock(),createBlock(_component_icon,{key:1,icon:"ant-design:caret-up"}))])):createCommentVNode("",!0)])])),extra:withCtx((()=>[createVNode(_component_a_tooltip,{title:"刷新"},{default:withCtx((()=>[createVNode(_component_icon,{icon:"ant-design:redo",style:{cursor:"pointer"},onClick:_cache[1]||(_cache[1]=()=>_ctx.emit("redo",_ctx.form))})])),_:1})])),default:withCtx((()=>[createVNode(_component_a_spin,{spinning:_ctx.form.loading},{default:withCtx((()=>[createVNode(_component_BasicForm,{onRegister:_ctx.form.register},null,8,["onRegister"]),createBaseVNode("div",_hoisted_2,[createVNode(_component_a_button,{type:"primary","pre-icon":"ant-design:save",onClick:_ctx.onSubmit},{default:withCtx((()=>[_hoisted_3])),_:1},8,["onClick"]),_ctx.isDefault?(openBlock(),createElementBlock(Fragment,{key:0},[createVNode(_component_a_divider,{type:"vertical"}),_ctx.card.allowAdd?(openBlock(),createBlock(_component_a_button,{key:0,"pre-icon":"ant-design:plus",onClick:_ctx.onAddCard},{default:withCtx((()=>[createBaseVNode("span",null,toDisplayString(_ctx.addBtnText),1)])),_:1},8,["onClick"])):createCommentVNode("",!0)],64)):(openBlock(),createElementBlock(Fragment,{key:1},[createVNode(_component_a_divider,{type:"vertical"}),createVNode(_component_a_popconfirm,{title:"确定要删除当前配置吗？",onConfirm:_ctx.onRemoveCard},{default:withCtx((()=>[_ctx.card.allowDel?(openBlock(),createBlock(_component_a_button,{key:0,"pre-icon":"ant-design:minus",danger:""},{default:withCtx((()=>[_hoisted_4])),_:1})):createCommentVNode("",!0)])),_:1},8,["onConfirm"])],64))])])),_:1},8,["spinning"])])),_:1},8,["class"])}]]);export{CardForm as default};
