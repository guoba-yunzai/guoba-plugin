var e=Object.defineProperty,r=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,n=(r,t,o)=>t in r?e(r,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[t]=o;import{a as l,b as s,p as d,bK as p,r as m,v as c,e as u,o as f,i as j,j as y,z as v,m as b,f as C,bO as g,k as x,F as k,bN as w}from"./index.js";import{B as F}from"./BasicForm.js";import{u as O}from"./usePrompt.js";import"./Prompt.js";import"./index2.js";import"./find.js";import"./_baseIteratee.js";import"./get.js";import"./index4.js";import"./index5.js";import"./useFormItem.js";import"./transButton.js";import"./index3.js";import"./useWindowSizeFn.js";import"./FullscreenOutlined.js";import"./upperFirst.js";import"./download.js";import"./index6.js";import"./index7.js";import"./uniqBy.js";import"./useForm.js";const P=s({name:"CardForm",components:{BasicForm:F},props:{card:d.object.isRequired.type,form:d.object.isRequired.type,isDefault:d.bool.def(!1),allowFold:d.bool.def(!1),defaultFold:d.bool.def(!1)},emits:["redo","submit","addCard","delCard"],setup(e,{emit:l}){const{createPrompt:s}=O(),{prefixCls:d}=p("card-form"),u=m(!!e.defaultFold),f=c((()=>{return r=e.card,t=e.form,r.title.replace(/{{([^}]+)}}/g,((e,o)=>new Function("card","form",`return ${o}`)(r,t)));var r,t})),j=c((()=>{var r,t;return null!=(t=null==(r=e.card)?void 0:r.addBtnText)?t:"新增"}));return{emit:l,prefixCls:d,folded:u,cardTitle:f,addBtnText:j,onClickTitle:function(){e.allowFold&&(u.value=!u.value)},onAddCard:function(){var d,p;s((p=((e,r)=>{for(var t in r||(r={}))a.call(r,t)&&n(e,t,r[t]);if(o)for(var t of o(r))i.call(r,t)&&n(e,t,r[t]);return e})({title:j.value,required:!0},null==(d=e.card)?void 0:d.promptProps),r(p,t({onOk(r){return t=this,o=null,a=function*(){l("addCard",{form:e.form,key:r})},new Promise(((e,r)=>{var i=e=>{try{l(a.next(e))}catch(t){r(t)}},n=e=>{try{l(a.throw(e))}catch(t){r(t)}},l=r=>r.done?e(r.value):Promise.resolve(r.value).then(i,n);l((a=a.apply(t,o)).next())}));var t,o,a}}))))},onRemoveCard:function(){l("delCard",{form:e.form})}}}}),B={key:0,style:{"margin-left":"8px"}},T={style:{"text-align":"center"}},_=v("span",null,"保存",-1),h=v("span",null,"删除当前配置",-1);var R=l(P,[["render",function(e,r,t,o,a,i){const n=u("icon"),l=u("a-tooltip"),s=u("BasicForm"),d=u("a-button"),p=u("a-divider"),m=u("a-popconfirm"),c=u("a-spin"),F=u("a-card");return f(),j(F,{class:w([e.prefixCls,{"allow-fold":e.allowFold,folded:e.folded}]),bordered:!1},{title:y((()=>[v("div",{class:"card-title",onClick:r[0]||(r[0]=(...r)=>e.onClickTitle&&e.onClickTitle(...r))},[v("span",null,b(e.cardTitle),1),e.allowFold?(f(),C("span",B,[e.folded?(f(),j(n,{key:0,icon:"ant-design:caret-down"})):(f(),j(n,{key:1,icon:"ant-design:caret-up"}))])):g("",!0)])])),extra:y((()=>[x(l,{title:"刷新"},{default:y((()=>[x(n,{icon:"ant-design:redo",style:{cursor:"pointer"},onClick:r[1]||(r[1]=()=>e.emit("redo",e.form))})])),_:1})])),default:y((()=>[x(c,{spinning:e.form.loading},{default:y((()=>[x(s,{onRegister:e.form.register},null,8,["onRegister"]),v("div",T,[x(d,{type:"primary","pre-icon":"ant-design:save",onClick:r[2]||(r[2]=()=>e.emit("submit",e.form))},{default:y((()=>[_])),_:1}),e.isDefault?(f(),C(k,{key:0},[x(p,{type:"vertical"}),e.card.allowAdd?(f(),j(d,{key:0,"pre-icon":"ant-design:plus",onClick:e.onAddCard},{default:y((()=>[v("span",null,b(e.addBtnText),1)])),_:1},8,["onClick"])):g("",!0)],64)):(f(),C(k,{key:1},[x(p,{type:"vertical"}),x(m,{title:"确定要删除当前配置吗？",onConfirm:e.onRemoveCard},{default:y((()=>[e.card.allowDel?(f(),j(d,{key:0,"pre-icon":"ant-design:minus",danger:""},{default:y((()=>[h])),_:1})):g("",!0)])),_:1},8,["onConfirm"])],64))])])),_:1},8,["spinning"])])),_:1},8,["class"])}]]);export{R as default};
