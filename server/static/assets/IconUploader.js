import{d,p}from"./esm.js";import{d as defineComponent,r as ref,c as resolveComponent,o as openBlock,h as createBlock,i as withCtx,E as createBaseVNode,D as unref,e as createElementBlock,Y as normalizeStyle,j as createVNode,k as createTextVNode,B as createCommentVNode,bm as Modal,R as pushScopeId,T as popScopeId,b as _export_sfc}from"./index.js";const _withScopeId=n=>(pushScopeId("data-v-419bfdfd"),n=n(),popScopeId(),n),_hoisted_1={class:"frame"},_hoisted_2={key:1},_hoisted_3={class:"wrap"},_hoisted_4=_withScopeId((()=>createBaseVNode("div",null,"替换",-1))),_hoisted_5={class:"wrap"},_hoisted_6=_withScopeId((()=>createBaseVNode("input",{type:"file",id:"upload1",style:{display:"none"},name:"icon",accept:"image/bmp,image/jpeg,image/png"},null,-1))),_hoisted_7={key:0},_hoisted_8=_withScopeId((()=>createBaseVNode("div",{class:"tip"},"请使图片尽量填满取景框",-1))),IconUploader=_export_sfc(defineComponent({__name:"IconUploader",props:{uploader:Object,iconB64List:Array},setup(__props){const props=__props,pic=ref(null),select=()=>{let btn2=document.getElementById("upload1");void 0===btn2.bind&&(btn2.bind=!0,btn2.addEventListener("change",(ev=>{let files=ev.target.files;if(0!==files.size){let file=files[0],Reader=new FileReader;Reader.readAsDataURL(file),Reader.onload=()=>{pic.value=Reader.result}}}))),btn2.click()},submit=()=>{let selected=props.uploader.selected;p.getFile().then((file=>{let cvs=document.createElement("canvas");cvs.width=100,cvs.height=100;let reader=new FileReader;reader.onload=function(){let ctx=cvs.getContext("2d"),newImg=new Image;newImg.src=reader.result,newImg.onload=function(){ctx.textAlign="center",ctx.font="bold 14px sans-serif",ctx.drawImage(newImg,0,0,80,80),ctx.fillText(selected,40,95),props.iconB64List[selected]=cvs.toDataURL(),pic.value=null}},reader.readAsDataURL(file)}))};return document.getElementById("upload1"),(_ctx,_cache)=>{const _component_a_button=resolveComponent("a-button");return openBlock(),createBlock(unref(Modal),{visible:__props.uploader.show,"onUpdate:visible":_cache[0]||(_cache[0]=$event=>__props.uploader.show=$event),width:"420px",closable:!1,footer:null},{default:withCtx((()=>[createBaseVNode("div",_hoisted_1,[pic.value?(openBlock(),createBlock(unref(d),{key:0,boxStyle:{height:"300px",width:"100%",backgroundColor:"#f8f8f8"},img:pic.value,options:{viewMode:1,dragMode:"move",aspectRatio:1}},null,8,["img"])):(openBlock(),createElementBlock("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[_hoisted_4,createBaseVNode("div",{class:"icon",style:normalizeStyle(`background: url(${__props.iconB64List[__props.uploader.selected]}) 0 0 no-repeat`)},null,4)])])),createBaseVNode("div",_hoisted_5,[_hoisted_6,createVNode(_component_a_button,{block:"",type:"info",onClick:select},{default:withCtx((()=>[createTextVNode("选择图片")])),_:1}),pic.value?(openBlock(),createElementBlock("div",_hoisted_7,[createVNode(_component_a_button,{block:"",type:"success",onClick:submit},{default:withCtx((()=>[createTextVNode("确定")])),_:1}),_hoisted_8])):createCommentVNode("",!0)])])])),_:1},8,["visible"])}}}),[["__scopeId","data-v-419bfdfd"]]);export{IconUploader as default};
