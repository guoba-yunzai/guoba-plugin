const __vite__fileDeps=["assets/DropMenuItem.js","assets/index.js","assets/index.css","assets/LockModal.js","assets/index19.js","assets/useWindowSizeFn.js","assets/FullscreenOutlined.js","assets/index4.css","assets/BasicForm.js","assets/BasicForm.vue_vue_type_style_index_0_lang.js","assets/index21.js","assets/index6.css","assets/index22.js","assets/index7.css","assets/useFormItem.js","assets/DeleteOutlined.js","assets/transButton.js","assets/upperFirst.js","assets/download.js","assets/index23.js","assets/index8.css","assets/index24.js","assets/index9.css","assets/BasicForm.css","assets/index5.css","assets/uniqBy.js","assets/lock.js","assets/header.js","assets/LockModal.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
var __async=(__this,__arguments,generator)=>new Promise(((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())}));import{d as defineComponent,dc as Dropdown,ab as Menu,K as createAsyncComponent,L as __vitePreload,p as propTypes,z as useDesign,a5 as useUserStore,A as computed,aa as useI18n,aA as openWindow,ga as botApi,j as createVNode,k as createTextVNode,g1 as sysApi,y as useMessage,b as _export_sfc,c as resolveComponent,o as openBlock,e as createElementBlock,i as withCtx,h as createBlock,B as createCommentVNode,E as createBaseVNode,C as normalizeClass,m as toDisplayString,F as Fragment}from"./index.js";import{D as DOC_URL}from"./siteSetting.js";import{u as useHeaderSetting}from"./index2.js";import{a as useModal}from"./index19.js";import{h as headerImg}from"./header.js";import{a as sleep}from"./common.js";import"./PluginIcon.vue_vue_type_style_index_0_lang.js";import"./FullscreenOutlined.js";import"./index17.js";import"./useWindowSizeFn.js";import"./useContentViewHeight.js";import"./uniqBy.js";import"./index29.js";import"./RedoOutlined.js";import"./lock.js";const index=_export_sfc(defineComponent({name:"UserDropdown",components:{Dropdown:Dropdown,Menu:Menu,MenuItem:createAsyncComponent((()=>__vitePreload((()=>import("./DropMenuItem.js")),__vite__mapDeps([0,1,2])))),MenuDivider:Menu.Divider,LockAction:createAsyncComponent((()=>__vitePreload((()=>import("./LockModal.js")),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28]))))},props:{theme:propTypes.oneOf(["dark","light"])},setup(){const{prefixCls:prefixCls}=useDesign("header-user-dropdown"),{t:t}=useI18n(),{getShowDoc:getShowDoc,getUseLockPage:getUseLockPage}=useHeaderSetting(),userStore=useUserStore(),getUserInfo=computed((()=>{const{realName:realName="",avatar:avatar,desc:desc,userId:userId}=userStore.getUserInfo||{};return{realName:realName,avatar:avatar||headerImg,desc:desc,userId:userId}})),[register,{openModal:openModal}]=useModal();const{createConfirm:createConfirm}=useMessage();return{prefixCls:prefixCls,t:t,getUserInfo:getUserInfo,handleMenuClick:function(e){switch(e.key){case"logout":userStore.confirmLoginOut();break;case"doc":openWindow(DOC_URL);break;case"lock":openModal(!0);break;case"restart-bot":createConfirm({title:"重启",iconType:"warning",content:"确定要立即重启Bot吗？",onOk(){return __async(this,null,(function*(){yield botApi.doRestart(),yield sleep(5e3),window.location.reload()}))}});break;case"restart-guoba":createConfirm({title:"重启",iconType:"warning",content:createVNode("div",null,[createVNode("p",{style:"color: #333"},[createTextVNode("确定要立即重启Guoba吗？")]),createVNode("p",{style:"color: #999"},[createTextVNode("不会重启Bot")])]),onOk(){return __async(this,null,(function*(){yield sysApi.doRestartGuoba(),yield sleep(1e3),window.location.reload()}))}})}},getShowDoc:getShowDoc,register:register,getUseLockPage:getUseLockPage}}}),[["render",function(_ctx,_cache,$props,$setup,$data,$options){const _component_GAvatar=resolveComponent("GAvatar"),_component_MenuDivider=resolveComponent("MenuDivider"),_component_MenuItem=resolveComponent("MenuItem"),_component_Menu=resolveComponent("Menu"),_component_Dropdown=resolveComponent("Dropdown"),_component_LockAction=resolveComponent("LockAction");return openBlock(),createElementBlock(Fragment,null,[createVNode(_component_Dropdown,{placement:"bottomLeft",overlayClassName:`${_ctx.prefixCls}-dropdown-overlay`},{overlay:withCtx((()=>[createVNode(_component_Menu,{onClick:_ctx.handleMenuClick},{default:withCtx((()=>[_ctx.getShowDoc?(openBlock(),createBlock(_component_MenuDivider,{key:0})):createCommentVNode("",!0),_ctx.getUseLockPage?(openBlock(),createBlock(_component_MenuItem,{key:"lock",text:_ctx.t("layout.header.tooltipLock"),icon:"ion:lock-closed-outline"},null,8,["text"])):createCommentVNode("",!0),createVNode(_component_MenuItem,{key:"logout",text:_ctx.t("layout.header.dropdownItemLoginOut"),icon:"ion:power-outline"},null,8,["text"]),createVNode(_component_MenuDivider),createVNode(_component_MenuItem,{key:"restart-guoba",text:"重启Guoba",icon:"solar:restart-bold"}),createVNode(_component_MenuItem,{key:"restart-bot",text:"重启Bot",icon:"solar:restart-bold"})])),_:1},8,["onClick"])])),default:withCtx((()=>[createBaseVNode("span",{class:normalizeClass([[_ctx.prefixCls,`${_ctx.prefixCls}--${_ctx.theme}`],"flex"])},[createVNode(_component_GAvatar,{class:normalizeClass(`${_ctx.prefixCls}__header`),id:_ctx.getUserInfo.userId,qs:100,size:24},null,8,["class","id"]),createBaseVNode("span",{class:normalizeClass(`${_ctx.prefixCls}__info hidden md:block`)},[createBaseVNode("span",{class:normalizeClass([`${_ctx.prefixCls}__name  `,"truncate"])},toDisplayString(_ctx.getUserInfo.realName),3)],2)],2)])),_:1},8,["overlayClassName"]),createVNode(_component_LockAction,{onRegister:_ctx.register},null,8,["onRegister"])],64)}]]);export{index as default};
