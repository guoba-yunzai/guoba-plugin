var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value;import{aJ as useRootSetting,A as computed,r as ref,w as watch,bw as tryOnUnmounted,D as unref,ad as useTimeoutFn,n as nextTick,fF as useEventListener,bJ as useBreakpoint,ay as useDebounceFn}from"./index.js";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d2,b2){d2.__proto__=b2}||function(d2,b2){for(var p in b2)Object.prototype.hasOwnProperty.call(b2,p)&&(d2[p]=b2[p])})(d,b)};function __extends(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var Browser=function(){return function(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}}(),env=new(function(){return function(){this.browser=new Browser,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow="undefined"!=typeof window}}());"object"==typeof wx&&"function"==typeof wx.getSystemInfoSync?(env.wxa=!0,env.touchEventsSupported=!0):"undefined"==typeof document&&"undefined"!=typeof self?env.worker=!0:!env.hasGlobalWindow||"Deno"in window?(env.node=!0,env.svgSupported=!0):function(ua,env2){var browser=env2.browser,firefox=ua.match(/Firefox\/([\d.]+)/),ie=ua.match(/MSIE\s([\d.]+)/)||ua.match(/Trident\/.+?rv:(([\d.]+))/),edge=ua.match(/Edge?\/([\d.]+)/),weChat=/micromessenger/i.test(ua);firefox&&(browser.firefox=!0,browser.version=firefox[1]);ie&&(browser.ie=!0,browser.version=ie[1]);edge&&(browser.edge=!0,browser.version=edge[1],browser.newEdge=+edge[1].split(".")[0]>18);weChat&&(browser.weChat=!0);env2.svgSupported="undefined"!=typeof SVGRect,env2.touchEventsSupported="ontouchstart"in window&&!browser.ie&&!browser.edge,env2.pointerEventsSupported="onpointerdown"in window&&(browser.edge||browser.ie&&+browser.version>=11),env2.domSupported="undefined"!=typeof document;var style=document.documentElement.style;env2.transform3dSupported=(browser.ie&&"transition"in style||browser.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in style)&&!("OTransition"in style),env2.transformSupported=env2.transform3dSupported||browser.ie&&+browser.version>=9}(navigator.userAgent,env);var DEFAULT_FONT="12px sans-serif";var DEFAULT_TEXT_WIDTH_MAP=function(mapStr){var map2={};if("undefined"==typeof JSON)return map2;for(var i=0;i<mapStr.length;i++){var char=String.fromCharCode(i+32),size=(mapStr.charCodeAt(i)-20)/100;map2[char]=size}return map2}("007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N"),platformApi={createCanvas:function(){return"undefined"!=typeof document&&document.createElement("canvas")},measureText:function(){var _ctx,_cachedFont;return function(text,font){if(!_ctx){var canvas=platformApi.createCanvas();_ctx=canvas&&canvas.getContext("2d")}if(_ctx)return _cachedFont!==font&&(_cachedFont=_ctx.font=font||DEFAULT_FONT),_ctx.measureText(text);text=text||"";var res=/((?:\d+)?\.?\d*)px/.exec(font=font||DEFAULT_FONT),fontSize=res&&+res[1]||12,width=0;if(font.indexOf("mono")>=0)width=fontSize*text.length;else for(var i=0;i<text.length;i++){var preCalcWidth=DEFAULT_TEXT_WIDTH_MAP[text[i]];width+=null==preCalcWidth?fontSize:preCalcWidth*fontSize}return{width:width}}}(),loadImage:function(src,onload,onerror){var image=new Image;return image.onload=onload,image.onerror=onerror,image.src=src,image}};function setPlatformAPI(newPlatformApis){for(var key in platformApi)newPlatformApis[key]&&(platformApi[key]=newPlatformApis[key])}var BUILTIN_OBJECT=reduce(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],(function(obj,val){return obj["[object "+val+"]"]=!0,obj}),{}),TYPED_ARRAY=reduce(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],(function(obj,val){return obj["[object "+val+"Array]"]=!0,obj}),{}),objToString=Object.prototype.toString,arrayProto=Array.prototype,nativeForEach=arrayProto.forEach,nativeFilter=arrayProto.filter,nativeSlice=arrayProto.slice,nativeMap=arrayProto.map,ctorFunction=function(){}.constructor,protoFunction=ctorFunction?ctorFunction.prototype:null,idStart=2311;function guid(){return idStart++}function logError(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];"undefined"!=typeof console&&console.error.apply(console,args)}function clone$3(source){if(null==source||"object"!=typeof source)return source;var result=source,typeStr=objToString.call(source);if("[object Array]"===typeStr){if(!isPrimitive(source)){result=[];for(var i=0,len2=source.length;i<len2;i++)result[i]=clone$3(source[i])}}else if(TYPED_ARRAY[typeStr]){if(!isPrimitive(source)){var Ctor=source.constructor;if(Ctor.from)result=Ctor.from(source);else{result=new Ctor(source.length);for(i=0,len2=source.length;i<len2;i++)result[i]=source[i]}}}else if(!BUILTIN_OBJECT[typeStr]&&!isPrimitive(source)&&!isDom(source))for(var key in result={},source)source.hasOwnProperty(key)&&"__proto__"!==key&&(result[key]=clone$3(source[key]));return result}function merge(target,source,overwrite){if(!isObject$3(source)||!isObject$3(target))return overwrite?clone$3(source):target;for(var key in source)if(source.hasOwnProperty(key)&&"__proto__"!==key){var targetProp=target[key],sourceProp=source[key];!isObject$3(sourceProp)||!isObject$3(targetProp)||isArray$1(sourceProp)||isArray$1(targetProp)||isDom(sourceProp)||isDom(targetProp)||isBuiltInObject(sourceProp)||isBuiltInObject(targetProp)||isPrimitive(sourceProp)||isPrimitive(targetProp)?!overwrite&&key in target||(target[key]=clone$3(source[key])):merge(targetProp,sourceProp,overwrite)}return target}function mergeAll(targetAndSources,overwrite){for(var result=targetAndSources[0],i=1,len2=targetAndSources.length;i<len2;i++)result=merge(result,targetAndSources[i],overwrite);return result}function extend(target,source){if(Object.assign)Object.assign(target,source);else for(var key in source)source.hasOwnProperty(key)&&"__proto__"!==key&&(target[key]=source[key]);return target}function defaults(target,source,overlay){for(var keysArr=keys(source),i=0,len2=keysArr.length;i<len2;i++){var key=keysArr[i];(overlay?null!=source[key]:null==target[key])&&(target[key]=source[key])}return target}var createCanvas=platformApi.createCanvas;function indexOf(array,value){if(array){if(array.indexOf)return array.indexOf(value);for(var i=0,len2=array.length;i<len2;i++)if(array[i]===value)return i}return-1}function inherits(clazz,baseClazz){var clazzPrototype=clazz.prototype;function F(){}for(var prop in F.prototype=baseClazz.prototype,clazz.prototype=new F,clazzPrototype)clazzPrototype.hasOwnProperty(prop)&&(clazz.prototype[prop]=clazzPrototype[prop]);clazz.prototype.constructor=clazz,clazz.superClass=baseClazz}function mixin(target,source,override){if(target="prototype"in target?target.prototype:target,source="prototype"in source?source.prototype:source,Object.getOwnPropertyNames)for(var keyList=Object.getOwnPropertyNames(source),i=0;i<keyList.length;i++){var key=keyList[i];"constructor"!==key&&(override?null!=source[key]:null==target[key])&&(target[key]=source[key])}else defaults(target,source,override)}function isArrayLike(data){return!!data&&("string"!=typeof data&&"number"==typeof data.length)}function each$d(arr,cb,context){if(arr&&cb)if(arr.forEach&&arr.forEach===nativeForEach)arr.forEach(cb,context);else if(arr.length===+arr.length)for(var i=0,len2=arr.length;i<len2;i++)cb.call(context,arr[i],i,arr);else for(var key in arr)arr.hasOwnProperty(key)&&cb.call(context,arr[key],key,arr)}function map$1(arr,cb,context){if(!arr)return[];if(!cb)return slice(arr);if(arr.map&&arr.map===nativeMap)return arr.map(cb,context);for(var result=[],i=0,len2=arr.length;i<len2;i++)result.push(cb.call(context,arr[i],i,arr));return result}function reduce(arr,cb,memo,context){if(arr&&cb){for(var i=0,len2=arr.length;i<len2;i++)memo=cb.call(context,memo,arr[i],i,arr);return memo}}function filter(arr,cb,context){if(!arr)return[];if(!cb)return slice(arr);if(arr.filter&&arr.filter===nativeFilter)return arr.filter(cb,context);for(var result=[],i=0,len2=arr.length;i<len2;i++)cb.call(context,arr[i],i,arr)&&result.push(arr[i]);return result}function find(arr,cb,context){if(arr&&cb)for(var i=0,len2=arr.length;i<len2;i++)if(cb.call(context,arr[i],i,arr))return arr[i]}function keys(obj){if(!obj)return[];if(Object.keys)return Object.keys(obj);var keyList=[];for(var key in obj)obj.hasOwnProperty(key)&&keyList.push(key);return keyList}var bind$1=protoFunction&&isFunction(protoFunction.bind)?protoFunction.call.bind(protoFunction.bind):function(func,context){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];return function(){return func.apply(context,args.concat(nativeSlice.call(arguments)))}};function curry$1(func){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return function(){return func.apply(this,args.concat(nativeSlice.call(arguments)))}}function isArray$1(value){return Array.isArray?Array.isArray(value):"[object Array]"===objToString.call(value)}function isFunction(value){return"function"==typeof value}function isString(value){return"string"==typeof value}function isStringSafe(value){return"[object String]"===objToString.call(value)}function isNumber(value){return"number"==typeof value}function isObject$3(value){var type=typeof value;return"function"===type||!!value&&"object"===type}function isBuiltInObject(value){return!!BUILTIN_OBJECT[objToString.call(value)]}function isTypedArray(value){return!!TYPED_ARRAY[objToString.call(value)]}function isDom(value){return"object"==typeof value&&"number"==typeof value.nodeType&&"object"==typeof value.ownerDocument}function isGradientObject(value){return null!=value.colorStops}function eqNaN(value){return value!=value}function retrieve(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];for(var i=0,len2=args.length;i<len2;i++)if(null!=args[i])return args[i]}function retrieve2(value0,value1){return null!=value0?value0:value1}function retrieve3(value0,value1,value2){return null!=value0?value0:null!=value1?value1:value2}function slice(arr){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];return nativeSlice.apply(arr,args)}function normalizeCssArray$1(val){if("number"==typeof val)return[val,val,val,val];var len2=val.length;return 2===len2?[val[0],val[1],val[0],val[1]]:3===len2?[val[0],val[1],val[2],val[1]]:val}function assert(condition,message){if(!condition)throw new Error(message)}function trim$1(str){return null==str?null:"function"==typeof str.trim?str.trim():str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var primitiveKey="__ec_primitive__";function setAsPrimitive(obj){obj[primitiveKey]=!0}function isPrimitive(obj){return obj[primitiveKey]}var MapPolyfill=function(){function MapPolyfill2(){this.data={}}return MapPolyfill2.prototype.delete=function(key){var existed=this.has(key);return existed&&delete this.data[key],existed},MapPolyfill2.prototype.has=function(key){return this.data.hasOwnProperty(key)},MapPolyfill2.prototype.get=function(key){return this.data[key]},MapPolyfill2.prototype.set=function(key,value){return this.data[key]=value,this},MapPolyfill2.prototype.keys=function(){return keys(this.data)},MapPolyfill2.prototype.forEach=function(callback){var data=this.data;for(var key in data)data.hasOwnProperty(key)&&callback(data[key],key)},MapPolyfill2}(),isNativeMapSupported="function"==typeof Map;var HashMap=function(){function HashMap2(obj){var isArr=isArray$1(obj);this.data=isNativeMapSupported?new Map:new MapPolyfill;var thisMap=this;function visit(value,key){isArr?thisMap.set(value,key):thisMap.set(key,value)}obj instanceof HashMap2?obj.each(visit):obj&&each$d(obj,visit)}return HashMap2.prototype.hasKey=function(key){return this.data.has(key)},HashMap2.prototype.get=function(key){return this.data.get(key)},HashMap2.prototype.set=function(key,value){return this.data.set(key,value),value},HashMap2.prototype.each=function(cb,context){this.data.forEach((function(value,key){cb.call(context,value,key)}))},HashMap2.prototype.keys=function(){var keys2=this.data.keys();return isNativeMapSupported?Array.from(keys2):keys2},HashMap2.prototype.removeKey=function(key){this.data.delete(key)},HashMap2}();function createHashMap(obj){return new HashMap(obj)}function concatArray(a,b){for(var newArray=new a.constructor(a.length+b.length),i=0;i<a.length;i++)newArray[i]=a[i];var offset=a.length;for(i=0;i<b.length;i++)newArray[i+offset]=b[i];return newArray}function createObject(proto2,properties){var obj;if(Object.create)obj=Object.create(proto2);else{var StyleCtor=function(){};StyleCtor.prototype=proto2,obj=new StyleCtor}return properties&&extend(obj,properties),obj}function hasOwn(own,prop){return own.hasOwnProperty(prop)}function noop(){}var RADIAN_TO_DEGREE=180/Math.PI;const util$1=Object.freeze(Object.defineProperty({__proto__:null,HashMap:HashMap,RADIAN_TO_DEGREE:RADIAN_TO_DEGREE,assert:assert,bind:bind$1,clone:clone$3,concatArray:concatArray,createCanvas:createCanvas,createHashMap:createHashMap,createObject:createObject,curry:curry$1,defaults:defaults,disableUserSelect:function(dom){var domStyle=dom.style;domStyle.webkitUserSelect="none",domStyle.userSelect="none",domStyle.webkitTapHighlightColor="rgba(0,0,0,0)",domStyle["-webkit-touch-callout"]="none"},each:each$d,eqNaN:eqNaN,extend:extend,filter:filter,find:find,guid:guid,hasOwn:hasOwn,indexOf:indexOf,inherits:inherits,isArray:isArray$1,isArrayLike:isArrayLike,isBuiltInObject:isBuiltInObject,isDom:isDom,isFunction:isFunction,isGradientObject:isGradientObject,isImagePatternObject:function(value){return null!=value.image},isNumber:isNumber,isObject:isObject$3,isPrimitive:isPrimitive,isRegExp:function(value){return"[object RegExp]"===objToString.call(value)},isString:isString,isStringSafe:isStringSafe,isTypedArray:isTypedArray,keys:keys,logError:logError,map:map$1,merge:merge,mergeAll:mergeAll,mixin:mixin,noop:noop,normalizeCssArray:normalizeCssArray$1,reduce:reduce,retrieve:retrieve,retrieve2:retrieve2,retrieve3:retrieve3,setAsPrimitive:setAsPrimitive,slice:slice,trim:trim$1},Symbol.toStringTag,{value:"Module"}));function create$1(x,y){return null==x&&(x=0),null==y&&(y=0),[x,y]}function copy$1(out2,v){return out2[0]=v[0],out2[1]=v[1],out2}function clone$2(v){return[v[0],v[1]]}function add(out2,v1,v2){return out2[0]=v1[0]+v2[0],out2[1]=v1[1]+v2[1],out2}function sub(out2,v1,v2){return out2[0]=v1[0]-v2[0],out2[1]=v1[1]-v2[1],out2}function len(v){return Math.sqrt(lenSquare(v))}var length=len;function lenSquare(v){return v[0]*v[0]+v[1]*v[1]}var lengthSquare=lenSquare;function scale$2(out2,v,s){return out2[0]=v[0]*s,out2[1]=v[1]*s,out2}function normalize$1(out2,v){var d=len(v);return 0===d?(out2[0]=0,out2[1]=0):(out2[0]=v[0]/d,out2[1]=v[1]/d),out2}function distance(v1,v2){return Math.sqrt((v1[0]-v2[0])*(v1[0]-v2[0])+(v1[1]-v2[1])*(v1[1]-v2[1]))}var dist$1=distance;function distanceSquare(v1,v2){return(v1[0]-v2[0])*(v1[0]-v2[0])+(v1[1]-v2[1])*(v1[1]-v2[1])}var distSquare=distanceSquare;function lerp$1(out2,v1,v2,t){return out2[0]=v1[0]+t*(v2[0]-v1[0]),out2[1]=v1[1]+t*(v2[1]-v1[1]),out2}function applyTransform$1(out2,v,m2){var x=v[0],y=v[1];return out2[0]=m2[0]*x+m2[2]*y+m2[4],out2[1]=m2[1]*x+m2[3]*y+m2[5],out2}function min$1(out2,v1,v2){return out2[0]=Math.min(v1[0],v2[0]),out2[1]=Math.min(v1[1],v2[1]),out2}function max$1(out2,v1,v2){return out2[0]=Math.max(v1[0],v2[0]),out2[1]=Math.max(v1[1],v2[1]),out2}const vector=Object.freeze(Object.defineProperty({__proto__:null,add:add,applyTransform:applyTransform$1,clone:clone$2,copy:copy$1,create:create$1,dist:dist$1,distSquare:distSquare,distance:distance,distanceSquare:distanceSquare,div:function(out2,v1,v2){return out2[0]=v1[0]/v2[0],out2[1]=v1[1]/v2[1],out2},dot:function(v1,v2){return v1[0]*v2[0]+v1[1]*v2[1]},len:len,lenSquare:lenSquare,length:length,lengthSquare:lengthSquare,lerp:lerp$1,max:max$1,min:min$1,mul:function(out2,v1,v2){return out2[0]=v1[0]*v2[0],out2[1]=v1[1]*v2[1],out2},negate:function(out2,v){return out2[0]=-v[0],out2[1]=-v[1],out2},normalize:normalize$1,scale:scale$2,scaleAndAdd:function(out2,v1,v2,a){return out2[0]=v1[0]+v2[0]*a,out2[1]=v1[1]+v2[1]*a,out2},set:function(out2,a,b){return out2[0]=a,out2[1]=b,out2},sub:sub},Symbol.toStringTag,{value:"Module"}));var Param=function(){return function(target,e2){this.target=target,this.topTarget=e2&&e2.topTarget}}(),Draggable=function(){function Draggable2(handler){this.handler=handler,handler.on("mousedown",this._dragStart,this),handler.on("mousemove",this._drag,this),handler.on("mouseup",this._dragEnd,this)}return Draggable2.prototype._dragStart=function(e2){for(var draggingTarget=e2.target;draggingTarget&&!draggingTarget.draggable;)draggingTarget=draggingTarget.parent||draggingTarget.__hostTarget;draggingTarget&&(this._draggingTarget=draggingTarget,draggingTarget.dragging=!0,this._x=e2.offsetX,this._y=e2.offsetY,this.handler.dispatchToElement(new Param(draggingTarget,e2),"dragstart",e2.event))},Draggable2.prototype._drag=function(e2){var draggingTarget=this._draggingTarget;if(draggingTarget){var x=e2.offsetX,y=e2.offsetY,dx=x-this._x,dy=y-this._y;this._x=x,this._y=y,draggingTarget.drift(dx,dy,e2),this.handler.dispatchToElement(new Param(draggingTarget,e2),"drag",e2.event);var dropTarget=this.handler.findHover(x,y,draggingTarget).target,lastDropTarget=this._dropTarget;this._dropTarget=dropTarget,draggingTarget!==dropTarget&&(lastDropTarget&&dropTarget!==lastDropTarget&&this.handler.dispatchToElement(new Param(lastDropTarget,e2),"dragleave",e2.event),dropTarget&&dropTarget!==lastDropTarget&&this.handler.dispatchToElement(new Param(dropTarget,e2),"dragenter",e2.event))}},Draggable2.prototype._dragEnd=function(e2){var draggingTarget=this._draggingTarget;draggingTarget&&(draggingTarget.dragging=!1),this.handler.dispatchToElement(new Param(draggingTarget,e2),"dragend",e2.event),this._dropTarget&&this.handler.dispatchToElement(new Param(this._dropTarget,e2),"drop",e2.event),this._draggingTarget=null,this._dropTarget=null},Draggable2}(),Eventful=function(){function Eventful2(eventProcessors){eventProcessors&&(this._$eventProcessor=eventProcessors)}return Eventful2.prototype.on=function(event,query,handler,context){this._$handlers||(this._$handlers={});var _h=this._$handlers;if("function"==typeof query&&(context=handler,handler=query,query=null),!handler||!event)return this;var eventProcessor=this._$eventProcessor;null!=query&&eventProcessor&&eventProcessor.normalizeQuery&&(query=eventProcessor.normalizeQuery(query)),_h[event]||(_h[event]=[]);for(var i=0;i<_h[event].length;i++)if(_h[event][i].h===handler)return this;var wrap={h:handler,query:query,ctx:context||this,callAtLast:handler.zrEventfulCallAtLast},lastIndex=_h[event].length-1,lastWrap=_h[event][lastIndex];return lastWrap&&lastWrap.callAtLast?_h[event].splice(lastIndex,0,wrap):_h[event].push(wrap),this},Eventful2.prototype.isSilent=function(eventName){var _h=this._$handlers;return!_h||!_h[eventName]||!_h[eventName].length},Eventful2.prototype.off=function(eventType,handler){var _h=this._$handlers;if(!_h)return this;if(!eventType)return this._$handlers={},this;if(handler){if(_h[eventType]){for(var newList=[],i=0,l=_h[eventType].length;i<l;i++)_h[eventType][i].h!==handler&&newList.push(_h[eventType][i]);_h[eventType]=newList}_h[eventType]&&0===_h[eventType].length&&delete _h[eventType]}else delete _h[eventType];return this},Eventful2.prototype.trigger=function(eventType){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];if(!this._$handlers)return this;var _h=this._$handlers[eventType],eventProcessor=this._$eventProcessor;if(_h)for(var argLen=args.length,len2=_h.length,i=0;i<len2;i++){var hItem=_h[i];if(!eventProcessor||!eventProcessor.filter||null==hItem.query||eventProcessor.filter(eventType,hItem.query))switch(argLen){case 0:hItem.h.call(hItem.ctx);break;case 1:hItem.h.call(hItem.ctx,args[0]);break;case 2:hItem.h.call(hItem.ctx,args[0],args[1]);break;default:hItem.h.apply(hItem.ctx,args)}}return eventProcessor&&eventProcessor.afterTrigger&&eventProcessor.afterTrigger(eventType),this},Eventful2.prototype.triggerWithContext=function(type){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];if(!this._$handlers)return this;var _h=this._$handlers[type],eventProcessor=this._$eventProcessor;if(_h)for(var argLen=args.length,ctx=args[argLen-1],len2=_h.length,i=0;i<len2;i++){var hItem=_h[i];if(!eventProcessor||!eventProcessor.filter||null==hItem.query||eventProcessor.filter(type,hItem.query))switch(argLen){case 0:hItem.h.call(ctx);break;case 1:hItem.h.call(ctx,args[0]);break;case 2:hItem.h.call(ctx,args[0],args[1]);break;default:hItem.h.apply(ctx,args.slice(1,argLen-1))}}return eventProcessor&&eventProcessor.afterTrigger&&eventProcessor.afterTrigger(type),this},Eventful2}(),LN2=Math.log(2);function determinant(rows,rank,rowStart,rowMask,colMask,detCache){var cacheKey=rowMask+"-"+colMask,fullRank=rows.length;if(detCache.hasOwnProperty(cacheKey))return detCache[cacheKey];if(1===rank){var colStart=Math.round(Math.log((1<<fullRank)-1&~colMask)/LN2);return rows[rowStart][colStart]}for(var subRowMask=rowMask|1<<rowStart,subRowStart=rowStart+1;rowMask&1<<subRowStart;)subRowStart++;for(var sum=0,j=0,colLocalIdx=0;j<fullRank;j++){var colTag=1<<j;colTag&colMask||(sum+=(colLocalIdx%2?-1:1)*rows[rowStart][j]*determinant(rows,rank-1,subRowStart,subRowMask,colMask|colTag,detCache),colLocalIdx++)}return detCache[cacheKey]=sum,sum}function buildTransformer(src,dest){var mA=[[src[0],src[1],1,0,0,0,-dest[0]*src[0],-dest[0]*src[1]],[0,0,0,src[0],src[1],1,-dest[1]*src[0],-dest[1]*src[1]],[src[2],src[3],1,0,0,0,-dest[2]*src[2],-dest[2]*src[3]],[0,0,0,src[2],src[3],1,-dest[3]*src[2],-dest[3]*src[3]],[src[4],src[5],1,0,0,0,-dest[4]*src[4],-dest[4]*src[5]],[0,0,0,src[4],src[5],1,-dest[5]*src[4],-dest[5]*src[5]],[src[6],src[7],1,0,0,0,-dest[6]*src[6],-dest[6]*src[7]],[0,0,0,src[6],src[7],1,-dest[7]*src[6],-dest[7]*src[7]]],detCache={},det=determinant(mA,8,0,0,0,detCache);if(0!==det){for(var vh=[],i=0;i<8;i++)for(var j=0;j<8;j++)null==vh[j]&&(vh[j]=0),vh[j]+=((i+j)%2?-1:1)*determinant(mA,7,0===i?1:0,1<<i,1<<j,detCache)/det*dest[i];return function(out2,srcPointX,srcPointY){var pk=srcPointX*vh[6]+srcPointY*vh[7]+1;out2[0]=(srcPointX*vh[0]+srcPointY*vh[1]+vh[2])/pk,out2[1]=(srcPointX*vh[3]+srcPointY*vh[4]+vh[5])/pk}}}var _calcOut$1=[];function transformCoordWithViewport(out2,el,inX,inY,inverse){if(el.getBoundingClientRect&&env.domSupported&&!isCanvasEl(el)){var saved=el.___zrEVENTSAVED||(el.___zrEVENTSAVED={}),markers=function(el,saved){var markers=saved.markers;if(markers)return markers;markers=saved.markers=[];for(var propLR=["left","right"],propTB=["top","bottom"],i=0;i<4;i++){var marker=document.createElement("div"),idxLR=i%2,idxTB=(i>>1)%2;marker.style.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",propLR[idxLR]+":0",propTB[idxTB]+":0",propLR[1-idxLR]+":auto",propTB[1-idxTB]+":auto",""].join("!important;"),el.appendChild(marker),markers.push(marker)}return markers}(el,saved),transformer=function(markers,saved,inverse){for(var transformerName=inverse?"invTrans":"trans",transformer=saved[transformerName],oldSrcCoords=saved.srcCoords,srcCoords=[],destCoords=[],oldCoordTheSame=!0,i=0;i<4;i++){var rect=markers[i].getBoundingClientRect(),ii=2*i,x=rect.left,y=rect.top;srcCoords.push(x,y),oldCoordTheSame=oldCoordTheSame&&oldSrcCoords&&x===oldSrcCoords[ii]&&y===oldSrcCoords[ii+1],destCoords.push(markers[i].offsetLeft,markers[i].offsetTop)}return oldCoordTheSame&&transformer?transformer:(saved.srcCoords=srcCoords,saved[transformerName]=inverse?buildTransformer(destCoords,srcCoords):buildTransformer(srcCoords,destCoords))}(markers,saved,inverse);if(transformer)return transformer(out2,inX,inY),!0}return!1}function isCanvasEl(el){return"CANVAS"===el.nodeName.toUpperCase()}var replaceReg=/([&<>"'])/g,replaceMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function encodeHTML(source){return null==source?"":(source+"").replace(replaceReg,(function(str,c){return replaceMap[c]}))}var MOUSE_EVENT_REG=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,_calcOut=[],firefoxNotSupportOffsetXY=env.browser.firefox&&+env.browser.version.split(".")[0]<39;function clientToLocal(el,e2,out2,calculate){return out2=out2||{},calculate?calculateZrXY(el,e2,out2):firefoxNotSupportOffsetXY&&null!=e2.layerX&&e2.layerX!==e2.offsetX?(out2.zrX=e2.layerX,out2.zrY=e2.layerY):null!=e2.offsetX?(out2.zrX=e2.offsetX,out2.zrY=e2.offsetY):calculateZrXY(el,e2,out2),out2}function calculateZrXY(el,e2,out2){if(env.domSupported&&el.getBoundingClientRect){var ex=e2.clientX,ey=e2.clientY;if(isCanvasEl(el)){var box2=el.getBoundingClientRect();return out2.zrX=ex-box2.left,void(out2.zrY=ey-box2.top)}if(transformCoordWithViewport(_calcOut,el,ex,ey))return out2.zrX=_calcOut[0],void(out2.zrY=_calcOut[1])}out2.zrX=out2.zrY=0}function getNativeEvent(e2){return e2||window.event}function normalizeEvent(el,e2,calculate){if(null!=(e2=getNativeEvent(e2)).zrX)return e2;var eventType=e2.type;if(eventType&&eventType.indexOf("touch")>=0){var touch="touchend"!==eventType?e2.targetTouches[0]:e2.changedTouches[0];touch&&clientToLocal(el,touch,e2,calculate)}else{clientToLocal(el,e2,e2,calculate);var wheelDelta=function(e2){var rawWheelDelta=e2.wheelDelta;if(rawWheelDelta)return rawWheelDelta;var deltaX=e2.deltaX,deltaY=e2.deltaY;if(null==deltaX||null==deltaY)return rawWheelDelta;return 3*(0!==deltaY?Math.abs(deltaY):Math.abs(deltaX))*(deltaY>0?-1:deltaY<0?1:deltaX>0?-1:1)}(e2);e2.zrDelta=wheelDelta?wheelDelta/120:-(e2.detail||0)/3}var button=e2.button;return null==e2.which&&void 0!==button&&MOUSE_EVENT_REG.test(e2.type)&&(e2.which=1&button?1:2&button?3:4&button?2:0),e2}function addEventListener(el,name,handler,opt){el.addEventListener(name,handler,opt)}var stop=function(e2){e2.preventDefault(),e2.stopPropagation(),e2.cancelBubble=!0};function isMiddleOrRightButtonOnMouseUpDown(e2){return 2===e2.which||3===e2.which}var GestureMgr=function(){function GestureMgr2(){this._track=[]}return GestureMgr2.prototype.recognize=function(event,target,root){return this._doTrack(event,target,root),this._recognize(event)},GestureMgr2.prototype.clear=function(){return this._track.length=0,this},GestureMgr2.prototype._doTrack=function(event,target,root){var touches=event.touches;if(touches){for(var trackItem={points:[],touches:[],target:target,event:event},i=0,len2=touches.length;i<len2;i++){var touch=touches[i],pos=clientToLocal(root,touch,{});trackItem.points.push([pos.zrX,pos.zrY]),trackItem.touches.push(touch)}this._track.push(trackItem)}},GestureMgr2.prototype._recognize=function(event){for(var eventName in recognizers)if(recognizers.hasOwnProperty(eventName)){var gestureInfo=recognizers[eventName](this._track,event);if(gestureInfo)return gestureInfo}},GestureMgr2}();function dist(pointPair){var dx=pointPair[1][0]-pointPair[0][0],dy=pointPair[1][1]-pointPair[0][1];return Math.sqrt(dx*dx+dy*dy)}var recognizers={pinch:function(tracks,event){var trackLen=tracks.length;if(trackLen){var pointPair,pinchEnd=(tracks[trackLen-1]||{}).points,pinchPre=(tracks[trackLen-2]||{}).points||pinchEnd;if(pinchPre&&pinchPre.length>1&&pinchEnd&&pinchEnd.length>1){var pinchScale=dist(pinchEnd)/dist(pinchPre);!isFinite(pinchScale)&&(pinchScale=1),event.pinchScale=pinchScale;var pinchCenter=[((pointPair=pinchEnd)[0][0]+pointPair[1][0])/2,(pointPair[0][1]+pointPair[1][1])/2];return event.pinchX=pinchCenter[0],event.pinchY=pinchCenter[1],{type:"pinch",target:tracks[0].target,event:event}}}}};function create(){return[1,0,0,1,0,0]}function identity(out2){return out2[0]=1,out2[1]=0,out2[2]=0,out2[3]=1,out2[4]=0,out2[5]=0,out2}function copy(out2,m2){return out2[0]=m2[0],out2[1]=m2[1],out2[2]=m2[2],out2[3]=m2[3],out2[4]=m2[4],out2[5]=m2[5],out2}function mul(out2,m1,m2){var out0=m1[0]*m2[0]+m1[2]*m2[1],out1=m1[1]*m2[0]+m1[3]*m2[1],out22=m1[0]*m2[2]+m1[2]*m2[3],out3=m1[1]*m2[2]+m1[3]*m2[3],out4=m1[0]*m2[4]+m1[2]*m2[5]+m1[4],out5=m1[1]*m2[4]+m1[3]*m2[5]+m1[5];return out2[0]=out0,out2[1]=out1,out2[2]=out22,out2[3]=out3,out2[4]=out4,out2[5]=out5,out2}function translate(out2,a,v){return out2[0]=a[0],out2[1]=a[1],out2[2]=a[2],out2[3]=a[3],out2[4]=a[4]+v[0],out2[5]=a[5]+v[1],out2}function rotate(out2,a,rad,pivot){void 0===pivot&&(pivot=[0,0]);var aa=a[0],ac=a[2],atx=a[4],ab=a[1],ad=a[3],aty=a[5],st=Math.sin(rad),ct=Math.cos(rad);return out2[0]=aa*ct+ab*st,out2[1]=-aa*st+ab*ct,out2[2]=ac*ct+ad*st,out2[3]=-ac*st+ct*ad,out2[4]=ct*(atx-pivot[0])+st*(aty-pivot[1])+pivot[0],out2[5]=ct*(aty-pivot[1])-st*(atx-pivot[0])+pivot[1],out2}function scale$1(out2,a,v){var vx=v[0],vy=v[1];return out2[0]=a[0]*vx,out2[1]=a[1]*vy,out2[2]=a[2]*vx,out2[3]=a[3]*vy,out2[4]=a[4]*vx,out2[5]=a[5]*vy,out2}function invert(out2,a){var aa=a[0],ac=a[2],atx=a[4],ab=a[1],ad=a[3],aty=a[5],det=aa*ad-ab*ac;return det?(det=1/det,out2[0]=ad*det,out2[1]=-ab*det,out2[2]=-ac*det,out2[3]=aa*det,out2[4]=(ac*aty-ad*atx)*det,out2[5]=(ab*atx-aa*aty)*det,out2):null}const matrix=Object.freeze(Object.defineProperty({__proto__:null,clone:function(a){var b=[1,0,0,1,0,0];return copy(b,a),b},copy:copy,create:create,identity:identity,invert:invert,mul:mul,rotate:rotate,scale:scale$1,translate:translate},Symbol.toStringTag,{value:"Module"}));var Point=function(){function Point2(x,y){this.x=x||0,this.y=y||0}return Point2.prototype.copy=function(other){return this.x=other.x,this.y=other.y,this},Point2.prototype.clone=function(){return new Point2(this.x,this.y)},Point2.prototype.set=function(x,y){return this.x=x,this.y=y,this},Point2.prototype.equal=function(other){return other.x===this.x&&other.y===this.y},Point2.prototype.add=function(other){return this.x+=other.x,this.y+=other.y,this},Point2.prototype.scale=function(scalar){this.x*=scalar,this.y*=scalar},Point2.prototype.scaleAndAdd=function(other,scalar){this.x+=other.x*scalar,this.y+=other.y*scalar},Point2.prototype.sub=function(other){return this.x-=other.x,this.y-=other.y,this},Point2.prototype.dot=function(other){return this.x*other.x+this.y*other.y},Point2.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Point2.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},Point2.prototype.normalize=function(){var len2=this.len();return this.x/=len2,this.y/=len2,this},Point2.prototype.distance=function(other){var dx=this.x-other.x,dy=this.y-other.y;return Math.sqrt(dx*dx+dy*dy)},Point2.prototype.distanceSquare=function(other){var dx=this.x-other.x,dy=this.y-other.y;return dx*dx+dy*dy},Point2.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},Point2.prototype.transform=function(m2){if(m2){var x=this.x,y=this.y;return this.x=m2[0]*x+m2[2]*y+m2[4],this.y=m2[1]*x+m2[3]*y+m2[5],this}},Point2.prototype.toArray=function(out2){return out2[0]=this.x,out2[1]=this.y,out2},Point2.prototype.fromArray=function(input){this.x=input[0],this.y=input[1]},Point2.set=function(p,x,y){p.x=x,p.y=y},Point2.copy=function(p,p2){p.x=p2.x,p.y=p2.y},Point2.len=function(p){return Math.sqrt(p.x*p.x+p.y*p.y)},Point2.lenSquare=function(p){return p.x*p.x+p.y*p.y},Point2.dot=function(p0,p1){return p0.x*p1.x+p0.y*p1.y},Point2.add=function(out2,p0,p1){out2.x=p0.x+p1.x,out2.y=p0.y+p1.y},Point2.sub=function(out2,p0,p1){out2.x=p0.x-p1.x,out2.y=p0.y-p1.y},Point2.scale=function(out2,p0,scalar){out2.x=p0.x*scalar,out2.y=p0.y*scalar},Point2.scaleAndAdd=function(out2,p0,p1,scalar){out2.x=p0.x+p1.x*scalar,out2.y=p0.y+p1.y*scalar},Point2.lerp=function(out2,p0,p1,t){var onet=1-t;out2.x=onet*p0.x+t*p1.x,out2.y=onet*p0.y+t*p1.y},Point2}(),mathMin$9=Math.min,mathMax$9=Math.max,lt=new Point,rb=new Point,lb=new Point,rt=new Point,minTv$1=new Point,maxTv$1=new Point,BoundingRect=function(){function BoundingRect2(x,y,width,height){width<0&&(x+=width,width=-width),height<0&&(y+=height,height=-height),this.x=x,this.y=y,this.width=width,this.height=height}return BoundingRect2.prototype.union=function(other){var x=mathMin$9(other.x,this.x),y=mathMin$9(other.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=mathMax$9(other.x+other.width,this.x+this.width)-x:this.width=other.width,isFinite(this.y)&&isFinite(this.height)?this.height=mathMax$9(other.y+other.height,this.y+this.height)-y:this.height=other.height,this.x=x,this.y=y},BoundingRect2.prototype.applyTransform=function(m2){BoundingRect2.applyTransform(this,this,m2)},BoundingRect2.prototype.calculateTransform=function(b){var a=this,sx=b.width/a.width,sy=b.height/a.height,m2=[1,0,0,1,0,0];return translate(m2,m2,[-a.x,-a.y]),scale$1(m2,m2,[sx,sy]),translate(m2,m2,[b.x,b.y]),m2},BoundingRect2.prototype.intersect=function(b,mtv){if(!b)return!1;b instanceof BoundingRect2||(b=BoundingRect2.create(b));var a=this,ax0=a.x,ax1=a.x+a.width,ay0=a.y,ay1=a.y+a.height,bx0=b.x,bx1=b.x+b.width,by0=b.y,by1=b.y+b.height,overlap=!(ax1<bx0||bx1<ax0||ay1<by0||by1<ay0);if(mtv){var dMin=Infinity,dMax=0,d0=Math.abs(ax1-bx0),d1=Math.abs(bx1-ax0),d2=Math.abs(ay1-by0),d3=Math.abs(by1-ay0),dx=Math.min(d0,d1),dy=Math.min(d2,d3);ax1<bx0||bx1<ax0?dx>dMax&&(dMax=dx,d0<d1?Point.set(maxTv$1,-d0,0):Point.set(maxTv$1,d1,0)):dx<dMin&&(dMin=dx,d0<d1?Point.set(minTv$1,d0,0):Point.set(minTv$1,-d1,0)),ay1<by0||by1<ay0?dy>dMax&&(dMax=dy,d2<d3?Point.set(maxTv$1,0,-d2):Point.set(maxTv$1,0,d3)):dx<dMin&&(dMin=dx,d2<d3?Point.set(minTv$1,0,d2):Point.set(minTv$1,0,-d3))}return mtv&&Point.copy(mtv,overlap?minTv$1:maxTv$1),overlap},BoundingRect2.prototype.contain=function(x,y){return x>=this.x&&x<=this.x+this.width&&y>=this.y&&y<=this.y+this.height},BoundingRect2.prototype.clone=function(){return new BoundingRect2(this.x,this.y,this.width,this.height)},BoundingRect2.prototype.copy=function(other){BoundingRect2.copy(this,other)},BoundingRect2.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},BoundingRect2.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},BoundingRect2.prototype.isZero=function(){return 0===this.width||0===this.height},BoundingRect2.create=function(rect){return new BoundingRect2(rect.x,rect.y,rect.width,rect.height)},BoundingRect2.copy=function(target,source){target.x=source.x,target.y=source.y,target.width=source.width,target.height=source.height},BoundingRect2.applyTransform=function(target,source,m2){if(m2){if(m2[1]<1e-5&&m2[1]>-1e-5&&m2[2]<1e-5&&m2[2]>-1e-5){var sx=m2[0],sy=m2[3],tx=m2[4],ty=m2[5];return target.x=source.x*sx+tx,target.y=source.y*sy+ty,target.width=source.width*sx,target.height=source.height*sy,target.width<0&&(target.x+=target.width,target.width=-target.width),void(target.height<0&&(target.y+=target.height,target.height=-target.height))}lt.x=lb.x=source.x,lt.y=rt.y=source.y,rb.x=rt.x=source.x+source.width,rb.y=lb.y=source.y+source.height,lt.transform(m2),rt.transform(m2),rb.transform(m2),lb.transform(m2),target.x=mathMin$9(lt.x,rb.x,lb.x,rt.x),target.y=mathMin$9(lt.y,rb.y,lb.y,rt.y);var maxX=mathMax$9(lt.x,rb.x,lb.x,rt.x),maxY=mathMax$9(lt.y,rb.y,lb.y,rt.y);target.width=maxX-target.x,target.height=maxY-target.y}else target!==source&&BoundingRect2.copy(target,source)},BoundingRect2}();function stopEvent(){stop(this.event)}var EmptyProxy=function(_super){function EmptyProxy2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.handler=null,_this}return __extends(EmptyProxy2,_super),EmptyProxy2.prototype.dispose=function(){},EmptyProxy2.prototype.setCursor=function(){},EmptyProxy2}(Eventful),HoveredResult=function(){return function(x,y){this.x=x,this.y=y}}(),handlerNames=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],tmpRect$1=new BoundingRect(0,0,0,0),Handler=function(_super){function Handler2(storage2,painter,proxy,painterRoot,pointerSize){var _this=_super.call(this)||this;return _this._hovered=new HoveredResult(0,0),_this.storage=storage2,_this.painter=painter,_this.painterRoot=painterRoot,_this._pointerSize=pointerSize,proxy=proxy||new EmptyProxy,_this.proxy=null,_this.setHandlerProxy(proxy),_this._draggingMgr=new Draggable(_this),_this}return __extends(Handler2,_super),Handler2.prototype.setHandlerProxy=function(proxy){this.proxy&&this.proxy.dispose(),proxy&&(each$d(handlerNames,(function(name){proxy.on&&proxy.on(name,this[name],this)}),this),proxy.handler=this),this.proxy=proxy},Handler2.prototype.mousemove=function(event){var x=event.zrX,y=event.zrY,isOutside=isOutsideBoundary(this,x,y),lastHovered=this._hovered,lastHoveredTarget=lastHovered.target;lastHoveredTarget&&!lastHoveredTarget.__zr&&(lastHoveredTarget=(lastHovered=this.findHover(lastHovered.x,lastHovered.y)).target);var hovered=this._hovered=isOutside?new HoveredResult(x,y):this.findHover(x,y),hoveredTarget=hovered.target,proxy=this.proxy;proxy.setCursor&&proxy.setCursor(hoveredTarget?hoveredTarget.cursor:"default"),lastHoveredTarget&&hoveredTarget!==lastHoveredTarget&&this.dispatchToElement(lastHovered,"mouseout",event),this.dispatchToElement(hovered,"mousemove",event),hoveredTarget&&hoveredTarget!==lastHoveredTarget&&this.dispatchToElement(hovered,"mouseover",event)},Handler2.prototype.mouseout=function(event){var eventControl=event.zrEventControl;"only_globalout"!==eventControl&&this.dispatchToElement(this._hovered,"mouseout",event),"no_globalout"!==eventControl&&this.trigger("globalout",{type:"globalout",event:event})},Handler2.prototype.resize=function(){this._hovered=new HoveredResult(0,0)},Handler2.prototype.dispatch=function(eventName,eventArgs){var handler=this[eventName];handler&&handler.call(this,eventArgs)},Handler2.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},Handler2.prototype.setCursorStyle=function(cursorStyle){var proxy=this.proxy;proxy.setCursor&&proxy.setCursor(cursorStyle)},Handler2.prototype.dispatchToElement=function(targetInfo,eventName,event){var el=(targetInfo=targetInfo||{}).target;if(!el||!el.silent){for(var eventKey="on"+eventName,eventPacket=function(eveType,targetInfo,event){return{type:eveType,event:event,target:targetInfo.target,topTarget:targetInfo.topTarget,cancelBubble:!1,offsetX:event.zrX,offsetY:event.zrY,gestureEvent:event.gestureEvent,pinchX:event.pinchX,pinchY:event.pinchY,pinchScale:event.pinchScale,wheelDelta:event.zrDelta,zrByTouch:event.zrByTouch,which:event.which,stop:stopEvent}}(eventName,targetInfo,event);el&&(el[eventKey]&&(eventPacket.cancelBubble=!!el[eventKey].call(el,eventPacket)),el.trigger(eventName,eventPacket),el=el.__hostTarget?el.__hostTarget:el.parent,!eventPacket.cancelBubble););eventPacket.cancelBubble||(this.trigger(eventName,eventPacket),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer((function(layer){"function"==typeof layer[eventKey]&&layer[eventKey].call(layer,eventPacket),layer.trigger&&layer.trigger(eventName,eventPacket)})))}},Handler2.prototype.findHover=function(x,y,exclude){var list=this.storage.getDisplayList(),out2=new HoveredResult(x,y);if(setHoverTarget(list,out2,x,y,exclude),this._pointerSize&&!out2.target){for(var candidates=[],pointerSize=this._pointerSize,targetSizeHalf=pointerSize/2,pointerRect=new BoundingRect(x-targetSizeHalf,y-targetSizeHalf,pointerSize,pointerSize),i=list.length-1;i>=0;i--){var el=list[i];el===exclude||el.ignore||el.ignoreCoarsePointer||el.parent&&el.parent.ignoreCoarsePointer||(tmpRect$1.copy(el.getBoundingRect()),el.transform&&tmpRect$1.applyTransform(el.transform),tmpRect$1.intersect(pointerRect)&&candidates.push(el))}if(candidates.length)for(var thetaStep=Math.PI/12,PI22=2*Math.PI,r=0;r<targetSizeHalf;r+=4)for(var theta=0;theta<PI22;theta+=thetaStep){if(setHoverTarget(candidates,out2,x+r*Math.cos(theta),y+r*Math.sin(theta),exclude),out2.target)return out2}}return out2},Handler2.prototype.processGesture=function(event,stage){this._gestureMgr||(this._gestureMgr=new GestureMgr);var gestureMgr=this._gestureMgr;"start"===stage&&gestureMgr.clear();var gestureInfo=gestureMgr.recognize(event,this.findHover(event.zrX,event.zrY,null).target,this.proxy.dom);if("end"===stage&&gestureMgr.clear(),gestureInfo){var type=gestureInfo.type;event.gestureEvent=type;var res=new HoveredResult;res.target=gestureInfo.target,this.dispatchToElement(res,type,gestureInfo.event)}},Handler2}(Eventful);function isHover(displayable,x,y){if(displayable[displayable.rectHover?"rectContain":"contain"](x,y)){for(var el=displayable,isSilent=void 0,ignoreClip=!1;el;){if(el.ignoreClip&&(ignoreClip=!0),!ignoreClip){var clipPath=el.getClipPath();if(clipPath&&!clipPath.contain(x,y))return!1}el.silent&&(isSilent=!0);var hostEl=el.__hostTarget;el=hostEl||el.parent}return!isSilent||"silent"}return!1}function setHoverTarget(list,out2,x,y,exclude){for(var i=list.length-1;i>=0;i--){var el=list[i],hoverCheckResult=void 0;if(el!==exclude&&!el.ignore&&(hoverCheckResult=isHover(el,x,y))&&(!out2.topTarget&&(out2.topTarget=el),"silent"!==hoverCheckResult)){out2.target=el;break}}}function isOutsideBoundary(handlerInstance,x,y){var painter=handlerInstance.painter;return x<0||x>painter.getWidth()||y<0||y>painter.getHeight()}each$d(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],(function(name){Handler.prototype[name]=function(event){var hovered,hoveredTarget,x=event.zrX,y=event.zrY,isOutside=isOutsideBoundary(this,x,y);if("mouseup"===name&&isOutside||(hoveredTarget=(hovered=this.findHover(x,y)).target),"mousedown"===name)this._downEl=hoveredTarget,this._downPoint=[event.zrX,event.zrY],this._upEl=hoveredTarget;else if("mouseup"===name)this._upEl=hoveredTarget;else if("click"===name){if(this._downEl!==this._upEl||!this._downPoint||dist$1(this._downPoint,[event.zrX,event.zrY])>4)return;this._downPoint=null}this.dispatchToElement(hovered,name,event)}}));function makeAscendingRun(array,lo,hi,compare2){var runHi=lo+1;if(runHi===hi)return 1;if(compare2(array[runHi++],array[lo])<0){for(;runHi<hi&&compare2(array[runHi],array[runHi-1])<0;)runHi++;!function(array,lo,hi){hi--;for(;lo<hi;){var t=array[lo];array[lo++]=array[hi],array[hi--]=t}}(array,lo,runHi)}else for(;runHi<hi&&compare2(array[runHi],array[runHi-1])>=0;)runHi++;return runHi-lo}function binaryInsertionSort(array,lo,hi,start2,compare2){for(start2===lo&&start2++;start2<hi;start2++){for(var mid,pivot=array[start2],left=lo,right=start2;left<right;)compare2(pivot,array[mid=left+right>>>1])<0?right=mid:left=mid+1;var n=start2-left;switch(n){case 3:array[left+3]=array[left+2];case 2:array[left+2]=array[left+1];case 1:array[left+1]=array[left];break;default:for(;n>0;)array[left+n]=array[left+n-1],n--}array[left]=pivot}}function gallopLeft(value,array,start2,length2,hint,compare2){var lastOffset=0,maxOffset=0,offset=1;if(compare2(value,array[start2+hint])>0){for(maxOffset=length2-hint;offset<maxOffset&&compare2(value,array[start2+hint+offset])>0;)lastOffset=offset,(offset=1+(offset<<1))<=0&&(offset=maxOffset);offset>maxOffset&&(offset=maxOffset),lastOffset+=hint,offset+=hint}else{for(maxOffset=hint+1;offset<maxOffset&&compare2(value,array[start2+hint-offset])<=0;)lastOffset=offset,(offset=1+(offset<<1))<=0&&(offset=maxOffset);offset>maxOffset&&(offset=maxOffset);var tmp=lastOffset;lastOffset=hint-offset,offset=hint-tmp}for(lastOffset++;lastOffset<offset;){var m2=lastOffset+(offset-lastOffset>>>1);compare2(value,array[start2+m2])>0?lastOffset=m2+1:offset=m2}return offset}function gallopRight(value,array,start2,length2,hint,compare2){var lastOffset=0,maxOffset=0,offset=1;if(compare2(value,array[start2+hint])<0){for(maxOffset=hint+1;offset<maxOffset&&compare2(value,array[start2+hint-offset])<0;)lastOffset=offset,(offset=1+(offset<<1))<=0&&(offset=maxOffset);offset>maxOffset&&(offset=maxOffset);var tmp=lastOffset;lastOffset=hint-offset,offset=hint-tmp}else{for(maxOffset=length2-hint;offset<maxOffset&&compare2(value,array[start2+hint+offset])>=0;)lastOffset=offset,(offset=1+(offset<<1))<=0&&(offset=maxOffset);offset>maxOffset&&(offset=maxOffset),lastOffset+=hint,offset+=hint}for(lastOffset++;lastOffset<offset;){var m2=lastOffset+(offset-lastOffset>>>1);compare2(value,array[start2+m2])<0?offset=m2:lastOffset=m2+1}return offset}function TimSort(array,compare2){var runStart,runLength,minGallop=7,stackSize=0,tmp=[];function mergeAt(i){var start1=runStart[i],length1=runLength[i],start2=runStart[i+1],length2=runLength[i+1];runLength[i]=length1+length2,i===stackSize-3&&(runStart[i+1]=runStart[i+2],runLength[i+1]=runLength[i+2]),stackSize--;var k=gallopRight(array[start2],array,start1,length1,0,compare2);start1+=k,0!==(length1-=k)&&0!==(length2=gallopLeft(array[start1+length1-1],array,start2,length2,length2-1,compare2))&&(length1<=length2?function(start1,length1,start2,length2){var i=0;for(i=0;i<length1;i++)tmp[i]=array[start1+i];var cursor1=0,cursor2=start2,dest=start1;if(array[dest++]=array[cursor2++],0==--length2){for(i=0;i<length1;i++)array[dest+i]=tmp[cursor1+i];return}if(1===length1){for(i=0;i<length2;i++)array[dest+i]=array[cursor2+i];return void(array[dest+length2]=tmp[cursor1])}var count1,count2,exit,_minGallop=minGallop;for(;;){count1=0,count2=0,exit=!1;do{if(compare2(array[cursor2],tmp[cursor1])<0){if(array[dest++]=array[cursor2++],count2++,count1=0,0==--length2){exit=!0;break}}else if(array[dest++]=tmp[cursor1++],count1++,count2=0,1==--length1){exit=!0;break}}while((count1|count2)<_minGallop);if(exit)break;do{if(0!==(count1=gallopRight(array[cursor2],tmp,cursor1,length1,0,compare2))){for(i=0;i<count1;i++)array[dest+i]=tmp[cursor1+i];if(dest+=count1,cursor1+=count1,(length1-=count1)<=1){exit=!0;break}}if(array[dest++]=array[cursor2++],0==--length2){exit=!0;break}if(0!==(count2=gallopLeft(tmp[cursor1],array,cursor2,length2,0,compare2))){for(i=0;i<count2;i++)array[dest+i]=array[cursor2+i];if(dest+=count2,cursor2+=count2,0===(length2-=count2)){exit=!0;break}}if(array[dest++]=tmp[cursor1++],1==--length1){exit=!0;break}_minGallop--}while(count1>=7||count2>=7);if(exit)break;_minGallop<0&&(_minGallop=0),_minGallop+=2}if((minGallop=_minGallop)<1&&(minGallop=1),1===length1){for(i=0;i<length2;i++)array[dest+i]=array[cursor2+i];array[dest+length2]=tmp[cursor1]}else{if(0===length1)throw new Error;for(i=0;i<length1;i++)array[dest+i]=tmp[cursor1+i]}}(start1,length1,start2,length2):function(start1,length1,start2,length2){var i=0;for(i=0;i<length2;i++)tmp[i]=array[start2+i];var cursor1=start1+length1-1,cursor2=length2-1,dest=start2+length2-1,customCursor=0,customDest=0;if(array[dest--]=array[cursor1--],0==--length1){for(customCursor=dest-(length2-1),i=0;i<length2;i++)array[customCursor+i]=tmp[i];return}if(1===length2){for(customDest=(dest-=length1)+1,customCursor=(cursor1-=length1)+1,i=length1-1;i>=0;i--)array[customDest+i]=array[customCursor+i];return void(array[dest]=tmp[cursor2])}var _minGallop=minGallop;for(;;){var count1=0,count2=0,exit=!1;do{if(compare2(tmp[cursor2],array[cursor1])<0){if(array[dest--]=array[cursor1--],count1++,count2=0,0==--length1){exit=!0;break}}else if(array[dest--]=tmp[cursor2--],count2++,count1=0,1==--length2){exit=!0;break}}while((count1|count2)<_minGallop);if(exit)break;do{if(0!==(count1=length1-gallopRight(tmp[cursor2],array,start1,length1,length1-1,compare2))){for(length1-=count1,customDest=(dest-=count1)+1,customCursor=(cursor1-=count1)+1,i=count1-1;i>=0;i--)array[customDest+i]=array[customCursor+i];if(0===length1){exit=!0;break}}if(array[dest--]=tmp[cursor2--],1==--length2){exit=!0;break}if(0!==(count2=length2-gallopLeft(array[cursor1],tmp,0,length2,length2-1,compare2))){for(length2-=count2,customDest=(dest-=count2)+1,customCursor=(cursor2-=count2)+1,i=0;i<count2;i++)array[customDest+i]=tmp[customCursor+i];if(length2<=1){exit=!0;break}}if(array[dest--]=array[cursor1--],0==--length1){exit=!0;break}_minGallop--}while(count1>=7||count2>=7);if(exit)break;_minGallop<0&&(_minGallop=0),_minGallop+=2}(minGallop=_minGallop)<1&&(minGallop=1);if(1===length2){for(customDest=(dest-=length1)+1,customCursor=(cursor1-=length1)+1,i=length1-1;i>=0;i--)array[customDest+i]=array[customCursor+i];array[dest]=tmp[cursor2]}else{if(0===length2)throw new Error;for(customCursor=dest-(length2-1),i=0;i<length2;i++)array[customCursor+i]=tmp[i]}}(start1,length1,start2,length2))}return runStart=[],runLength=[],{mergeRuns:function(){for(;stackSize>1;){var n=stackSize-2;if(n>=1&&runLength[n-1]<=runLength[n]+runLength[n+1]||n>=2&&runLength[n-2]<=runLength[n]+runLength[n-1])runLength[n-1]<runLength[n+1]&&n--;else if(runLength[n]>runLength[n+1])break;mergeAt(n)}},forceMergeRuns:function(){for(;stackSize>1;){var n=stackSize-2;n>0&&runLength[n-1]<runLength[n+1]&&n--,mergeAt(n)}},pushRun:function(_runStart,_runLength){runStart[stackSize]=_runStart,runLength[stackSize]=_runLength,stackSize+=1}}}function sort(array,compare2,lo,hi){lo||(lo=0),hi||(hi=array.length);var remaining=hi-lo;if(!(remaining<2)){var runLength=0;if(remaining<32)binaryInsertionSort(array,lo,hi,lo+(runLength=makeAscendingRun(array,lo,hi,compare2)),compare2);else{var ts=TimSort(array,compare2),minRun=function(n){for(var r=0;n>=32;)r|=1&n,n>>=1;return n+r}(remaining);do{if((runLength=makeAscendingRun(array,lo,hi,compare2))<minRun){var force=remaining;force>minRun&&(force=minRun),binaryInsertionSort(array,lo,lo+force,lo+runLength,compare2),runLength=force}ts.pushRun(lo,runLength),ts.mergeRuns(),remaining-=runLength,lo+=runLength}while(0!==remaining);ts.forceMergeRuns()}}}var invalidZErrorLogged=!1;function logInvalidZError(){invalidZErrorLogged||(invalidZErrorLogged=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function shapeCompareFunc(a,b){return a.zlevel===b.zlevel?a.z===b.z?a.z2-b.z2:a.z-b.z:a.zlevel-b.zlevel}var requestAnimationFrame,Storage=function(){function Storage2(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=shapeCompareFunc}return Storage2.prototype.traverse=function(cb,context){for(var i=0;i<this._roots.length;i++)this._roots[i].traverse(cb,context)},Storage2.prototype.getDisplayList=function(update,includeIgnore){includeIgnore=includeIgnore||!1;var displayList=this._displayList;return!update&&displayList.length||this.updateDisplayList(includeIgnore),displayList},Storage2.prototype.updateDisplayList=function(includeIgnore){this._displayListLen=0;for(var roots2=this._roots,displayList=this._displayList,i=0,len2=roots2.length;i<len2;i++)this._updateAndAddDisplayable(roots2[i],null,includeIgnore);displayList.length=this._displayListLen,sort(displayList,shapeCompareFunc)},Storage2.prototype._updateAndAddDisplayable=function(el,clipPaths,includeIgnore){if(!el.ignore||includeIgnore){el.beforeUpdate(),el.update(),el.afterUpdate();var userSetClipPath=el.getClipPath();if(el.ignoreClip)clipPaths=null;else if(userSetClipPath){clipPaths=clipPaths?clipPaths.slice():[];for(var currentClipPath=userSetClipPath,parentClipPath=el;currentClipPath;)currentClipPath.parent=parentClipPath,currentClipPath.updateTransform(),clipPaths.push(currentClipPath),parentClipPath=currentClipPath,currentClipPath=currentClipPath.getClipPath()}if(el.childrenRef){for(var children=el.childrenRef(),i=0;i<children.length;i++){var child=children[i];el.__dirty&&(child.__dirty|=1),this._updateAndAddDisplayable(child,clipPaths,includeIgnore)}el.__dirty=0}else{var disp=el;clipPaths&&clipPaths.length?disp.__clipPaths=clipPaths:disp.__clipPaths&&disp.__clipPaths.length>0&&(disp.__clipPaths=[]),isNaN(disp.z)&&(logInvalidZError(),disp.z=0),isNaN(disp.z2)&&(logInvalidZError(),disp.z2=0),isNaN(disp.zlevel)&&(logInvalidZError(),disp.zlevel=0),this._displayList[this._displayListLen++]=disp}var decalEl=el.getDecalElement&&el.getDecalElement();decalEl&&this._updateAndAddDisplayable(decalEl,clipPaths,includeIgnore);var textGuide=el.getTextGuideLine();textGuide&&this._updateAndAddDisplayable(textGuide,clipPaths,includeIgnore);var textEl=el.getTextContent();textEl&&this._updateAndAddDisplayable(textEl,clipPaths,includeIgnore)}},Storage2.prototype.addRoot=function(el){el.__zr&&el.__zr.storage===this||this._roots.push(el)},Storage2.prototype.delRoot=function(el){if(el instanceof Array)for(var i=0,l=el.length;i<l;i++)this.delRoot(el[i]);else{var idx=indexOf(this._roots,el);idx>=0&&this._roots.splice(idx,1)}},Storage2.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},Storage2.prototype.getRoots=function(){return this._roots},Storage2.prototype.dispose=function(){this._displayList=null,this._roots=null},Storage2}();requestAnimationFrame=env.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(func){return setTimeout(func,16)};var easingFuncs={linear:function(k){return k},quadraticIn:function(k){return k*k},quadraticOut:function(k){return k*(2-k)},quadraticInOut:function(k){return(k*=2)<1?.5*k*k:-.5*(--k*(k-2)-1)},cubicIn:function(k){return k*k*k},cubicOut:function(k){return--k*k*k+1},cubicInOut:function(k){return(k*=2)<1?.5*k*k*k:.5*((k-=2)*k*k+2)},quarticIn:function(k){return k*k*k*k},quarticOut:function(k){return 1- --k*k*k*k},quarticInOut:function(k){return(k*=2)<1?.5*k*k*k*k:-.5*((k-=2)*k*k*k-2)},quinticIn:function(k){return k*k*k*k*k},quinticOut:function(k){return--k*k*k*k*k+1},quinticInOut:function(k){return(k*=2)<1?.5*k*k*k*k*k:.5*((k-=2)*k*k*k*k+2)},sinusoidalIn:function(k){return 1-Math.cos(k*Math.PI/2)},sinusoidalOut:function(k){return Math.sin(k*Math.PI/2)},sinusoidalInOut:function(k){return.5*(1-Math.cos(Math.PI*k))},exponentialIn:function(k){return 0===k?0:Math.pow(1024,k-1)},exponentialOut:function(k){return 1===k?1:1-Math.pow(2,-10*k)},exponentialInOut:function(k){return 0===k?0:1===k?1:(k*=2)<1?.5*Math.pow(1024,k-1):.5*(2-Math.pow(2,-10*(k-1)))},circularIn:function(k){return 1-Math.sqrt(1-k*k)},circularOut:function(k){return Math.sqrt(1- --k*k)},circularInOut:function(k){return(k*=2)<1?-.5*(Math.sqrt(1-k*k)-1):.5*(Math.sqrt(1-(k-=2)*k)+1)},elasticIn:function(k){var s,a=.1;return 0===k?0:1===k?1:(!a||a<1?(a=1,s=.1):s=.4*Math.asin(1/a)/(2*Math.PI),-a*Math.pow(2,10*(k-=1))*Math.sin((k-s)*(2*Math.PI)/.4))},elasticOut:function(k){var s,a=.1;return 0===k?0:1===k?1:(!a||a<1?(a=1,s=.1):s=.4*Math.asin(1/a)/(2*Math.PI),a*Math.pow(2,-10*k)*Math.sin((k-s)*(2*Math.PI)/.4)+1)},elasticInOut:function(k){var s,a=.1,p=.4;return 0===k?0:1===k?1:(!a||a<1?(a=1,s=.1):s=p*Math.asin(1/a)/(2*Math.PI),(k*=2)<1?a*Math.pow(2,10*(k-=1))*Math.sin((k-s)*(2*Math.PI)/p)*-.5:a*Math.pow(2,-10*(k-=1))*Math.sin((k-s)*(2*Math.PI)/p)*.5+1)},backIn:function(k){var s=1.70158;return k*k*((s+1)*k-s)},backOut:function(k){var s=1.70158;return--k*k*((s+1)*k+s)+1},backInOut:function(k){var s=2.5949095;return(k*=2)<1?k*k*((s+1)*k-s)*.5:.5*((k-=2)*k*((s+1)*k+s)+2)},bounceIn:function(k){return 1-easingFuncs.bounceOut(1-k)},bounceOut:function(k){return k<1/2.75?7.5625*k*k:k<2/2.75?7.5625*(k-=1.5/2.75)*k+.75:k<2.5/2.75?7.5625*(k-=2.25/2.75)*k+.9375:7.5625*(k-=2.625/2.75)*k+.984375},bounceInOut:function(k){return k<.5?.5*easingFuncs.bounceIn(2*k):.5*easingFuncs.bounceOut(2*k-1)+.5}},mathPow$2=Math.pow,mathSqrt$3=Math.sqrt,THREE_SQRT=mathSqrt$3(3),ONE_THIRD=1/3,_v0=create$1(),_v1=create$1(),_v2=create$1();function isAroundZero$1(val){return val>-1e-8&&val<1e-8}function isNotAroundZero$1(val){return val>1e-8||val<-1e-8}function cubicAt(p0,p1,p2,p3,t){var onet=1-t;return onet*onet*(onet*p0+3*t*p1)+t*t*(t*p3+3*onet*p2)}function cubicDerivativeAt(p0,p1,p2,p3,t){var onet=1-t;return 3*(((p1-p0)*onet+2*(p2-p1)*t)*onet+(p3-p2)*t*t)}function cubicRootAt(p0,p1,p2,p3,val,roots2){var a=p3+3*(p1-p2)-p0,b=3*(p2-2*p1+p0),c=3*(p1-p0),d=p0-val,A=b*b-3*a*c,B=b*c-9*a*d,C=c*c-3*b*d,n=0;if(isAroundZero$1(A)&&isAroundZero$1(B)){if(isAroundZero$1(b))roots2[0]=0;else(t1=-c/b)>=0&&t1<=1&&(roots2[n++]=t1)}else{var disc=B*B-4*A*C;if(isAroundZero$1(disc)){var K=B/A,t2=-K/2;(t1=-b/a+K)>=0&&t1<=1&&(roots2[n++]=t1),t2>=0&&t2<=1&&(roots2[n++]=t2)}else if(disc>0){var discSqrt=mathSqrt$3(disc),Y1=A*b+1.5*a*(-B+discSqrt),Y2=A*b+1.5*a*(-B-discSqrt);(t1=(-b-((Y1=Y1<0?-mathPow$2(-Y1,ONE_THIRD):mathPow$2(Y1,ONE_THIRD))+(Y2=Y2<0?-mathPow$2(-Y2,ONE_THIRD):mathPow$2(Y2,ONE_THIRD))))/(3*a))>=0&&t1<=1&&(roots2[n++]=t1)}else{var T=(2*A*b-3*a*B)/(2*mathSqrt$3(A*A*A)),theta=Math.acos(T)/3,ASqrt=mathSqrt$3(A),tmp=Math.cos(theta),t1=(-b-2*ASqrt*tmp)/(3*a),t3=(t2=(-b+ASqrt*(tmp+THREE_SQRT*Math.sin(theta)))/(3*a),(-b+ASqrt*(tmp-THREE_SQRT*Math.sin(theta)))/(3*a));t1>=0&&t1<=1&&(roots2[n++]=t1),t2>=0&&t2<=1&&(roots2[n++]=t2),t3>=0&&t3<=1&&(roots2[n++]=t3)}}return n}function cubicExtrema(p0,p1,p2,p3,extrema2){var b=6*p2-12*p1+6*p0,a=9*p1+3*p3-3*p0-9*p2,c=3*p1-3*p0,n=0;if(isAroundZero$1(a)){if(isNotAroundZero$1(b))(t1=-c/b)>=0&&t1<=1&&(extrema2[n++]=t1)}else{var disc=b*b-4*a*c;if(isAroundZero$1(disc))extrema2[0]=-b/(2*a);else if(disc>0){var t1,discSqrt=mathSqrt$3(disc),t2=(-b-discSqrt)/(2*a);(t1=(-b+discSqrt)/(2*a))>=0&&t1<=1&&(extrema2[n++]=t1),t2>=0&&t2<=1&&(extrema2[n++]=t2)}}return n}function cubicSubdivide(p0,p1,p2,p3,t,out2){var p01=(p1-p0)*t+p0,p12=(p2-p1)*t+p1,p23=(p3-p2)*t+p2,p012=(p12-p01)*t+p01,p123=(p23-p12)*t+p12,p0123=(p123-p012)*t+p012;out2[0]=p0,out2[1]=p01,out2[2]=p012,out2[3]=p0123,out2[4]=p0123,out2[5]=p123,out2[6]=p23,out2[7]=p3}function cubicLength(x0,y0,x1,y1,x2,y2,x3,y3,iteration){for(var px=x0,py=y0,d=0,step=1/iteration,i=1;i<=iteration;i++){var t=i*step,x=cubicAt(x0,x1,x2,x3,t),y=cubicAt(y0,y1,y2,y3,t),dx=x-px,dy=y-py;d+=Math.sqrt(dx*dx+dy*dy),px=x,py=y}return d}function quadraticAt(p0,p1,p2,t){var onet=1-t;return onet*(onet*p0+2*t*p1)+t*t*p2}function quadraticDerivativeAt(p0,p1,p2,t){return 2*((1-t)*(p1-p0)+t*(p2-p1))}function quadraticExtremum(p0,p1,p2){var divider=p0+p2-2*p1;return 0===divider?.5:(p0-p1)/divider}function quadraticSubdivide(p0,p1,p2,t,out2){var p01=(p1-p0)*t+p0,p12=(p2-p1)*t+p1,p012=(p12-p01)*t+p01;out2[0]=p0,out2[1]=p01,out2[2]=p012,out2[3]=p012,out2[4]=p12,out2[5]=p2}function quadraticLength(x0,y0,x1,y1,x2,y2,iteration){for(var px=x0,py=y0,d=0,step=1/iteration,i=1;i<=iteration;i++){var t=i*step,x=quadraticAt(x0,x1,x2,t),y=quadraticAt(y0,y1,y2,t),dx=x-px,dy=y-py;d+=Math.sqrt(dx*dx+dy*dy),px=x,py=y}return d}var regexp=/cubic-bezier\(([0-9,\.e ]+)\)/;function createCubicEasingFunc(cubicEasingStr){var cubic=cubicEasingStr&&regexp.exec(cubicEasingStr);if(cubic){var points2=cubic[1].split(","),a_1=+trim$1(points2[0]),b_1=+trim$1(points2[1]),c_1=+trim$1(points2[2]),d_1=+trim$1(points2[3]);if(isNaN(a_1+b_1+c_1+d_1))return;var roots_1=[];return function(p){return p<=0?0:p>=1?1:cubicRootAt(0,a_1,c_1,1,p,roots_1)&&cubicAt(0,b_1,d_1,1,roots_1[0])}}}var Clip=function(){function Clip2(opts){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=opts.life||1e3,this._delay=opts.delay||0,this.loop=opts.loop||!1,this.onframe=opts.onframe||noop,this.ondestroy=opts.ondestroy||noop,this.onrestart=opts.onrestart||noop,opts.easing&&this.setEasing(opts.easing)}return Clip2.prototype.step=function(globalTime,deltaTime){if(this._inited||(this._startTime=globalTime+this._delay,this._inited=!0),!this._paused){var life=this._life,elapsedTime=globalTime-this._startTime-this._pausedTime,percent=elapsedTime/life;percent<0&&(percent=0),percent=Math.min(percent,1);var easingFunc=this.easingFunc,schedule=easingFunc?easingFunc(percent):percent;if(this.onframe(schedule),1===percent){if(!this.loop)return!0;var remainder=elapsedTime%life;this._startTime=globalTime-remainder,this._pausedTime=0,this.onrestart()}return!1}this._pausedTime+=deltaTime},Clip2.prototype.pause=function(){this._paused=!0},Clip2.prototype.resume=function(){this._paused=!1},Clip2.prototype.setEasing=function(easing){this.easing=easing,this.easingFunc=isFunction(easing)?easing:easingFuncs[easing]||createCubicEasingFunc(easing)},Clip2}(),Entry=function(){return function(val){this.value=val}}(),LinkedList=function(){function LinkedList2(){this._len=0}return LinkedList2.prototype.insert=function(val){var entry=new Entry(val);return this.insertEntry(entry),entry},LinkedList2.prototype.insertEntry=function(entry){this.head?(this.tail.next=entry,entry.prev=this.tail,entry.next=null,this.tail=entry):this.head=this.tail=entry,this._len++},LinkedList2.prototype.remove=function(entry){var prev=entry.prev,next=entry.next;prev?prev.next=next:this.head=next,next?next.prev=prev:this.tail=prev,entry.next=entry.prev=null,this._len--},LinkedList2.prototype.len=function(){return this._len},LinkedList2.prototype.clear=function(){this.head=this.tail=null,this._len=0},LinkedList2}(),LRU=function(){function LRU2(maxSize){this._list=new LinkedList,this._maxSize=10,this._map={},this._maxSize=maxSize}return LRU2.prototype.put=function(key,value){var list=this._list,map2=this._map,removed=null;if(null==map2[key]){var len2=list.len(),entry=this._lastRemovedEntry;if(len2>=this._maxSize&&len2>0){var leastUsedEntry=list.head;list.remove(leastUsedEntry),delete map2[leastUsedEntry.key],removed=leastUsedEntry.value,this._lastRemovedEntry=leastUsedEntry}entry?entry.value=value:entry=new Entry(value),entry.key=key,list.insertEntry(entry),map2[key]=entry}return removed},LRU2.prototype.get=function(key){var entry=this._map[key],list=this._list;if(null!=entry)return entry!==list.tail&&(list.remove(entry),list.insertEntry(entry)),entry.value},LRU2.prototype.clear=function(){this._list.clear(),this._map={}},LRU2.prototype.len=function(){return this._list.len()},LRU2}(),kCSSColorTable={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function clampCssByte(i){return(i=Math.round(i))<0?0:i>255?255:i}function clampCssFloat(f){return f<0?0:f>1?1:f}function parseCssInt(val){var str=val;return str.length&&"%"===str.charAt(str.length-1)?clampCssByte(parseFloat(str)/100*255):clampCssByte(parseInt(str,10))}function parseCssFloat(val){var str=val;return str.length&&"%"===str.charAt(str.length-1)?clampCssFloat(parseFloat(str)/100):clampCssFloat(parseFloat(str))}function cssHueToRgb(m1,m2,h){return h<0?h+=1:h>1&&(h-=1),6*h<1?m1+(m2-m1)*h*6:2*h<1?m2:3*h<2?m1+(m2-m1)*(2/3-h)*6:m1}function lerpNumber(a,b,p){return a+(b-a)*p}function setRgba(out2,r,g,b,a){return out2[0]=r,out2[1]=g,out2[2]=b,out2[3]=a,out2}function copyRgba(out2,a){return out2[0]=a[0],out2[1]=a[1],out2[2]=a[2],out2[3]=a[3],out2}var colorCache=new LRU(20),lastRemovedArr=null;function putToCache(colorStr,rgbaArr){lastRemovedArr&&copyRgba(lastRemovedArr,rgbaArr),lastRemovedArr=colorCache.put(colorStr,lastRemovedArr||rgbaArr.slice())}function parse(colorStr,rgbaArr){if(colorStr){rgbaArr=rgbaArr||[];var cached=colorCache.get(colorStr);if(cached)return copyRgba(rgbaArr,cached);var str=(colorStr+="").replace(/ /g,"").toLowerCase();if(str in kCSSColorTable)return copyRgba(rgbaArr,kCSSColorTable[str]),putToCache(colorStr,rgbaArr),rgbaArr;var iv,strLen=str.length;if("#"===str.charAt(0))return 4===strLen||5===strLen?(iv=parseInt(str.slice(1,4),16))>=0&&iv<=4095?(setRgba(rgbaArr,(3840&iv)>>4|(3840&iv)>>8,240&iv|(240&iv)>>4,15&iv|(15&iv)<<4,5===strLen?parseInt(str.slice(4),16)/15:1),putToCache(colorStr,rgbaArr),rgbaArr):void setRgba(rgbaArr,0,0,0,1):7===strLen||9===strLen?(iv=parseInt(str.slice(1,7),16))>=0&&iv<=16777215?(setRgba(rgbaArr,(16711680&iv)>>16,(65280&iv)>>8,255&iv,9===strLen?parseInt(str.slice(7),16)/255:1),putToCache(colorStr,rgbaArr),rgbaArr):void setRgba(rgbaArr,0,0,0,1):void 0;var op=str.indexOf("("),ep=str.indexOf(")");if(-1!==op&&ep+1===strLen){var fname=str.substr(0,op),params=str.substr(op+1,ep-(op+1)).split(","),alpha=1;switch(fname){case"rgba":if(4!==params.length)return 3===params.length?setRgba(rgbaArr,+params[0],+params[1],+params[2],1):setRgba(rgbaArr,0,0,0,1);alpha=parseCssFloat(params.pop());case"rgb":return params.length>=3?(setRgba(rgbaArr,parseCssInt(params[0]),parseCssInt(params[1]),parseCssInt(params[2]),3===params.length?alpha:parseCssFloat(params[3])),putToCache(colorStr,rgbaArr),rgbaArr):void setRgba(rgbaArr,0,0,0,1);case"hsla":return 4!==params.length?void setRgba(rgbaArr,0,0,0,1):(params[3]=parseCssFloat(params[3]),hsla2rgba(params,rgbaArr),putToCache(colorStr,rgbaArr),rgbaArr);case"hsl":return 3!==params.length?void setRgba(rgbaArr,0,0,0,1):(hsla2rgba(params,rgbaArr),putToCache(colorStr,rgbaArr),rgbaArr);default:return}}setRgba(rgbaArr,0,0,0,1)}}function hsla2rgba(hsla,rgba){var h=(parseFloat(hsla[0])%360+360)%360/360,s=parseCssFloat(hsla[1]),l=parseCssFloat(hsla[2]),m2=l<=.5?l*(s+1):l+s-l*s,m1=2*l-m2;return setRgba(rgba=rgba||[],clampCssByte(255*cssHueToRgb(m1,m2,h+1/3)),clampCssByte(255*cssHueToRgb(m1,m2,h)),clampCssByte(255*cssHueToRgb(m1,m2,h-1/3)),1),4===hsla.length&&(rgba[3]=hsla[3]),rgba}function lift(color2,level){var colorArr=parse(color2);if(colorArr){for(var i=0;i<3;i++)colorArr[i]=level<0?colorArr[i]*(1-level)|0:(255-colorArr[i])*level+colorArr[i]|0,colorArr[i]>255?colorArr[i]=255:colorArr[i]<0&&(colorArr[i]=0);return stringify(colorArr,4===colorArr.length?"rgba":"rgb")}}function fastLerp(normalizedValue,colors,out2){if(colors&&colors.length&&normalizedValue>=0&&normalizedValue<=1){out2=out2||[];var value=normalizedValue*(colors.length-1),leftIndex=Math.floor(value),rightIndex=Math.ceil(value),leftColor=colors[leftIndex],rightColor=colors[rightIndex],dv=value-leftIndex;return out2[0]=clampCssByte(lerpNumber(leftColor[0],rightColor[0],dv)),out2[1]=clampCssByte(lerpNumber(leftColor[1],rightColor[1],dv)),out2[2]=clampCssByte(lerpNumber(leftColor[2],rightColor[2],dv)),out2[3]=clampCssFloat(lerpNumber(leftColor[3],rightColor[3],dv)),out2}}var fastMapToColor=fastLerp;function lerp(normalizedValue,colors,fullOutput){if(colors&&colors.length&&normalizedValue>=0&&normalizedValue<=1){var value=normalizedValue*(colors.length-1),leftIndex=Math.floor(value),rightIndex=Math.ceil(value),leftColor=parse(colors[leftIndex]),rightColor=parse(colors[rightIndex]),dv=value-leftIndex,color2=stringify([clampCssByte(lerpNumber(leftColor[0],rightColor[0],dv)),clampCssByte(lerpNumber(leftColor[1],rightColor[1],dv)),clampCssByte(lerpNumber(leftColor[2],rightColor[2],dv)),clampCssFloat(lerpNumber(leftColor[3],rightColor[3],dv))],"rgba");return fullOutput?{color:color2,leftIndex:leftIndex,rightIndex:rightIndex,value:value}:color2}}var mapToColor=lerp;function modifyHSL(color2,h,s,l){var colorArr=parse(color2);if(color2)return colorArr=function(rgba){if(rgba){var H,S,R=rgba[0]/255,G=rgba[1]/255,B=rgba[2]/255,vMin=Math.min(R,G,B),vMax=Math.max(R,G,B),delta=vMax-vMin,L=(vMax+vMin)/2;if(0===delta)H=0,S=0;else{S=L<.5?delta/(vMax+vMin):delta/(2-vMax-vMin);var deltaR=((vMax-R)/6+delta/2)/delta,deltaG=((vMax-G)/6+delta/2)/delta,deltaB=((vMax-B)/6+delta/2)/delta;R===vMax?H=deltaB-deltaG:G===vMax?H=1/3+deltaR-deltaB:B===vMax&&(H=2/3+deltaG-deltaR),H<0&&(H+=1),H>1&&(H-=1)}var hsla=[360*H,S,L];return null!=rgba[3]&&hsla.push(rgba[3]),hsla}}(colorArr),null!=h&&(colorArr[0]=function(i){return(i=Math.round(i))<0?0:i>360?360:i}(h)),null!=s&&(colorArr[1]=parseCssFloat(s)),null!=l&&(colorArr[2]=parseCssFloat(l)),stringify(hsla2rgba(colorArr),"rgba")}function modifyAlpha(color2,alpha){var colorArr=parse(color2);if(colorArr&&null!=alpha)return colorArr[3]=clampCssFloat(alpha),stringify(colorArr,"rgba")}function stringify(arrColor,type){if(arrColor&&arrColor.length){var colorStr=arrColor[0]+","+arrColor[1]+","+arrColor[2];return"rgba"!==type&&"hsva"!==type&&"hsla"!==type||(colorStr+=","+arrColor[3]),type+"("+colorStr+")"}}function lum(color2,backgroundLum){var arr=parse(color2);return arr?(.299*arr[0]+.587*arr[1]+.114*arr[2])*arr[3]/255+(1-arr[3])*backgroundLum:0}var liftedColorCache=new LRU(100);function liftColor(color2){if(isString(color2)){var liftedColor=liftedColorCache.get(color2);return liftedColor||(liftedColor=lift(color2,-.1),liftedColorCache.put(color2,liftedColor)),liftedColor}if(isGradientObject(color2)){var ret=extend({},color2);return ret.colorStops=map$1(color2.colorStops,(function(stop2){return{offset:stop2.offset,color:lift(stop2.color,-.1)}})),ret}return color2}const color=Object.freeze(Object.defineProperty({__proto__:null,fastLerp:fastLerp,fastMapToColor:fastMapToColor,lerp:lerp,lift:lift,liftColor:liftColor,lum:lum,mapToColor:mapToColor,modifyAlpha:modifyAlpha,modifyHSL:modifyHSL,parse:parse,random:function(){return stringify([Math.round(255*Math.random()),Math.round(255*Math.random()),Math.round(255*Math.random())],"rgb")},stringify:stringify,toHex:function(color2){var colorArr=parse(color2);if(colorArr)return((1<<24)+(colorArr[0]<<16)+(colorArr[1]<<8)+ +colorArr[2]).toString(16).slice(1)}},Symbol.toStringTag,{value:"Module"}));var mathRound$1=Math.round;function normalizeColor(color2){var opacity;if(color2&&"transparent"!==color2){if("string"==typeof color2&&color2.indexOf("rgba")>-1){var arr=parse(color2);arr&&(color2="rgb("+arr[0]+","+arr[1]+","+arr[2]+")",opacity=arr[3])}}else color2="none";return{color:color2,opacity:null==opacity?1:opacity}}function isAroundZero(transform){return transform<1e-4&&transform>-1e-4}function round3(transform){return mathRound$1(1e3*transform)/1e3}function round4(transform){return mathRound$1(1e4*transform)/1e4}var TEXT_ALIGN_TO_ANCHOR={left:"start",right:"end",center:"middle",middle:"middle"};function isImagePattern(val){return val&&!!val.image}function isPattern(val){return isImagePattern(val)||function(val){return val&&!!val.svgElement}(val)}function isLinearGradient(val){return"linear"===val.type}function isRadialGradient(val){return"radial"===val.type}function isGradient(val){return val&&("linear"===val.type||"radial"===val.type)}function getIdURL(id){return"url(#"+id+")"}function getPathPrecision(el){var scale2=el.getGlobalScale(),size=Math.max(scale2[0],scale2[1]);return Math.max(Math.ceil(Math.log(size)/Math.log(10)),1)}function getSRTTransformString(transform){var x=transform.x||0,y=transform.y||0,rotation=(transform.rotation||0)*RADIAN_TO_DEGREE,scaleX=retrieve2(transform.scaleX,1),scaleY=retrieve2(transform.scaleY,1),skewX=transform.skewX||0,skewY=transform.skewY||0,res=[];return(x||y)&&res.push("translate("+x+"px,"+y+"px)"),rotation&&res.push("rotate("+rotation+")"),1===scaleX&&1===scaleY||res.push("scale("+scaleX+","+scaleY+")"),(skewX||skewY)&&res.push("skew("+mathRound$1(skewX*RADIAN_TO_DEGREE)+"deg, "+mathRound$1(skewY*RADIAN_TO_DEGREE)+"deg)"),res.join(" ")}var encodeBase64=env.hasGlobalWindow&&isFunction(window.btoa)?function(str){return window.btoa(unescape(encodeURIComponent(str)))}:"undefined"!=typeof Buffer?function(str){return Buffer.from(str).toString("base64")}:function(str){return null},arraySlice=Array.prototype.slice;function interpolateNumber$1(p0,p1,percent){return(p1-p0)*percent+p0}function interpolate1DArray(out2,p0,p1,percent){for(var len2=p0.length,i=0;i<len2;i++)out2[i]=interpolateNumber$1(p0[i],p1[i],percent);return out2}function add1DArray(out2,p0,p1,sign){for(var len2=p0.length,i=0;i<len2;i++)out2[i]=p0[i]+p1[i]*sign;return out2}function add2DArray(out2,p0,p1,sign){for(var len2=p0.length,len22=len2&&p0[0].length,i=0;i<len2;i++){out2[i]||(out2[i]=[]);for(var j=0;j<len22;j++)out2[i][j]=p0[i][j]+p1[i][j]*sign}return out2}function fillColorStops(val0,val1){for(var len0=val0.length,len1=val1.length,shorterArr=len0>len1?val1:val0,shorterLen=Math.min(len0,len1),last=shorterArr[shorterLen-1]||{color:[0,0,0,0],offset:0},i=shorterLen;i<Math.max(len0,len1);i++)shorterArr.push({offset:last.offset,color:last.color.slice()})}function fillArray(val0,val1,arrDim){var arr0=val0,arr1=val1;if(arr0.push&&arr1.push){var arr0Len=arr0.length,arr1Len=arr1.length;if(arr0Len!==arr1Len)if(arr0Len>arr1Len)arr0.length=arr1Len;else for(var i=arr0Len;i<arr1Len;i++)arr0.push(1===arrDim?arr1[i]:arraySlice.call(arr1[i]));var len2=arr0[0]&&arr0[0].length;for(i=0;i<arr0.length;i++)if(1===arrDim)isNaN(arr0[i])&&(arr0[i]=arr1[i]);else for(var j=0;j<len2;j++)isNaN(arr0[i][j])&&(arr0[i][j]=arr1[i][j])}}function cloneValue(value){if(isArrayLike(value)){var len2=value.length;if(isArrayLike(value[0])){for(var ret=[],i=0;i<len2;i++)ret.push(arraySlice.call(value[i]));return ret}return arraySlice.call(value)}return value}function rgba2String(rgba){return rgba[0]=Math.floor(rgba[0])||0,rgba[1]=Math.floor(rgba[1])||0,rgba[2]=Math.floor(rgba[2])||0,rgba[3]=null==rgba[3]?1:rgba[3],"rgba("+rgba.join(",")+")"}function isGradientValueType(valType){return 4===valType||5===valType}function isArrayValueType(valType){return 1===valType||2===valType}var tmpRgba=[0,0,0,0],Track=function(){function Track2(propName){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=propName}return Track2.prototype.isFinished=function(){return this._finished},Track2.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},Track2.prototype.needsAnimate=function(){return this.keyframes.length>=1},Track2.prototype.getAdditiveTrack=function(){return this._additiveTrack},Track2.prototype.addKeyframe=function(time2,rawValue,easing){this._needsSort=!0;var keyframes=this.keyframes,len2=keyframes.length,discrete=!1,valType=6,value=rawValue;if(isArrayLike(rawValue)){var arrayDim=function(value){return isArrayLike(value&&value[0])?2:1}(rawValue);valType=arrayDim,(1===arrayDim&&!isNumber(rawValue[0])||2===arrayDim&&!isNumber(rawValue[0][0]))&&(discrete=!0)}else if(isNumber(rawValue)&&!eqNaN(rawValue))valType=0;else if(isString(rawValue))if(isNaN(+rawValue)){var colorArray=parse(rawValue);colorArray&&(value=colorArray,valType=3)}else valType=0;else if(isGradientObject(rawValue)){var parsedGradient=extend({},value);parsedGradient.colorStops=map$1(rawValue.colorStops,(function(colorStop){return{offset:colorStop.offset,color:parse(colorStop.color)}})),isLinearGradient(rawValue)?valType=4:isRadialGradient(rawValue)&&(valType=5),value=parsedGradient}0===len2?this.valType=valType:valType===this.valType&&6!==valType||(discrete=!0),this.discrete=this.discrete||discrete;var kf={time:time2,value:value,rawValue:rawValue,percent:0};return easing&&(kf.easing=easing,kf.easingFunc=isFunction(easing)?easing:easingFuncs[easing]||createCubicEasingFunc(easing)),keyframes.push(kf),kf},Track2.prototype.prepare=function(maxTime,additiveTrack){var kfs=this.keyframes;this._needsSort&&kfs.sort((function(a,b){return a.time-b.time}));for(var valType=this.valType,kfsLen=kfs.length,lastKf=kfs[kfsLen-1],isDiscrete=this.discrete,isArr=isArrayValueType(valType),isGradient2=isGradientValueType(valType),i=0;i<kfsLen;i++){var kf=kfs[i],value=kf.value,lastValue=lastKf.value;kf.percent=kf.time/maxTime,isDiscrete||(isArr&&i!==kfsLen-1?fillArray(value,lastValue,valType):isGradient2&&fillColorStops(value.colorStops,lastValue.colorStops))}if(!isDiscrete&&5!==valType&&additiveTrack&&this.needsAnimate()&&additiveTrack.needsAnimate()&&valType===additiveTrack.valType&&!additiveTrack._finished){this._additiveTrack=additiveTrack;var startValue=kfs[0].value;for(i=0;i<kfsLen;i++)0===valType?kfs[i].additiveValue=kfs[i].value-startValue:3===valType?kfs[i].additiveValue=add1DArray([],kfs[i].value,startValue,-1):isArrayValueType(valType)&&(kfs[i].additiveValue=1===valType?add1DArray([],kfs[i].value,startValue,-1):add2DArray([],kfs[i].value,startValue,-1))}},Track2.prototype.step=function(target,percent){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var frameIdx,frame,nextFrame,isAdditive=null!=this._additiveTrack,valueKey=isAdditive?"additiveValue":"value",valType=this.valType,keyframes=this.keyframes,kfsNum=keyframes.length,propName=this.propName,isValueColor=3===valType,lastFrame=this._lastFr,mathMin2=Math.min;if(1===kfsNum)frame=nextFrame=keyframes[0];else{if(percent<0)frameIdx=0;else if(percent<this._lastFrP){for(frameIdx=mathMin2(lastFrame+1,kfsNum-1);frameIdx>=0&&!(keyframes[frameIdx].percent<=percent);frameIdx--);frameIdx=mathMin2(frameIdx,kfsNum-2)}else{for(frameIdx=lastFrame;frameIdx<kfsNum&&!(keyframes[frameIdx].percent>percent);frameIdx++);frameIdx=mathMin2(frameIdx-1,kfsNum-2)}nextFrame=keyframes[frameIdx+1],frame=keyframes[frameIdx]}if(frame&&nextFrame){this._lastFr=frameIdx,this._lastFrP=percent;var interval=nextFrame.percent-frame.percent,w=0===interval?1:mathMin2((percent-frame.percent)/interval,1);nextFrame.easingFunc&&(w=nextFrame.easingFunc(w));var targetArr=isAdditive?this._additiveValue:isValueColor?tmpRgba:target[propName];if(!isArrayValueType(valType)&&!isValueColor||targetArr||(targetArr=this._additiveValue=[]),this.discrete)target[propName]=w<1?frame.rawValue:nextFrame.rawValue;else if(isArrayValueType(valType))1===valType?interpolate1DArray(targetArr,frame[valueKey],nextFrame[valueKey],w):function(out2,p0,p1,percent){for(var len2=p0.length,len22=len2&&p0[0].length,i=0;i<len2;i++){out2[i]||(out2[i]=[]);for(var j=0;j<len22;j++)out2[i][j]=interpolateNumber$1(p0[i][j],p1[i][j],percent)}}(targetArr,frame[valueKey],nextFrame[valueKey],w);else if(isGradientValueType(valType)){var val=frame[valueKey],nextVal_1=nextFrame[valueKey],isLinearGradient_1=4===valType;target[propName]={type:isLinearGradient_1?"linear":"radial",x:interpolateNumber$1(val.x,nextVal_1.x,w),y:interpolateNumber$1(val.y,nextVal_1.y,w),colorStops:map$1(val.colorStops,(function(colorStop,idx){var nextColorStop=nextVal_1.colorStops[idx];return{offset:interpolateNumber$1(colorStop.offset,nextColorStop.offset,w),color:rgba2String(interpolate1DArray([],colorStop.color,nextColorStop.color,w))}})),global:nextVal_1.global},isLinearGradient_1?(target[propName].x2=interpolateNumber$1(val.x2,nextVal_1.x2,w),target[propName].y2=interpolateNumber$1(val.y2,nextVal_1.y2,w)):target[propName].r=interpolateNumber$1(val.r,nextVal_1.r,w)}else if(isValueColor)interpolate1DArray(targetArr,frame[valueKey],nextFrame[valueKey],w),isAdditive||(target[propName]=rgba2String(targetArr));else{var value=interpolateNumber$1(frame[valueKey],nextFrame[valueKey],w);isAdditive?this._additiveValue=value:target[propName]=value}isAdditive&&this._addToTarget(target)}}},Track2.prototype._addToTarget=function(target){var valType=this.valType,propName=this.propName,additiveValue=this._additiveValue;0===valType?target[propName]=target[propName]+additiveValue:3===valType?(parse(target[propName],tmpRgba),add1DArray(tmpRgba,tmpRgba,additiveValue,1),target[propName]=rgba2String(tmpRgba)):1===valType?add1DArray(target[propName],target[propName],additiveValue,1):2===valType&&add2DArray(target[propName],target[propName],additiveValue,1)},Track2}(),Animator=function(){function Animator2(target,loop,allowDiscreteAnimation,additiveTo){this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=target,this._loop=loop,loop&&additiveTo?logError("Can' use additive animation on looped animation."):(this._additiveAnimators=additiveTo,this._allowDiscrete=allowDiscreteAnimation)}return Animator2.prototype.getMaxTime=function(){return this._maxTime},Animator2.prototype.getDelay=function(){return this._delay},Animator2.prototype.getLoop=function(){return this._loop},Animator2.prototype.getTarget=function(){return this._target},Animator2.prototype.changeTarget=function(target){this._target=target},Animator2.prototype.when=function(time2,props,easing){return this.whenWithKeys(time2,props,keys(props),easing)},Animator2.prototype.whenWithKeys=function(time2,props,propNames,easing){for(var tracks=this._tracks,i=0;i<propNames.length;i++){var propName=propNames[i],track=tracks[propName];if(!track){track=tracks[propName]=new Track(propName);var initialValue=void 0,additiveTrack=this._getAdditiveTrack(propName);if(additiveTrack){var addtiveTrackKfs=additiveTrack.keyframes,lastFinalKf=addtiveTrackKfs[addtiveTrackKfs.length-1];initialValue=lastFinalKf&&lastFinalKf.value,3===additiveTrack.valType&&initialValue&&(initialValue=rgba2String(initialValue))}else initialValue=this._target[propName];if(null==initialValue)continue;time2>0&&track.addKeyframe(0,cloneValue(initialValue),easing),this._trackKeys.push(propName)}track.addKeyframe(time2,cloneValue(props[propName]),easing)}return this._maxTime=Math.max(this._maxTime,time2),this},Animator2.prototype.pause=function(){this._clip.pause(),this._paused=!0},Animator2.prototype.resume=function(){this._clip.resume(),this._paused=!1},Animator2.prototype.isPaused=function(){return!!this._paused},Animator2.prototype.duration=function(duration){return this._maxTime=duration,this._force=!0,this},Animator2.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var doneList=this._doneCbs;if(doneList)for(var len2=doneList.length,i=0;i<len2;i++)doneList[i].call(this)},Animator2.prototype._abortedCallback=function(){this._setTracksFinished();var animation=this.animation,abortedList=this._abortedCbs;if(animation&&animation.removeClip(this._clip),this._clip=null,abortedList)for(var i=0;i<abortedList.length;i++)abortedList[i].call(this)},Animator2.prototype._setTracksFinished=function(){for(var tracks=this._tracks,tracksKeys=this._trackKeys,i=0;i<tracksKeys.length;i++)tracks[tracksKeys[i]].setFinished()},Animator2.prototype._getAdditiveTrack=function(trackName){var additiveTrack,additiveAnimators=this._additiveAnimators;if(additiveAnimators)for(var i=0;i<additiveAnimators.length;i++){var track=additiveAnimators[i].getTrack(trackName);track&&(additiveTrack=track)}return additiveTrack},Animator2.prototype.start=function(easing){if(!(this._started>0)){this._started=1;for(var self2=this,tracks=[],maxTime=this._maxTime||0,i=0;i<this._trackKeys.length;i++){var propName=this._trackKeys[i],track=this._tracks[propName],additiveTrack=this._getAdditiveTrack(propName),kfs=track.keyframes,kfsNum=kfs.length;if(track.prepare(maxTime,additiveTrack),track.needsAnimate())if(!this._allowDiscrete&&track.discrete){var lastKf=kfs[kfsNum-1];lastKf&&(self2._target[track.propName]=lastKf.rawValue),track.setFinished()}else tracks.push(track)}if(tracks.length||this._force){var clip2=new Clip({life:maxTime,loop:this._loop,delay:this._delay||0,onframe:function(percent){self2._started=2;var additiveAnimators=self2._additiveAnimators;if(additiveAnimators){for(var stillHasAdditiveAnimator=!1,i2=0;i2<additiveAnimators.length;i2++)if(additiveAnimators[i2]._clip){stillHasAdditiveAnimator=!0;break}stillHasAdditiveAnimator||(self2._additiveAnimators=null)}for(i2=0;i2<tracks.length;i2++)tracks[i2].step(self2._target,percent);var onframeList=self2._onframeCbs;if(onframeList)for(i2=0;i2<onframeList.length;i2++)onframeList[i2](self2._target,percent)},ondestroy:function(){self2._doneCallback()}});this._clip=clip2,this.animation&&this.animation.addClip(clip2),easing&&clip2.setEasing(easing)}else this._doneCallback();return this}},Animator2.prototype.stop=function(forwardToLast){if(this._clip){var clip2=this._clip;forwardToLast&&clip2.onframe(1),this._abortedCallback()}},Animator2.prototype.delay=function(time2){return this._delay=time2,this},Animator2.prototype.during=function(cb){return cb&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(cb)),this},Animator2.prototype.done=function(cb){return cb&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(cb)),this},Animator2.prototype.aborted=function(cb){return cb&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(cb)),this},Animator2.prototype.getClip=function(){return this._clip},Animator2.prototype.getTrack=function(propName){return this._tracks[propName]},Animator2.prototype.getTracks=function(){var _this=this;return map$1(this._trackKeys,(function(key){return _this._tracks[key]}))},Animator2.prototype.stopTracks=function(propNames,forwardToLast){if(!propNames.length||!this._clip)return!0;for(var tracks=this._tracks,tracksKeys=this._trackKeys,i=0;i<propNames.length;i++){var track=tracks[propNames[i]];track&&!track.isFinished()&&(forwardToLast?track.step(this._target,1):1===this._started&&track.step(this._target,0),track.setFinished())}var allAborted=!0;for(i=0;i<tracksKeys.length;i++)if(!tracks[tracksKeys[i]].isFinished()){allAborted=!1;break}return allAborted&&this._abortedCallback(),allAborted},Animator2.prototype.saveTo=function(target,trackKeys,firstOrLast){if(target){trackKeys=trackKeys||this._trackKeys;for(var i=0;i<trackKeys.length;i++){var propName=trackKeys[i],track=this._tracks[propName];if(track&&!track.isFinished()){var kfs=track.keyframes,kf=kfs[firstOrLast?0:kfs.length-1];kf&&(target[propName]=cloneValue(kf.rawValue))}}}},Animator2.prototype.__changeFinalValue=function(finalProps,trackKeys){trackKeys=trackKeys||keys(finalProps);for(var i=0;i<trackKeys.length;i++){var propName=trackKeys[i],track=this._tracks[propName];if(track){var kfs=track.keyframes;if(kfs.length>1){var lastKf=kfs.pop();track.addKeyframe(lastKf.time,finalProps[propName]),track.prepare(this._maxTime,track.getAdditiveTrack())}}}},Animator2}();function getTime(){return(new Date).getTime()}var mouseHandlerNames,pointerEventNameMap,Animation=function(_super){function Animation2(opts){var _this=_super.call(this)||this;return _this._running=!1,_this._time=0,_this._pausedTime=0,_this._pauseStart=0,_this._paused=!1,opts=opts||{},_this.stage=opts.stage||{},_this}return __extends(Animation2,_super),Animation2.prototype.addClip=function(clip2){clip2.animation&&this.removeClip(clip2),this._head?(this._tail.next=clip2,clip2.prev=this._tail,clip2.next=null,this._tail=clip2):this._head=this._tail=clip2,clip2.animation=this},Animation2.prototype.addAnimator=function(animator){animator.animation=this;var clip2=animator.getClip();clip2&&this.addClip(clip2)},Animation2.prototype.removeClip=function(clip2){if(clip2.animation){var prev=clip2.prev,next=clip2.next;prev?prev.next=next:this._head=next,next?next.prev=prev:this._tail=prev,clip2.next=clip2.prev=clip2.animation=null}},Animation2.prototype.removeAnimator=function(animator){var clip2=animator.getClip();clip2&&this.removeClip(clip2),animator.animation=null},Animation2.prototype.update=function(notTriggerFrameAndStageUpdate){for(var time2=getTime()-this._pausedTime,delta=time2-this._time,clip2=this._head;clip2;){var nextClip=clip2.next;clip2.step(time2,delta)?(clip2.ondestroy(),this.removeClip(clip2),clip2=nextClip):clip2=nextClip}this._time=time2,notTriggerFrameAndStageUpdate||(this.trigger("frame",delta),this.stage.update&&this.stage.update())},Animation2.prototype._startLoop=function(){var self2=this;this._running=!0,requestAnimationFrame((function step(){self2._running&&(requestAnimationFrame(step),!self2._paused&&self2.update())}))},Animation2.prototype.start=function(){this._running||(this._time=getTime(),this._pausedTime=0,this._startLoop())},Animation2.prototype.stop=function(){this._running=!1},Animation2.prototype.pause=function(){this._paused||(this._pauseStart=getTime(),this._paused=!0)},Animation2.prototype.resume=function(){this._paused&&(this._pausedTime+=getTime()-this._pauseStart,this._paused=!1)},Animation2.prototype.clear=function(){for(var clip2=this._head;clip2;){var nextClip=clip2.next;clip2.prev=clip2.next=clip2.animation=null,clip2=nextClip}this._head=this._tail=null},Animation2.prototype.isFinished=function(){return null==this._head},Animation2.prototype.animate=function(target,options){options=options||{},this.start();var animator=new Animator(target,options.loop);return this.addAnimator(animator),animator},Animation2}(Eventful),globalEventSupported=env.domSupported,localNativeListenerNames=(pointerEventNameMap={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},{mouse:mouseHandlerNames=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],touch:["touchstart","touchend","touchmove"],pointer:map$1(mouseHandlerNames,(function(name){var nm=name.replace("mouse","pointer");return pointerEventNameMap.hasOwnProperty(nm)?nm:name}))}),globalNativeListenerNames_mouse=["mousemove","mouseup"],globalNativeListenerNames_pointer=["pointermove","pointerup"],wheelEventSupported=!1;function isPointerFromTouch(event){var pointerType=event.pointerType;return"pen"===pointerType||"touch"===pointerType}function markTouch(event){event&&(event.zrByTouch=!0)}function isLocalEl(instance,el){for(var elTmp=el,isLocal=!1;elTmp&&9!==elTmp.nodeType&&!(isLocal=elTmp.domBelongToZr||elTmp!==el&&elTmp===instance.painterRoot);)elTmp=elTmp.parentNode;return isLocal}var FakeGlobalEvent=function(){return function(instance,event){this.stopPropagation=noop,this.stopImmediatePropagation=noop,this.preventDefault=noop,this.type=event.type,this.target=this.currentTarget=instance.dom,this.pointerType=event.pointerType,this.clientX=event.clientX,this.clientY=event.clientY}}(),localDOMHandlers={mousedown:function(event){event=normalizeEvent(this.dom,event),this.__mayPointerCapture=[event.zrX,event.zrY],this.trigger("mousedown",event)},mousemove:function(event){event=normalizeEvent(this.dom,event);var downPoint=this.__mayPointerCapture;!downPoint||event.zrX===downPoint[0]&&event.zrY===downPoint[1]||this.__togglePointerCapture(!0),this.trigger("mousemove",event)},mouseup:function(event){event=normalizeEvent(this.dom,event),this.__togglePointerCapture(!1),this.trigger("mouseup",event)},mouseout:function(event){isLocalEl(this,(event=normalizeEvent(this.dom,event)).toElement||event.relatedTarget)||(this.__pointerCapturing&&(event.zrEventControl="no_globalout"),this.trigger("mouseout",event))},wheel:function(event){wheelEventSupported=!0,event=normalizeEvent(this.dom,event),this.trigger("mousewheel",event)},mousewheel:function(event){wheelEventSupported||(event=normalizeEvent(this.dom,event),this.trigger("mousewheel",event))},touchstart:function(event){markTouch(event=normalizeEvent(this.dom,event)),this.__lastTouchMoment=new Date,this.handler.processGesture(event,"start"),localDOMHandlers.mousemove.call(this,event),localDOMHandlers.mousedown.call(this,event)},touchmove:function(event){markTouch(event=normalizeEvent(this.dom,event)),this.handler.processGesture(event,"change"),localDOMHandlers.mousemove.call(this,event)},touchend:function(event){markTouch(event=normalizeEvent(this.dom,event)),this.handler.processGesture(event,"end"),localDOMHandlers.mouseup.call(this,event),+new Date-+this.__lastTouchMoment<300&&localDOMHandlers.click.call(this,event)},pointerdown:function(event){localDOMHandlers.mousedown.call(this,event)},pointermove:function(event){isPointerFromTouch(event)||localDOMHandlers.mousemove.call(this,event)},pointerup:function(event){localDOMHandlers.mouseup.call(this,event)},pointerout:function(event){isPointerFromTouch(event)||localDOMHandlers.mouseout.call(this,event)}};each$d(["click","dblclick","contextmenu"],(function(name){localDOMHandlers[name]=function(event){event=normalizeEvent(this.dom,event),this.trigger(name,event)}}));var globalDOMHandlers={pointermove:function(event){isPointerFromTouch(event)||globalDOMHandlers.mousemove.call(this,event)},pointerup:function(event){globalDOMHandlers.mouseup.call(this,event)},mousemove:function(event){this.trigger("mousemove",event)},mouseup:function(event){var pointerCaptureReleasing=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",event),pointerCaptureReleasing&&(event.zrEventControl="only_globalout",this.trigger("mouseout",event))}};function mountLocalDOMEventListeners(instance,scope){var domHandlers=scope.domHandlers;env.pointerEventsSupported?each$d(localNativeListenerNames.pointer,(function(nativeEventName){mountSingleDOMEventListener(scope,nativeEventName,(function(event){domHandlers[nativeEventName].call(instance,event)}))})):(env.touchEventsSupported&&each$d(localNativeListenerNames.touch,(function(nativeEventName){mountSingleDOMEventListener(scope,nativeEventName,(function(event){domHandlers[nativeEventName].call(instance,event),function(scope){scope.touching=!0,null!=scope.touchTimer&&(clearTimeout(scope.touchTimer),scope.touchTimer=null),scope.touchTimer=setTimeout((function(){scope.touching=!1,scope.touchTimer=null}),700)}(scope)}))})),each$d(localNativeListenerNames.mouse,(function(nativeEventName){mountSingleDOMEventListener(scope,nativeEventName,(function(event){event=getNativeEvent(event),scope.touching||domHandlers[nativeEventName].call(instance,event)}))})))}function mountGlobalDOMEventListeners(instance,scope){function mount(nativeEventName){mountSingleDOMEventListener(scope,nativeEventName,(function(event){event=getNativeEvent(event),isLocalEl(instance,event.target)||(event=function(instance,event){return normalizeEvent(instance.dom,new FakeGlobalEvent(instance,event),!0)}(instance,event),scope.domHandlers[nativeEventName].call(instance,event))}),{capture:!0})}env.pointerEventsSupported?each$d(globalNativeListenerNames_pointer,mount):env.touchEventsSupported||each$d(globalNativeListenerNames_mouse,mount)}function mountSingleDOMEventListener(scope,nativeEventName,listener,opt){scope.mounted[nativeEventName]=listener,scope.listenerOpts[nativeEventName]=opt,addEventListener(scope.domTarget,nativeEventName,listener,opt)}function unmountDOMEventListeners(scope){var el,name,handler,opt,mounted=scope.mounted;for(var nativeEventName in mounted)mounted.hasOwnProperty(nativeEventName)&&(el=scope.domTarget,name=nativeEventName,handler=mounted[nativeEventName],opt=scope.listenerOpts[nativeEventName],el.removeEventListener(name,handler,opt));scope.mounted={}}var DOMHandlerScope=function(){return function(domTarget,domHandlers){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=domTarget,this.domHandlers=domHandlers}}(),HandlerDomProxy=function(_super){function HandlerDomProxy2(dom,painterRoot){var _this=_super.call(this)||this;return _this.__pointerCapturing=!1,_this.dom=dom,_this.painterRoot=painterRoot,_this._localHandlerScope=new DOMHandlerScope(dom,localDOMHandlers),globalEventSupported&&(_this._globalHandlerScope=new DOMHandlerScope(document,globalDOMHandlers)),mountLocalDOMEventListeners(_this,_this._localHandlerScope),_this}return __extends(HandlerDomProxy2,_super),HandlerDomProxy2.prototype.dispose=function(){unmountDOMEventListeners(this._localHandlerScope),globalEventSupported&&unmountDOMEventListeners(this._globalHandlerScope)},HandlerDomProxy2.prototype.setCursor=function(cursorStyle){this.dom.style&&(this.dom.style.cursor=cursorStyle||"default")},HandlerDomProxy2.prototype.__togglePointerCapture=function(isPointerCapturing){if(this.__mayPointerCapture=null,globalEventSupported&&+this.__pointerCapturing^+isPointerCapturing){this.__pointerCapturing=isPointerCapturing;var globalHandlerScope=this._globalHandlerScope;isPointerCapturing?mountGlobalDOMEventListeners(this,globalHandlerScope):unmountDOMEventListeners(globalHandlerScope)}},HandlerDomProxy2}(Eventful),dpr=1;env.hasGlobalWindow&&(dpr=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var devicePixelRatio=dpr,mIdentity=identity;function isNotAroundZero(val){return val>5e-5||val<-5e-5}var scaleTmp=[],tmpTransform=[],originTransform=[1,0,0,1,0,0],abs=Math.abs,Transformable=function(){function Transformable2(){}var proto2;return Transformable2.prototype.getLocalTransform=function(m2){return Transformable2.getLocalTransform(this,m2)},Transformable2.prototype.setPosition=function(arr){this.x=arr[0],this.y=arr[1]},Transformable2.prototype.setScale=function(arr){this.scaleX=arr[0],this.scaleY=arr[1]},Transformable2.prototype.setSkew=function(arr){this.skewX=arr[0],this.skewY=arr[1]},Transformable2.prototype.setOrigin=function(arr){this.originX=arr[0],this.originY=arr[1]},Transformable2.prototype.needLocalTransform=function(){return isNotAroundZero(this.rotation)||isNotAroundZero(this.x)||isNotAroundZero(this.y)||isNotAroundZero(this.scaleX-1)||isNotAroundZero(this.scaleY-1)||isNotAroundZero(this.skewX)||isNotAroundZero(this.skewY)},Transformable2.prototype.updateTransform=function(){var parentTransform=this.parent&&this.parent.transform,needLocalTransform=this.needLocalTransform(),m2=this.transform;needLocalTransform||parentTransform?(m2=m2||[1,0,0,1,0,0],needLocalTransform?this.getLocalTransform(m2):mIdentity(m2),parentTransform&&(needLocalTransform?mul(m2,parentTransform,m2):copy(m2,parentTransform)),this.transform=m2,this._resolveGlobalScaleRatio(m2)):m2&&(mIdentity(m2),this.invTransform=null)},Transformable2.prototype._resolveGlobalScaleRatio=function(m2){var globalScaleRatio=this.globalScaleRatio;if(null!=globalScaleRatio&&1!==globalScaleRatio){this.getGlobalScale(scaleTmp);var relX=scaleTmp[0]<0?-1:1,relY=scaleTmp[1]<0?-1:1,sx=((scaleTmp[0]-relX)*globalScaleRatio+relX)/scaleTmp[0]||0,sy=((scaleTmp[1]-relY)*globalScaleRatio+relY)/scaleTmp[1]||0;m2[0]*=sx,m2[1]*=sx,m2[2]*=sy,m2[3]*=sy}this.invTransform=this.invTransform||[1,0,0,1,0,0],invert(this.invTransform,m2)},Transformable2.prototype.getComputedTransform=function(){for(var transformNode=this,ancestors=[];transformNode;)ancestors.push(transformNode),transformNode=transformNode.parent;for(;transformNode=ancestors.pop();)transformNode.updateTransform();return this.transform},Transformable2.prototype.setLocalTransform=function(m2){if(m2){var sx=m2[0]*m2[0]+m2[1]*m2[1],sy=m2[2]*m2[2]+m2[3]*m2[3],rotation=Math.atan2(m2[1],m2[0]),shearX=Math.PI/2+rotation-Math.atan2(m2[3],m2[2]);sy=Math.sqrt(sy)*Math.cos(shearX),sx=Math.sqrt(sx),this.skewX=shearX,this.skewY=0,this.rotation=-rotation,this.x=+m2[4],this.y=+m2[5],this.scaleX=sx,this.scaleY=sy,this.originX=0,this.originY=0}},Transformable2.prototype.decomposeTransform=function(){if(this.transform){var parent=this.parent,m2=this.transform;parent&&parent.transform&&(parent.invTransform=parent.invTransform||[1,0,0,1,0,0],mul(tmpTransform,parent.invTransform,m2),m2=tmpTransform);var ox=this.originX,oy=this.originY;(ox||oy)&&(originTransform[4]=ox,originTransform[5]=oy,mul(tmpTransform,m2,originTransform),tmpTransform[4]-=ox,tmpTransform[5]-=oy,m2=tmpTransform),this.setLocalTransform(m2)}},Transformable2.prototype.getGlobalScale=function(out2){var m2=this.transform;return out2=out2||[],m2?(out2[0]=Math.sqrt(m2[0]*m2[0]+m2[1]*m2[1]),out2[1]=Math.sqrt(m2[2]*m2[2]+m2[3]*m2[3]),m2[0]<0&&(out2[0]=-out2[0]),m2[3]<0&&(out2[1]=-out2[1]),out2):(out2[0]=1,out2[1]=1,out2)},Transformable2.prototype.transformCoordToLocal=function(x,y){var v2=[x,y],invTransform=this.invTransform;return invTransform&&applyTransform$1(v2,v2,invTransform),v2},Transformable2.prototype.transformCoordToGlobal=function(x,y){var v2=[x,y],transform=this.transform;return transform&&applyTransform$1(v2,v2,transform),v2},Transformable2.prototype.getLineScale=function(){var m2=this.transform;return m2&&abs(m2[0]-1)>1e-10&&abs(m2[3]-1)>1e-10?Math.sqrt(abs(m2[0]*m2[3]-m2[2]*m2[1])):1},Transformable2.prototype.copyTransform=function(source){copyTransform(this,source)},Transformable2.getLocalTransform=function(target,m2){m2=m2||[];var ox=target.originX||0,oy=target.originY||0,sx=target.scaleX,sy=target.scaleY,ax=target.anchorX,ay=target.anchorY,rotation=target.rotation||0,x=target.x,y=target.y,skewX=target.skewX?Math.tan(target.skewX):0,skewY=target.skewY?Math.tan(-target.skewY):0;if(ox||oy||ax||ay){var dx=ox+ax,dy=oy+ay;m2[4]=-dx*sx-skewX*dy*sy,m2[5]=-dy*sy-skewY*dx*sx}else m2[4]=m2[5]=0;return m2[0]=sx,m2[3]=sy,m2[1]=skewY*sx,m2[2]=skewX*sy,rotation&&rotate(m2,m2,rotation),m2[4]+=ox+x,m2[5]+=oy+y,m2},Transformable2.initDefaultProps=((proto2=Transformable2.prototype).scaleX=proto2.scaleY=proto2.globalScaleRatio=1,void(proto2.x=proto2.y=proto2.originX=proto2.originY=proto2.skewX=proto2.skewY=proto2.rotation=proto2.anchorX=proto2.anchorY=0)),Transformable2}(),TRANSFORMABLE_PROPS=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function copyTransform(target,source){for(var i=0;i<TRANSFORMABLE_PROPS.length;i++){var propName=TRANSFORMABLE_PROPS[i];target[propName]=source[propName]}}var textWidthCache={};function getWidth(text,font){var cacheOfFont=textWidthCache[font=font||DEFAULT_FONT];cacheOfFont||(cacheOfFont=textWidthCache[font]=new LRU(500));var width=cacheOfFont.get(text);return null==width&&(width=platformApi.measureText(text,font).width,cacheOfFont.put(text,width)),width}function innerGetBoundingRect(text,font,textAlign,textBaseline){var width=getWidth(text,font),height=getLineHeight(font),x=adjustTextX(0,width,textAlign),y=adjustTextY(0,height,textBaseline);return new BoundingRect(x,y,width,height)}function getBoundingRect(text,font,textAlign,textBaseline){var textLines=((text||"")+"").split("\n");if(1===textLines.length)return innerGetBoundingRect(textLines[0],font,textAlign,textBaseline);for(var uniondRect=new BoundingRect(0,0,0,0),i=0;i<textLines.length;i++){var rect=innerGetBoundingRect(textLines[i],font,textAlign,textBaseline);0===i?uniondRect.copy(rect):uniondRect.union(rect)}return uniondRect}function adjustTextX(x,width,textAlign){return"right"===textAlign?x-=width:"center"===textAlign&&(x-=width/2),x}function adjustTextY(y,height,verticalAlign){return"middle"===verticalAlign?y-=height/2:"bottom"===verticalAlign&&(y-=height),y}function getLineHeight(font){return getWidth("国",font)}function parsePercent$1(value,maxValue){return"string"==typeof value?value.lastIndexOf("%")>=0?parseFloat(value)/100*maxValue:parseFloat(value):value}function calculateTextPosition(out2,opts,rect){var textPosition=opts.position||"inside",distance2=null!=opts.distance?opts.distance:5,height=rect.height,width=rect.width,halfHeight=height/2,x=rect.x,y=rect.y,textAlign="left",textVerticalAlign="top";if(textPosition instanceof Array)x+=parsePercent$1(textPosition[0],rect.width),y+=parsePercent$1(textPosition[1],rect.height),textAlign=null,textVerticalAlign=null;else switch(textPosition){case"left":x-=distance2,y+=halfHeight,textAlign="right",textVerticalAlign="middle";break;case"right":x+=distance2+width,y+=halfHeight,textVerticalAlign="middle";break;case"top":x+=width/2,y-=distance2,textAlign="center",textVerticalAlign="bottom";break;case"bottom":x+=width/2,y+=height+distance2,textAlign="center";break;case"inside":x+=width/2,y+=halfHeight,textAlign="center",textVerticalAlign="middle";break;case"insideLeft":x+=distance2,y+=halfHeight,textVerticalAlign="middle";break;case"insideRight":x+=width-distance2,y+=halfHeight,textAlign="right",textVerticalAlign="middle";break;case"insideTop":x+=width/2,y+=distance2,textAlign="center";break;case"insideBottom":x+=width/2,y+=height-distance2,textAlign="center",textVerticalAlign="bottom";break;case"insideTopLeft":x+=distance2,y+=distance2;break;case"insideTopRight":x+=width-distance2,y+=distance2,textAlign="right";break;case"insideBottomLeft":x+=distance2,y+=height-distance2,textVerticalAlign="bottom";break;case"insideBottomRight":x+=width-distance2,y+=height-distance2,textAlign="right",textVerticalAlign="bottom"}return(out2=out2||{}).x=x,out2.y=y,out2.align=textAlign,out2.verticalAlign=textVerticalAlign,out2}var PRIMARY_STATES_KEYS$1=TRANSFORMABLE_PROPS.concat(["ignore"]),DEFAULT_ANIMATABLE_MAP=reduce(TRANSFORMABLE_PROPS,(function(obj,key){return obj[key]=!0,obj}),{ignore:!1}),tmpTextPosCalcRes={},tmpBoundingRect=new BoundingRect(0,0,0,0),Element=function(){function Element2(props){this.id=guid(),this.animators=[],this.currentStates=[],this.states={},this._init(props)}return Element2.prototype._init=function(props){this.attr(props)},Element2.prototype.drift=function(dx,dy,e2){switch(this.draggable){case"horizontal":dy=0;break;case"vertical":dx=0}var m2=this.transform;m2||(m2=this.transform=[1,0,0,1,0,0]),m2[4]+=dx,m2[5]+=dy,this.decomposeTransform(),this.markRedraw()},Element2.prototype.beforeUpdate=function(){},Element2.prototype.afterUpdate=function(){},Element2.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},Element2.prototype.updateInnerText=function(forceUpdate){var textEl=this._textContent;if(textEl&&(!textEl.ignore||forceUpdate)){this.textConfig||(this.textConfig={});var textConfig=this.textConfig,isLocal=textConfig.local,innerTransformable=textEl.innerTransformable,textAlign=void 0,textVerticalAlign=void 0,textStyleChanged=!1;innerTransformable.parent=isLocal?this:null;var innerOrigin=!1;if(innerTransformable.copyTransform(textEl),null!=textConfig.position){var layoutRect=tmpBoundingRect;textConfig.layoutRect?layoutRect.copy(textConfig.layoutRect):layoutRect.copy(this.getBoundingRect()),isLocal||layoutRect.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(tmpTextPosCalcRes,textConfig,layoutRect):calculateTextPosition(tmpTextPosCalcRes,textConfig,layoutRect),innerTransformable.x=tmpTextPosCalcRes.x,innerTransformable.y=tmpTextPosCalcRes.y,textAlign=tmpTextPosCalcRes.align,textVerticalAlign=tmpTextPosCalcRes.verticalAlign;var textOrigin=textConfig.origin;if(textOrigin&&null!=textConfig.rotation){var relOriginX=void 0,relOriginY=void 0;"center"===textOrigin?(relOriginX=.5*layoutRect.width,relOriginY=.5*layoutRect.height):(relOriginX=parsePercent$1(textOrigin[0],layoutRect.width),relOriginY=parsePercent$1(textOrigin[1],layoutRect.height)),innerOrigin=!0,innerTransformable.originX=-innerTransformable.x+relOriginX+(isLocal?0:layoutRect.x),innerTransformable.originY=-innerTransformable.y+relOriginY+(isLocal?0:layoutRect.y)}}null!=textConfig.rotation&&(innerTransformable.rotation=textConfig.rotation);var textOffset=textConfig.offset;textOffset&&(innerTransformable.x+=textOffset[0],innerTransformable.y+=textOffset[1],innerOrigin||(innerTransformable.originX=-textOffset[0],innerTransformable.originY=-textOffset[1]));var isInside=null==textConfig.inside?"string"==typeof textConfig.position&&textConfig.position.indexOf("inside")>=0:textConfig.inside,innerTextDefaultStyle=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),textFill=void 0,textStroke=void 0,autoStroke=void 0;isInside&&this.canBeInsideText()?(textFill=textConfig.insideFill,textStroke=textConfig.insideStroke,null!=textFill&&"auto"!==textFill||(textFill=this.getInsideTextFill()),null!=textStroke&&"auto"!==textStroke||(textStroke=this.getInsideTextStroke(textFill),autoStroke=!0)):(textFill=textConfig.outsideFill,textStroke=textConfig.outsideStroke,null!=textFill&&"auto"!==textFill||(textFill=this.getOutsideFill()),null!=textStroke&&"auto"!==textStroke||(textStroke=this.getOutsideStroke(textFill),autoStroke=!0)),(textFill=textFill||"#000")===innerTextDefaultStyle.fill&&textStroke===innerTextDefaultStyle.stroke&&autoStroke===innerTextDefaultStyle.autoStroke&&textAlign===innerTextDefaultStyle.align&&textVerticalAlign===innerTextDefaultStyle.verticalAlign||(textStyleChanged=!0,innerTextDefaultStyle.fill=textFill,innerTextDefaultStyle.stroke=textStroke,innerTextDefaultStyle.autoStroke=autoStroke,innerTextDefaultStyle.align=textAlign,innerTextDefaultStyle.verticalAlign=textVerticalAlign,textEl.setDefaultTextStyle(innerTextDefaultStyle)),textEl.__dirty|=1,textStyleChanged&&textEl.dirtyStyle(!0)}},Element2.prototype.canBeInsideText=function(){return!0},Element2.prototype.getInsideTextFill=function(){return"#fff"},Element2.prototype.getInsideTextStroke=function(textFill){return"#000"},Element2.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?"#ccc":"#333"},Element2.prototype.getOutsideStroke=function(textFill){var backgroundColor2=this.__zr&&this.__zr.getBackgroundColor(),colorArr="string"==typeof backgroundColor2&&parse(backgroundColor2);colorArr||(colorArr=[255,255,255,1]);for(var alpha=colorArr[3],isDark=this.__zr.isDarkMode(),i=0;i<3;i++)colorArr[i]=colorArr[i]*alpha+(isDark?0:255)*(1-alpha);return colorArr[3]=1,stringify(colorArr,"rgba")},Element2.prototype.traverse=function(cb,context){},Element2.prototype.attrKV=function(key,value){"textConfig"===key?this.setTextConfig(value):"textContent"===key?this.setTextContent(value):"clipPath"===key?this.setClipPath(value):"extra"===key?(this.extra=this.extra||{},extend(this.extra,value)):this[key]=value},Element2.prototype.hide=function(){this.ignore=!0,this.markRedraw()},Element2.prototype.show=function(){this.ignore=!1,this.markRedraw()},Element2.prototype.attr=function(keyOrObj,value){if("string"==typeof keyOrObj)this.attrKV(keyOrObj,value);else if(isObject$3(keyOrObj))for(var keysArr=keys(keyOrObj),i=0;i<keysArr.length;i++){var key=keysArr[i];this.attrKV(key,keyOrObj[key])}return this.markRedraw(),this},Element2.prototype.saveCurrentToNormalState=function(toState){this._innerSaveToNormal(toState);for(var normalState=this._normalState,i=0;i<this.animators.length;i++){var animator=this.animators[i],fromStateTransition=animator.__fromStateTransition;if(!(animator.getLoop()||fromStateTransition&&"__zr_normal__"!==fromStateTransition)){var targetName=animator.targetName,target=targetName?normalState[targetName]:normalState;animator.saveTo(target)}}},Element2.prototype._innerSaveToNormal=function(toState){var normalState=this._normalState;normalState||(normalState=this._normalState={}),toState.textConfig&&!normalState.textConfig&&(normalState.textConfig=this.textConfig),this._savePrimaryToNormal(toState,normalState,PRIMARY_STATES_KEYS$1)},Element2.prototype._savePrimaryToNormal=function(toState,normalState,primaryKeys){for(var i=0;i<primaryKeys.length;i++){var key=primaryKeys[i];null==toState[key]||key in normalState||(normalState[key]=this[key])}},Element2.prototype.hasState=function(){return this.currentStates.length>0},Element2.prototype.getState=function(name){return this.states[name]},Element2.prototype.ensureState=function(name){var states=this.states;return states[name]||(states[name]={}),states[name]},Element2.prototype.clearStates=function(noAnimation){this.useState("__zr_normal__",!1,noAnimation)},Element2.prototype.useState=function(stateName,keepCurrentStates,noAnimation,forceUseHoverLayer){var toNormalState="__zr_normal__"===stateName;if(this.hasState()||!toNormalState){var currentStates=this.currentStates,animationCfg=this.stateTransition;if(!(indexOf(currentStates,stateName)>=0)||!keepCurrentStates&&1!==currentStates.length){var state;if(this.stateProxy&&!toNormalState&&(state=this.stateProxy(stateName)),state||(state=this.states&&this.states[stateName]),state||toNormalState){toNormalState||this.saveCurrentToNormalState(state);var useHoverLayer=!!(state&&state.hoverLayer||forceUseHoverLayer);useHoverLayer&&this._toggleHoverLayerFlag(!0),this._applyStateObj(stateName,state,this._normalState,keepCurrentStates,!noAnimation&&!this.__inHover&&animationCfg&&animationCfg.duration>0,animationCfg);var textContent=this._textContent,textGuide=this._textGuide;return textContent&&textContent.useState(stateName,keepCurrentStates,noAnimation,useHoverLayer),textGuide&&textGuide.useState(stateName,keepCurrentStates,noAnimation,useHoverLayer),toNormalState?(this.currentStates=[],this._normalState={}):keepCurrentStates?this.currentStates.push(stateName):this.currentStates=[stateName],this._updateAnimationTargets(),this.markRedraw(),!useHoverLayer&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=-2),state}logError("State "+stateName+" not exists.")}}},Element2.prototype.useStates=function(states,noAnimation,forceUseHoverLayer){if(states.length){var stateObjects=[],currentStates=this.currentStates,len2=states.length,notChange=len2===currentStates.length;if(notChange)for(var i=0;i<len2;i++)if(states[i]!==currentStates[i]){notChange=!1;break}if(notChange)return;for(i=0;i<len2;i++){var stateName=states[i],stateObj=void 0;this.stateProxy&&(stateObj=this.stateProxy(stateName,states)),stateObj||(stateObj=this.states[stateName]),stateObj&&stateObjects.push(stateObj)}var lastStateObj=stateObjects[len2-1],useHoverLayer=!!(lastStateObj&&lastStateObj.hoverLayer||forceUseHoverLayer);useHoverLayer&&this._toggleHoverLayerFlag(!0);var mergedState=this._mergeStates(stateObjects),animationCfg=this.stateTransition;this.saveCurrentToNormalState(mergedState),this._applyStateObj(states.join(","),mergedState,this._normalState,!1,!noAnimation&&!this.__inHover&&animationCfg&&animationCfg.duration>0,animationCfg);var textContent=this._textContent,textGuide=this._textGuide;textContent&&textContent.useStates(states,noAnimation,useHoverLayer),textGuide&&textGuide.useStates(states,noAnimation,useHoverLayer),this._updateAnimationTargets(),this.currentStates=states.slice(),this.markRedraw(),!useHoverLayer&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=-2)}else this.clearStates()},Element2.prototype.isSilent=function(){for(var isSilent=this.silent,ancestor=this.parent;!isSilent&&ancestor;){if(ancestor.silent){isSilent=!0;break}ancestor=ancestor.parent}return isSilent},Element2.prototype._updateAnimationTargets=function(){for(var i=0;i<this.animators.length;i++){var animator=this.animators[i];animator.targetName&&animator.changeTarget(this[animator.targetName])}},Element2.prototype.removeState=function(state){var idx=indexOf(this.currentStates,state);if(idx>=0){var currentStates=this.currentStates.slice();currentStates.splice(idx,1),this.useStates(currentStates)}},Element2.prototype.replaceState=function(oldState,newState,forceAdd){var currentStates=this.currentStates.slice(),idx=indexOf(currentStates,oldState),newStateExists=indexOf(currentStates,newState)>=0;idx>=0?newStateExists?currentStates.splice(idx,1):currentStates[idx]=newState:forceAdd&&!newStateExists&&currentStates.push(newState),this.useStates(currentStates)},Element2.prototype.toggleState=function(state,enable){enable?this.useState(state,!0):this.removeState(state)},Element2.prototype._mergeStates=function(states){for(var mergedTextConfig,mergedState={},i=0;i<states.length;i++){var state=states[i];extend(mergedState,state),state.textConfig&&extend(mergedTextConfig=mergedTextConfig||{},state.textConfig)}return mergedTextConfig&&(mergedState.textConfig=mergedTextConfig),mergedState},Element2.prototype._applyStateObj=function(stateName,state,normalState,keepCurrentStates,transition,animationCfg){var needsRestoreToNormal=!(state&&keepCurrentStates);state&&state.textConfig?(this.textConfig=extend({},keepCurrentStates?this.textConfig:normalState.textConfig),extend(this.textConfig,state.textConfig)):needsRestoreToNormal&&normalState.textConfig&&(this.textConfig=normalState.textConfig);for(var transitionTarget={},hasTransition=!1,i=0;i<PRIMARY_STATES_KEYS$1.length;i++){var key=PRIMARY_STATES_KEYS$1[i],propNeedsTransition=transition&&DEFAULT_ANIMATABLE_MAP[key];state&&null!=state[key]?propNeedsTransition?(hasTransition=!0,transitionTarget[key]=state[key]):this[key]=state[key]:needsRestoreToNormal&&null!=normalState[key]&&(propNeedsTransition?(hasTransition=!0,transitionTarget[key]=normalState[key]):this[key]=normalState[key])}if(!transition)for(i=0;i<this.animators.length;i++){var animator=this.animators[i],targetName=animator.targetName;animator.getLoop()||animator.__changeFinalValue(targetName?(state||normalState)[targetName]:state||normalState)}hasTransition&&this._transitionState(stateName,transitionTarget,animationCfg)},Element2.prototype._attachComponent=function(componentEl){if((!componentEl.__zr||componentEl.__hostTarget)&&componentEl!==this){var zr=this.__zr;zr&&componentEl.addSelfToZr(zr),componentEl.__zr=zr,componentEl.__hostTarget=this}},Element2.prototype._detachComponent=function(componentEl){componentEl.__zr&&componentEl.removeSelfFromZr(componentEl.__zr),componentEl.__zr=null,componentEl.__hostTarget=null},Element2.prototype.getClipPath=function(){return this._clipPath},Element2.prototype.setClipPath=function(clipPath){this._clipPath&&this._clipPath!==clipPath&&this.removeClipPath(),this._attachComponent(clipPath),this._clipPath=clipPath,this.markRedraw()},Element2.prototype.removeClipPath=function(){var clipPath=this._clipPath;clipPath&&(this._detachComponent(clipPath),this._clipPath=null,this.markRedraw())},Element2.prototype.getTextContent=function(){return this._textContent},Element2.prototype.setTextContent=function(textEl){var previousTextContent=this._textContent;previousTextContent!==textEl&&(previousTextContent&&previousTextContent!==textEl&&this.removeTextContent(),textEl.innerTransformable=new Transformable,this._attachComponent(textEl),this._textContent=textEl,this.markRedraw())},Element2.prototype.setTextConfig=function(cfg){this.textConfig||(this.textConfig={}),extend(this.textConfig,cfg),this.markRedraw()},Element2.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},Element2.prototype.removeTextContent=function(){var textEl=this._textContent;textEl&&(textEl.innerTransformable=null,this._detachComponent(textEl),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},Element2.prototype.getTextGuideLine=function(){return this._textGuide},Element2.prototype.setTextGuideLine=function(guideLine){this._textGuide&&this._textGuide!==guideLine&&this.removeTextGuideLine(),this._attachComponent(guideLine),this._textGuide=guideLine,this.markRedraw()},Element2.prototype.removeTextGuideLine=function(){var textGuide=this._textGuide;textGuide&&(this._detachComponent(textGuide),this._textGuide=null,this.markRedraw())},Element2.prototype.markRedraw=function(){this.__dirty|=1;var zr=this.__zr;zr&&(this.__inHover?zr.refreshHover():zr.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},Element2.prototype.dirty=function(){this.markRedraw()},Element2.prototype._toggleHoverLayerFlag=function(inHover){this.__inHover=inHover;var textContent=this._textContent,textGuide=this._textGuide;textContent&&(textContent.__inHover=inHover),textGuide&&(textGuide.__inHover=inHover)},Element2.prototype.addSelfToZr=function(zr){if(this.__zr!==zr){this.__zr=zr;var animators=this.animators;if(animators)for(var i=0;i<animators.length;i++)zr.animation.addAnimator(animators[i]);this._clipPath&&this._clipPath.addSelfToZr(zr),this._textContent&&this._textContent.addSelfToZr(zr),this._textGuide&&this._textGuide.addSelfToZr(zr)}},Element2.prototype.removeSelfFromZr=function(zr){if(this.__zr){this.__zr=null;var animators=this.animators;if(animators)for(var i=0;i<animators.length;i++)zr.animation.removeAnimator(animators[i]);this._clipPath&&this._clipPath.removeSelfFromZr(zr),this._textContent&&this._textContent.removeSelfFromZr(zr),this._textGuide&&this._textGuide.removeSelfFromZr(zr)}},Element2.prototype.animate=function(key,loop,allowDiscreteAnimation){var target=key?this[key]:this,animator=new Animator(target,loop,allowDiscreteAnimation);return key&&(animator.targetName=key),this.addAnimator(animator,key),animator},Element2.prototype.addAnimator=function(animator,key){var zr=this.__zr,el=this;animator.during((function(){el.updateDuringAnimation(key)})).done((function(){var animators=el.animators,idx=indexOf(animators,animator);idx>=0&&animators.splice(idx,1)})),this.animators.push(animator),zr&&zr.animation.addAnimator(animator),zr&&zr.wakeUp()},Element2.prototype.updateDuringAnimation=function(key){this.markRedraw()},Element2.prototype.stopAnimation=function(scope,forwardToLast){for(var animators=this.animators,len2=animators.length,leftAnimators=[],i=0;i<len2;i++){var animator=animators[i];scope&&scope!==animator.scope?leftAnimators.push(animator):animator.stop(forwardToLast)}return this.animators=leftAnimators,this},Element2.prototype.animateTo=function(target,cfg,animationProps){animateTo(this,target,cfg,animationProps)},Element2.prototype.animateFrom=function(target,cfg,animationProps){animateTo(this,target,cfg,animationProps,!0)},Element2.prototype._transitionState=function(stateName,target,cfg,animationProps){for(var animators=animateTo(this,target,cfg,animationProps),i=0;i<animators.length;i++)animators[i].__fromStateTransition=stateName},Element2.prototype.getBoundingRect=function(){return null},Element2.prototype.getPaintRect=function(){return null},Element2.initDefaultProps=function(){var elProto=Element2.prototype;function createLegacyProperty(key,privateKey,xKey,yKey){function enhanceArray(self2,pos){Object.defineProperty(pos,0,{get:function(){return self2[xKey]},set:function(val){self2[xKey]=val}}),Object.defineProperty(pos,1,{get:function(){return self2[yKey]},set:function(val){self2[yKey]=val}})}Object.defineProperty(elProto,key,{get:function(){this[privateKey]||enhanceArray(this,this[privateKey]=[]);return this[privateKey]},set:function(pos){this[xKey]=pos[0],this[yKey]=pos[1],this[privateKey]=pos,enhanceArray(this,pos)}})}elProto.type="element",elProto.name="",elProto.ignore=elProto.silent=elProto.isGroup=elProto.draggable=elProto.dragging=elProto.ignoreClip=elProto.__inHover=!1,elProto.__dirty=1,Object.defineProperty&&(createLegacyProperty("position","_legacyPos","x","y"),createLegacyProperty("scale","_legacyScale","scaleX","scaleY"),createLegacyProperty("origin","_legacyOrigin","originX","originY"))}(),Element2}();function animateTo(animatable,target,cfg,animationProps,reverse){var animators=[];animateToShallow(animatable,"",animatable,target,cfg=cfg||{},animationProps,animators,reverse);var finishCount=animators.length,doneHappened=!1,cfgDone=cfg.done,cfgAborted=cfg.aborted,doneCb=function(){doneHappened=!0,--finishCount<=0&&(doneHappened?cfgDone&&cfgDone():cfgAborted&&cfgAborted())},abortedCb=function(){--finishCount<=0&&(doneHappened?cfgDone&&cfgDone():cfgAborted&&cfgAborted())};finishCount||cfgDone&&cfgDone(),animators.length>0&&cfg.during&&animators[0].during((function(target2,percent){cfg.during(percent)}));for(var i=0;i<animators.length;i++){var animator=animators[i];animator.done(doneCb),animator.aborted(abortedCb),cfg.force&&animator.duration(cfg.duration),animator.start(cfg.easing)}return animators}function copyArrShallow(source,target,len2){for(var i=0;i<len2;i++)source[i]=target[i]}function copyValue(target,source,key){if(isArrayLike(source[key]))if(isArrayLike(target[key])||(target[key]=[]),isTypedArray(source[key])){var len2=source[key].length;target[key].length!==len2&&(target[key]=new source[key].constructor(len2),copyArrShallow(target[key],source[key],len2))}else{var sourceArr=source[key],targetArr=target[key],len0=sourceArr.length;if(isArrayLike(sourceArr[0]))for(var len1=sourceArr[0].length,i=0;i<len0;i++)targetArr[i]?copyArrShallow(targetArr[i],sourceArr[i],len1):targetArr[i]=Array.prototype.slice.call(sourceArr[i]);else copyArrShallow(targetArr,sourceArr,len0);targetArr.length=sourceArr.length}else target[key]=source[key]}function animateToShallow(animatable,topKey,animateObj,target,cfg,animationProps,animators,reverse){for(var targetKeys=keys(target),duration=cfg.duration,delay=cfg.delay,additive=cfg.additive,setToFinal=cfg.setToFinal,animateAll=!isObject$3(animationProps),existsAnimators=animatable.animators,animationKeys=[],k=0;k<targetKeys.length;k++){var innerKey=targetKeys[k],targetVal=target[innerKey];if(null!=targetVal&&null!=animateObj[innerKey]&&(animateAll||animationProps[innerKey]))if(!isObject$3(targetVal)||isArrayLike(targetVal)||isGradientObject(targetVal))animationKeys.push(innerKey);else{if(topKey){reverse||(animateObj[innerKey]=targetVal,animatable.updateDuringAnimation(topKey));continue}animateToShallow(animatable,innerKey,animateObj[innerKey],targetVal,cfg,animationProps&&animationProps[innerKey],animators,reverse)}else reverse||(animateObj[innerKey]=targetVal,animatable.updateDuringAnimation(topKey),animationKeys.push(innerKey))}var keyLen=animationKeys.length;if(!additive&&keyLen)for(var i=0;i<existsAnimators.length;i++){if((animator=existsAnimators[i]).targetName===topKey)if(animator.stopTracks(animationKeys)){var idx=indexOf(existsAnimators,animator);existsAnimators.splice(idx,1)}}if(cfg.force||(animationKeys=filter(animationKeys,(function(key){return val1=target[key],val2=animateObj[key],!(val1===val2||isArrayLike(val1)&&isArrayLike(val2)&&function(arr0,arr1){var len2=arr0.length;if(len2!==arr1.length)return!1;for(var i=0;i<len2;i++)if(arr0[i]!==arr1[i])return!1;return!0}(val1,val2));var val1,val2})),keyLen=animationKeys.length),keyLen>0||cfg.force&&!animators.length){var animator,revertedSource=void 0,reversedTarget=void 0,sourceClone=void 0;if(reverse){reversedTarget={},setToFinal&&(revertedSource={});for(i=0;i<keyLen;i++){reversedTarget[innerKey=animationKeys[i]]=animateObj[innerKey],setToFinal?revertedSource[innerKey]=target[innerKey]:animateObj[innerKey]=target[innerKey]}}else if(setToFinal){sourceClone={};for(i=0;i<keyLen;i++){sourceClone[innerKey=animationKeys[i]]=cloneValue(animateObj[innerKey]),copyValue(animateObj,target,innerKey)}}(animator=new Animator(animateObj,!1,!1,additive?filter(existsAnimators,(function(animator2){return animator2.targetName===topKey})):null)).targetName=topKey,cfg.scope&&(animator.scope=cfg.scope),setToFinal&&revertedSource&&animator.whenWithKeys(0,revertedSource,animationKeys),sourceClone&&animator.whenWithKeys(0,sourceClone,animationKeys),animator.whenWithKeys(null==duration?500:duration,reverse?reversedTarget:target,animationKeys).delay(delay||0),animatable.addAnimator(animator,topKey),animators.push(animator)}}mixin(Element,Eventful),mixin(Element,Transformable);var Group$2=function(_super){function Group2(opts){var _this=_super.call(this)||this;return _this.isGroup=!0,_this._children=[],_this.attr(opts),_this}return __extends(Group2,_super),Group2.prototype.childrenRef=function(){return this._children},Group2.prototype.children=function(){return this._children.slice()},Group2.prototype.childAt=function(idx){return this._children[idx]},Group2.prototype.childOfName=function(name){for(var children=this._children,i=0;i<children.length;i++)if(children[i].name===name)return children[i]},Group2.prototype.childCount=function(){return this._children.length},Group2.prototype.add=function(child){return child&&child!==this&&child.parent!==this&&(this._children.push(child),this._doAdd(child)),this},Group2.prototype.addBefore=function(child,nextSibling2){if(child&&child!==this&&child.parent!==this&&nextSibling2&&nextSibling2.parent===this){var children=this._children,idx=children.indexOf(nextSibling2);idx>=0&&(children.splice(idx,0,child),this._doAdd(child))}return this},Group2.prototype.replace=function(oldChild,newChild){var idx=indexOf(this._children,oldChild);return idx>=0&&this.replaceAt(newChild,idx),this},Group2.prototype.replaceAt=function(child,index){var children=this._children,old=children[index];if(child&&child!==this&&child.parent!==this&&child!==old){children[index]=child,old.parent=null;var zr=this.__zr;zr&&old.removeSelfFromZr(zr),this._doAdd(child)}return this},Group2.prototype._doAdd=function(child){child.parent&&child.parent.remove(child),child.parent=this;var zr=this.__zr;zr&&zr!==child.__zr&&child.addSelfToZr(zr),zr&&zr.refresh()},Group2.prototype.remove=function(child){var zr=this.__zr,children=this._children,idx=indexOf(children,child);return idx<0||(children.splice(idx,1),child.parent=null,zr&&child.removeSelfFromZr(zr),zr&&zr.refresh()),this},Group2.prototype.removeAll=function(){for(var children=this._children,zr=this.__zr,i=0;i<children.length;i++){var child=children[i];zr&&child.removeSelfFromZr(zr),child.parent=null}return children.length=0,this},Group2.prototype.eachChild=function(cb,context){for(var children=this._children,i=0;i<children.length;i++){var child=children[i];cb.call(context,child,i)}return this},Group2.prototype.traverse=function(cb,context){for(var i=0;i<this._children.length;i++){var child=this._children[i],stopped=cb.call(context,child);child.isGroup&&!stopped&&child.traverse(cb,context)}return this},Group2.prototype.addSelfToZr=function(zr){_super.prototype.addSelfToZr.call(this,zr);for(var i=0;i<this._children.length;i++){this._children[i].addSelfToZr(zr)}},Group2.prototype.removeSelfFromZr=function(zr){_super.prototype.removeSelfFromZr.call(this,zr);for(var i=0;i<this._children.length;i++){this._children[i].removeSelfFromZr(zr)}},Group2.prototype.getBoundingRect=function(includeChildren){for(var tmpRect2=new BoundingRect(0,0,0,0),children=includeChildren||this._children,tmpMat=[],rect=null,i=0;i<children.length;i++){var child=children[i];if(!child.ignore&&!child.invisible){var childRect=child.getBoundingRect(),transform=child.getLocalTransform(tmpMat);transform?(BoundingRect.applyTransform(tmpRect2,childRect,transform),(rect=rect||tmpRect2.clone()).union(tmpRect2)):(rect=rect||childRect.clone()).union(childRect)}}return rect||tmpRect2},Group2}(Element);Group$2.prototype.type="group";
/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/
var painterCtors={},instances$1={};var ssrDataGetter,ZRender=function(){function ZRender2(id,dom,opts){var _this=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,opts=opts||{},this.dom=dom,this.id=id;var storage2=new Storage,rendererType=opts.renderer||"canvas";painterCtors[rendererType]||(rendererType=keys(painterCtors)[0]),opts.useDirtyRect=null!=opts.useDirtyRect&&opts.useDirtyRect;var painter=new painterCtors[rendererType](dom,storage2,opts,id),ssrMode=opts.ssr||painter.ssrOnly;this.storage=storage2,this.painter=painter;var pointerSize,handlerProxy=env.node||env.worker||ssrMode?null:new HandlerDomProxy(painter.getViewportRoot(),painter.root),useCoarsePointer=opts.useCoarsePointer;(null==useCoarsePointer||"auto"===useCoarsePointer?env.touchEventsSupported:!!useCoarsePointer)&&(pointerSize=retrieve2(opts.pointerSize,44)),this.handler=new Handler(storage2,painter,handlerProxy,painter.root,pointerSize),this.animation=new Animation({stage:{update:ssrMode?null:function(){return _this._flush(!0)}}}),ssrMode||this.animation.start()}return ZRender2.prototype.add=function(el){!this._disposed&&el&&(this.storage.addRoot(el),el.addSelfToZr(this),this.refresh())},ZRender2.prototype.remove=function(el){!this._disposed&&el&&(this.storage.delRoot(el),el.removeSelfFromZr(this),this.refresh())},ZRender2.prototype.configLayer=function(zLevel,config){this._disposed||(this.painter.configLayer&&this.painter.configLayer(zLevel,config),this.refresh())},ZRender2.prototype.setBackgroundColor=function(backgroundColor2){this._disposed||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(backgroundColor2),this.refresh(),this._backgroundColor=backgroundColor2,this._darkMode=function(backgroundColor2){if(!backgroundColor2)return!1;if("string"==typeof backgroundColor2)return lum(backgroundColor2,1)<.4;if(backgroundColor2.colorStops){for(var colorStops=backgroundColor2.colorStops,totalLum=0,len2=colorStops.length,i=0;i<len2;i++)totalLum+=lum(colorStops[i].color,1);return(totalLum/=len2)<.4}return!1}(backgroundColor2))},ZRender2.prototype.getBackgroundColor=function(){return this._backgroundColor},ZRender2.prototype.setDarkMode=function(darkMode){this._darkMode=darkMode},ZRender2.prototype.isDarkMode=function(){return this._darkMode},ZRender2.prototype.refreshImmediately=function(fromInside){this._disposed||(fromInside||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1)},ZRender2.prototype.refresh=function(){this._disposed||(this._needsRefresh=!0,this.animation.start())},ZRender2.prototype.flush=function(){this._disposed||this._flush(!1)},ZRender2.prototype._flush=function(fromInside){var triggerRendered,start2=getTime();this._needsRefresh&&(triggerRendered=!0,this.refreshImmediately(fromInside)),this._needsRefreshHover&&(triggerRendered=!0,this.refreshHoverImmediately());var end2=getTime();triggerRendered?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:end2-start2})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},ZRender2.prototype.setSleepAfterStill=function(stillFramesCount){this._sleepAfterStill=stillFramesCount},ZRender2.prototype.wakeUp=function(){this._disposed||(this.animation.start(),this._stillFrameAccum=0)},ZRender2.prototype.refreshHover=function(){this._needsRefreshHover=!0},ZRender2.prototype.refreshHoverImmediately=function(){this._disposed||(this._needsRefreshHover=!1,this.painter.refreshHover&&"canvas"===this.painter.getType()&&this.painter.refreshHover())},ZRender2.prototype.resize=function(opts){this._disposed||(opts=opts||{},this.painter.resize(opts.width,opts.height),this.handler.resize())},ZRender2.prototype.clearAnimation=function(){this._disposed||this.animation.clear()},ZRender2.prototype.getWidth=function(){if(!this._disposed)return this.painter.getWidth()},ZRender2.prototype.getHeight=function(){if(!this._disposed)return this.painter.getHeight()},ZRender2.prototype.setCursorStyle=function(cursorStyle){this._disposed||this.handler.setCursorStyle(cursorStyle)},ZRender2.prototype.findHover=function(x,y){if(!this._disposed)return this.handler.findHover(x,y)},ZRender2.prototype.on=function(eventName,eventHandler,context){return this._disposed||this.handler.on(eventName,eventHandler,context),this},ZRender2.prototype.off=function(eventName,eventHandler){this._disposed||this.handler.off(eventName,eventHandler)},ZRender2.prototype.trigger=function(eventName,event){this._disposed||this.handler.trigger(eventName,event)},ZRender2.prototype.clear=function(){if(!this._disposed){for(var roots2=this.storage.getRoots(),i=0;i<roots2.length;i++)roots2[i]instanceof Group$2&&roots2[i].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},ZRender2.prototype.dispose=function(){var id;this._disposed||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this._disposed=!0,id=this.id,delete instances$1[id])},ZRender2}();function init$1(dom,opts){var zr=new ZRender(guid(),dom,opts);return instances$1[zr.id]=zr,zr}function registerPainter(name,Ctor){painterCtors[name]=Ctor}function getElementSSRData(el){if("function"==typeof ssrDataGetter)return ssrDataGetter(el)}function registerSSRDataGetter(getter){ssrDataGetter=getter}const zrender=Object.freeze(Object.defineProperty({__proto__:null,dispose:function(zr){zr.dispose()},disposeAll:function(){for(var key in instances$1)instances$1.hasOwnProperty(key)&&instances$1[key].dispose();instances$1={}},getElementSSRData:getElementSSRData,getInstance:function(id){return instances$1[id]},init:init$1,registerPainter:registerPainter,registerSSRDataGetter:registerSSRDataGetter,version:"5.6.1"},Symbol.toStringTag,{value:"Module"}));function linearMap$2(val,domain,range,clamp2){var d0=domain[0],d1=domain[1],r0=range[0],r1=range[1],subDomain=d1-d0,subRange=r1-r0;if(0===subDomain)return 0===subRange?r0:(r0+r1)/2;if(clamp2)if(subDomain>0){if(val<=d0)return r0;if(val>=d1)return r1}else{if(val>=d0)return r0;if(val<=d1)return r1}else{if(val===d0)return r0;if(val===d1)return r1}return(val-d0)/subDomain*subRange+r0}function parsePercent(percent,all){switch(percent){case"center":case"middle":percent="50%";break;case"left":case"top":percent="0%";break;case"right":case"bottom":percent="100%"}return isString(percent)?(str=percent,str.replace(/^\s+|\s+$/g,"")).match(/%$/)?parseFloat(percent)/100*all:parseFloat(percent):null==percent?NaN:+percent;var str}function round$3(x,precision,returnStr){return null==precision&&(precision=10),precision=Math.min(Math.max(0,precision),20),x=(+x).toFixed(precision),returnStr?x:+x}function asc$2(arr){return arr.sort((function(a,b){return a-b})),arr}function getPrecision(val){if(val=+val,isNaN(val))return 0;if(val>1e-14)for(var e2=1,i=0;i<15;i++,e2*=10)if(Math.round(val*e2)/e2===val)return i;return getPrecisionSafe(val)}function getPrecisionSafe(val){var str=val.toString().toLowerCase(),eIndex=str.indexOf("e"),exp=eIndex>0?+str.slice(eIndex+1):0,significandPartLen=eIndex>0?eIndex:str.length,dotIndex=str.indexOf("."),decimalPartLen=dotIndex<0?0:significandPartLen-1-dotIndex;return Math.max(0,decimalPartLen-exp)}function getPixelPrecision(dataExtent,pixelExtent){var log=Math.log,LN10=Math.LN10,dataQuantity=Math.floor(log(dataExtent[1]-dataExtent[0])/LN10),sizeQuantity=Math.round(log(Math.abs(pixelExtent[1]-pixelExtent[0]))/LN10),precision=Math.min(Math.max(-dataQuantity+sizeQuantity,0),20);return isFinite(precision)?precision:20}function getPercentSeats(valueList,precision){var sum=reduce(valueList,(function(acc,val){return acc+(isNaN(val)?0:val)}),0);if(0===sum)return[];for(var digits=Math.pow(10,precision),votesPerQuota=map$1(valueList,(function(val){return(isNaN(val)?0:val)/sum*digits*100})),targetSeats=100*digits,seats=map$1(votesPerQuota,(function(votes){return Math.floor(votes)})),currentSum=reduce(seats,(function(acc,val){return acc+val}),0),remainder=map$1(votesPerQuota,(function(votes,idx){return votes-seats[idx]}));currentSum<targetSeats;){for(var max3=Number.NEGATIVE_INFINITY,maxId=null,i=0,len2=remainder.length;i<len2;++i)remainder[i]>max3&&(max3=remainder[i],maxId=i);++seats[maxId],remainder[maxId]=0,++currentSum}return map$1(seats,(function(seat){return seat/digits}))}function addSafe(val0,val1){var maxPrecision=Math.max(getPrecision(val0),getPrecision(val1)),sum=val0+val1;return maxPrecision>20?sum:round$3(sum,maxPrecision)}function remRadian(radian){var pi2=2*Math.PI;return(radian%pi2+pi2)%pi2}function isRadianAroundZero(val){return val>-1e-4&&val<1e-4}var TIME_REG=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function parseDate(value){if(value instanceof Date)return value;if(isString(value)){var match=TIME_REG.exec(value);if(!match)return new Date(NaN);if(match[8]){var hour=+match[4]||0;return"Z"!==match[8].toUpperCase()&&(hour-=+match[8].slice(0,3)),new Date(Date.UTC(+match[1],+(match[2]||1)-1,+match[3]||1,hour,+(match[5]||0),+match[6]||0,match[7]?+match[7].substring(0,3):0))}return new Date(+match[1],+(match[2]||1)-1,+match[3]||1,+match[4]||0,+(match[5]||0),+match[6]||0,match[7]?+match[7].substring(0,3):0)}return null==value?new Date(NaN):new Date(Math.round(value))}function quantity(val){return Math.pow(10,quantityExponent(val))}function quantityExponent(val){if(0===val)return 0;var exp=Math.floor(Math.log(val)/Math.LN10);return val/Math.pow(10,exp)>=10&&exp++,exp}function nice(val,round2){var exponent=quantityExponent(val),exp10=Math.pow(10,exponent),f=val/exp10;return val=(round2?f<1.5?1:f<2.5?2:f<4?3:f<7?5:10:f<1?1:f<2?2:f<3?3:f<5?5:10)*exp10,exponent>=-20?+val.toFixed(exponent<0?-exponent:0):val}function reformIntervals(list){list.sort((function(a,b){return littleThan2(a,b,0)?-1:1}));for(var curr=-Infinity,currClose=1,i=0;i<list.length;){for(var interval=list[i].interval,close_1=list[i].close,lg=0;lg<2;lg++)interval[lg]<=curr&&(interval[lg]=curr,close_1[lg]=lg?1:1-currClose),curr=interval[lg],currClose=close_1[lg];interval[0]===interval[1]&&close_1[0]*close_1[1]!=1?list.splice(i,1):i++}return list;function littleThan2(a,b,lg2){return a.interval[lg2]<b.interval[lg2]||a.interval[lg2]===b.interval[lg2]&&(a.close[lg2]-b.close[lg2]==(lg2?-1:1)||!lg2&&littleThan2(a,b,1))}}function numericToNumber(val){var valFloat=parseFloat(val);return valFloat==val&&(0!==valFloat||!isString(val)||val.indexOf("x")<=0)?valFloat:NaN}function isNumeric(val){return!isNaN(numericToNumber(val))}function getRandomIdBase(){return Math.round(9*Math.random())}function getGreatestCommonDividor(a,b){return 0===b?a:getGreatestCommonDividor(b,a%b)}function getLeastCommonMultiple(a,b){return null==a?b:null==b?a:a*b/getGreatestCommonDividor(a,b)}function throwError(msg){throw new Error(msg)}function interpolateNumber(p0,p1,percent){return(p1-p0)*percent+p0}function normalizeToArray(value){return value instanceof Array?value:null==value?[]:[value]}function defaultEmphasis(opt,key,subOpts){if(opt){opt[key]=opt[key]||{},opt.emphasis=opt.emphasis||{},opt.emphasis[key]=opt.emphasis[key]||{};for(var i=0,len2=subOpts.length;i<len2;i++){var subOptName=subOpts[i];!opt.emphasis[key].hasOwnProperty(subOptName)&&opt[key].hasOwnProperty(subOptName)&&(opt.emphasis[key][subOptName]=opt[key][subOptName])}}}var TEXT_STYLE_OPTIONS=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function getDataItemValue(dataItem){return!isObject$3(dataItem)||isArray$1(dataItem)||dataItem instanceof Date?dataItem:dataItem.value}function isDataItemOption(dataItem){return isObject$3(dataItem)&&!(dataItem instanceof Array)}function mappingToExists(existings,newCmptOptions,mode){var isNormalMergeMode="normalMerge"===mode,isReplaceMergeMode="replaceMerge"===mode,isReplaceAllMode="replaceAll"===mode;existings=existings||[],newCmptOptions=(newCmptOptions||[]).slice();var existingIdIdxMap=createHashMap();each$d(newCmptOptions,(function(cmptOption,index){isObject$3(cmptOption)||(newCmptOptions[index]=null)}));var mapResult,idMap,result=function(existings,existingIdIdxMap,mode){var result=[];if("replaceAll"===mode)return result;for(var index=0;index<existings.length;index++){var existing=existings[index];existing&&null!=existing.id&&existingIdIdxMap.set(existing.id,index),result.push({existing:"replaceMerge"===mode||isComponentIdInternal(existing)?null:existing,newOption:null,keyInfo:null,brandNew:null})}return result}(existings,existingIdIdxMap,mode);return(isNormalMergeMode||isReplaceMergeMode)&&function(result,existings,existingIdIdxMap,newCmptOptions){each$d(newCmptOptions,(function(cmptOption,index){if(cmptOption&&null!=cmptOption.id){var optionId=makeComparableKey(cmptOption.id),existingIdx=existingIdIdxMap.get(optionId);if(null!=existingIdx){var resultItem=result[existingIdx];assert(!resultItem.newOption,'Duplicated option on id "'+optionId+'".'),resultItem.newOption=cmptOption,resultItem.existing=existings[existingIdx],newCmptOptions[index]=null}}}))}(result,existings,existingIdIdxMap,newCmptOptions),isNormalMergeMode&&function(result,newCmptOptions){each$d(newCmptOptions,(function(cmptOption,index){if(cmptOption&&null!=cmptOption.name)for(var i=0;i<result.length;i++){var existing=result[i].existing;if(!result[i].newOption&&existing&&(null==existing.id||null==cmptOption.id)&&!isComponentIdInternal(cmptOption)&&!isComponentIdInternal(existing)&&keyExistAndEqual("name",existing,cmptOption))return result[i].newOption=cmptOption,void(newCmptOptions[index]=null)}}))}(result,newCmptOptions),isNormalMergeMode||isReplaceMergeMode?function(result,newCmptOptions,brandNew){each$d(newCmptOptions,(function(cmptOption){if(cmptOption){for(var resultItem,nextIdx=0;(resultItem=result[nextIdx])&&(resultItem.newOption||isComponentIdInternal(resultItem.existing)||resultItem.existing&&null!=cmptOption.id&&!keyExistAndEqual("id",cmptOption,resultItem.existing));)nextIdx++;resultItem?(resultItem.newOption=cmptOption,resultItem.brandNew=brandNew):result.push({newOption:cmptOption,brandNew:brandNew,existing:null,keyInfo:null}),nextIdx++}}))}(result,newCmptOptions,isReplaceMergeMode):isReplaceAllMode&&function(result,newCmptOptions){each$d(newCmptOptions,(function(cmptOption){result.push({newOption:cmptOption,brandNew:!0,existing:null,keyInfo:null})}))}(result,newCmptOptions),mapResult=result,idMap=createHashMap(),each$d(mapResult,(function(item){var existing=item.existing;existing&&idMap.set(existing.id,item)})),each$d(mapResult,(function(item){var opt=item.newOption;assert(!opt||null==opt.id||!idMap.get(opt.id)||idMap.get(opt.id)===item,"id duplicates: "+(opt&&opt.id)),opt&&null!=opt.id&&idMap.set(opt.id,item),!item.keyInfo&&(item.keyInfo={})})),each$d(mapResult,(function(item,index){var existing=item.existing,opt=item.newOption,keyInfo=item.keyInfo;if(isObject$3(opt)){if(keyInfo.name=null!=opt.name?makeComparableKey(opt.name):existing?existing.name:"series\0"+index,existing)keyInfo.id=makeComparableKey(existing.id);else if(null!=opt.id)keyInfo.id=makeComparableKey(opt.id);else{var idNum=0;do{keyInfo.id="\0"+keyInfo.name+"\0"+idNum++}while(idMap.get(keyInfo.id))}idMap.set(keyInfo.id,item)}})),result}function keyExistAndEqual(attr,obj1,obj2){var key1=convertOptionIdName(obj1[attr],null),key2=convertOptionIdName(obj2[attr],null);return null!=key1&&null!=key2&&key1===key2}function makeComparableKey(val){return convertOptionIdName(val,"")}function convertOptionIdName(idOrName,defaultValue){return null==idOrName?defaultValue:isString(idOrName)?idOrName:isNumber(idOrName)||isStringSafe(idOrName)?idOrName+"":defaultValue}function isNameSpecified(componentModel){var name=componentModel.name;return!(!name||!name.indexOf("series\0"))}function isComponentIdInternal(cmptOption){return cmptOption&&null!=cmptOption.id&&0===makeComparableKey(cmptOption.id).indexOf("\0_ec_\0")}function queryDataIndex(data,payload){return null!=payload.dataIndexInside?payload.dataIndexInside:null!=payload.dataIndex?isArray$1(payload.dataIndex)?map$1(payload.dataIndex,(function(value){return data.indexOfRawIndex(value)})):data.indexOfRawIndex(payload.dataIndex):null!=payload.name?isArray$1(payload.name)?map$1(payload.name,(function(value){return data.indexOfName(value)})):data.indexOfName(payload.name):void 0}function makeInner(){var key="__ec_inner_"+innerUniqueIndex++;return function(hostObj){return hostObj[key]||(hostObj[key]={})}}var innerUniqueIndex=getRandomIdBase();function parseFinder$1(ecModel,finderInput,opt){var _a2=preParseFinder(finderInput,opt),mainTypeSpecified=_a2.mainTypeSpecified,queryOptionMap=_a2.queryOptionMap,result=_a2.others,defaultMainType=opt?opt.defaultMainType:null;return!mainTypeSpecified&&defaultMainType&&queryOptionMap.set(defaultMainType,{}),queryOptionMap.each((function(queryOption,mainType){var queryResult=queryReferringComponents(ecModel,mainType,queryOption,{useDefault:defaultMainType===mainType,enableAll:!opt||null==opt.enableAll||opt.enableAll,enableNone:!opt||null==opt.enableNone||opt.enableNone});result[mainType+"Models"]=queryResult.models,result[mainType+"Model"]=queryResult.models[0]})),result}function preParseFinder(finderInput,opt){var finder;if(isString(finderInput)){var obj={};obj[finderInput+"Index"]=0,finder=obj}else finder=finderInput;var queryOptionMap=createHashMap(),others={},mainTypeSpecified=!1;return each$d(finder,(function(value,key){if("dataIndex"!==key&&"dataIndexInside"!==key){var parsedKey=key.match(/^(\w+)(Index|Id|Name)$/)||[],mainType=parsedKey[1],queryType=(parsedKey[2]||"").toLowerCase();if(mainType&&queryType&&!(opt&&opt.includeMainTypes&&indexOf(opt.includeMainTypes,mainType)<0))mainTypeSpecified=mainTypeSpecified||!!mainType,(queryOptionMap.get(mainType)||queryOptionMap.set(mainType,{}))[queryType]=value}else others[key]=value})),{mainTypeSpecified:mainTypeSpecified,queryOptionMap:queryOptionMap,others:others}}var SINGLE_REFERRING={useDefault:!0,enableAll:!1,enableNone:!1},MULTIPLE_REFERRING={useDefault:!1,enableAll:!0,enableNone:!0};function queryReferringComponents(ecModel,mainType,userOption,opt){opt=opt||SINGLE_REFERRING;var indexOption=userOption.index,idOption=userOption.id,nameOption=userOption.name,result={models:null,specified:null!=indexOption||null!=idOption||null!=nameOption};if(!result.specified){var firstCmpt=void 0;return result.models=opt.useDefault&&(firstCmpt=ecModel.getComponent(mainType))?[firstCmpt]:[],result}return"none"===indexOption||!1===indexOption?(assert(opt.enableNone,'`"none"` or `false` is not a valid value on index option.'),result.models=[],result):("all"===indexOption&&(assert(opt.enableAll,'`"all"` is not a valid value on index option.'),indexOption=idOption=nameOption=null),result.models=ecModel.queryComponents({mainType:mainType,index:indexOption,id:idOption,name:nameOption}),result)}function setAttribute(dom,key,value){dom.setAttribute?dom.setAttribute(key,value):dom[key]=value}var IS_CONTAINER="___EC__COMPONENT__CONTAINER___";function parseClassType(componentType){var ret={main:"",sub:""};if(componentType){var typeArr=componentType.split(".");ret.main=typeArr[0]||"",ret.sub=typeArr[1]||""}return ret}function enableClassExtend(rootClz,mandatoryMethods){rootClz.$constructor=rootClz,rootClz.extend=function(proto2){var ExtendedClass,fn,superClass=this;return isFunction(fn=superClass)&&/^class\s/.test(Function.prototype.toString.call(fn))?ExtendedClass=function(_super){function class_1(){return _super.apply(this,arguments)||this}return __extends(class_1,_super),class_1}(superClass):(ExtendedClass=function(){(proto2.$constructor||superClass).apply(this,arguments)},inherits(ExtendedClass,this)),extend(ExtendedClass.prototype,proto2),ExtendedClass.___EC__EXTENDED_CLASS___=!0,ExtendedClass.extend=this.extend,ExtendedClass.superCall=superCall,ExtendedClass.superApply=superApply,ExtendedClass.superClass=superClass,ExtendedClass}}function mountExtend(SubClz,SupperClz){SubClz.extend=SupperClz.extend}var classBase=Math.round(10*Math.random());function superCall(context,methodName){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];return this.superClass.prototype[methodName].apply(context,args)}function superApply(context,methodName,args){return this.superClass.prototype[methodName].apply(context,args)}function enableClassManagement(target){var storage2={};target.registerClass=function(clz){var componentType,componentFullType=clz.type||clz.prototype.type;if(componentFullType){assert(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(componentType=componentFullType),'componentType "'+componentType+'" illegal'),clz.prototype.type=componentFullType;var componentTypeInfo=parseClassType(componentFullType);if(componentTypeInfo.sub){if(componentTypeInfo.sub!==IS_CONTAINER){var container=function(componentTypeInfo){var container=storage2[componentTypeInfo.main];container&&container[IS_CONTAINER]||((container=storage2[componentTypeInfo.main]={})[IS_CONTAINER]=!0);return container}(componentTypeInfo);container[componentTypeInfo.sub]=clz}}else storage2[componentTypeInfo.main]=clz}return clz},target.getClass=function(mainType,subType,throwWhenNotFound){var clz=storage2[mainType];if(clz&&clz[IS_CONTAINER]&&(clz=subType?clz[subType]:null),throwWhenNotFound&&!clz)throw new Error(subType?"Component "+mainType+"."+(subType||"")+" is used but not imported.":mainType+".type should be specified.");return clz},target.getClassesByMainType=function(componentType){var componentTypeInfo=parseClassType(componentType),result=[],obj=storage2[componentTypeInfo.main];return obj&&obj[IS_CONTAINER]?each$d(obj,(function(o,type){type!==IS_CONTAINER&&result.push(o)})):result.push(obj),result},target.hasClass=function(componentType){var componentTypeInfo=parseClassType(componentType);return!!storage2[componentTypeInfo.main]},target.getAllClassMainTypes=function(){var types=[];return each$d(storage2,(function(obj,type){types.push(type)})),types},target.hasSubTypes=function(componentType){var componentTypeInfo=parseClassType(componentType),obj=storage2[componentTypeInfo.main];return obj&&obj[IS_CONTAINER]}}function makeStyleMapper(properties,ignoreParent){for(var i=0;i<properties.length;i++)properties[i][1]||(properties[i][1]=properties[i][0]);return ignoreParent=ignoreParent||!1,function(model,excludes,includes){for(var style={},i2=0;i2<properties.length;i2++){var propName=properties[i2][1];if(!(excludes&&indexOf(excludes,propName)>=0||includes&&indexOf(includes,propName)<0)){var val=model.getShallow(propName,ignoreParent);null!=val&&(style[properties[i2][0]]=val)}}return style}}var getAreaStyle=makeStyleMapper([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]]),AreaStyleMixin=function(){function AreaStyleMixin2(){}return AreaStyleMixin2.prototype.getAreaStyle=function(excludes,includes){return getAreaStyle(this,excludes,includes)},AreaStyleMixin2}(),globalImageCache=new LRU(50);function findExistImage(newImageOrSrc){if("string"==typeof newImageOrSrc){var cachedImgObj=globalImageCache.get(newImageOrSrc);return cachedImgObj&&cachedImgObj.image}return newImageOrSrc}function createOrUpdateImage(newImageOrSrc,image,hostEl,onload,cbPayload){if(newImageOrSrc){if("string"==typeof newImageOrSrc){if(image&&image.__zrImageSrc===newImageOrSrc||!hostEl)return image;var cachedImgObj=globalImageCache.get(newImageOrSrc),pendingWrap={hostEl:hostEl,cb:onload,cbPayload:cbPayload};return cachedImgObj?!isImageReady(image=cachedImgObj.image)&&cachedImgObj.pending.push(pendingWrap):((image=platformApi.loadImage(newImageOrSrc,imageOnLoad,imageOnLoad)).__zrImageSrc=newImageOrSrc,globalImageCache.put(newImageOrSrc,image.__cachedImgObj={image:image,pending:[pendingWrap]})),image}return newImageOrSrc}return image}function imageOnLoad(){var cachedImgObj=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var i=0;i<cachedImgObj.pending.length;i++){var pendingWrap=cachedImgObj.pending[i],cb=pendingWrap.cb;cb&&cb(this,pendingWrap.cbPayload),pendingWrap.hostEl.dirty()}cachedImgObj.pending.length=0}function isImageReady(image){return image&&image.width&&image.height}var STYLE_REG=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function truncateText2(out2,text,containerWidth,font,ellipsis,options){if(!containerWidth)return out2.text="",void(out2.isTruncated=!1);var textLines=(text+"").split("\n");options=prepareTruncateOptions(containerWidth,font,ellipsis,options);for(var isTruncated=!1,truncateOut={},i=0,len2=textLines.length;i<len2;i++)truncateSingleLine(truncateOut,textLines[i],options),textLines[i]=truncateOut.textLine,isTruncated=isTruncated||truncateOut.isTruncated;out2.text=textLines.join("\n"),out2.isTruncated=isTruncated}function prepareTruncateOptions(containerWidth,font,ellipsis,options){var preparedOpts=extend({},options=options||{});preparedOpts.font=font,ellipsis=retrieve2(ellipsis,"..."),preparedOpts.maxIterations=retrieve2(options.maxIterations,2);var minChar=preparedOpts.minChar=retrieve2(options.minChar,0);preparedOpts.cnCharWidth=getWidth("国",font);var ascCharWidth=preparedOpts.ascCharWidth=getWidth("a",font);preparedOpts.placeholder=retrieve2(options.placeholder,"");for(var contentWidth=containerWidth=Math.max(0,containerWidth-1),i=0;i<minChar&&contentWidth>=ascCharWidth;i++)contentWidth-=ascCharWidth;var ellipsisWidth=getWidth(ellipsis,font);return ellipsisWidth>contentWidth&&(ellipsis="",ellipsisWidth=0),contentWidth=containerWidth-ellipsisWidth,preparedOpts.ellipsis=ellipsis,preparedOpts.ellipsisWidth=ellipsisWidth,preparedOpts.contentWidth=contentWidth,preparedOpts.containerWidth=containerWidth,preparedOpts}function truncateSingleLine(out2,textLine,options){var containerWidth=options.containerWidth,font=options.font,contentWidth=options.contentWidth;if(!containerWidth)return out2.textLine="",void(out2.isTruncated=!1);var lineWidth=getWidth(textLine,font);if(lineWidth<=containerWidth)return out2.textLine=textLine,void(out2.isTruncated=!1);for(var j=0;;j++){if(lineWidth<=contentWidth||j>=options.maxIterations){textLine+=options.ellipsis;break}var subLength=0===j?estimateLength(textLine,contentWidth,options.ascCharWidth,options.cnCharWidth):lineWidth>0?Math.floor(textLine.length*contentWidth/lineWidth):0;lineWidth=getWidth(textLine=textLine.substr(0,subLength),font)}""===textLine&&(textLine=options.placeholder),out2.textLine=textLine,out2.isTruncated=!0}function estimateLength(text,contentWidth,ascCharWidth,cnCharWidth){for(var width=0,i=0,len2=text.length;i<len2&&width<contentWidth;i++){var charCode=text.charCodeAt(i);width+=0<=charCode&&charCode<=127?ascCharWidth:cnCharWidth}return i}var RichTextToken=function(){return function(){}}(),RichTextLine=function(){return function(tokens){this.tokens=[],tokens&&(this.tokens=tokens)}}(),RichTextContentBlock=function(){return function(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[],this.isTruncated=!1}}();function pushTokens(block,str,style,wrapInfo,styleName){var strLines,linesWidths,isEmptyStr=""===str,tokenStyle=styleName&&style.rich[styleName]||{},lines=block.lines,font=tokenStyle.font||style.font,newLine=!1;if(wrapInfo){var tokenPadding=tokenStyle.padding,tokenPaddingH=tokenPadding?tokenPadding[1]+tokenPadding[3]:0;if(null!=tokenStyle.width&&"auto"!==tokenStyle.width){var outerWidth_1=parsePercent$1(tokenStyle.width,wrapInfo.width)+tokenPaddingH;lines.length>0&&outerWidth_1+wrapInfo.accumWidth>wrapInfo.width&&(strLines=str.split("\n"),newLine=!0),wrapInfo.accumWidth=outerWidth_1}else{var res=wrapText(str,font,wrapInfo.width,wrapInfo.breakAll,wrapInfo.accumWidth);wrapInfo.accumWidth=res.accumWidth+tokenPaddingH,linesWidths=res.linesWidths,strLines=res.lines}}else strLines=str.split("\n");for(var i=0;i<strLines.length;i++){var text=strLines[i],token=new RichTextToken;if(token.styleName=styleName,token.text=text,token.isLineHolder=!text&&!isEmptyStr,"number"==typeof tokenStyle.width?token.width=tokenStyle.width:token.width=linesWidths?linesWidths[i]:getWidth(text,font),i||newLine)lines.push(new RichTextLine([token]));else{var tokens=(lines[lines.length-1]||(lines[0]=new RichTextLine)).tokens,tokensLen=tokens.length;1===tokensLen&&tokens[0].isLineHolder?tokens[0]=token:(text||!tokensLen||isEmptyStr)&&tokens.push(token)}}}var breakCharMap=reduce(",&?/;] ".split(""),(function(obj,ch){return obj[ch]=!0,obj}),{});function isWordBreakChar(ch){return!function(ch){var code=ch.charCodeAt(0);return code>=32&&code<=591||code>=880&&code<=4351||code>=4608&&code<=5119||code>=7680&&code<=8303}(ch)||!!breakCharMap[ch]}function wrapText(text,font,lineWidth,isBreakAll,lastAccumWidth){for(var lines=[],linesWidths=[],line="",currentWord="",currentWordWidth=0,accumWidth=0,i=0;i<text.length;i++){var ch=text.charAt(i);if("\n"!==ch){var chWidth=getWidth(ch,font),inWord=!isBreakAll&&!isWordBreakChar(ch);(lines.length?accumWidth+chWidth>lineWidth:lastAccumWidth+accumWidth+chWidth>lineWidth)?accumWidth?(line||currentWord)&&(inWord?(line||(line=currentWord,currentWord="",accumWidth=currentWordWidth=0),lines.push(line),linesWidths.push(accumWidth-currentWordWidth),currentWord+=ch,line="",accumWidth=currentWordWidth+=chWidth):(currentWord&&(line+=currentWord,currentWord="",currentWordWidth=0),lines.push(line),linesWidths.push(accumWidth),line=ch,accumWidth=chWidth)):inWord?(lines.push(currentWord),linesWidths.push(currentWordWidth),currentWord=ch,currentWordWidth=chWidth):(lines.push(ch),linesWidths.push(chWidth)):(accumWidth+=chWidth,inWord?(currentWord+=ch,currentWordWidth+=chWidth):(currentWord&&(line+=currentWord,currentWord="",currentWordWidth=0),line+=ch))}else currentWord&&(line+=currentWord,accumWidth+=currentWordWidth),lines.push(line),linesWidths.push(accumWidth),line="",currentWord="",currentWordWidth=0,accumWidth=0}return lines.length||line||(line=text,currentWord="",currentWordWidth=0),currentWord&&(line+=currentWord),line&&(lines.push(line),linesWidths.push(accumWidth)),1===lines.length&&(accumWidth+=lastAccumWidth),{accumWidth:accumWidth,lines:lines,linesWidths:linesWidths}}var STYLE_MAGIC_KEY="__zr_style_"+Math.round(10*Math.random()),DEFAULT_COMMON_STYLE={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},DEFAULT_COMMON_ANIMATION_PROPS={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};DEFAULT_COMMON_STYLE[STYLE_MAGIC_KEY]=!0;var PRIMARY_STATES_KEYS=["z","z2","invisible"],PRIMARY_STATES_KEYS_IN_HOVER_LAYER=["invisible"],Displayable=function(_super){function Displayable2(props){return _super.call(this,props)||this}var dispProto;return __extends(Displayable2,_super),Displayable2.prototype._init=function(props){for(var keysArr=keys(props),i=0;i<keysArr.length;i++){var key=keysArr[i];"style"===key?this.useStyle(props[key]):_super.prototype.attrKV.call(this,key,props[key])}this.style||this.useStyle({})},Displayable2.prototype.beforeBrush=function(){},Displayable2.prototype.afterBrush=function(){},Displayable2.prototype.innerBeforeBrush=function(){},Displayable2.prototype.innerAfterBrush=function(){},Displayable2.prototype.shouldBePainted=function(viewWidth,viewHeight,considerClipPath,considerAncestors){var m2=this.transform;if(this.ignore||this.invisible||0===this.style.opacity||this.culling&&function(el,width,height){tmpRect.copy(el.getBoundingRect()),el.transform&&tmpRect.applyTransform(el.transform);return viewRect.width=width,viewRect.height=height,!tmpRect.intersect(viewRect)}(this,viewWidth,viewHeight)||m2&&!m2[0]&&!m2[3])return!1;if(considerClipPath&&this.__clipPaths)for(var i=0;i<this.__clipPaths.length;++i)if(this.__clipPaths[i].isZeroArea())return!1;if(considerAncestors&&this.parent)for(var parent_1=this.parent;parent_1;){if(parent_1.ignore)return!1;parent_1=parent_1.parent}return!0},Displayable2.prototype.contain=function(x,y){return this.rectContain(x,y)},Displayable2.prototype.traverse=function(cb,context){cb.call(context,this)},Displayable2.prototype.rectContain=function(x,y){var coord=this.transformCoordToLocal(x,y);return this.getBoundingRect().contain(coord[0],coord[1])},Displayable2.prototype.getPaintRect=function(){var rect=this._paintRect;if(!this._paintRect||this.__dirty){var transform=this.transform,elRect=this.getBoundingRect(),style=this.style,shadowSize=style.shadowBlur||0,shadowOffsetX=style.shadowOffsetX||0,shadowOffsetY=style.shadowOffsetY||0;rect=this._paintRect||(this._paintRect=new BoundingRect(0,0,0,0)),transform?BoundingRect.applyTransform(rect,elRect,transform):rect.copy(elRect),(shadowSize||shadowOffsetX||shadowOffsetY)&&(rect.width+=2*shadowSize+Math.abs(shadowOffsetX),rect.height+=2*shadowSize+Math.abs(shadowOffsetY),rect.x=Math.min(rect.x,rect.x+shadowOffsetX-shadowSize),rect.y=Math.min(rect.y,rect.y+shadowOffsetY-shadowSize));var tolerance=this.dirtyRectTolerance;rect.isZero()||(rect.x=Math.floor(rect.x-tolerance),rect.y=Math.floor(rect.y-tolerance),rect.width=Math.ceil(rect.width+1+2*tolerance),rect.height=Math.ceil(rect.height+1+2*tolerance))}return rect},Displayable2.prototype.setPrevPaintRect=function(paintRect){paintRect?(this._prevPaintRect=this._prevPaintRect||new BoundingRect(0,0,0,0),this._prevPaintRect.copy(paintRect)):this._prevPaintRect=null},Displayable2.prototype.getPrevPaintRect=function(){return this._prevPaintRect},Displayable2.prototype.animateStyle=function(loop){return this.animate("style",loop)},Displayable2.prototype.updateDuringAnimation=function(targetKey){"style"===targetKey?this.dirtyStyle():this.markRedraw()},Displayable2.prototype.attrKV=function(key,value){"style"!==key?_super.prototype.attrKV.call(this,key,value):this.style?this.setStyle(value):this.useStyle(value)},Displayable2.prototype.setStyle=function(keyOrObj,value){return"string"==typeof keyOrObj?this.style[keyOrObj]=value:extend(this.style,keyOrObj),this.dirtyStyle(),this},Displayable2.prototype.dirtyStyle=function(notRedraw){notRedraw||this.markRedraw(),this.__dirty|=2,this._rect&&(this._rect=null)},Displayable2.prototype.dirty=function(){this.dirtyStyle()},Displayable2.prototype.styleChanged=function(){return!!(2&this.__dirty)},Displayable2.prototype.styleUpdated=function(){this.__dirty&=-3},Displayable2.prototype.createStyle=function(obj){return createObject(DEFAULT_COMMON_STYLE,obj)},Displayable2.prototype.useStyle=function(obj){obj[STYLE_MAGIC_KEY]||(obj=this.createStyle(obj)),this.__inHover?this.__hoverStyle=obj:this.style=obj,this.dirtyStyle()},Displayable2.prototype.isStyleObject=function(obj){return obj[STYLE_MAGIC_KEY]},Displayable2.prototype._innerSaveToNormal=function(toState){_super.prototype._innerSaveToNormal.call(this,toState);var normalState=this._normalState;toState.style&&!normalState.style&&(normalState.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(toState,normalState,PRIMARY_STATES_KEYS)},Displayable2.prototype._applyStateObj=function(stateName,state,normalState,keepCurrentStates,transition,animationCfg){_super.prototype._applyStateObj.call(this,stateName,state,normalState,keepCurrentStates,transition,animationCfg);var targetStyle,needsRestoreToNormal=!(state&&keepCurrentStates);if(state&&state.style?transition?keepCurrentStates?targetStyle=state.style:(targetStyle=this._mergeStyle(this.createStyle(),normalState.style),this._mergeStyle(targetStyle,state.style)):(targetStyle=this._mergeStyle(this.createStyle(),keepCurrentStates?this.style:normalState.style),this._mergeStyle(targetStyle,state.style)):needsRestoreToNormal&&(targetStyle=normalState.style),targetStyle)if(transition){var sourceStyle=this.style;if(this.style=this.createStyle(needsRestoreToNormal?{}:sourceStyle),needsRestoreToNormal)for(var changedKeys=keys(sourceStyle),i=0;i<changedKeys.length;i++){(key=changedKeys[i])in targetStyle&&(targetStyle[key]=targetStyle[key],this.style[key]=sourceStyle[key])}var targetKeys=keys(targetStyle);for(i=0;i<targetKeys.length;i++){var key=targetKeys[i];this.style[key]=this.style[key]}this._transitionState(stateName,{style:targetStyle},animationCfg,this.getAnimationStyleProps())}else this.useStyle(targetStyle);var statesKeys=this.__inHover?PRIMARY_STATES_KEYS_IN_HOVER_LAYER:PRIMARY_STATES_KEYS;for(i=0;i<statesKeys.length;i++){key=statesKeys[i];state&&null!=state[key]?this[key]=state[key]:needsRestoreToNormal&&null!=normalState[key]&&(this[key]=normalState[key])}},Displayable2.prototype._mergeStates=function(states){for(var mergedStyle,mergedState=_super.prototype._mergeStates.call(this,states),i=0;i<states.length;i++){var state=states[i];state.style&&(mergedStyle=mergedStyle||{},this._mergeStyle(mergedStyle,state.style))}return mergedStyle&&(mergedState.style=mergedStyle),mergedState},Displayable2.prototype._mergeStyle=function(targetStyle,sourceStyle){return extend(targetStyle,sourceStyle),targetStyle},Displayable2.prototype.getAnimationStyleProps=function(){return DEFAULT_COMMON_ANIMATION_PROPS},Displayable2.initDefaultProps=((dispProto=Displayable2.prototype).type="displayable",dispProto.invisible=!1,dispProto.z=0,dispProto.z2=0,dispProto.zlevel=0,dispProto.culling=!1,dispProto.cursor="pointer",dispProto.rectHover=!1,dispProto.incremental=!1,dispProto._rect=null,dispProto.dirtyRectTolerance=0,void(dispProto.__dirty=3)),Displayable2}(Element),tmpRect=new BoundingRect(0,0,0,0),viewRect=new BoundingRect(0,0,0,0);var mathMin$8=Math.min,mathMax$8=Math.max,mathSin$4=Math.sin,mathCos$4=Math.cos,PI2$7=2*Math.PI,start=create$1(),end=create$1(),extremity=create$1();function fromLine(x0,y0,x1,y1,min3,max3){min3[0]=mathMin$8(x0,x1),min3[1]=mathMin$8(y0,y1),max3[0]=mathMax$8(x0,x1),max3[1]=mathMax$8(y0,y1)}var xDim=[],yDim=[];function fromCubic(x0,y0,x1,y1,x2,y2,x3,y3,min3,max3){var cubicExtrema$1=cubicExtrema,cubicAt$1=cubicAt,n=cubicExtrema$1(x0,x1,x2,x3,xDim);min3[0]=Infinity,min3[1]=Infinity,max3[0]=-Infinity,max3[1]=-Infinity;for(var i=0;i<n;i++){var x=cubicAt$1(x0,x1,x2,x3,xDim[i]);min3[0]=mathMin$8(x,min3[0]),max3[0]=mathMax$8(x,max3[0])}n=cubicExtrema$1(y0,y1,y2,y3,yDim);for(i=0;i<n;i++){var y=cubicAt$1(y0,y1,y2,y3,yDim[i]);min3[1]=mathMin$8(y,min3[1]),max3[1]=mathMax$8(y,max3[1])}min3[0]=mathMin$8(x0,min3[0]),max3[0]=mathMax$8(x0,max3[0]),min3[0]=mathMin$8(x3,min3[0]),max3[0]=mathMax$8(x3,max3[0]),min3[1]=mathMin$8(y0,min3[1]),max3[1]=mathMax$8(y0,max3[1]),min3[1]=mathMin$8(y3,min3[1]),max3[1]=mathMax$8(y3,max3[1])}function fromQuadratic(x0,y0,x1,y1,x2,y2,min3,max3){var quadraticExtremum$1=quadraticExtremum,quadraticAt$1=quadraticAt,tx=mathMax$8(mathMin$8(quadraticExtremum$1(x0,x1,x2),1),0),ty=mathMax$8(mathMin$8(quadraticExtremum$1(y0,y1,y2),1),0),x=quadraticAt$1(x0,x1,x2,tx),y=quadraticAt$1(y0,y1,y2,ty);min3[0]=mathMin$8(x0,x2,x),min3[1]=mathMin$8(y0,y2,y),max3[0]=mathMax$8(x0,x2,x),max3[1]=mathMax$8(y0,y2,y)}function fromArc(x,y,rx,ry,startAngle,endAngle,anticlockwise,min3,max3){var vec2Min=min$1,vec2Max=max$1,diff=Math.abs(startAngle-endAngle);if(diff%PI2$7<1e-4&&diff>1e-4)return min3[0]=x-rx,min3[1]=y-ry,max3[0]=x+rx,void(max3[1]=y+ry);if(start[0]=mathCos$4(startAngle)*rx+x,start[1]=mathSin$4(startAngle)*ry+y,end[0]=mathCos$4(endAngle)*rx+x,end[1]=mathSin$4(endAngle)*ry+y,vec2Min(min3,start,end),vec2Max(max3,start,end),(startAngle%=PI2$7)<0&&(startAngle+=PI2$7),(endAngle%=PI2$7)<0&&(endAngle+=PI2$7),startAngle>endAngle&&!anticlockwise?endAngle+=PI2$7:startAngle<endAngle&&anticlockwise&&(startAngle+=PI2$7),anticlockwise){var tmp=endAngle;endAngle=startAngle,startAngle=tmp}for(var angle=0;angle<endAngle;angle+=Math.PI/2)angle>startAngle&&(extremity[0]=mathCos$4(angle)*rx+x,extremity[1]=mathSin$4(angle)*ry+y,vec2Min(min3,extremity,min3),vec2Max(max3,extremity,max3))}var CMD$2={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},tmpOutX=[],tmpOutY=[],min=[],max=[],min2=[],max2=[],mathMin$7=Math.min,mathMax$7=Math.max,mathCos$3=Math.cos,mathSin$3=Math.sin,mathAbs$1=Math.abs,PI$7=Math.PI,PI2$6=2*PI$7,hasTypedArray="undefined"!=typeof Float32Array,tmpAngles=[];function modPI2(radian){return Math.round(radian/PI$7*1e8)/1e8%2*PI$7}function normalizeArcAngles(angles,anticlockwise){var newStartAngle=modPI2(angles[0]);newStartAngle<0&&(newStartAngle+=PI2$6);var delta=newStartAngle-angles[0],newEndAngle=angles[1];newEndAngle+=delta,!anticlockwise&&newEndAngle-newStartAngle>=PI2$6?newEndAngle=newStartAngle+PI2$6:anticlockwise&&newStartAngle-newEndAngle>=PI2$6?newEndAngle=newStartAngle-PI2$6:!anticlockwise&&newStartAngle>newEndAngle?newEndAngle=newStartAngle+(PI2$6-modPI2(newStartAngle-newEndAngle)):anticlockwise&&newStartAngle<newEndAngle&&(newEndAngle=newStartAngle-(PI2$6-modPI2(newEndAngle-newStartAngle))),angles[0]=newStartAngle,angles[1]=newEndAngle}var PathProxy=function(){function PathProxy2(notSaveData){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,notSaveData&&(this._saveData=!1),this._saveData&&(this.data=[])}var proto2;return PathProxy2.prototype.increaseVersion=function(){this._version++},PathProxy2.prototype.getVersion=function(){return this._version},PathProxy2.prototype.setScale=function(sx,sy,segmentIgnoreThreshold){(segmentIgnoreThreshold=segmentIgnoreThreshold||0)>0&&(this._ux=mathAbs$1(segmentIgnoreThreshold/devicePixelRatio/sx)||0,this._uy=mathAbs$1(segmentIgnoreThreshold/devicePixelRatio/sy)||0)},PathProxy2.prototype.setDPR=function(dpr2){this.dpr=dpr2},PathProxy2.prototype.setContext=function(ctx){this._ctx=ctx},PathProxy2.prototype.getContext=function(){return this._ctx},PathProxy2.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},PathProxy2.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},PathProxy2.prototype.moveTo=function(x,y){return this._drawPendingPt(),this.addData(CMD$2.M,x,y),this._ctx&&this._ctx.moveTo(x,y),this._x0=x,this._y0=y,this._xi=x,this._yi=y,this},PathProxy2.prototype.lineTo=function(x,y){var dx=mathAbs$1(x-this._xi),dy=mathAbs$1(y-this._yi),exceedUnit=dx>this._ux||dy>this._uy;if(this.addData(CMD$2.L,x,y),this._ctx&&exceedUnit&&this._ctx.lineTo(x,y),exceedUnit)this._xi=x,this._yi=y,this._pendingPtDist=0;else{var d2=dx*dx+dy*dy;d2>this._pendingPtDist&&(this._pendingPtX=x,this._pendingPtY=y,this._pendingPtDist=d2)}return this},PathProxy2.prototype.bezierCurveTo=function(x1,y1,x2,y2,x3,y3){return this._drawPendingPt(),this.addData(CMD$2.C,x1,y1,x2,y2,x3,y3),this._ctx&&this._ctx.bezierCurveTo(x1,y1,x2,y2,x3,y3),this._xi=x3,this._yi=y3,this},PathProxy2.prototype.quadraticCurveTo=function(x1,y1,x2,y2){return this._drawPendingPt(),this.addData(CMD$2.Q,x1,y1,x2,y2),this._ctx&&this._ctx.quadraticCurveTo(x1,y1,x2,y2),this._xi=x2,this._yi=y2,this},PathProxy2.prototype.arc=function(cx,cy,r,startAngle,endAngle,anticlockwise){this._drawPendingPt(),tmpAngles[0]=startAngle,tmpAngles[1]=endAngle,normalizeArcAngles(tmpAngles,anticlockwise),startAngle=tmpAngles[0];var delta=(endAngle=tmpAngles[1])-startAngle;return this.addData(CMD$2.A,cx,cy,r,r,startAngle,delta,0,anticlockwise?0:1),this._ctx&&this._ctx.arc(cx,cy,r,startAngle,endAngle,anticlockwise),this._xi=mathCos$3(endAngle)*r+cx,this._yi=mathSin$3(endAngle)*r+cy,this},PathProxy2.prototype.arcTo=function(x1,y1,x2,y2,radius){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(x1,y1,x2,y2,radius),this},PathProxy2.prototype.rect=function(x,y,w,h){return this._drawPendingPt(),this._ctx&&this._ctx.rect(x,y,w,h),this.addData(CMD$2.R,x,y,w,h),this},PathProxy2.prototype.closePath=function(){this._drawPendingPt(),this.addData(CMD$2.Z);var ctx=this._ctx,x0=this._x0,y0=this._y0;return ctx&&ctx.closePath(),this._xi=x0,this._yi=y0,this},PathProxy2.prototype.fill=function(ctx){ctx&&ctx.fill(),this.toStatic()},PathProxy2.prototype.stroke=function(ctx){ctx&&ctx.stroke(),this.toStatic()},PathProxy2.prototype.len=function(){return this._len},PathProxy2.prototype.setData=function(data){var len2=data.length;this.data&&this.data.length===len2||!hasTypedArray||(this.data=new Float32Array(len2));for(var i=0;i<len2;i++)this.data[i]=data[i];this._len=len2},PathProxy2.prototype.appendPath=function(path){path instanceof Array||(path=[path]);for(var len2=path.length,appendSize=0,offset=this._len,i=0;i<len2;i++)appendSize+=path[i].len();hasTypedArray&&this.data instanceof Float32Array&&(this.data=new Float32Array(offset+appendSize));for(i=0;i<len2;i++)for(var appendPathData=path[i].data,k=0;k<appendPathData.length;k++)this.data[offset++]=appendPathData[k];this._len=offset},PathProxy2.prototype.addData=function(cmd,a,b,c,d,e2,f,g,h){if(this._saveData){var data=this.data;this._len+arguments.length>data.length&&(this._expandData(),data=this.data);for(var i=0;i<arguments.length;i++)data[this._len++]=arguments[i]}},PathProxy2.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},PathProxy2.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var newData=[],i=0;i<this._len;i++)newData[i]=this.data[i];this.data=newData}},PathProxy2.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var data=this.data;data instanceof Array&&(data.length=this._len,hasTypedArray&&this._len>11&&(this.data=new Float32Array(data)))}},PathProxy2.prototype.getBoundingRect=function(){min[0]=min[1]=min2[0]=min2[1]=Number.MAX_VALUE,max[0]=max[1]=max2[0]=max2[1]=-Number.MAX_VALUE;var i,data=this.data,xi=0,yi=0,x0=0,y0=0;for(i=0;i<this._len;){var cmd=data[i++],isFirst=1===i;switch(isFirst&&(x0=xi=data[i],y0=yi=data[i+1]),cmd){case CMD$2.M:xi=x0=data[i++],yi=y0=data[i++],min2[0]=x0,min2[1]=y0,max2[0]=x0,max2[1]=y0;break;case CMD$2.L:fromLine(xi,yi,data[i],data[i+1],min2,max2),xi=data[i++],yi=data[i++];break;case CMD$2.C:fromCubic(xi,yi,data[i++],data[i++],data[i++],data[i++],data[i],data[i+1],min2,max2),xi=data[i++],yi=data[i++];break;case CMD$2.Q:fromQuadratic(xi,yi,data[i++],data[i++],data[i],data[i+1],min2,max2),xi=data[i++],yi=data[i++];break;case CMD$2.A:var cx=data[i++],cy=data[i++],rx=data[i++],ry=data[i++],startAngle=data[i++],endAngle=data[i++]+startAngle;i+=1;var anticlockwise=!data[i++];isFirst&&(x0=mathCos$3(startAngle)*rx+cx,y0=mathSin$3(startAngle)*ry+cy),fromArc(cx,cy,rx,ry,startAngle,endAngle,anticlockwise,min2,max2),xi=mathCos$3(endAngle)*rx+cx,yi=mathSin$3(endAngle)*ry+cy;break;case CMD$2.R:fromLine(x0=xi=data[i++],y0=yi=data[i++],x0+data[i++],y0+data[i++],min2,max2);break;case CMD$2.Z:xi=x0,yi=y0}min$1(min,min,min2),max$1(max,max,max2)}return 0===i&&(min[0]=min[1]=max[0]=max[1]=0),new BoundingRect(min[0],min[1],max[0]-min[0],max[1]-min[1])},PathProxy2.prototype._calculateLength=function(){var data=this.data,len2=this._len,ux=this._ux,uy=this._uy,xi=0,yi=0,x0=0,y0=0;this._pathSegLen||(this._pathSegLen=[]);for(var pathSegLen=this._pathSegLen,pathTotalLen=0,segCount=0,i=0;i<len2;){var cmd=data[i++],isFirst=1===i;isFirst&&(x0=xi=data[i],y0=yi=data[i+1]);var l=-1;switch(cmd){case CMD$2.M:xi=x0=data[i++],yi=y0=data[i++];break;case CMD$2.L:var x2=data[i++],dy=(y2=data[i++])-yi;(mathAbs$1(dx=x2-xi)>ux||mathAbs$1(dy)>uy||i===len2-1)&&(l=Math.sqrt(dx*dx+dy*dy),xi=x2,yi=y2);break;case CMD$2.C:var x1=data[i++],y1=data[i++],y2=(x2=data[i++],data[i++]),x3=data[i++],y3=data[i++];l=cubicLength(xi,yi,x1,y1,x2,y2,x3,y3,10),xi=x3,yi=y3;break;case CMD$2.Q:l=quadraticLength(xi,yi,x1=data[i++],y1=data[i++],x2=data[i++],y2=data[i++],10),xi=x2,yi=y2;break;case CMD$2.A:var cx=data[i++],cy=data[i++],rx=data[i++],ry=data[i++],startAngle=data[i++],delta=data[i++],endAngle=delta+startAngle;i+=1,isFirst&&(x0=mathCos$3(startAngle)*rx+cx,y0=mathSin$3(startAngle)*ry+cy),l=mathMax$7(rx,ry)*mathMin$7(PI2$6,Math.abs(delta)),xi=mathCos$3(endAngle)*rx+cx,yi=mathSin$3(endAngle)*ry+cy;break;case CMD$2.R:x0=xi=data[i++],y0=yi=data[i++],l=2*data[i++]+2*data[i++];break;case CMD$2.Z:var dx=x0-xi;dy=y0-yi;l=Math.sqrt(dx*dx+dy*dy),xi=x0,yi=y0}l>=0&&(pathSegLen[segCount++]=l,pathTotalLen+=l)}return this._pathLen=pathTotalLen,pathTotalLen},PathProxy2.prototype.rebuildPath=function(ctx,percent){var x0,y0,xi,yi,x,y,pathSegLen,displayedLength,pendingPtX,pendingPtY,d=this.data,ux=this._ux,uy=this._uy,len2=this._len,drawPart=percent<1,accumLength=0,segCount=0,pendingPtDist=0;if(!drawPart||(this._pathSegLen||this._calculateLength(),pathSegLen=this._pathSegLen,displayedLength=percent*this._pathLen))lo:for(var i=0;i<len2;){var cmd=d[i++],isFirst=1===i;switch(isFirst&&(x0=xi=d[i],y0=yi=d[i+1]),cmd!==CMD$2.L&&pendingPtDist>0&&(ctx.lineTo(pendingPtX,pendingPtY),pendingPtDist=0),cmd){case CMD$2.M:x0=xi=d[i++],y0=yi=d[i++],ctx.moveTo(xi,yi);break;case CMD$2.L:x=d[i++],y=d[i++];var dx=mathAbs$1(x-xi),dy=mathAbs$1(y-yi);if(dx>ux||dy>uy){if(drawPart){if(accumLength+(l=pathSegLen[segCount++])>displayedLength){var t=(displayedLength-accumLength)/l;ctx.lineTo(xi*(1-t)+x*t,yi*(1-t)+y*t);break lo}accumLength+=l}ctx.lineTo(x,y),xi=x,yi=y,pendingPtDist=0}else{var d2=dx*dx+dy*dy;d2>pendingPtDist&&(pendingPtX=x,pendingPtY=y,pendingPtDist=d2)}break;case CMD$2.C:var x1=d[i++],y1=d[i++],x2=d[i++],y2=d[i++],x3=d[i++],y3=d[i++];if(drawPart){if(accumLength+(l=pathSegLen[segCount++])>displayedLength){cubicSubdivide(xi,x1,x2,x3,t=(displayedLength-accumLength)/l,tmpOutX),cubicSubdivide(yi,y1,y2,y3,t,tmpOutY),ctx.bezierCurveTo(tmpOutX[1],tmpOutY[1],tmpOutX[2],tmpOutY[2],tmpOutX[3],tmpOutY[3]);break lo}accumLength+=l}ctx.bezierCurveTo(x1,y1,x2,y2,x3,y3),xi=x3,yi=y3;break;case CMD$2.Q:x1=d[i++],y1=d[i++],x2=d[i++],y2=d[i++];if(drawPart){if(accumLength+(l=pathSegLen[segCount++])>displayedLength){quadraticSubdivide(xi,x1,x2,t=(displayedLength-accumLength)/l,tmpOutX),quadraticSubdivide(yi,y1,y2,t,tmpOutY),ctx.quadraticCurveTo(tmpOutX[1],tmpOutY[1],tmpOutX[2],tmpOutY[2]);break lo}accumLength+=l}ctx.quadraticCurveTo(x1,y1,x2,y2),xi=x2,yi=y2;break;case CMD$2.A:var cx=d[i++],cy=d[i++],rx=d[i++],ry=d[i++],startAngle=d[i++],delta=d[i++],psi=d[i++],anticlockwise=!d[i++],r=rx>ry?rx:ry,isEllipse=mathAbs$1(rx-ry)>.001,endAngle=startAngle+delta,breakBuild=!1;if(drawPart)accumLength+(l=pathSegLen[segCount++])>displayedLength&&(endAngle=startAngle+delta*(displayedLength-accumLength)/l,breakBuild=!0),accumLength+=l;if(isEllipse&&ctx.ellipse?ctx.ellipse(cx,cy,rx,ry,psi,startAngle,endAngle,anticlockwise):ctx.arc(cx,cy,r,startAngle,endAngle,anticlockwise),breakBuild)break lo;isFirst&&(x0=mathCos$3(startAngle)*rx+cx,y0=mathSin$3(startAngle)*ry+cy),xi=mathCos$3(endAngle)*rx+cx,yi=mathSin$3(endAngle)*ry+cy;break;case CMD$2.R:x0=xi=d[i],y0=yi=d[i+1],x=d[i++],y=d[i++];var width=d[i++],height=d[i++];if(drawPart){if(accumLength+(l=pathSegLen[segCount++])>displayedLength){var d_1=displayedLength-accumLength;ctx.moveTo(x,y),ctx.lineTo(x+mathMin$7(d_1,width),y),(d_1-=width)>0&&ctx.lineTo(x+width,y+mathMin$7(d_1,height)),(d_1-=height)>0&&ctx.lineTo(x+mathMax$7(width-d_1,0),y+height),(d_1-=width)>0&&ctx.lineTo(x,y+mathMax$7(height-d_1,0));break lo}accumLength+=l}ctx.rect(x,y,width,height);break;case CMD$2.Z:if(drawPart){var l;if(accumLength+(l=pathSegLen[segCount++])>displayedLength){t=(displayedLength-accumLength)/l;ctx.lineTo(xi*(1-t)+x0*t,yi*(1-t)+y0*t);break lo}accumLength+=l}ctx.closePath(),xi=x0,yi=y0}}},PathProxy2.prototype.clone=function(){var newProxy=new PathProxy2,data=this.data;return newProxy.data=data.slice?data.slice():Array.prototype.slice.call(data),newProxy._len=this._len,newProxy},PathProxy2.CMD=CMD$2,PathProxy2.initDefaultProps=((proto2=PathProxy2.prototype)._saveData=!0,proto2._ux=0,proto2._uy=0,proto2._pendingPtDist=0,void(proto2._version=0)),PathProxy2}();function containStroke$4(x0,y0,x1,y1,lineWidth,x,y){if(0===lineWidth)return!1;var _l=lineWidth,_a2=0;if(y>y0+_l&&y>y1+_l||y<y0-_l&&y<y1-_l||x>x0+_l&&x>x1+_l||x<x0-_l&&x<x1-_l)return!1;if(x0===x1)return Math.abs(x-x0)<=_l/2;var tmp=(_a2=(y0-y1)/(x0-x1))*x-y+(x0*y1-x1*y0)/(x0-x1);return tmp*tmp/(_a2*_a2+1)<=_l/2*_l/2}function containStroke$3(x0,y0,x1,y1,x2,y2,x3,y3,lineWidth,x,y){if(0===lineWidth)return!1;var _l=lineWidth;if(y>y0+_l&&y>y1+_l&&y>y2+_l&&y>y3+_l||y<y0-_l&&y<y1-_l&&y<y2-_l&&y<y3-_l||x>x0+_l&&x>x1+_l&&x>x2+_l&&x>x3+_l||x<x0-_l&&x<x1-_l&&x<x2-_l&&x<x3-_l)return!1;var d=function(x0,y0,x1,y1,x2,y2,x3,y3,x,y){var t,prev,next,d1,d2,interval=.005,d=Infinity;_v0[0]=x,_v0[1]=y;for(var _t=0;_t<1;_t+=.05)_v1[0]=cubicAt(x0,x1,x2,x3,_t),_v1[1]=cubicAt(y0,y1,y2,y3,_t),(d1=distSquare(_v0,_v1))<d&&(t=_t,d=d1);d=Infinity;for(var i=0;i<32&&!(interval<1e-4);i++)prev=t-interval,next=t+interval,_v1[0]=cubicAt(x0,x1,x2,x3,prev),_v1[1]=cubicAt(y0,y1,y2,y3,prev),d1=distSquare(_v1,_v0),prev>=0&&d1<d?(t=prev,d=d1):(_v2[0]=cubicAt(x0,x1,x2,x3,next),_v2[1]=cubicAt(y0,y1,y2,y3,next),d2=distSquare(_v2,_v0),next<=1&&d2<d?(t=next,d=d2):interval*=.5);return mathSqrt$3(d)}(x0,y0,x1,y1,x2,y2,x3,y3,x,y);return d<=_l/2}function containStroke$2(x0,y0,x1,y1,x2,y2,lineWidth,x,y){if(0===lineWidth)return!1;var _l=lineWidth;if(y>y0+_l&&y>y1+_l&&y>y2+_l||y<y0-_l&&y<y1-_l&&y<y2-_l||x>x0+_l&&x>x1+_l&&x>x2+_l||x<x0-_l&&x<x1-_l&&x<x2-_l)return!1;var d=function(x0,y0,x1,y1,x2,y2,x,y){var t,interval=.005,d=Infinity;_v0[0]=x,_v0[1]=y;for(var _t=0;_t<1;_t+=.05)_v1[0]=quadraticAt(x0,x1,x2,_t),_v1[1]=quadraticAt(y0,y1,y2,_t),(d1=distSquare(_v0,_v1))<d&&(t=_t,d=d1);d=Infinity;for(var i=0;i<32&&!(interval<1e-4);i++){var prev=t-interval,next=t+interval;_v1[0]=quadraticAt(x0,x1,x2,prev),_v1[1]=quadraticAt(y0,y1,y2,prev);var d1=distSquare(_v1,_v0);if(prev>=0&&d1<d)t=prev,d=d1;else{_v2[0]=quadraticAt(x0,x1,x2,next),_v2[1]=quadraticAt(y0,y1,y2,next);var d2=distSquare(_v2,_v0);next<=1&&d2<d?(t=next,d=d2):interval*=.5}}return mathSqrt$3(d)}(x0,y0,x1,y1,x2,y2,x,y);return d<=_l/2}var PI2$5=2*Math.PI;function normalizeRadian(angle){return(angle%=PI2$5)<0&&(angle+=PI2$5),angle}var PI2$4=2*Math.PI;function containStroke$1(cx,cy,r,startAngle,endAngle,anticlockwise,lineWidth,x,y){if(0===lineWidth)return!1;var _l=lineWidth;x-=cx,y-=cy;var d=Math.sqrt(x*x+y*y);if(d-_l>r||d+_l<r)return!1;if(Math.abs(startAngle-endAngle)%PI2$4<1e-4)return!0;if(anticlockwise){var tmp=startAngle;startAngle=normalizeRadian(endAngle),endAngle=normalizeRadian(tmp)}else startAngle=normalizeRadian(startAngle),endAngle=normalizeRadian(endAngle);startAngle>endAngle&&(endAngle+=PI2$4);var angle=Math.atan2(y,x);return angle<0&&(angle+=PI2$4),angle>=startAngle&&angle<=endAngle||angle+PI2$4>=startAngle&&angle+PI2$4<=endAngle}function windingLine(x0,y0,x1,y1,x,y){if(y>y0&&y>y1||y<y0&&y<y1)return 0;if(y1===y0)return 0;var t=(y-y0)/(y1-y0),dir3=y1<y0?1:-1;1!==t&&0!==t||(dir3=y1<y0?.5:-.5);var x_=t*(x1-x0)+x0;return x_===x?Infinity:x_>x?dir3:0}var CMD$1=PathProxy.CMD,PI2$3=2*Math.PI;var roots=[-1,-1,-1],extrema=[-1,-1];function windingCubic(x0,y0,x1,y1,x2,y2,x3,y3,x,y){if(y>y0&&y>y1&&y>y2&&y>y3||y<y0&&y<y1&&y<y2&&y<y3)return 0;var tmp,nRoots=cubicRootAt(y0,y1,y2,y3,y,roots);if(0===nRoots)return 0;for(var w=0,nExtrema=-1,y0_=void 0,y1_=void 0,i=0;i<nRoots;i++){var t=roots[i],unit=0===t||1===t?.5:1;cubicAt(x0,x1,x2,x3,t)<x||(nExtrema<0&&(nExtrema=cubicExtrema(y0,y1,y2,y3,extrema),extrema[1]<extrema[0]&&nExtrema>1&&(tmp=void 0,tmp=extrema[0],extrema[0]=extrema[1],extrema[1]=tmp),y0_=cubicAt(y0,y1,y2,y3,extrema[0]),nExtrema>1&&(y1_=cubicAt(y0,y1,y2,y3,extrema[1]))),2===nExtrema?t<extrema[0]?w+=y0_<y0?unit:-unit:t<extrema[1]?w+=y1_<y0_?unit:-unit:w+=y3<y1_?unit:-unit:t<extrema[0]?w+=y0_<y0?unit:-unit:w+=y3<y0_?unit:-unit)}return w}function windingQuadratic(x0,y0,x1,y1,x2,y2,x,y){if(y>y0&&y>y1&&y>y2||y<y0&&y<y1&&y<y2)return 0;var nRoots=function(p0,p1,p2,val,roots2){var a=p0-2*p1+p2,b=2*(p1-p0),c=p0-val,n=0;if(isAroundZero$1(a))isNotAroundZero$1(b)&&(t1=-c/b)>=0&&t1<=1&&(roots2[n++]=t1);else{var disc=b*b-4*a*c;if(isAroundZero$1(disc))(t1=-b/(2*a))>=0&&t1<=1&&(roots2[n++]=t1);else if(disc>0){var t1,discSqrt=mathSqrt$3(disc),t2=(-b-discSqrt)/(2*a);(t1=(-b+discSqrt)/(2*a))>=0&&t1<=1&&(roots2[n++]=t1),t2>=0&&t2<=1&&(roots2[n++]=t2)}}return n}(y0,y1,y2,y,roots);if(0===nRoots)return 0;var t=quadraticExtremum(y0,y1,y2);if(t>=0&&t<=1){for(var w=0,y_=quadraticAt(y0,y1,y2,t),i=0;i<nRoots;i++){var unit=0===roots[i]||1===roots[i]?.5:1;quadraticAt(x0,x1,x2,roots[i])<x||(roots[i]<t?w+=y_<y0?unit:-unit:w+=y2<y_?unit:-unit)}return w}unit=0===roots[0]||1===roots[0]?.5:1;return quadraticAt(x0,x1,x2,roots[0])<x?0:y2<y0?unit:-unit}function windingArc(cx,cy,r,startAngle,endAngle,anticlockwise,x,y){if((y-=cy)>r||y<-r)return 0;var tmp=Math.sqrt(r*r-y*y);roots[0]=-tmp,roots[1]=tmp;var dTheta=Math.abs(startAngle-endAngle);if(dTheta<1e-4)return 0;if(dTheta>=PI2$3-1e-4){startAngle=0,endAngle=PI2$3;var dir3=anticlockwise?1:-1;return x>=roots[0]+cx&&x<=roots[1]+cx?dir3:0}if(startAngle>endAngle){var tmp_1=startAngle;startAngle=endAngle,endAngle=tmp_1}startAngle<0&&(startAngle+=PI2$3,endAngle+=PI2$3);for(var w=0,i=0;i<2;i++){var x_=roots[i];if(x_+cx>x){var angle=Math.atan2(y,x_);dir3=anticlockwise?1:-1;angle<0&&(angle=PI2$3+angle),(angle>=startAngle&&angle<=endAngle||angle+PI2$3>=startAngle&&angle+PI2$3<=endAngle)&&(angle>Math.PI/2&&angle<1.5*Math.PI&&(dir3=-dir3),w+=dir3)}}return w}function containPath(path,lineWidth,isStroke,x,y){for(var x1,y1,a,b,data=path.data,len2=path.len(),w=0,xi=0,yi=0,x0=0,y0=0,i=0;i<len2;){var cmd=data[i++],isFirst=1===i;switch(cmd===CMD$1.M&&i>1&&(isStroke||(w+=windingLine(xi,yi,x0,y0,x,y))),isFirst&&(x0=xi=data[i],y0=yi=data[i+1]),cmd){case CMD$1.M:xi=x0=data[i++],yi=y0=data[i++];break;case CMD$1.L:if(isStroke){if(containStroke$4(xi,yi,data[i],data[i+1],lineWidth,x,y))return!0}else w+=windingLine(xi,yi,data[i],data[i+1],x,y)||0;xi=data[i++],yi=data[i++];break;case CMD$1.C:if(isStroke){if(containStroke$3(xi,yi,data[i++],data[i++],data[i++],data[i++],data[i],data[i+1],lineWidth,x,y))return!0}else w+=windingCubic(xi,yi,data[i++],data[i++],data[i++],data[i++],data[i],data[i+1],x,y)||0;xi=data[i++],yi=data[i++];break;case CMD$1.Q:if(isStroke){if(containStroke$2(xi,yi,data[i++],data[i++],data[i],data[i+1],lineWidth,x,y))return!0}else w+=windingQuadratic(xi,yi,data[i++],data[i++],data[i],data[i+1],x,y)||0;xi=data[i++],yi=data[i++];break;case CMD$1.A:var cx=data[i++],cy=data[i++],rx=data[i++],ry=data[i++],theta=data[i++],dTheta=data[i++];i+=1;var anticlockwise=!!(1-data[i++]);x1=Math.cos(theta)*rx+cx,y1=Math.sin(theta)*ry+cy,isFirst?(x0=x1,y0=y1):w+=windingLine(xi,yi,x1,y1,x,y);var _x=(x-cx)*ry/rx+cx;if(isStroke){if(containStroke$1(cx,cy,ry,theta,theta+dTheta,anticlockwise,lineWidth,_x,y))return!0}else w+=windingArc(cx,cy,ry,theta,theta+dTheta,anticlockwise,_x,y);xi=Math.cos(theta+dTheta)*rx+cx,yi=Math.sin(theta+dTheta)*ry+cy;break;case CMD$1.R:if(x0=xi=data[i++],y0=yi=data[i++],x1=x0+data[i++],y1=y0+data[i++],isStroke){if(containStroke$4(x0,y0,x1,y0,lineWidth,x,y)||containStroke$4(x1,y0,x1,y1,lineWidth,x,y)||containStroke$4(x1,y1,x0,y1,lineWidth,x,y)||containStroke$4(x0,y1,x0,y0,lineWidth,x,y))return!0}else w+=windingLine(x1,y0,x1,y1,x,y),w+=windingLine(x0,y1,x0,y0,x,y);break;case CMD$1.Z:if(isStroke){if(containStroke$4(xi,yi,x0,y0,lineWidth,x,y))return!0}else w+=windingLine(xi,yi,x0,y0,x,y);xi=x0,yi=y0}}return isStroke||(a=yi,b=y0,Math.abs(a-b)<1e-4)||(w+=windingLine(xi,yi,x0,y0,x,y)||0),0!==w}var DEFAULT_PATH_STYLE=defaults({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},DEFAULT_COMMON_STYLE),DEFAULT_PATH_ANIMATION_PROPS={style:defaults({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)},pathCopyParams=TRANSFORMABLE_PROPS.concat(["invisible","culling","z","z2","zlevel","parent"]),Path=function(_super){function Path2(opts){return _super.call(this,opts)||this}var pathProto;return __extends(Path2,_super),Path2.prototype.update=function(){var _this=this;_super.prototype.update.call(this);var style=this.style;if(style.decal){var decalEl=this._decalEl=this._decalEl||new Path2;decalEl.buildPath===Path2.prototype.buildPath&&(decalEl.buildPath=function(ctx){_this.buildPath(ctx,_this.shape)}),decalEl.silent=!0;var decalElStyle=decalEl.style;for(var key in style)decalElStyle[key]!==style[key]&&(decalElStyle[key]=style[key]);decalElStyle.fill=style.fill?style.decal:null,decalElStyle.decal=null,decalElStyle.shadowColor=null,style.strokeFirst&&(decalElStyle.stroke=null);for(var i=0;i<pathCopyParams.length;++i)decalEl[pathCopyParams[i]]=this[pathCopyParams[i]];decalEl.__dirty|=1}else this._decalEl&&(this._decalEl=null)},Path2.prototype.getDecalElement=function(){return this._decalEl},Path2.prototype._init=function(props){var keysArr=keys(props);this.shape=this.getDefaultShape();var defaultStyle=this.getDefaultStyle();defaultStyle&&this.useStyle(defaultStyle);for(var i=0;i<keysArr.length;i++){var key=keysArr[i],value=props[key];"style"===key?this.style?extend(this.style,value):this.useStyle(value):"shape"===key?extend(this.shape,value):_super.prototype.attrKV.call(this,key,value)}this.style||this.useStyle({})},Path2.prototype.getDefaultStyle=function(){return null},Path2.prototype.getDefaultShape=function(){return{}},Path2.prototype.canBeInsideText=function(){return this.hasFill()},Path2.prototype.getInsideTextFill=function(){var pathFill=this.style.fill;if("none"!==pathFill){if(isString(pathFill)){var fillLum=lum(pathFill,0);return fillLum>.5?"#333":fillLum>.2?"#eee":"#ccc"}if(pathFill)return"#ccc"}return"#333"},Path2.prototype.getInsideTextStroke=function(textFill){var pathFill=this.style.fill;if(isString(pathFill)){var zr=this.__zr;if(!(!zr||!zr.isDarkMode())===lum(textFill,0)<.4)return pathFill}},Path2.prototype.buildPath=function(ctx,shapeCfg,inBatch){},Path2.prototype.pathUpdated=function(){this.__dirty&=-5},Path2.prototype.getUpdatedPathProxy=function(inBatch){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,inBatch),this.path},Path2.prototype.createPathProxy=function(){this.path=new PathProxy(!1)},Path2.prototype.hasStroke=function(){var style=this.style,stroke=style.stroke;return!(null==stroke||"none"===stroke||!(style.lineWidth>0))},Path2.prototype.hasFill=function(){var fill=this.style.fill;return null!=fill&&"none"!==fill},Path2.prototype.getBoundingRect=function(){var rect=this._rect,style=this.style,needsUpdateRect=!rect;if(needsUpdateRect){var firstInvoke=!1;this.path||(firstInvoke=!0,this.createPathProxy());var path=this.path;(firstInvoke||4&this.__dirty)&&(path.beginPath(),this.buildPath(path,this.shape,!1),this.pathUpdated()),rect=path.getBoundingRect()}if(this._rect=rect,this.hasStroke()&&this.path&&this.path.len()>0){var rectStroke=this._rectStroke||(this._rectStroke=rect.clone());if(this.__dirty||needsUpdateRect){rectStroke.copy(rect);var lineScale=style.strokeNoScale?this.getLineScale():1,w=style.lineWidth;if(!this.hasFill()){var strokeContainThreshold=this.strokeContainThreshold;w=Math.max(w,null==strokeContainThreshold?4:strokeContainThreshold)}lineScale>1e-10&&(rectStroke.width+=w/lineScale,rectStroke.height+=w/lineScale,rectStroke.x-=w/lineScale/2,rectStroke.y-=w/lineScale/2)}return rectStroke}return rect},Path2.prototype.contain=function(x,y){var localPos=this.transformCoordToLocal(x,y),rect=this.getBoundingRect(),style=this.style;if(x=localPos[0],y=localPos[1],rect.contain(x,y)){var pathProxy=this.path;if(this.hasStroke()){var lineWidth=style.lineWidth,lineScale=style.strokeNoScale?this.getLineScale():1;if(lineScale>1e-10&&(this.hasFill()||(lineWidth=Math.max(lineWidth,this.strokeContainThreshold)),function(pathProxy,lineWidth,x,y){return containPath(pathProxy,lineWidth,!0,x,y)}(pathProxy,lineWidth/lineScale,x,y)))return!0}if(this.hasFill())return function(pathProxy,x,y){return containPath(pathProxy,0,!1,x,y)}(pathProxy,x,y)}return!1},Path2.prototype.dirtyShape=function(){this.__dirty|=4,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},Path2.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},Path2.prototype.animateShape=function(loop){return this.animate("shape",loop)},Path2.prototype.updateDuringAnimation=function(targetKey){"style"===targetKey?this.dirtyStyle():"shape"===targetKey?this.dirtyShape():this.markRedraw()},Path2.prototype.attrKV=function(key,value){"shape"===key?this.setShape(value):_super.prototype.attrKV.call(this,key,value)},Path2.prototype.setShape=function(keyOrObj,value){var shape=this.shape;return shape||(shape=this.shape={}),"string"==typeof keyOrObj?shape[keyOrObj]=value:extend(shape,keyOrObj),this.dirtyShape(),this},Path2.prototype.shapeChanged=function(){return!!(4&this.__dirty)},Path2.prototype.createStyle=function(obj){return createObject(DEFAULT_PATH_STYLE,obj)},Path2.prototype._innerSaveToNormal=function(toState){_super.prototype._innerSaveToNormal.call(this,toState);var normalState=this._normalState;toState.shape&&!normalState.shape&&(normalState.shape=extend({},this.shape))},Path2.prototype._applyStateObj=function(stateName,state,normalState,keepCurrentStates,transition,animationCfg){_super.prototype._applyStateObj.call(this,stateName,state,normalState,keepCurrentStates,transition,animationCfg);var targetShape,needsRestoreToNormal=!(state&&keepCurrentStates);if(state&&state.shape?transition?keepCurrentStates?targetShape=state.shape:(targetShape=extend({},normalState.shape),extend(targetShape,state.shape)):(targetShape=extend({},keepCurrentStates?this.shape:normalState.shape),extend(targetShape,state.shape)):needsRestoreToNormal&&(targetShape=normalState.shape),targetShape)if(transition){this.shape=extend({},this.shape);for(var targetShapePrimaryProps={},shapeKeys=keys(targetShape),i=0;i<shapeKeys.length;i++){var key=shapeKeys[i];"object"==typeof targetShape[key]?this.shape[key]=targetShape[key]:targetShapePrimaryProps[key]=targetShape[key]}this._transitionState(stateName,{shape:targetShapePrimaryProps},animationCfg)}else this.shape=targetShape,this.dirtyShape()},Path2.prototype._mergeStates=function(states){for(var mergedShape,mergedState=_super.prototype._mergeStates.call(this,states),i=0;i<states.length;i++){var state=states[i];state.shape&&(mergedShape=mergedShape||{},this._mergeStyle(mergedShape,state.shape))}return mergedShape&&(mergedState.shape=mergedShape),mergedState},Path2.prototype.getAnimationStyleProps=function(){return DEFAULT_PATH_ANIMATION_PROPS},Path2.prototype.isZeroArea=function(){return!1},Path2.extend=function(defaultProps){var Sub=function(_super2){function Sub2(opts){var _this=_super2.call(this,opts)||this;return defaultProps.init&&defaultProps.init.call(_this,opts),_this}return __extends(Sub2,_super2),Sub2.prototype.getDefaultStyle=function(){return clone$3(defaultProps.style)},Sub2.prototype.getDefaultShape=function(){return clone$3(defaultProps.shape)},Sub2}(Path2);for(var key in defaultProps)"function"==typeof defaultProps[key]&&(Sub.prototype[key]=defaultProps[key]);return Sub},Path2.initDefaultProps=((pathProto=Path2.prototype).type="path",pathProto.strokeContainThreshold=5,pathProto.segmentIgnoreThreshold=0,pathProto.subPixelOptimize=!1,pathProto.autoBatch=!1,void(pathProto.__dirty=7)),Path2}(Displayable),DEFAULT_TSPAN_STYLE=defaults({strokeFirst:!0,font:DEFAULT_FONT,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},DEFAULT_PATH_STYLE),TSpan=function(_super){function TSpan2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(TSpan2,_super),TSpan2.prototype.hasStroke=function(){var style=this.style,stroke=style.stroke;return null!=stroke&&"none"!==stroke&&style.lineWidth>0},TSpan2.prototype.hasFill=function(){var fill=this.style.fill;return null!=fill&&"none"!==fill},TSpan2.prototype.createStyle=function(obj){return createObject(DEFAULT_TSPAN_STYLE,obj)},TSpan2.prototype.setBoundingRect=function(rect){this._rect=rect},TSpan2.prototype.getBoundingRect=function(){var style=this.style;if(!this._rect){var text=style.text;null!=text?text+="":text="";var rect=getBoundingRect(text,style.font,style.textAlign,style.textBaseline);if(rect.x+=style.x||0,rect.y+=style.y||0,this.hasStroke()){var w=style.lineWidth;rect.x-=w/2,rect.y-=w/2,rect.width+=w,rect.height+=w}this._rect=rect}return this._rect},TSpan2.initDefaultProps=void(TSpan2.prototype.dirtyRectTolerance=10),TSpan2}(Displayable);TSpan.prototype.type="tspan";var DEFAULT_IMAGE_STYLE=defaults({x:0,y:0},DEFAULT_COMMON_STYLE),DEFAULT_IMAGE_ANIMATION_PROPS={style:defaults({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)};var ZRImage=function(_super){function ZRImage2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ZRImage2,_super),ZRImage2.prototype.createStyle=function(obj){return createObject(DEFAULT_IMAGE_STYLE,obj)},ZRImage2.prototype._getSize=function(dim){var style=this.style,size=style[dim];if(null!=size)return size;var source,imageSource=(source=style.image)&&"string"!=typeof source&&source.width&&source.height?style.image:this.__image;if(!imageSource)return 0;var otherDim="width"===dim?"height":"width",otherDimSize=style[otherDim];return null==otherDimSize?imageSource[dim]:imageSource[dim]/imageSource[otherDim]*otherDimSize},ZRImage2.prototype.getWidth=function(){return this._getSize("width")},ZRImage2.prototype.getHeight=function(){return this._getSize("height")},ZRImage2.prototype.getAnimationStyleProps=function(){return DEFAULT_IMAGE_ANIMATION_PROPS},ZRImage2.prototype.getBoundingRect=function(){var style=this.style;return this._rect||(this._rect=new BoundingRect(style.x||0,style.y||0,this.getWidth(),this.getHeight())),this._rect},ZRImage2}(Displayable);ZRImage.prototype.type="image";var round$2=Math.round;function subPixelOptimizeLine$1(outputShape,inputShape,style){if(inputShape){var x1=inputShape.x1,x2=inputShape.x2,y1=inputShape.y1,y2=inputShape.y2;outputShape.x1=x1,outputShape.x2=x2,outputShape.y1=y1,outputShape.y2=y2;var lineWidth=style&&style.lineWidth;return lineWidth?(round$2(2*x1)===round$2(2*x2)&&(outputShape.x1=outputShape.x2=subPixelOptimize$1(x1,lineWidth,!0)),round$2(2*y1)===round$2(2*y2)&&(outputShape.y1=outputShape.y2=subPixelOptimize$1(y1,lineWidth,!0)),outputShape):outputShape}}function subPixelOptimizeRect$1(outputShape,inputShape,style){if(inputShape){var originX=inputShape.x,originY=inputShape.y,originWidth=inputShape.width,originHeight=inputShape.height;outputShape.x=originX,outputShape.y=originY,outputShape.width=originWidth,outputShape.height=originHeight;var lineWidth=style&&style.lineWidth;return lineWidth?(outputShape.x=subPixelOptimize$1(originX,lineWidth,!0),outputShape.y=subPixelOptimize$1(originY,lineWidth,!0),outputShape.width=Math.max(subPixelOptimize$1(originX+originWidth,lineWidth,!1)-outputShape.x,0===originWidth?0:1),outputShape.height=Math.max(subPixelOptimize$1(originY+originHeight,lineWidth,!1)-outputShape.y,0===originHeight?0:1),outputShape):outputShape}}function subPixelOptimize$1(position,lineWidth,positiveOrNegative){if(!lineWidth)return position;var doubledPosition=round$2(2*position);return(doubledPosition+round$2(lineWidth))%2==0?doubledPosition/2:(doubledPosition+(positiveOrNegative?1:-1))/2}var RectShape=function(){return function(){this.x=0,this.y=0,this.width=0,this.height=0}}(),subPixelOptimizeOutputShape$1={},Rect$1=function(_super){function Rect2(opts){return _super.call(this,opts)||this}return __extends(Rect2,_super),Rect2.prototype.getDefaultShape=function(){return new RectShape},Rect2.prototype.buildPath=function(ctx,shape){var x,y,width,height;if(this.subPixelOptimize){var optimizedShape=subPixelOptimizeRect$1(subPixelOptimizeOutputShape$1,shape,this.style);x=optimizedShape.x,y=optimizedShape.y,width=optimizedShape.width,height=optimizedShape.height,optimizedShape.r=shape.r,shape=optimizedShape}else x=shape.x,y=shape.y,width=shape.width,height=shape.height;shape.r?function(ctx,shape){var r1,r2,r3,r4,total,x=shape.x,y=shape.y,width=shape.width,height=shape.height,r=shape.r;width<0&&(x+=width,width=-width),height<0&&(y+=height,height=-height),"number"==typeof r?r1=r2=r3=r4=r:r instanceof Array?1===r.length?r1=r2=r3=r4=r[0]:2===r.length?(r1=r3=r[0],r2=r4=r[1]):3===r.length?(r1=r[0],r2=r4=r[1],r3=r[2]):(r1=r[0],r2=r[1],r3=r[2],r4=r[3]):r1=r2=r3=r4=0,r1+r2>width&&(r1*=width/(total=r1+r2),r2*=width/total),r3+r4>width&&(r3*=width/(total=r3+r4),r4*=width/total),r2+r3>height&&(r2*=height/(total=r2+r3),r3*=height/total),r1+r4>height&&(r1*=height/(total=r1+r4),r4*=height/total),ctx.moveTo(x+r1,y),ctx.lineTo(x+width-r2,y),0!==r2&&ctx.arc(x+width-r2,y+r2,r2,-Math.PI/2,0),ctx.lineTo(x+width,y+height-r3),0!==r3&&ctx.arc(x+width-r3,y+height-r3,r3,0,Math.PI/2),ctx.lineTo(x+r4,y+height),0!==r4&&ctx.arc(x+r4,y+height-r4,r4,Math.PI/2,Math.PI),ctx.lineTo(x,y+r1),0!==r1&&ctx.arc(x+r1,y+r1,r1,Math.PI,1.5*Math.PI)}(ctx,shape):ctx.rect(x,y,width,height)},Rect2.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},Rect2}(Path);Rect$1.prototype.type="rect";var DEFAULT_RICH_TEXT_COLOR={fill:"#000"},DEFAULT_TEXT_ANIMATION_PROPS={style:defaults({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)},ZRText=function(_super){function ZRText2(opts){var _this=_super.call(this)||this;return _this.type="text",_this._children=[],_this._defaultStyle=DEFAULT_RICH_TEXT_COLOR,_this.attr(opts),_this}return __extends(ZRText2,_super),ZRText2.prototype.childrenRef=function(){return this._children},ZRText2.prototype.update=function(){_super.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var i=0;i<this._children.length;i++){var child=this._children[i];child.zlevel=this.zlevel,child.z=this.z,child.z2=this.z2,child.culling=this.culling,child.cursor=this.cursor,child.invisible=this.invisible}},ZRText2.prototype.updateTransform=function(){var innerTransformable=this.innerTransformable;innerTransformable?(innerTransformable.updateTransform(),innerTransformable.transform&&(this.transform=innerTransformable.transform)):_super.prototype.updateTransform.call(this)},ZRText2.prototype.getLocalTransform=function(m2){var innerTransformable=this.innerTransformable;return innerTransformable?innerTransformable.getLocalTransform(m2):_super.prototype.getLocalTransform.call(this,m2)},ZRText2.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),_super.prototype.getComputedTransform.call(this)},ZRText2.prototype._updateSubTexts=function(){var style;this._childCursor=0,normalizeStyle(style=this.style),each$d(style.rich,normalizeStyle),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},ZRText2.prototype.addSelfToZr=function(zr){_super.prototype.addSelfToZr.call(this,zr);for(var i=0;i<this._children.length;i++)this._children[i].__zr=zr},ZRText2.prototype.removeSelfFromZr=function(zr){_super.prototype.removeSelfFromZr.call(this,zr);for(var i=0;i<this._children.length;i++)this._children[i].__zr=null},ZRText2.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var tmpRect2=new BoundingRect(0,0,0,0),children=this._children,tmpMat=[],rect=null,i=0;i<children.length;i++){var child=children[i],childRect=child.getBoundingRect(),transform=child.getLocalTransform(tmpMat);transform?(tmpRect2.copy(childRect),tmpRect2.applyTransform(transform),(rect=rect||tmpRect2.clone()).union(tmpRect2)):(rect=rect||childRect.clone()).union(childRect)}this._rect=rect||tmpRect2}return this._rect},ZRText2.prototype.setDefaultTextStyle=function(defaultTextStyle){this._defaultStyle=defaultTextStyle||DEFAULT_RICH_TEXT_COLOR},ZRText2.prototype.setTextContent=function(textContent){},ZRText2.prototype._mergeStyle=function(targetStyle,sourceStyle){if(!sourceStyle)return targetStyle;var sourceRich=sourceStyle.rich,targetRich=targetStyle.rich||sourceRich&&{};return extend(targetStyle,sourceStyle),sourceRich&&targetRich?(this._mergeRich(targetRich,sourceRich),targetStyle.rich=targetRich):targetRich&&(targetStyle.rich=targetRich),targetStyle},ZRText2.prototype._mergeRich=function(targetRich,sourceRich){for(var richNames=keys(sourceRich),i=0;i<richNames.length;i++){var richName=richNames[i];targetRich[richName]=targetRich[richName]||{},extend(targetRich[richName],sourceRich[richName])}},ZRText2.prototype.getAnimationStyleProps=function(){return DEFAULT_TEXT_ANIMATION_PROPS},ZRText2.prototype._getOrCreateChild=function(Ctor){var child=this._children[this._childCursor];return child&&child instanceof Ctor||(child=new Ctor),this._children[this._childCursor++]=child,child.__zr=this.__zr,child.parent=this,child},ZRText2.prototype._updatePlainTexts=function(){var style=this.style,textFont=style.font||DEFAULT_FONT,textPadding=style.padding,contentBlock=function(text,style){null!=text&&(text+="");var lines,overflow=style.overflow,padding=style.padding,font=style.font,truncate="truncate"===overflow,calculatedLineHeight=getLineHeight(font),lineHeight=retrieve2(style.lineHeight,calculatedLineHeight),bgColorDrawn=!!style.backgroundColor,truncateLineOverflow="truncate"===style.lineOverflow,isTruncated=!1,width=style.width,contentHeight=(lines=null==width||"break"!==overflow&&"breakAll"!==overflow?text?text.split("\n"):[]:text?wrapText(text,style.font,width,"breakAll"===overflow,0).lines:[]).length*lineHeight,height=retrieve2(style.height,contentHeight);if(contentHeight>height&&truncateLineOverflow){var lineCount=Math.floor(height/lineHeight);isTruncated=isTruncated||lines.length>lineCount,lines=lines.slice(0,lineCount)}if(text&&truncate&&null!=width)for(var options=prepareTruncateOptions(width,font,style.ellipsis,{minChar:style.truncateMinChar,placeholder:style.placeholder}),singleOut={},i=0;i<lines.length;i++)truncateSingleLine(singleOut,lines[i],options),lines[i]=singleOut.textLine,isTruncated=isTruncated||singleOut.isTruncated;var outerHeight=height,contentWidth=0;for(i=0;i<lines.length;i++)contentWidth=Math.max(getWidth(lines[i],font),contentWidth);null==width&&(width=contentWidth);var outerWidth=contentWidth;return padding&&(outerHeight+=padding[0]+padding[2],outerWidth+=padding[1]+padding[3],width+=padding[1]+padding[3]),bgColorDrawn&&(outerWidth=width),{lines:lines,height:height,outerWidth:outerWidth,outerHeight:outerHeight,lineHeight:lineHeight,calculatedLineHeight:calculatedLineHeight,contentWidth:contentWidth,contentHeight:contentHeight,width:width,isTruncated:isTruncated}}(getStyleText(style),style),needDrawBg=needDrawBackground(style),bgColorDrawn=!!style.backgroundColor,outerHeight=contentBlock.outerHeight,outerWidth=contentBlock.outerWidth,contentWidth=contentBlock.contentWidth,textLines=contentBlock.lines,lineHeight=contentBlock.lineHeight,defaultStyle=this._defaultStyle;this.isTruncated=!!contentBlock.isTruncated;var baseX=style.x||0,baseY=style.y||0,textAlign=style.align||defaultStyle.align||"left",verticalAlign=style.verticalAlign||defaultStyle.verticalAlign||"top",textX=baseX,textY=adjustTextY(baseY,contentBlock.contentHeight,verticalAlign);if(needDrawBg||textPadding){var boxX=adjustTextX(baseX,outerWidth,textAlign),boxY=adjustTextY(baseY,outerHeight,verticalAlign);needDrawBg&&this._renderBackground(style,style,boxX,boxY,outerWidth,outerHeight)}textY+=lineHeight/2,textPadding&&(textX=getTextXForPadding(baseX,textAlign,textPadding),"top"===verticalAlign?textY+=textPadding[0]:"bottom"===verticalAlign&&(textY-=textPadding[2]));for(var defaultLineWidth=0,useDefaultFill=!1,textFill=(getFill("fill"in style?style.fill:(useDefaultFill=!0,defaultStyle.fill))),textStroke=(getStroke("stroke"in style?style.stroke:bgColorDrawn||defaultStyle.autoStroke&&!useDefaultFill?null:(defaultLineWidth=2,defaultStyle.stroke))),hasShadow2=style.textShadowBlur>0,fixedBoundingRect=null!=style.width&&("truncate"===style.overflow||"break"===style.overflow||"breakAll"===style.overflow),calculatedLineHeight=contentBlock.calculatedLineHeight,i=0;i<textLines.length;i++){var el=this._getOrCreateChild(TSpan),subElStyle=el.createStyle();el.useStyle(subElStyle),subElStyle.text=textLines[i],subElStyle.x=textX,subElStyle.y=textY,subElStyle.textAlign=textAlign,subElStyle.textBaseline="middle",subElStyle.opacity=style.opacity,subElStyle.strokeFirst=!0,hasShadow2&&(subElStyle.shadowBlur=style.textShadowBlur||0,subElStyle.shadowColor=style.textShadowColor||"transparent",subElStyle.shadowOffsetX=style.textShadowOffsetX||0,subElStyle.shadowOffsetY=style.textShadowOffsetY||0),subElStyle.stroke=textStroke,subElStyle.fill=textFill,textStroke&&(subElStyle.lineWidth=style.lineWidth||defaultLineWidth,subElStyle.lineDash=style.lineDash,subElStyle.lineDashOffset=style.lineDashOffset||0),subElStyle.font=textFont,setSeparateFont(subElStyle,style),textY+=lineHeight,fixedBoundingRect&&el.setBoundingRect(new BoundingRect(adjustTextX(subElStyle.x,contentWidth,subElStyle.textAlign),adjustTextY(subElStyle.y,calculatedLineHeight,subElStyle.textBaseline),contentWidth,calculatedLineHeight))}},ZRText2.prototype._updateRichTexts=function(){var style=this.style,contentBlock=function(text,style){var contentBlock=new RichTextContentBlock;if(null!=text&&(text+=""),!text)return contentBlock;for(var result,topWidth=style.width,topHeight=style.height,overflow=style.overflow,wrapInfo="break"!==overflow&&"breakAll"!==overflow||null==topWidth?null:{width:topWidth,accumWidth:0,breakAll:"breakAll"===overflow},lastIndex=STYLE_REG.lastIndex=0;null!=(result=STYLE_REG.exec(text));){var matchedIndex=result.index;matchedIndex>lastIndex&&pushTokens(contentBlock,text.substring(lastIndex,matchedIndex),style,wrapInfo),pushTokens(contentBlock,result[2],style,wrapInfo,result[1]),lastIndex=STYLE_REG.lastIndex}lastIndex<text.length&&pushTokens(contentBlock,text.substring(lastIndex,text.length),style,wrapInfo);var pendingList=[],calculatedHeight=0,calculatedWidth=0,stlPadding=style.padding,truncate="truncate"===overflow,truncateLine="truncate"===style.lineOverflow,tmpTruncateOut={};function finishLine(line2,lineWidth2,lineHeight2){line2.width=lineWidth2,line2.lineHeight=lineHeight2,calculatedHeight+=lineHeight2,calculatedWidth=Math.max(calculatedWidth,lineWidth2)}outer:for(var i=0;i<contentBlock.lines.length;i++){for(var line=contentBlock.lines[i],lineHeight=0,lineWidth=0,j=0;j<line.tokens.length;j++){var tokenStyle=(token=line.tokens[j]).styleName&&style.rich[token.styleName]||{},textPadding=token.textPadding=tokenStyle.padding,paddingH=textPadding?textPadding[1]+textPadding[3]:0,font=token.font=tokenStyle.font||style.font;token.contentHeight=getLineHeight(font);var tokenHeight=retrieve2(tokenStyle.height,token.contentHeight);if(token.innerHeight=tokenHeight,textPadding&&(tokenHeight+=textPadding[0]+textPadding[2]),token.height=tokenHeight,token.lineHeight=retrieve3(tokenStyle.lineHeight,style.lineHeight,tokenHeight),token.align=tokenStyle&&tokenStyle.align||style.align,token.verticalAlign=tokenStyle&&tokenStyle.verticalAlign||"middle",truncateLine&&null!=topHeight&&calculatedHeight+token.lineHeight>topHeight){var originalLength=contentBlock.lines.length;j>0?(line.tokens=line.tokens.slice(0,j),finishLine(line,lineWidth,lineHeight),contentBlock.lines=contentBlock.lines.slice(0,i+1)):contentBlock.lines=contentBlock.lines.slice(0,i),contentBlock.isTruncated=contentBlock.isTruncated||contentBlock.lines.length<originalLength;break outer}var styleTokenWidth=tokenStyle.width,tokenWidthNotSpecified=null==styleTokenWidth||"auto"===styleTokenWidth;if("string"==typeof styleTokenWidth&&"%"===styleTokenWidth.charAt(styleTokenWidth.length-1))token.percentWidth=styleTokenWidth,pendingList.push(token),token.contentWidth=getWidth(token.text,font);else{if(tokenWidthNotSpecified){var textBackgroundColor=tokenStyle.backgroundColor,bgImg=textBackgroundColor&&textBackgroundColor.image;bgImg&&isImageReady(bgImg=findExistImage(bgImg))&&(token.width=Math.max(token.width,bgImg.width*tokenHeight/bgImg.height))}var remainTruncWidth=truncate&&null!=topWidth?topWidth-lineWidth:null;null!=remainTruncWidth&&remainTruncWidth<token.width?!tokenWidthNotSpecified||remainTruncWidth<paddingH?(token.text="",token.width=token.contentWidth=0):(truncateText2(tmpTruncateOut,token.text,remainTruncWidth-paddingH,font,style.ellipsis,{minChar:style.truncateMinChar}),token.text=tmpTruncateOut.text,contentBlock.isTruncated=contentBlock.isTruncated||tmpTruncateOut.isTruncated,token.width=token.contentWidth=getWidth(token.text,font)):token.contentWidth=getWidth(token.text,font)}token.width+=paddingH,lineWidth+=token.width,tokenStyle&&(lineHeight=Math.max(lineHeight,token.lineHeight))}finishLine(line,lineWidth,lineHeight)}for(contentBlock.outerWidth=contentBlock.width=retrieve2(topWidth,calculatedWidth),contentBlock.outerHeight=contentBlock.height=retrieve2(topHeight,calculatedHeight),contentBlock.contentHeight=calculatedHeight,contentBlock.contentWidth=calculatedWidth,stlPadding&&(contentBlock.outerWidth+=stlPadding[1]+stlPadding[3],contentBlock.outerHeight+=stlPadding[0]+stlPadding[2]),i=0;i<pendingList.length;i++){var token,percentWidth=(token=pendingList[i]).percentWidth;token.width=parseInt(percentWidth,10)/100*contentBlock.width}return contentBlock}(getStyleText(style),style),contentWidth=contentBlock.width,outerWidth=contentBlock.outerWidth,outerHeight=contentBlock.outerHeight,textPadding=style.padding,baseX=style.x||0,baseY=style.y||0,defaultStyle=this._defaultStyle,textAlign=style.align||defaultStyle.align,verticalAlign=style.verticalAlign||defaultStyle.verticalAlign;this.isTruncated=!!contentBlock.isTruncated;var boxX=adjustTextX(baseX,outerWidth,textAlign),boxY=adjustTextY(baseY,outerHeight,verticalAlign),xLeft=boxX,lineTop=boxY;textPadding&&(xLeft+=textPadding[3],lineTop+=textPadding[0]);var xRight=xLeft+contentWidth;needDrawBackground(style)&&this._renderBackground(style,style,boxX,boxY,outerWidth,outerHeight);for(var bgColorDrawn=!!style.backgroundColor,i=0;i<contentBlock.lines.length;i++){for(var line=contentBlock.lines[i],tokens=line.tokens,tokenCount=tokens.length,lineHeight=line.lineHeight,remainedWidth=line.width,leftIndex=0,lineXLeft=xLeft,lineXRight=xRight,rightIndex=tokenCount-1,token=void 0;leftIndex<tokenCount&&(!(token=tokens[leftIndex]).align||"left"===token.align);)this._placeToken(token,style,lineHeight,lineTop,lineXLeft,"left",bgColorDrawn),remainedWidth-=token.width,lineXLeft+=token.width,leftIndex++;for(;rightIndex>=0&&"right"===(token=tokens[rightIndex]).align;)this._placeToken(token,style,lineHeight,lineTop,lineXRight,"right",bgColorDrawn),remainedWidth-=token.width,lineXRight-=token.width,rightIndex--;for(lineXLeft+=(contentWidth-(lineXLeft-xLeft)-(xRight-lineXRight)-remainedWidth)/2;leftIndex<=rightIndex;)token=tokens[leftIndex],this._placeToken(token,style,lineHeight,lineTop,lineXLeft+token.width/2,"center",bgColorDrawn),lineXLeft+=token.width,leftIndex++;lineTop+=lineHeight}},ZRText2.prototype._placeToken=function(token,style,lineHeight,lineTop,x,textAlign,parentBgColorDrawn){var tokenStyle=style.rich[token.styleName]||{};tokenStyle.text=token.text;var verticalAlign=token.verticalAlign,y=lineTop+lineHeight/2;"top"===verticalAlign?y=lineTop+token.height/2:"bottom"===verticalAlign&&(y=lineTop+lineHeight-token.height/2),!token.isLineHolder&&needDrawBackground(tokenStyle)&&this._renderBackground(tokenStyle,style,"right"===textAlign?x-token.width:"center"===textAlign?x-token.width/2:x,y-token.height/2,token.width,token.height);var bgColorDrawn=!!tokenStyle.backgroundColor,textPadding=token.textPadding;textPadding&&(x=getTextXForPadding(x,textAlign,textPadding),y-=token.height/2-textPadding[0]-token.innerHeight/2);var el=this._getOrCreateChild(TSpan),subElStyle=el.createStyle();el.useStyle(subElStyle);var defaultStyle=this._defaultStyle,useDefaultFill=!1,defaultLineWidth=0,textFill=getFill("fill"in tokenStyle?tokenStyle.fill:"fill"in style?style.fill:(useDefaultFill=!0,defaultStyle.fill)),textStroke=getStroke("stroke"in tokenStyle?tokenStyle.stroke:"stroke"in style?style.stroke:bgColorDrawn||parentBgColorDrawn||defaultStyle.autoStroke&&!useDefaultFill?null:(defaultLineWidth=2,defaultStyle.stroke)),hasShadow2=tokenStyle.textShadowBlur>0||style.textShadowBlur>0;subElStyle.text=token.text,subElStyle.x=x,subElStyle.y=y,hasShadow2&&(subElStyle.shadowBlur=tokenStyle.textShadowBlur||style.textShadowBlur||0,subElStyle.shadowColor=tokenStyle.textShadowColor||style.textShadowColor||"transparent",subElStyle.shadowOffsetX=tokenStyle.textShadowOffsetX||style.textShadowOffsetX||0,subElStyle.shadowOffsetY=tokenStyle.textShadowOffsetY||style.textShadowOffsetY||0),subElStyle.textAlign=textAlign,subElStyle.textBaseline="middle",subElStyle.font=token.font||DEFAULT_FONT,subElStyle.opacity=retrieve3(tokenStyle.opacity,style.opacity,1),setSeparateFont(subElStyle,tokenStyle),textStroke&&(subElStyle.lineWidth=retrieve3(tokenStyle.lineWidth,style.lineWidth,defaultLineWidth),subElStyle.lineDash=retrieve2(tokenStyle.lineDash,style.lineDash),subElStyle.lineDashOffset=style.lineDashOffset||0,subElStyle.stroke=textStroke),textFill&&(subElStyle.fill=textFill);var textWidth=token.contentWidth,textHeight=token.contentHeight;el.setBoundingRect(new BoundingRect(adjustTextX(subElStyle.x,textWidth,subElStyle.textAlign),adjustTextY(subElStyle.y,textHeight,subElStyle.textBaseline),textWidth,textHeight))},ZRText2.prototype._renderBackground=function(style,topStyle,x,y,width,height){var rectEl,imgEl,rectStyle,textBackgroundColor=style.backgroundColor,textBorderWidth=style.borderWidth,textBorderColor=style.borderColor,isImageBg=textBackgroundColor&&textBackgroundColor.image,isPlainOrGradientBg=textBackgroundColor&&!isImageBg,textBorderRadius=style.borderRadius,self2=this;if(isPlainOrGradientBg||style.lineHeight||textBorderWidth&&textBorderColor){(rectEl=this._getOrCreateChild(Rect$1)).useStyle(rectEl.createStyle()),rectEl.style.fill=null;var rectShape=rectEl.shape;rectShape.x=x,rectShape.y=y,rectShape.width=width,rectShape.height=height,rectShape.r=textBorderRadius,rectEl.dirtyShape()}if(isPlainOrGradientBg)(rectStyle=rectEl.style).fill=textBackgroundColor||null,rectStyle.fillOpacity=retrieve2(style.fillOpacity,1);else if(isImageBg){(imgEl=this._getOrCreateChild(ZRImage)).onload=function(){self2.dirtyStyle()};var imgStyle=imgEl.style;imgStyle.image=textBackgroundColor.image,imgStyle.x=x,imgStyle.y=y,imgStyle.width=width,imgStyle.height=height}textBorderWidth&&textBorderColor&&((rectStyle=rectEl.style).lineWidth=textBorderWidth,rectStyle.stroke=textBorderColor,rectStyle.strokeOpacity=retrieve2(style.strokeOpacity,1),rectStyle.lineDash=style.borderDash,rectStyle.lineDashOffset=style.borderDashOffset||0,rectEl.strokeContainThreshold=0,rectEl.hasFill()&&rectEl.hasStroke()&&(rectStyle.strokeFirst=!0,rectStyle.lineWidth*=2));var commonStyle=(rectEl||imgEl).style;commonStyle.shadowBlur=style.shadowBlur||0,commonStyle.shadowColor=style.shadowColor||"transparent",commonStyle.shadowOffsetX=style.shadowOffsetX||0,commonStyle.shadowOffsetY=style.shadowOffsetY||0,commonStyle.opacity=retrieve3(style.opacity,topStyle.opacity,1)},ZRText2.makeFont=function(style){var font="";return hasSeparateFont(style)&&(font=[style.fontStyle,style.fontWeight,parseFontSize(style.fontSize),style.fontFamily||"sans-serif"].join(" ")),font&&trim$1(font)||style.textFont||style.font},ZRText2}(Displayable),VALID_TEXT_ALIGN={left:!0,right:1,center:1},VALID_TEXT_VERTICAL_ALIGN={top:1,bottom:1,middle:1},FONT_PARTS=["fontStyle","fontWeight","fontSize","fontFamily"];function parseFontSize(fontSize){return"string"!=typeof fontSize||-1===fontSize.indexOf("px")&&-1===fontSize.indexOf("rem")&&-1===fontSize.indexOf("em")?isNaN(+fontSize)?"12px":fontSize+"px":fontSize}function setSeparateFont(targetStyle,sourceStyle){for(var i=0;i<FONT_PARTS.length;i++){var fontProp=FONT_PARTS[i],val=sourceStyle[fontProp];null!=val&&(targetStyle[fontProp]=val)}}function hasSeparateFont(style){return null!=style.fontSize||style.fontFamily||style.fontWeight}function normalizeStyle(style){if(style){style.font=ZRText.makeFont(style);var textAlign=style.align;"middle"===textAlign&&(textAlign="center"),style.align=null==textAlign||VALID_TEXT_ALIGN[textAlign]?textAlign:"left";var verticalAlign=style.verticalAlign;"center"===verticalAlign&&(verticalAlign="middle"),style.verticalAlign=null==verticalAlign||VALID_TEXT_VERTICAL_ALIGN[verticalAlign]?verticalAlign:"top",style.padding&&(style.padding=normalizeCssArray$1(style.padding))}}function getStroke(stroke,lineWidth){return null==stroke||lineWidth<=0||"transparent"===stroke||"none"===stroke?null:stroke.image||stroke.colorStops?"#000":stroke}function getFill(fill){return null==fill||"none"===fill?null:fill.image||fill.colorStops?"#000":fill}function getTextXForPadding(x,textAlign,textPadding){return"right"===textAlign?x-textPadding[1]:"center"===textAlign?x+textPadding[3]/2-textPadding[1]/2:x+textPadding[3]}function getStyleText(style){var text=style.text;return null!=text&&(text+=""),text}function needDrawBackground(style){return!!(style.backgroundColor||style.lineHeight||style.borderWidth&&style.borderColor)}var getECData=makeInner(),_highlightNextDigit=1,_highlightKeyMap={},getSavedStates=makeInner(),getComponentStates=makeInner(),SPECIAL_STATES=["emphasis","blur","select"],DISPLAY_STATES=["normal","emphasis","blur","select"];function hasFillOrStroke(fillOrStroke){return null!=fillOrStroke&&"none"!==fillOrStroke}function doChangeHoverState(el,stateName,hoverStateEnum){el.onHoverStateChange&&(el.hoverState||0)!==hoverStateEnum&&el.onHoverStateChange(stateName),el.hoverState=hoverStateEnum}function singleEnterEmphasis(el){doChangeHoverState(el,"emphasis",2)}function singleLeaveEmphasis(el){2===el.hoverState&&doChangeHoverState(el,"normal",0)}function singleEnterBlur(el){doChangeHoverState(el,"blur",1)}function singleLeaveBlur(el){1===el.hoverState&&doChangeHoverState(el,"normal",0)}function singleEnterSelect(el){el.selected=!0}function singleLeaveSelect(el){el.selected=!1}function updateElementState(el,updater,commonParam){updater(el,commonParam)}function traverseUpdateState(el,updater,commonParam){updateElementState(el,updater,commonParam),el.isGroup&&el.traverse((function(child){updateElementState(child,updater,commonParam)}))}function setStatesFlag(el,stateName){switch(stateName){case"emphasis":el.hoverState=2;break;case"normal":el.hoverState=0;break;case"blur":el.hoverState=1;break;case"select":el.selected=!0}}function elementStateProxy(stateName,targetStates){var state=this.states[stateName];if(this.style){if("emphasis"===stateName)return function(el,stateName,targetStates,state){var hasSelect=targetStates&&indexOf(targetStates,"select")>=0,cloned=!1;if(el instanceof Path){var store=getSavedStates(el),fromFill=hasSelect&&store.selectFill||store.normalFill,fromStroke=hasSelect&&store.selectStroke||store.normalStroke;if(hasFillOrStroke(fromFill)||hasFillOrStroke(fromStroke)){var emphasisStyle=(state=state||{}).style||{};"inherit"===emphasisStyle.fill?(cloned=!0,state=extend({},state),(emphasisStyle=extend({},emphasisStyle)).fill=fromFill):!hasFillOrStroke(emphasisStyle.fill)&&hasFillOrStroke(fromFill)?(cloned=!0,state=extend({},state),(emphasisStyle=extend({},emphasisStyle)).fill=liftColor(fromFill)):!hasFillOrStroke(emphasisStyle.stroke)&&hasFillOrStroke(fromStroke)&&(cloned||(state=extend({},state),emphasisStyle=extend({},emphasisStyle)),emphasisStyle.stroke=liftColor(fromStroke)),state.style=emphasisStyle}}if(state&&null==state.z2){cloned||(state=extend({},state));var z2EmphasisLift=el.z2EmphasisLift;state.z2=el.z2+(null!=z2EmphasisLift?z2EmphasisLift:10)}return state}(this,0,targetStates,state);if("blur"===stateName)return function(el,stateName,state){var hasBlur=indexOf(el.currentStates,stateName)>=0,currentOpacity=el.style.opacity,fromState=hasBlur?null:function(el,props,toStateName,defaultValue){for(var style=el.style,fromState={},i=0;i<props.length;i++){var propName=props[i],val=style[propName];fromState[propName]=null==val?defaultValue[propName]:val}for(i=0;i<el.animators.length;i++){var animator=el.animators[i];animator.__fromStateTransition&&animator.__fromStateTransition.indexOf(toStateName)<0&&"style"===animator.targetName&&animator.saveTo(fromState,props)}return fromState}(el,["opacity"],stateName,{opacity:1}),blurStyle=(state=state||{}).style||{};return null==blurStyle.opacity&&(state=extend({},state),blurStyle=extend({opacity:hasBlur?currentOpacity:.1*fromState.opacity},blurStyle),state.style=blurStyle),state}(this,stateName,state);if("select"===stateName)return function(el,stateName,state){if(state&&null==state.z2){state=extend({},state);var z2SelectLift=el.z2SelectLift;state.z2=el.z2+(null!=z2SelectLift?z2SelectLift:9)}return state}(this,0,state)}return state}function setDefaultStateProxy(el){el.stateProxy=elementStateProxy;var textContent=el.getTextContent(),textGuide=el.getTextGuideLine();textContent&&(textContent.stateProxy=elementStateProxy),textGuide&&(textGuide.stateProxy=elementStateProxy)}function enterEmphasisWhenMouseOver(el,e2){!shouldSilent(el,e2)&&!el.__highByOuter&&traverseUpdateState(el,singleEnterEmphasis)}function leaveEmphasisWhenMouseOut(el,e2){!shouldSilent(el,e2)&&!el.__highByOuter&&traverseUpdateState(el,singleLeaveEmphasis)}function enterEmphasis(el,highlightDigit){el.__highByOuter|=1<<(highlightDigit||0),traverseUpdateState(el,singleEnterEmphasis)}function leaveEmphasis(el,highlightDigit){!(el.__highByOuter&=~(1<<(highlightDigit||0)))&&traverseUpdateState(el,singleLeaveEmphasis)}function leaveBlur(el){traverseUpdateState(el,singleLeaveBlur)}function enterSelect(el){traverseUpdateState(el,singleEnterSelect)}function leaveSelect(el){traverseUpdateState(el,singleLeaveSelect)}function shouldSilent(el,e2){return el.__highDownSilentOnTouch&&e2.zrByTouch}function allLeaveBlur(api){var model=api.getModel(),leaveBlurredSeries=[],allComponentViews=[];model.eachComponent((function(componentType,componentModel){var componentStates=getComponentStates(componentModel),isSeries2="series"===componentType,view=isSeries2?api.getViewOfSeriesModel(componentModel):api.getViewOfComponentModel(componentModel);!isSeries2&&allComponentViews.push(view),componentStates.isBlured&&(view.group.traverse((function(child){singleLeaveBlur(child)})),isSeries2&&leaveBlurredSeries.push(componentModel)),componentStates.isBlured=!1})),each$d(allComponentViews,(function(view){view&&view.toggleBlurSeries&&view.toggleBlurSeries(leaveBlurredSeries,!1,model)}))}function blurSeries(targetSeriesIndex,focus,blurScope,api){var ecModel=api.getModel();function leaveBlurOfIndices(data,dataIndices){for(var i=0;i<dataIndices.length;i++){var itemEl=data.getItemGraphicEl(dataIndices[i]);itemEl&&leaveBlur(itemEl)}}if(blurScope=blurScope||"coordinateSystem",null!=targetSeriesIndex&&focus&&"none"!==focus){var targetSeriesModel=ecModel.getSeriesByIndex(targetSeriesIndex),targetCoordSys=targetSeriesModel.coordinateSystem;targetCoordSys&&targetCoordSys.master&&(targetCoordSys=targetCoordSys.master);var blurredSeries=[];ecModel.eachSeries((function(seriesModel){var sameSeries=targetSeriesModel===seriesModel,coordSys=seriesModel.coordinateSystem;if(coordSys&&coordSys.master&&(coordSys=coordSys.master),!("series"===blurScope&&!sameSeries||"coordinateSystem"===blurScope&&!(coordSys&&targetCoordSys?coordSys===targetCoordSys:sameSeries)||"series"===focus&&sameSeries)){if(api.getViewOfSeriesModel(seriesModel).group.traverse((function(child){child.__highByOuter&&sameSeries&&"self"===focus||singleEnterBlur(child)})),isArrayLike(focus))leaveBlurOfIndices(seriesModel.getData(),focus);else if(isObject$3(focus))for(var dataTypes=keys(focus),d=0;d<dataTypes.length;d++)leaveBlurOfIndices(seriesModel.getData(dataTypes[d]),focus[dataTypes[d]]);blurredSeries.push(seriesModel),getComponentStates(seriesModel).isBlured=!0}})),ecModel.eachComponent((function(componentType,componentModel){if("series"!==componentType){var view=api.getViewOfComponentModel(componentModel);view&&view.toggleBlurSeries&&view.toggleBlurSeries(blurredSeries,!0,ecModel)}}))}}function blurComponent(componentMainType,componentIndex,api){if(null!=componentMainType&&null!=componentIndex){var componentModel=api.getModel().getComponent(componentMainType,componentIndex);if(componentModel){getComponentStates(componentModel).isBlured=!0;var view=api.getViewOfComponentModel(componentModel);view&&view.focusBlurEnabled&&view.group.traverse((function(child){singleEnterBlur(child)}))}}}function findComponentHighDownDispatchers(componentMainType,componentIndex,name,api){var ret={focusSelf:!1,dispatchers:null};if(null==componentMainType||"series"===componentMainType||null==componentIndex||null==name)return ret;var componentModel=api.getModel().getComponent(componentMainType,componentIndex);if(!componentModel)return ret;var view=api.getViewOfComponentModel(componentModel);if(!view||!view.findHighDownDispatchers)return ret;for(var focusSelf,dispatchers=view.findHighDownDispatchers(name),i=0;i<dispatchers.length;i++)if("self"===getECData(dispatchers[i]).focus){focusSelf=!0;break}return{focusSelf:focusSelf,dispatchers:dispatchers}}function updateSeriesElementSelection(seriesModel){each$d(seriesModel.getAllData(),(function(_a2){var data=_a2.data,type=_a2.type;data.eachItemGraphicEl((function(el,idx){seriesModel.isSelected(idx,type)?enterSelect(el):leaveSelect(el)}))}))}function getAllSelectedIndices(ecModel){var ret=[];return ecModel.eachSeries((function(seriesModel){each$d(seriesModel.getAllData(),(function(_a2){_a2.data;var type=_a2.type,dataIndices=seriesModel.getSelectedDataIndices();if(dataIndices.length>0){var item={dataIndex:dataIndices,seriesIndex:seriesModel.seriesIndex};null!=type&&(item.dataType=type),ret.push(item)}}))})),ret}function enableHoverEmphasis(el,focus,blurScope){setAsHighDownDispatcher(el,!0),traverseUpdateState(el,setDefaultStateProxy),function(el,focus,blurScope){var ecData=getECData(el);null!=focus?(ecData.focus=focus,ecData.blurScope=blurScope):ecData.focus&&(ecData.focus=null)}(el,focus,blurScope)}function toggleHoverEmphasis(el,focus,blurScope,isDisabled){isDisabled?function(el){setAsHighDownDispatcher(el,!1)}(el):enableHoverEmphasis(el,focus,blurScope)}var OTHER_STATES=["emphasis","blur","select"],defaultStyleGetterMap={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function setStatesStylesFromModel(el,itemModel,styleType,getter){styleType=styleType||"itemStyle";for(var i=0;i<OTHER_STATES.length;i++){var stateName=OTHER_STATES[i],model=itemModel.getModel([stateName,styleType]);el.ensureState(stateName).style=model[defaultStyleGetterMap[styleType]]()}}function setAsHighDownDispatcher(el,asDispatcher){var disable=!1===asDispatcher,extendedEl=el;el.highDownSilentOnTouch&&(extendedEl.__highDownSilentOnTouch=el.highDownSilentOnTouch),disable&&!extendedEl.__highDownDispatcher||(extendedEl.__highByOuter=extendedEl.__highByOuter||0,extendedEl.__highDownDispatcher=!disable)}function isHighDownDispatcher(el){return!(!el||!el.__highDownDispatcher)}function isSelectChangePayload(payload){var payloadType=payload.type;return"select"===payloadType||"unselect"===payloadType||"toggleSelect"===payloadType}function isHighDownPayload(payload){var payloadType=payload.type;return"highlight"===payloadType||"downplay"===payloadType}var CMD=PathProxy.CMD,points$2=[[],[],[]],mathSqrt$2=Math.sqrt,mathAtan2=Math.atan2;var mathSqrt$1=Math.sqrt,mathSin$2=Math.sin,mathCos$2=Math.cos,PI$6=Math.PI;function vMag(v){return Math.sqrt(v[0]*v[0]+v[1]*v[1])}function vRatio(u,v){return(u[0]*v[0]+u[1]*v[1])/(vMag(u)*vMag(v))}function vAngle(u,v){return(u[0]*v[1]<u[1]*v[0]?-1:1)*Math.acos(vRatio(u,v))}function processArc(x1,y1,x2,y2,fa,fs,rx,ry,psiDeg,cmd,path){var psi=psiDeg*(PI$6/180),xp=mathCos$2(psi)*(x1-x2)/2+mathSin$2(psi)*(y1-y2)/2,yp=-1*mathSin$2(psi)*(x1-x2)/2+mathCos$2(psi)*(y1-y2)/2,lambda=xp*xp/(rx*rx)+yp*yp/(ry*ry);lambda>1&&(rx*=mathSqrt$1(lambda),ry*=mathSqrt$1(lambda));var f=(fa===fs?-1:1)*mathSqrt$1((rx*rx*(ry*ry)-rx*rx*(yp*yp)-ry*ry*(xp*xp))/(rx*rx*(yp*yp)+ry*ry*(xp*xp)))||0,cxp=f*rx*yp/ry,cyp=f*-ry*xp/rx,cx=(x1+x2)/2+mathCos$2(psi)*cxp-mathSin$2(psi)*cyp,cy=(y1+y2)/2+mathSin$2(psi)*cxp+mathCos$2(psi)*cyp,theta=vAngle([1,0],[(xp-cxp)/rx,(yp-cyp)/ry]),u=[(xp-cxp)/rx,(yp-cyp)/ry],v=[(-1*xp-cxp)/rx,(-1*yp-cyp)/ry],dTheta=vAngle(u,v);if(vRatio(u,v)<=-1&&(dTheta=PI$6),vRatio(u,v)>=1&&(dTheta=0),dTheta<0){var n=Math.round(dTheta/PI$6*1e6)/1e6;dTheta=2*PI$6+n%2*PI$6}path.addData(cmd,cx,cy,rx,ry,theta,dTheta,psi,fs)}var commandReg=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/gi,numberReg$1=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;var SVGPath=function(_super){function SVGPath2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(SVGPath2,_super),SVGPath2.prototype.applyTransform=function(m2){},SVGPath2}(Path);function isPathProxy(path){return null!=path.setData}function createPathOptions(str,opts){var pathProxy=function(data){var path=new PathProxy;if(!data)return path;var prevCmd,cpx=0,cpy=0,subpathX=cpx,subpathY=cpy,CMD2=PathProxy.CMD,cmdList=data.match(commandReg);if(!cmdList)return path;for(var l=0;l<cmdList.length;l++){for(var cmdText=cmdList[l],cmdStr=cmdText.charAt(0),cmd=void 0,p=cmdText.match(numberReg$1)||[],pLen=p.length,i=0;i<pLen;i++)p[i]=parseFloat(p[i]);for(var off=0;off<pLen;){var ctlPtx=void 0,ctlPty=void 0,rx=void 0,ry=void 0,psi=void 0,fa=void 0,fs=void 0,x1=cpx,y1=cpy,len2=void 0,pathData=void 0;switch(cmdStr){case"l":cpx+=p[off++],cpy+=p[off++],cmd=CMD2.L,path.addData(cmd,cpx,cpy);break;case"L":cpx=p[off++],cpy=p[off++],cmd=CMD2.L,path.addData(cmd,cpx,cpy);break;case"m":cpx+=p[off++],cpy+=p[off++],cmd=CMD2.M,path.addData(cmd,cpx,cpy),subpathX=cpx,subpathY=cpy,cmdStr="l";break;case"M":cpx=p[off++],cpy=p[off++],cmd=CMD2.M,path.addData(cmd,cpx,cpy),subpathX=cpx,subpathY=cpy,cmdStr="L";break;case"h":cpx+=p[off++],cmd=CMD2.L,path.addData(cmd,cpx,cpy);break;case"H":cpx=p[off++],cmd=CMD2.L,path.addData(cmd,cpx,cpy);break;case"v":cpy+=p[off++],cmd=CMD2.L,path.addData(cmd,cpx,cpy);break;case"V":cpy=p[off++],cmd=CMD2.L,path.addData(cmd,cpx,cpy);break;case"C":cmd=CMD2.C,path.addData(cmd,p[off++],p[off++],p[off++],p[off++],p[off++],p[off++]),cpx=p[off-2],cpy=p[off-1];break;case"c":cmd=CMD2.C,path.addData(cmd,p[off++]+cpx,p[off++]+cpy,p[off++]+cpx,p[off++]+cpy,p[off++]+cpx,p[off++]+cpy),cpx+=p[off-2],cpy+=p[off-1];break;case"S":ctlPtx=cpx,ctlPty=cpy,len2=path.len(),pathData=path.data,prevCmd===CMD2.C&&(ctlPtx+=cpx-pathData[len2-4],ctlPty+=cpy-pathData[len2-3]),cmd=CMD2.C,x1=p[off++],y1=p[off++],cpx=p[off++],cpy=p[off++],path.addData(cmd,ctlPtx,ctlPty,x1,y1,cpx,cpy);break;case"s":ctlPtx=cpx,ctlPty=cpy,len2=path.len(),pathData=path.data,prevCmd===CMD2.C&&(ctlPtx+=cpx-pathData[len2-4],ctlPty+=cpy-pathData[len2-3]),cmd=CMD2.C,x1=cpx+p[off++],y1=cpy+p[off++],cpx+=p[off++],cpy+=p[off++],path.addData(cmd,ctlPtx,ctlPty,x1,y1,cpx,cpy);break;case"Q":x1=p[off++],y1=p[off++],cpx=p[off++],cpy=p[off++],cmd=CMD2.Q,path.addData(cmd,x1,y1,cpx,cpy);break;case"q":x1=p[off++]+cpx,y1=p[off++]+cpy,cpx+=p[off++],cpy+=p[off++],cmd=CMD2.Q,path.addData(cmd,x1,y1,cpx,cpy);break;case"T":ctlPtx=cpx,ctlPty=cpy,len2=path.len(),pathData=path.data,prevCmd===CMD2.Q&&(ctlPtx+=cpx-pathData[len2-4],ctlPty+=cpy-pathData[len2-3]),cpx=p[off++],cpy=p[off++],cmd=CMD2.Q,path.addData(cmd,ctlPtx,ctlPty,cpx,cpy);break;case"t":ctlPtx=cpx,ctlPty=cpy,len2=path.len(),pathData=path.data,prevCmd===CMD2.Q&&(ctlPtx+=cpx-pathData[len2-4],ctlPty+=cpy-pathData[len2-3]),cpx+=p[off++],cpy+=p[off++],cmd=CMD2.Q,path.addData(cmd,ctlPtx,ctlPty,cpx,cpy);break;case"A":rx=p[off++],ry=p[off++],psi=p[off++],fa=p[off++],fs=p[off++],processArc(x1=cpx,y1=cpy,cpx=p[off++],cpy=p[off++],fa,fs,rx,ry,psi,cmd=CMD2.A,path);break;case"a":rx=p[off++],ry=p[off++],psi=p[off++],fa=p[off++],fs=p[off++],processArc(x1=cpx,y1=cpy,cpx+=p[off++],cpy+=p[off++],fa,fs,rx,ry,psi,cmd=CMD2.A,path)}}"z"!==cmdStr&&"Z"!==cmdStr||(cmd=CMD2.Z,path.addData(cmd),cpx=subpathX,cpy=subpathY),prevCmd=cmd}return path.toStatic(),path}(str),innerOpts=extend({},opts);return innerOpts.buildPath=function(path){if(isPathProxy(path)){path.setData(pathProxy.data),(ctx=path.getContext())&&path.rebuildPath(ctx,1)}else{var ctx=path;pathProxy.rebuildPath(ctx,1)}},innerOpts.applyTransform=function(m2){!function(path,m2){if(m2){var cmd,nPoint,i,j,k,p,data=path.data,len2=path.len(),M=CMD.M,C=CMD.C,L=CMD.L,R=CMD.R,A=CMD.A,Q=CMD.Q;for(i=0,j=0;i<len2;){switch(cmd=data[i++],j=i,nPoint=0,cmd){case M:case L:nPoint=1;break;case C:nPoint=3;break;case Q:nPoint=2;break;case A:var x=m2[4],y=m2[5],sx=mathSqrt$2(m2[0]*m2[0]+m2[1]*m2[1]),sy=mathSqrt$2(m2[2]*m2[2]+m2[3]*m2[3]),angle=mathAtan2(-m2[1]/sy,m2[0]/sx);data[i]*=sx,data[i++]+=x,data[i]*=sy,data[i++]+=y,data[i++]*=sx,data[i++]*=sy,data[i++]+=angle,data[i++]+=angle,j=i+=2;break;case R:p[0]=data[i++],p[1]=data[i++],applyTransform$1(p,p,m2),data[j++]=p[0],data[j++]=p[1],p[0]+=data[i++],p[1]+=data[i++],applyTransform$1(p,p,m2),data[j++]=p[0],data[j++]=p[1]}for(k=0;k<nPoint;k++){var p_1=points$2[k];p_1[0]=data[i++],p_1[1]=data[i++],applyTransform$1(p_1,p_1,m2),data[j++]=p_1[0],data[j++]=p_1[1]}}path.increaseVersion()}}(pathProxy,m2),this.dirtyShape()},innerOpts}function createFromString(str,opts){return new SVGPath(createPathOptions(str,opts))}var CircleShape=function(){return function(){this.cx=0,this.cy=0,this.r=0}}(),Circle=function(_super){function Circle2(opts){return _super.call(this,opts)||this}return __extends(Circle2,_super),Circle2.prototype.getDefaultShape=function(){return new CircleShape},Circle2.prototype.buildPath=function(ctx,shape){ctx.moveTo(shape.cx+shape.r,shape.cy),ctx.arc(shape.cx,shape.cy,shape.r,0,2*Math.PI)},Circle2}(Path);Circle.prototype.type="circle";var EllipseShape=function(){return function(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}}(),Ellipse=function(_super){function Ellipse2(opts){return _super.call(this,opts)||this}return __extends(Ellipse2,_super),Ellipse2.prototype.getDefaultShape=function(){return new EllipseShape},Ellipse2.prototype.buildPath=function(ctx,shape){var k=.5522848,x=shape.cx,y=shape.cy,a=shape.rx,b=shape.ry,ox=a*k,oy=b*k;ctx.moveTo(x-a,y),ctx.bezierCurveTo(x-a,y-oy,x-ox,y-b,x,y-b),ctx.bezierCurveTo(x+ox,y-b,x+a,y-oy,x+a,y),ctx.bezierCurveTo(x+a,y+oy,x+ox,y+b,x,y+b),ctx.bezierCurveTo(x-ox,y+b,x-a,y+oy,x-a,y),ctx.closePath()},Ellipse2}(Path);Ellipse.prototype.type="ellipse";var PI$5=Math.PI,PI2$2=2*PI$5,mathSin$1=Math.sin,mathCos$1=Math.cos,mathACos=Math.acos,mathATan2=Math.atan2,mathAbs=Math.abs,mathSqrt=Math.sqrt,mathMax$6=Math.max,mathMin$6=Math.min,e=1e-4;function computeCornerTangents(x0,y0,x1,y1,radius,cr,clockwise){var x01=x0-x1,y01=y0-y1,lo=(clockwise?cr:-cr)/mathSqrt(x01*x01+y01*y01),ox=lo*y01,oy=-lo*x01,x11=x0+ox,y11=y0+oy,x10=x1+ox,y10=y1+oy,x00=(x11+x10)/2,y00=(y11+y10)/2,dx=x10-x11,dy=y10-y11,d2=dx*dx+dy*dy,r=radius-cr,s=x11*y10-x10*y11,d=(dy<0?-1:1)*mathSqrt(mathMax$6(0,r*r*d2-s*s)),cx0=(s*dy-dx*d)/d2,cy0=(-s*dx-dy*d)/d2,cx1=(s*dy+dx*d)/d2,cy1=(-s*dx+dy*d)/d2,dx0=cx0-x00,dy0=cy0-y00,dx1=cx1-x00,dy1=cy1-y00;return dx0*dx0+dy0*dy0>dx1*dx1+dy1*dy1&&(cx0=cx1,cy0=cy1),{cx:cx0,cy:cy0,x0:-ox,y0:-oy,x1:cx0*(radius/r-1),y1:cy0*(radius/r-1)}}function buildPath$1(ctx,shape){var _a2,radius=mathMax$6(shape.r,0),innerRadius=mathMax$6(shape.r0||0,0),hasRadius=radius>0;if(hasRadius||innerRadius>0){if(hasRadius||(radius=innerRadius,innerRadius=0),innerRadius>radius){var tmp=radius;radius=innerRadius,innerRadius=tmp}var startAngle=shape.startAngle,endAngle=shape.endAngle;if(!isNaN(startAngle)&&!isNaN(endAngle)){var cx=shape.cx,cy=shape.cy,clockwise=!!shape.clockwise,arc=mathAbs(endAngle-startAngle),mod=arc>PI2$2&&arc%PI2$2;if(mod>e&&(arc=mod),radius>e)if(arc>PI2$2-e)ctx.moveTo(cx+radius*mathCos$1(startAngle),cy+radius*mathSin$1(startAngle)),ctx.arc(cx,cy,radius,startAngle,endAngle,!clockwise),innerRadius>e&&(ctx.moveTo(cx+innerRadius*mathCos$1(endAngle),cy+innerRadius*mathSin$1(endAngle)),ctx.arc(cx,cy,innerRadius,endAngle,startAngle,clockwise));else{var icrStart=void 0,icrEnd=void 0,ocrStart=void 0,ocrEnd=void 0,ocrs=void 0,ocre=void 0,icrs=void 0,icre=void 0,ocrMax=void 0,icrMax=void 0,limitedOcrMax=void 0,limitedIcrMax=void 0,xre=void 0,yre=void 0,xirs=void 0,yirs=void 0,xrs=radius*mathCos$1(startAngle),yrs=radius*mathSin$1(startAngle),xire=innerRadius*mathCos$1(endAngle),yire=innerRadius*mathSin$1(endAngle),hasArc=arc>e;if(hasArc){var cornerRadius=shape.cornerRadius;cornerRadius&&(icrStart=(_a2=function(cr){var arr;if(isArray$1(cr)){var len2=cr.length;if(!len2)return cr;arr=1===len2?[cr[0],cr[0],0,0]:2===len2?[cr[0],cr[0],cr[1],cr[1]]:3===len2?cr.concat(cr[2]):cr}else arr=[cr,cr,cr,cr];return arr}(cornerRadius))[0],icrEnd=_a2[1],ocrStart=_a2[2],ocrEnd=_a2[3]);var halfRd=mathAbs(radius-innerRadius)/2;if(ocrs=mathMin$6(halfRd,ocrStart),ocre=mathMin$6(halfRd,ocrEnd),icrs=mathMin$6(halfRd,icrStart),icre=mathMin$6(halfRd,icrEnd),limitedOcrMax=ocrMax=mathMax$6(ocrs,ocre),limitedIcrMax=icrMax=mathMax$6(icrs,icre),(ocrMax>e||icrMax>e)&&(xre=radius*mathCos$1(endAngle),yre=radius*mathSin$1(endAngle),xirs=innerRadius*mathCos$1(startAngle),yirs=innerRadius*mathSin$1(startAngle),arc<PI$5)){var it_1=function(x0,y0,x1,y1,x2,y2,x3,y3){var dx10=x1-x0,dy10=y1-y0,dx32=x3-x2,dy32=y3-y2,t=dy32*dx10-dx32*dy10;if(!(t*t<e))return[x0+(t=(dx32*(y0-y2)-dy32*(x0-x2))/t)*dx10,y0+t*dy10]}(xrs,yrs,xirs,yirs,xre,yre,xire,yire);if(it_1){var x0=xrs-it_1[0],y0=yrs-it_1[1],x1=xre-it_1[0],y1=yre-it_1[1],a=1/mathSin$1(mathACos((x0*x1+y0*y1)/(mathSqrt(x0*x0+y0*y0)*mathSqrt(x1*x1+y1*y1)))/2),b=mathSqrt(it_1[0]*it_1[0]+it_1[1]*it_1[1]);limitedOcrMax=mathMin$6(ocrMax,(radius-b)/(a+1)),limitedIcrMax=mathMin$6(icrMax,(innerRadius-b)/(a-1))}}}if(hasArc)if(limitedOcrMax>e){var crStart=mathMin$6(ocrStart,limitedOcrMax),crEnd=mathMin$6(ocrEnd,limitedOcrMax),ct0=computeCornerTangents(xirs,yirs,xrs,yrs,radius,crStart,clockwise),ct1=computeCornerTangents(xre,yre,xire,yire,radius,crEnd,clockwise);ctx.moveTo(cx+ct0.cx+ct0.x0,cy+ct0.cy+ct0.y0),limitedOcrMax<ocrMax&&crStart===crEnd?ctx.arc(cx+ct0.cx,cy+ct0.cy,limitedOcrMax,mathATan2(ct0.y0,ct0.x0),mathATan2(ct1.y0,ct1.x0),!clockwise):(crStart>0&&ctx.arc(cx+ct0.cx,cy+ct0.cy,crStart,mathATan2(ct0.y0,ct0.x0),mathATan2(ct0.y1,ct0.x1),!clockwise),ctx.arc(cx,cy,radius,mathATan2(ct0.cy+ct0.y1,ct0.cx+ct0.x1),mathATan2(ct1.cy+ct1.y1,ct1.cx+ct1.x1),!clockwise),crEnd>0&&ctx.arc(cx+ct1.cx,cy+ct1.cy,crEnd,mathATan2(ct1.y1,ct1.x1),mathATan2(ct1.y0,ct1.x0),!clockwise))}else ctx.moveTo(cx+xrs,cy+yrs),ctx.arc(cx,cy,radius,startAngle,endAngle,!clockwise);else ctx.moveTo(cx+xrs,cy+yrs);if(innerRadius>e&&hasArc)if(limitedIcrMax>e){crStart=mathMin$6(icrStart,limitedIcrMax),ct0=computeCornerTangents(xire,yire,xre,yre,innerRadius,-(crEnd=mathMin$6(icrEnd,limitedIcrMax)),clockwise),ct1=computeCornerTangents(xrs,yrs,xirs,yirs,innerRadius,-crStart,clockwise);ctx.lineTo(cx+ct0.cx+ct0.x0,cy+ct0.cy+ct0.y0),limitedIcrMax<icrMax&&crStart===crEnd?ctx.arc(cx+ct0.cx,cy+ct0.cy,limitedIcrMax,mathATan2(ct0.y0,ct0.x0),mathATan2(ct1.y0,ct1.x0),!clockwise):(crEnd>0&&ctx.arc(cx+ct0.cx,cy+ct0.cy,crEnd,mathATan2(ct0.y0,ct0.x0),mathATan2(ct0.y1,ct0.x1),!clockwise),ctx.arc(cx,cy,innerRadius,mathATan2(ct0.cy+ct0.y1,ct0.cx+ct0.x1),mathATan2(ct1.cy+ct1.y1,ct1.cx+ct1.x1),clockwise),crStart>0&&ctx.arc(cx+ct1.cx,cy+ct1.cy,crStart,mathATan2(ct1.y1,ct1.x1),mathATan2(ct1.y0,ct1.x0),!clockwise))}else ctx.lineTo(cx+xire,cy+yire),ctx.arc(cx,cy,innerRadius,endAngle,startAngle,clockwise);else ctx.lineTo(cx+xire,cy+yire)}else ctx.moveTo(cx,cy);ctx.closePath()}}}var SectorShape=function(){return function(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.cornerRadius=0}}(),Sector=function(_super){function Sector2(opts){return _super.call(this,opts)||this}return __extends(Sector2,_super),Sector2.prototype.getDefaultShape=function(){return new SectorShape},Sector2.prototype.buildPath=function(ctx,shape){buildPath$1(ctx,shape)},Sector2.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},Sector2}(Path);Sector.prototype.type="sector";var RingShape=function(){return function(){this.cx=0,this.cy=0,this.r=0,this.r0=0}}(),Ring=function(_super){function Ring2(opts){return _super.call(this,opts)||this}return __extends(Ring2,_super),Ring2.prototype.getDefaultShape=function(){return new RingShape},Ring2.prototype.buildPath=function(ctx,shape){var x=shape.cx,y=shape.cy,PI22=2*Math.PI;ctx.moveTo(x+shape.r,y),ctx.arc(x,y,shape.r,0,PI22,!1),ctx.moveTo(x+shape.r0,y),ctx.arc(x,y,shape.r0,0,PI22,!0)},Ring2}(Path);function buildPath(ctx,shape,closePath){var smooth=shape.smooth,points2=shape.points;if(points2&&points2.length>=2){if(smooth){var controlPoints=function(points2,smooth,isLoop,constraint){var prevPoint,nextPoint,min3,max3,cps=[],v=[],v1=[],v2=[];if(constraint){min3=[Infinity,Infinity],max3=[-Infinity,-Infinity];for(var i=0,len2=points2.length;i<len2;i++)min$1(min3,min3,points2[i]),max$1(max3,max3,points2[i]);min$1(min3,min3,constraint[0]),max$1(max3,max3,constraint[1])}for(i=0,len2=points2.length;i<len2;i++){var point=points2[i];if(isLoop)prevPoint=points2[i?i-1:len2-1],nextPoint=points2[(i+1)%len2];else{if(0===i||i===len2-1){cps.push(clone$2(points2[i]));continue}prevPoint=points2[i-1],nextPoint=points2[i+1]}sub(v,nextPoint,prevPoint),scale$2(v,v,smooth);var d0=distance(point,prevPoint),d1=distance(point,nextPoint),sum=d0+d1;0!==sum&&(d0/=sum,d1/=sum),scale$2(v1,v,-d0),scale$2(v2,v,d1);var cp0=add([],point,v1),cp1=add([],point,v2);constraint&&(max$1(cp0,cp0,min3),min$1(cp0,cp0,max3),max$1(cp1,cp1,min3),min$1(cp1,cp1,max3)),cps.push(cp0),cps.push(cp1)}return isLoop&&cps.push(cps.shift()),cps}(points2,smooth,closePath,shape.smoothConstraint);ctx.moveTo(points2[0][0],points2[0][1]);for(var len2=points2.length,i=0;i<(closePath?len2:len2-1);i++){var cp1=controlPoints[2*i],cp2=controlPoints[2*i+1],p=points2[(i+1)%len2];ctx.bezierCurveTo(cp1[0],cp1[1],cp2[0],cp2[1],p[0],p[1])}}else{ctx.moveTo(points2[0][0],points2[0][1]);i=1;for(var l=points2.length;i<l;i++)ctx.lineTo(points2[i][0],points2[i][1])}closePath&&ctx.closePath()}}Ring.prototype.type="ring";var PolygonShape=function(){return function(){this.points=null,this.smooth=0,this.smoothConstraint=null}}(),Polygon=function(_super){function Polygon2(opts){return _super.call(this,opts)||this}return __extends(Polygon2,_super),Polygon2.prototype.getDefaultShape=function(){return new PolygonShape},Polygon2.prototype.buildPath=function(ctx,shape){buildPath(ctx,shape,!0)},Polygon2}(Path);Polygon.prototype.type="polygon";var PolylineShape=function(){return function(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}}(),Polyline=function(_super){function Polyline2(opts){return _super.call(this,opts)||this}return __extends(Polyline2,_super),Polyline2.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},Polyline2.prototype.getDefaultShape=function(){return new PolylineShape},Polyline2.prototype.buildPath=function(ctx,shape){buildPath(ctx,shape,!1)},Polyline2}(Path);Polyline.prototype.type="polyline";var subPixelOptimizeOutputShape={},LineShape=function(){return function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}}(),Line=function(_super){function Line2(opts){return _super.call(this,opts)||this}return __extends(Line2,_super),Line2.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},Line2.prototype.getDefaultShape=function(){return new LineShape},Line2.prototype.buildPath=function(ctx,shape){var x1,y1,x2,y2;if(this.subPixelOptimize){var optimizedShape=subPixelOptimizeLine$1(subPixelOptimizeOutputShape,shape,this.style);x1=optimizedShape.x1,y1=optimizedShape.y1,x2=optimizedShape.x2,y2=optimizedShape.y2}else x1=shape.x1,y1=shape.y1,x2=shape.x2,y2=shape.y2;var percent=shape.percent;0!==percent&&(ctx.moveTo(x1,y1),percent<1&&(x2=x1*(1-percent)+x2*percent,y2=y1*(1-percent)+y2*percent),ctx.lineTo(x2,y2))},Line2.prototype.pointAt=function(p){var shape=this.shape;return[shape.x1*(1-p)+shape.x2*p,shape.y1*(1-p)+shape.y2*p]},Line2}(Path);Line.prototype.type="line";var out=[],BezierCurveShape=function(){return function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}}();function someVectorAt(shape,t,isTangent){var cpx2=shape.cpx2,cpy2=shape.cpy2;return null!=cpx2||null!=cpy2?[(isTangent?cubicDerivativeAt:cubicAt)(shape.x1,shape.cpx1,shape.cpx2,shape.x2,t),(isTangent?cubicDerivativeAt:cubicAt)(shape.y1,shape.cpy1,shape.cpy2,shape.y2,t)]:[(isTangent?quadraticDerivativeAt:quadraticAt)(shape.x1,shape.cpx1,shape.x2,t),(isTangent?quadraticDerivativeAt:quadraticAt)(shape.y1,shape.cpy1,shape.y2,t)]}var BezierCurve=function(_super){function BezierCurve2(opts){return _super.call(this,opts)||this}return __extends(BezierCurve2,_super),BezierCurve2.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},BezierCurve2.prototype.getDefaultShape=function(){return new BezierCurveShape},BezierCurve2.prototype.buildPath=function(ctx,shape){var x1=shape.x1,y1=shape.y1,x2=shape.x2,y2=shape.y2,cpx1=shape.cpx1,cpy1=shape.cpy1,cpx2=shape.cpx2,cpy2=shape.cpy2,percent=shape.percent;0!==percent&&(ctx.moveTo(x1,y1),null==cpx2||null==cpy2?(percent<1&&(quadraticSubdivide(x1,cpx1,x2,percent,out),cpx1=out[1],x2=out[2],quadraticSubdivide(y1,cpy1,y2,percent,out),cpy1=out[1],y2=out[2]),ctx.quadraticCurveTo(cpx1,cpy1,x2,y2)):(percent<1&&(cubicSubdivide(x1,cpx1,cpx2,x2,percent,out),cpx1=out[1],cpx2=out[2],x2=out[3],cubicSubdivide(y1,cpy1,cpy2,y2,percent,out),cpy1=out[1],cpy2=out[2],y2=out[3]),ctx.bezierCurveTo(cpx1,cpy1,cpx2,cpy2,x2,y2)))},BezierCurve2.prototype.pointAt=function(t){return someVectorAt(this.shape,t,!1)},BezierCurve2.prototype.tangentAt=function(t){var p=someVectorAt(this.shape,t,!0);return normalize$1(p,p)},BezierCurve2}(Path);BezierCurve.prototype.type="bezier-curve";var ArcShape=function(){return function(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0}}(),Arc=function(_super){function Arc2(opts){return _super.call(this,opts)||this}return __extends(Arc2,_super),Arc2.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},Arc2.prototype.getDefaultShape=function(){return new ArcShape},Arc2.prototype.buildPath=function(ctx,shape){var x=shape.cx,y=shape.cy,r=Math.max(shape.r,0),startAngle=shape.startAngle,endAngle=shape.endAngle,clockwise=shape.clockwise,unitX=Math.cos(startAngle),unitY=Math.sin(startAngle);ctx.moveTo(unitX*r+x,unitY*r+y),ctx.arc(x,y,r,startAngle,endAngle,!clockwise)},Arc2}(Path);Arc.prototype.type="arc";var CompoundPath=function(_super){function CompoundPath2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type="compound",_this}return __extends(CompoundPath2,_super),CompoundPath2.prototype._updatePathDirty=function(){for(var paths=this.shape.paths,dirtyPath=this.shapeChanged(),i=0;i<paths.length;i++)dirtyPath=dirtyPath||paths[i].shapeChanged();dirtyPath&&this.dirtyShape()},CompoundPath2.prototype.beforeBrush=function(){this._updatePathDirty();for(var paths=this.shape.paths||[],scale2=this.getGlobalScale(),i=0;i<paths.length;i++)paths[i].path||paths[i].createPathProxy(),paths[i].path.setScale(scale2[0],scale2[1],paths[i].segmentIgnoreThreshold)},CompoundPath2.prototype.buildPath=function(ctx,shape){for(var paths=shape.paths||[],i=0;i<paths.length;i++)paths[i].buildPath(ctx,paths[i].shape,!0)},CompoundPath2.prototype.afterBrush=function(){for(var paths=this.shape.paths||[],i=0;i<paths.length;i++)paths[i].pathUpdated()},CompoundPath2.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),Path.prototype.getBoundingRect.call(this)},CompoundPath2}(Path),Gradient=function(){function Gradient2(colorStops){this.colorStops=colorStops||[]}return Gradient2.prototype.addColorStop=function(offset,color2){this.colorStops.push({offset:offset,color:color2})},Gradient2}(),LinearGradient=function(_super){function LinearGradient2(x,y,x2,y2,colorStops,globalCoord){var _this=_super.call(this,colorStops)||this;return _this.x=null==x?0:x,_this.y=null==y?0:y,_this.x2=null==x2?1:x2,_this.y2=null==y2?0:y2,_this.type="linear",_this.global=globalCoord||!1,_this}return __extends(LinearGradient2,_super),LinearGradient2}(Gradient),RadialGradient=function(_super){function RadialGradient2(x,y,r,colorStops,globalCoord){var _this=_super.call(this,colorStops)||this;return _this.x=null==x?.5:x,_this.y=null==y?.5:y,_this.r=null==r?.5:r,_this.type="radial",_this.global=globalCoord||!1,_this}return __extends(RadialGradient2,_super),RadialGradient2}(Gradient),extent=[0,0],extent2=[0,0],minTv=new Point,maxTv=new Point,OrientedBoundingRect=function(){function OrientedBoundingRect2(rect,transform){this._corners=[],this._axes=[],this._origin=[0,0];for(var i=0;i<4;i++)this._corners[i]=new Point;for(i=0;i<2;i++)this._axes[i]=new Point;rect&&this.fromBoundingRect(rect,transform)}return OrientedBoundingRect2.prototype.fromBoundingRect=function(rect,transform){var corners=this._corners,axes=this._axes,x=rect.x,y=rect.y,x2=x+rect.width,y2=y+rect.height;if(corners[0].set(x,y),corners[1].set(x2,y),corners[2].set(x2,y2),corners[3].set(x,y2),transform)for(var i=0;i<4;i++)corners[i].transform(transform);Point.sub(axes[0],corners[1],corners[0]),Point.sub(axes[1],corners[3],corners[0]),axes[0].normalize(),axes[1].normalize();for(i=0;i<2;i++)this._origin[i]=axes[i].dot(corners[0])},OrientedBoundingRect2.prototype.intersect=function(other,mtv){var overlapped=!0,noMtv=!mtv;return minTv.set(Infinity,Infinity),maxTv.set(0,0),!this._intersectCheckOneSide(this,other,minTv,maxTv,noMtv,1)&&(overlapped=!1,noMtv)||!this._intersectCheckOneSide(other,this,minTv,maxTv,noMtv,-1)&&(overlapped=!1,noMtv)||noMtv||Point.copy(mtv,overlapped?minTv:maxTv),overlapped},OrientedBoundingRect2.prototype._intersectCheckOneSide=function(self2,other,minTv2,maxTv2,noMtv,inverse){for(var overlapped=!0,i=0;i<2;i++){var axis=this._axes[i];if(this._getProjMinMaxOnAxis(i,self2._corners,extent),this._getProjMinMaxOnAxis(i,other._corners,extent2),extent[1]<extent2[0]||extent[0]>extent2[1]){if(overlapped=!1,noMtv)return overlapped;var dist0=Math.abs(extent2[0]-extent[1]),dist1=Math.abs(extent[0]-extent2[1]);Math.min(dist0,dist1)>maxTv2.len()&&(dist0<dist1?Point.scale(maxTv2,axis,-dist0*inverse):Point.scale(maxTv2,axis,dist1*inverse))}else if(minTv2){dist0=Math.abs(extent2[0]-extent[1]),dist1=Math.abs(extent[0]-extent2[1]);Math.min(dist0,dist1)<minTv2.len()&&(dist0<dist1?Point.scale(minTv2,axis,dist0*inverse):Point.scale(minTv2,axis,-dist1*inverse))}}return overlapped},OrientedBoundingRect2.prototype._getProjMinMaxOnAxis=function(dim,corners,out2){for(var axis=this._axes[dim],origin=this._origin,proj=corners[0].dot(axis)+origin[dim],min3=proj,max3=proj,i=1;i<corners.length;i++){var proj_1=corners[i].dot(axis)+origin[dim];min3=Math.min(proj_1,min3),max3=Math.max(proj_1,max3)}out2[0]=min3,out2[1]=max3},OrientedBoundingRect2}(),m=[],IncrementalDisplayable=function(_super){function IncrementalDisplayable2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.notClear=!0,_this.incremental=!0,_this._displayables=[],_this._temporaryDisplayables=[],_this._cursor=0,_this}return __extends(IncrementalDisplayable2,_super),IncrementalDisplayable2.prototype.traverse=function(cb,context){cb.call(context,this)},IncrementalDisplayable2.prototype.useStyle=function(){this.style={}},IncrementalDisplayable2.prototype.getCursor=function(){return this._cursor},IncrementalDisplayable2.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},IncrementalDisplayable2.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},IncrementalDisplayable2.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},IncrementalDisplayable2.prototype.addDisplayable=function(displayable,notPersistent){notPersistent?this._temporaryDisplayables.push(displayable):this._displayables.push(displayable),this.markRedraw()},IncrementalDisplayable2.prototype.addDisplayables=function(displayables,notPersistent){notPersistent=notPersistent||!1;for(var i=0;i<displayables.length;i++)this.addDisplayable(displayables[i],notPersistent)},IncrementalDisplayable2.prototype.getDisplayables=function(){return this._displayables},IncrementalDisplayable2.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},IncrementalDisplayable2.prototype.eachPendingDisplayable=function(cb){for(var i=this._cursor;i<this._displayables.length;i++)cb&&cb(this._displayables[i]);for(i=0;i<this._temporaryDisplayables.length;i++)cb&&cb(this._temporaryDisplayables[i])},IncrementalDisplayable2.prototype.update=function(){this.updateTransform();for(var i=this._cursor;i<this._displayables.length;i++){(displayable=this._displayables[i]).parent=this,displayable.update(),displayable.parent=null}for(i=0;i<this._temporaryDisplayables.length;i++){var displayable;(displayable=this._temporaryDisplayables[i]).parent=this,displayable.update(),displayable.parent=null}},IncrementalDisplayable2.prototype.getBoundingRect=function(){if(!this._rect){for(var rect=new BoundingRect(Infinity,Infinity,-Infinity,-Infinity),i=0;i<this._displayables.length;i++){var displayable=this._displayables[i],childRect=displayable.getBoundingRect().clone();displayable.needLocalTransform()&&childRect.applyTransform(displayable.getLocalTransform(m)),rect.union(childRect)}this._rect=rect}return this._rect},IncrementalDisplayable2.prototype.contain=function(x,y){var localPos=this.transformCoordToLocal(x,y);if(this.getBoundingRect().contain(localPos[0],localPos[1]))for(var i=0;i<this._displayables.length;i++){if(this._displayables[i].contain(x,y))return!0}return!1},IncrementalDisplayable2}(Displayable),transitionStore=makeInner();function getAnimationConfig(animationType,animatableModel,dataIndex,extraOpts,extraDelayParams){var animationPayload;if(animatableModel&&animatableModel.ecModel){var updatePayload=animatableModel.ecModel.getUpdatePayload();animationPayload=updatePayload&&updatePayload.animation}var isUpdate="update"===animationType;if(animatableModel&&animatableModel.isAnimationEnabled()){var duration=void 0,easing=void 0,delay=void 0;return extraOpts?(duration=retrieve2(extraOpts.duration,200),easing=retrieve2(extraOpts.easing,"cubicOut"),delay=0):(duration=animatableModel.getShallow(isUpdate?"animationDurationUpdate":"animationDuration"),easing=animatableModel.getShallow(isUpdate?"animationEasingUpdate":"animationEasing"),delay=animatableModel.getShallow(isUpdate?"animationDelayUpdate":"animationDelay")),animationPayload&&(null!=animationPayload.duration&&(duration=animationPayload.duration),null!=animationPayload.easing&&(easing=animationPayload.easing),null!=animationPayload.delay&&(delay=animationPayload.delay)),isFunction(delay)&&(delay=delay(dataIndex,extraDelayParams)),isFunction(duration)&&(duration=duration(dataIndex)),{duration:duration||0,delay:delay,easing:easing}}return null}function animateOrSetProps(animationType,el,props,animatableModel,dataIndex,cb,during){var removeOpt,isFrom=!1;isFunction(dataIndex)?(during=cb,cb=dataIndex,dataIndex=null):isObject$3(dataIndex)&&(cb=dataIndex.cb,during=dataIndex.during,isFrom=dataIndex.isFrom,removeOpt=dataIndex.removeOpt,dataIndex=dataIndex.dataIndex);var isRemove="leave"===animationType;isRemove||el.stopAnimation("leave");var animationConfig=getAnimationConfig(animationType,animatableModel,dataIndex,isRemove?removeOpt||{}:null,animatableModel&&animatableModel.getAnimationDelayParams?animatableModel.getAnimationDelayParams(el,dataIndex):null);if(animationConfig&&animationConfig.duration>0){var animateConfig={duration:animationConfig.duration,delay:animationConfig.delay||0,easing:animationConfig.easing,done:cb,force:!!cb||!!during,setToFinal:!isRemove,scope:animationType,during:during};isFrom?el.animateFrom(props,animateConfig):el.animateTo(props,animateConfig)}else el.stopAnimation(),!isFrom&&el.attr(props),during&&during(1),cb&&cb()}function updateProps$1(el,props,animatableModel,dataIndex,cb,during){animateOrSetProps("update",el,props,animatableModel,dataIndex,cb,during)}function initProps(el,props,animatableModel,dataIndex,cb,during){animateOrSetProps("enter",el,props,animatableModel,dataIndex,cb,during)}function isElementRemoved(el){if(!el.__zr)return!0;for(var i=0;i<el.animators.length;i++){if("leave"===el.animators[i].scope)return!0}return!1}function removeElement(el,props,animatableModel,dataIndex,cb,during){isElementRemoved(el)||animateOrSetProps("leave",el,props,animatableModel,dataIndex,cb,during)}function fadeOutDisplayable(el,animatableModel,dataIndex,done){el.removeTextContent(),el.removeTextGuideLine(),removeElement(el,{style:{opacity:0}},animatableModel,dataIndex,done)}function removeElementWithFadeOut(el,animatableModel,dataIndex){function doRemove(){el.parent&&el.parent.remove(el)}el.isGroup?el.traverse((function(disp){disp.isGroup||fadeOutDisplayable(disp,animatableModel,dataIndex,doRemove)})):fadeOutDisplayable(el,animatableModel,dataIndex,doRemove)}function saveOldStyle(el){transitionStore(el).oldStyle=el.style}var mathMax$5=Math.max,mathMin$5=Math.min,_customShapeMap={};function extendShape(opts){return Path.extend(opts)}var extendPathFromString=function(str,defaultOpts){var innerOpts=createPathOptions(str,defaultOpts);return function(_super){function Sub2(opts){var _this=_super.call(this,opts)||this;return _this.applyTransform=innerOpts.applyTransform,_this.buildPath=innerOpts.buildPath,_this}return __extends(Sub2,_super),Sub2}(SVGPath)};function extendPath(pathData,opts){return extendPathFromString(pathData,opts)}function registerShape(name,ShapeClass){_customShapeMap[name]=ShapeClass}function getShapeClass(name){if(_customShapeMap.hasOwnProperty(name))return _customShapeMap[name]}function makePath(pathData,opts,rect,layout2){var path=createFromString(pathData,opts);return rect&&("center"===layout2&&(rect=centerGraphic(rect,path.getBoundingRect())),resizePath(path,rect)),path}function makeImage(imageUrl,rect,layout2){var zrImg=new ZRImage({style:{image:imageUrl,x:rect.x,y:rect.y,width:rect.width,height:rect.height},onload:function(img){if("center"===layout2){var boundingRect={width:img.width,height:img.height};zrImg.setStyle(centerGraphic(rect,boundingRect))}}});return zrImg}function centerGraphic(rect,boundingRect){var height,aspect=boundingRect.width/boundingRect.height,width=rect.height*aspect;return height=width<=rect.width?rect.height:(width=rect.width)/aspect,{x:rect.x+rect.width/2-width/2,y:rect.y+rect.height/2-height/2,width:width,height:height}}var mergePath=function(pathEls,opts){for(var pathList=[],len2=pathEls.length,i=0;i<len2;i++){var pathEl=pathEls[i];pathList.push(pathEl.getUpdatedPathProxy(!0))}var pathBundle=new Path(opts);return pathBundle.createPathProxy(),pathBundle.buildPath=function(path){if(isPathProxy(path)){path.appendPath(pathList);var ctx=path.getContext();ctx&&path.rebuildPath(ctx,1)}},pathBundle};function resizePath(path,rect){if(path.applyTransform){var m2=path.getBoundingRect().calculateTransform(rect);path.applyTransform(m2)}}function subPixelOptimizeLine(shape,lineWidth){return subPixelOptimizeLine$1(shape,shape,{lineWidth:lineWidth}),shape}var subPixelOptimize=subPixelOptimize$1;function getTransform$1(target,ancestor){for(var mat=identity([]);target&&target!==ancestor;)mul(mat,target.getLocalTransform(),mat),target=target.parent;return mat}function applyTransform(target,transform,invert$1){return transform&&!isArrayLike(transform)&&(transform=Transformable.getLocalTransform(transform)),invert$1&&(transform=invert([],transform)),applyTransform$1([],target,transform)}function transformDirection(direction,transform,invert2){var hBase=0===transform[4]||0===transform[5]||0===transform[0]?1:Math.abs(2*transform[4]/transform[0]),vBase=0===transform[4]||0===transform[5]||0===transform[2]?1:Math.abs(2*transform[4]/transform[2]),vertex=["left"===direction?-hBase:"right"===direction?hBase:0,"top"===direction?-vBase:"bottom"===direction?vBase:0];return vertex=applyTransform(vertex,transform,invert2),Math.abs(vertex[0])>Math.abs(vertex[1])?vertex[0]>0?"right":"left":vertex[1]>0?"bottom":"top"}function isNotGroup(el){return!el.isGroup}function groupTransition(g1,g2,animatableModel){if(g1&&g2){var elMap,elMap1=(elMap={},g1.traverse((function(el){isNotGroup(el)&&el.anid&&(elMap[el.anid]=el)})),elMap);g2.traverse((function(el){if(isNotGroup(el)&&el.anid){var oldEl=elMap1[el.anid];if(oldEl){var newProp=getAnimatableProps(el);el.attr(getAnimatableProps(oldEl)),updateProps$1(el,newProp,animatableModel,getECData(el).dataIndex)}}}))}function getAnimatableProps(el){var obj={x:el.x,y:el.y,rotation:el.rotation};return function(el){return null!=el.shape}(el)&&(obj.shape=extend({},el.shape)),obj}}function clipPointsByRect(points2,rect){return map$1(points2,(function(point){var x=point[0];x=mathMax$5(x,rect.x),x=mathMin$5(x,rect.x+rect.width);var y=point[1];return y=mathMax$5(y,rect.y),[x,y=mathMin$5(y,rect.y+rect.height)]}))}function clipRectByRect(targetRect,rect){var x=mathMax$5(targetRect.x,rect.x),x2=mathMin$5(targetRect.x+targetRect.width,rect.x+rect.width),y=mathMax$5(targetRect.y,rect.y),y2=mathMin$5(targetRect.y+targetRect.height,rect.y+rect.height);if(x2>=x&&y2>=y)return{x:x,y:y,width:x2-x,height:y2-y}}function createIcon(iconStr,opt,rect){var innerOpts=extend({rectHover:!0},opt),style=innerOpts.style={strokeNoScale:!0};if(rect=rect||{x:-1,y:-1,width:2,height:2},iconStr)return 0===iconStr.indexOf("image://")?(style.image=iconStr.slice(8),defaults(style,rect),new ZRImage(innerOpts)):makePath(iconStr.replace("path://",""),innerOpts,rect,"center")}function lineLineIntersect(a1x,a1y,a2x,a2y,b1x,b1y,b2x,b2y){var val,mx=a2x-a1x,my=a2y-a1y,nx=b2x-b1x,ny=b2y-b1y,nmCrossProduct=crossProduct2d(nx,ny,mx,my);if((val=nmCrossProduct)<=1e-6&&val>=-1e-6)return!1;var b1a1x=a1x-b1x,b1a1y=a1y-b1y,q=crossProduct2d(b1a1x,b1a1y,mx,my)/nmCrossProduct;if(q<0||q>1)return!1;var p=crossProduct2d(b1a1x,b1a1y,nx,ny)/nmCrossProduct;return!(p<0||p>1)}function crossProduct2d(x1,y1,x2,y2){return x1*y2-x2*y1}function setTooltipConfig(opt){var itemTooltipOption=opt.itemTooltipOption,componentModel=opt.componentModel,itemName=opt.itemName,itemTooltipOptionObj=isString(itemTooltipOption)?{formatter:itemTooltipOption}:itemTooltipOption,mainType=componentModel.mainType,componentIndex=componentModel.componentIndex,formatterParams={componentType:mainType,name:itemName,$vars:["name"]};formatterParams[mainType+"Index"]=componentIndex;var formatterParamsExtra=opt.formatterParamsExtra;formatterParamsExtra&&each$d(keys(formatterParamsExtra),(function(key){hasOwn(formatterParams,key)||(formatterParams[key]=formatterParamsExtra[key],formatterParams.$vars.push(key))}));var ecData=getECData(opt.el);ecData.componentMainType=mainType,ecData.componentIndex=componentIndex,ecData.tooltipConfig={name:itemName,option:defaults({content:itemName,encodeHTMLContent:!0,formatterParams:formatterParams},itemTooltipOptionObj)}}function traverseElement(el,cb){var stopped;el.isGroup&&(stopped=cb(el)),stopped||el.traverse(cb)}function traverseElements(els,cb){if(els)if(isArray$1(els))for(var i=0;i<els.length;i++)traverseElement(els[i],cb);else traverseElement(els,cb)}registerShape("circle",Circle),registerShape("ellipse",Ellipse),registerShape("sector",Sector),registerShape("ring",Ring),registerShape("polygon",Polygon),registerShape("polyline",Polyline),registerShape("rect",Rect$1),registerShape("line",Line),registerShape("bezierCurve",BezierCurve),registerShape("arc",Arc);const graphic$1=Object.freeze(Object.defineProperty({__proto__:null,Arc:Arc,BezierCurve:BezierCurve,BoundingRect:BoundingRect,Circle:Circle,CompoundPath:CompoundPath,Ellipse:Ellipse,Group:Group$2,Image:ZRImage,IncrementalDisplayable:IncrementalDisplayable,Line:Line,LinearGradient:LinearGradient,OrientedBoundingRect:OrientedBoundingRect,Path:Path,Point:Point,Polygon:Polygon,Polyline:Polyline,RadialGradient:RadialGradient,Rect:Rect$1,Ring:Ring,Sector:Sector,Text:ZRText,applyTransform:applyTransform,clipPointsByRect:clipPointsByRect,clipRectByRect:clipRectByRect,createIcon:createIcon,extendPath:extendPath,extendShape:extendShape,getShapeClass:getShapeClass,getTransform:getTransform$1,groupTransition:groupTransition,initProps:initProps,isElementRemoved:isElementRemoved,lineLineIntersect:lineLineIntersect,linePolygonIntersect:function(a1x,a1y,a2x,a2y,points2){for(var i=0,p2=points2[points2.length-1];i<points2.length;i++){var p=points2[i];if(lineLineIntersect(a1x,a1y,a2x,a2y,p[0],p[1],p2[0],p2[1]))return!0;p2=p}},makeImage:makeImage,makePath:makePath,mergePath:mergePath,registerShape:registerShape,removeElement:removeElement,removeElementWithFadeOut:removeElementWithFadeOut,resizePath:resizePath,setTooltipConfig:setTooltipConfig,subPixelOptimize:subPixelOptimize,subPixelOptimizeLine:subPixelOptimizeLine,subPixelOptimizeRect:function(param){return subPixelOptimizeRect$1(param.shape,param.shape,param.style),param},transformDirection:transformDirection,traverseElements:traverseElements,updateProps:updateProps$1},Symbol.toStringTag,{value:"Module"}));var EMPTY_OBJ={};function getLabelText(opt,stateModels,interpolatedValue){var baseText,labelFetcher=opt.labelFetcher,labelDataIndex=opt.labelDataIndex,labelDimIndex=opt.labelDimIndex,normalModel=stateModels.normal;labelFetcher&&(baseText=labelFetcher.getFormattedLabel(labelDataIndex,"normal",null,labelDimIndex,normalModel&&normalModel.get("formatter"),null!=interpolatedValue?{interpolatedValue:interpolatedValue}:null)),null==baseText&&(baseText=isFunction(opt.defaultText)?opt.defaultText(labelDataIndex,opt,interpolatedValue):opt.defaultText);for(var statesText={normal:baseText},i=0;i<SPECIAL_STATES.length;i++){var stateName=SPECIAL_STATES[i],stateModel=stateModels[stateName];statesText[stateName]=retrieve2(labelFetcher?labelFetcher.getFormattedLabel(labelDataIndex,stateName,null,labelDimIndex,stateModel&&stateModel.get("formatter")):null,baseText)}return statesText}function setLabelStyle(targetEl,labelStatesModels,opt,stateSpecified){opt=opt||EMPTY_OBJ;for(var isSetOnText=targetEl instanceof ZRText,needsCreateText=!1,i=0;i<DISPLAY_STATES.length;i++){if((stateModel=labelStatesModels[DISPLAY_STATES[i]])&&stateModel.getShallow("show")){needsCreateText=!0;break}}var textContent=isSetOnText?targetEl:targetEl.getTextContent();if(needsCreateText){isSetOnText||(textContent||(textContent=new ZRText,targetEl.setTextContent(textContent)),targetEl.stateProxy&&(textContent.stateProxy=targetEl.stateProxy));var labelStatesTexts=getLabelText(opt,labelStatesModels),normalModel=labelStatesModels.normal,showNormal=!!normalModel.getShallow("show"),normalStyle=createTextStyle$1(normalModel,stateSpecified&&stateSpecified.normal,opt,!1,!isSetOnText);normalStyle.text=labelStatesTexts.normal,isSetOnText||targetEl.setTextConfig(createTextConfig(normalModel,opt,!1));for(i=0;i<SPECIAL_STATES.length;i++){var stateModel,stateName=SPECIAL_STATES[i];if(stateModel=labelStatesModels[stateName]){var stateObj=textContent.ensureState(stateName),stateShow=!!retrieve2(stateModel.getShallow("show"),showNormal);if(stateShow!==showNormal&&(stateObj.ignore=!stateShow),stateObj.style=createTextStyle$1(stateModel,stateSpecified&&stateSpecified[stateName],opt,!0,!isSetOnText),stateObj.style.text=labelStatesTexts[stateName],!isSetOnText)targetEl.ensureState(stateName).textConfig=createTextConfig(stateModel,opt,!0)}}textContent.silent=!!normalModel.getShallow("silent"),null!=textContent.style.x&&(normalStyle.x=textContent.style.x),null!=textContent.style.y&&(normalStyle.y=textContent.style.y),textContent.ignore=!showNormal,textContent.useStyle(normalStyle),textContent.dirty(),opt.enableTextSetter&&(labelInner(textContent).setLabelText=function(interpolatedValue){var labelStatesTexts2=getLabelText(opt,labelStatesModels,interpolatedValue);!function(label,labelTexts){for(var i=0;i<SPECIAL_STATES.length;i++){var stateName=SPECIAL_STATES[i],text=labelTexts[stateName],state=label.ensureState(stateName);state.style=state.style||{},state.style.text=text}var oldStates=label.currentStates.slice();label.clearStates(!0),label.setStyle({text:labelTexts.normal}),label.useStates(oldStates,!0)}(textContent,labelStatesTexts2)})}else textContent&&(textContent.ignore=!0);targetEl.dirty()}function getLabelStatesModels(itemModel,labelName){labelName=labelName||"label";for(var statesModels={normal:itemModel.getModel(labelName)},i=0;i<SPECIAL_STATES.length;i++){var stateName=SPECIAL_STATES[i];statesModels[stateName]=itemModel.getModel([stateName,labelName])}return statesModels}function createTextStyle$1(textStyleModel,specifiedTextStyle,opt,isNotNormal,isAttached){var textStyle={};return function(textStyle,textStyleModel,opt,isNotNormal,isAttached){opt=opt||EMPTY_OBJ;var richResult,ecModel=textStyleModel.ecModel,globalTextStyle=ecModel&&ecModel.option.textStyle,richItemNames=function(textStyleModel){var richItemNameMap;for(;textStyleModel&&textStyleModel!==textStyleModel.ecModel;){var rich=(textStyleModel.option||EMPTY_OBJ).rich;if(rich){richItemNameMap=richItemNameMap||{};for(var richKeys=keys(rich),i=0;i<richKeys.length;i++){richItemNameMap[richKeys[i]]=1}}textStyleModel=textStyleModel.parentModel}return richItemNameMap}(textStyleModel);if(richItemNames)for(var name_1 in richResult={},richItemNames)if(richItemNames.hasOwnProperty(name_1)){var richTextStyle=textStyleModel.getModel(["rich",name_1]);setTokenTextStyle(richResult[name_1]={},richTextStyle,globalTextStyle,opt,isNotNormal,isAttached,!1,!0)}richResult&&(textStyle.rich=richResult);var overflow=textStyleModel.get("overflow");overflow&&(textStyle.overflow=overflow);var margin=textStyleModel.get("minMargin");null!=margin&&(textStyle.margin=margin);setTokenTextStyle(textStyle,textStyleModel,globalTextStyle,opt,isNotNormal,isAttached,!0,!1)}(textStyle,textStyleModel,opt,isNotNormal,isAttached),specifiedTextStyle&&extend(textStyle,specifiedTextStyle),textStyle}function createTextConfig(textStyleModel,opt,isNotNormal){opt=opt||{};var labelPosition,textConfig={},labelRotate=textStyleModel.getShallow("rotate"),labelDistance=retrieve2(textStyleModel.getShallow("distance"),isNotNormal?null:5),labelOffset=textStyleModel.getShallow("offset");return"outside"===(labelPosition=textStyleModel.getShallow("position")||(isNotNormal?null:"inside"))&&(labelPosition=opt.defaultOutsidePosition||"top"),null!=labelPosition&&(textConfig.position=labelPosition),null!=labelOffset&&(textConfig.offset=labelOffset),null!=labelRotate&&(labelRotate*=Math.PI/180,textConfig.rotation=labelRotate),null!=labelDistance&&(textConfig.distance=labelDistance),textConfig.outsideFill="inherit"===textStyleModel.get("color")?opt.inheritColor||null:"auto",textConfig}var TEXT_PROPS_WITH_GLOBAL=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],TEXT_PROPS_SELF=["align","lineHeight","width","height","tag","verticalAlign","ellipsis"],TEXT_PROPS_BOX=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function setTokenTextStyle(textStyle,textStyleModel,globalTextStyle,opt,isNotNormal,isAttached,isBlock,inRich){globalTextStyle=!isNotNormal&&globalTextStyle||EMPTY_OBJ;var inheritColor=opt&&opt.inheritColor,fillColor=textStyleModel.getShallow("color"),strokeColor=textStyleModel.getShallow("textBorderColor"),opacity=retrieve2(textStyleModel.getShallow("opacity"),globalTextStyle.opacity);"inherit"!==fillColor&&"auto"!==fillColor||(fillColor=inheritColor||null),"inherit"!==strokeColor&&"auto"!==strokeColor||(strokeColor=inheritColor||null),isAttached||(fillColor=fillColor||globalTextStyle.color,strokeColor=strokeColor||globalTextStyle.textBorderColor),null!=fillColor&&(textStyle.fill=fillColor),null!=strokeColor&&(textStyle.stroke=strokeColor);var textBorderWidth=retrieve2(textStyleModel.getShallow("textBorderWidth"),globalTextStyle.textBorderWidth);null!=textBorderWidth&&(textStyle.lineWidth=textBorderWidth);var textBorderType=retrieve2(textStyleModel.getShallow("textBorderType"),globalTextStyle.textBorderType);null!=textBorderType&&(textStyle.lineDash=textBorderType);var textBorderDashOffset=retrieve2(textStyleModel.getShallow("textBorderDashOffset"),globalTextStyle.textBorderDashOffset);null!=textBorderDashOffset&&(textStyle.lineDashOffset=textBorderDashOffset),isNotNormal||null!=opacity||inRich||(opacity=opt&&opt.defaultOpacity),null!=opacity&&(textStyle.opacity=opacity),isNotNormal||isAttached||null==textStyle.fill&&opt.inheritColor&&(textStyle.fill=opt.inheritColor);for(var i=0;i<TEXT_PROPS_WITH_GLOBAL.length;i++){var key=TEXT_PROPS_WITH_GLOBAL[i];null!=(val=retrieve2(textStyleModel.getShallow(key),globalTextStyle[key]))&&(textStyle[key]=val)}for(i=0;i<TEXT_PROPS_SELF.length;i++){key=TEXT_PROPS_SELF[i];null!=(val=textStyleModel.getShallow(key))&&(textStyle[key]=val)}if(null==textStyle.verticalAlign){var baseline=textStyleModel.getShallow("baseline");null!=baseline&&(textStyle.verticalAlign=baseline)}if(!isBlock||!opt.disableBox){for(i=0;i<TEXT_PROPS_BOX.length;i++){var val;key=TEXT_PROPS_BOX[i];null!=(val=textStyleModel.getShallow(key))&&(textStyle[key]=val)}var borderType=textStyleModel.getShallow("borderType");null!=borderType&&(textStyle.borderDash=borderType),"auto"!==textStyle.backgroundColor&&"inherit"!==textStyle.backgroundColor||!inheritColor||(textStyle.backgroundColor=inheritColor),"auto"!==textStyle.borderColor&&"inherit"!==textStyle.borderColor||!inheritColor||(textStyle.borderColor=inheritColor)}}function getFont(opt,ecModel){var gTextStyleModel=ecModel&&ecModel.getModel("textStyle");return trim$1([opt.fontStyle||gTextStyleModel&&gTextStyleModel.getShallow("fontStyle")||"",opt.fontWeight||gTextStyleModel&&gTextStyleModel.getShallow("fontWeight")||"",(opt.fontSize||gTextStyleModel&&gTextStyleModel.getShallow("fontSize")||12)+"px",opt.fontFamily||gTextStyleModel&&gTextStyleModel.getShallow("fontFamily")||"sans-serif"].join(" "))}var labelInner=makeInner();var target,classAttr,PATH_COLOR=["textStyle","color"],textStyleParams=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],tmpText=new ZRText,TextStyleMixin=function(){function TextStyleMixin2(){}return TextStyleMixin2.prototype.getTextColor=function(isEmphasis){var ecModel=this.ecModel;return this.getShallow("color")||(!isEmphasis&&ecModel?ecModel.get(PATH_COLOR):null)},TextStyleMixin2.prototype.getFont=function(){return getFont({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},TextStyleMixin2.prototype.getTextRect=function(text){for(var style={text:text,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},i=0;i<textStyleParams.length;i++)style[textStyleParams[i]]=this.getShallow(textStyleParams[i]);return tmpText.useStyle(style),tmpText.update(),tmpText.getBoundingRect()},TextStyleMixin2}(),LINE_STYLE_KEY_MAP=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],getLineStyle=makeStyleMapper(LINE_STYLE_KEY_MAP),LineStyleMixin=function(){function LineStyleMixin2(){}return LineStyleMixin2.prototype.getLineStyle=function(excludes){return getLineStyle(this,excludes)},LineStyleMixin2}(),ITEM_STYLE_KEY_MAP=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],getItemStyle=makeStyleMapper(ITEM_STYLE_KEY_MAP),ItemStyleMixin=function(){function ItemStyleMixin2(){}return ItemStyleMixin2.prototype.getItemStyle=function(excludes,includes){return getItemStyle(this,excludes,includes)},ItemStyleMixin2}(),Model=function(){function Model2(option,parentModel,ecModel){this.parentModel=parentModel,this.ecModel=ecModel,this.option=option}return Model2.prototype.init=function(option,parentModel,ecModel){},Model2.prototype.mergeOption=function(option,ecModel){merge(this.option,option,!0)},Model2.prototype.get=function(path,ignoreParent){return null==path?this.option:this._doGet(this.parsePath(path),!ignoreParent&&this.parentModel)},Model2.prototype.getShallow=function(key,ignoreParent){var option=this.option,val=null==option?option:option[key];if(null==val&&!ignoreParent){var parentModel=this.parentModel;parentModel&&(val=parentModel.getShallow(key))}return val},Model2.prototype.getModel=function(path,parentModel){var hasPath=null!=path,pathFinal=hasPath?this.parsePath(path):null;return new Model2(hasPath?this._doGet(pathFinal):this.option,parentModel=parentModel||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(pathFinal)),this.ecModel)},Model2.prototype.isEmpty=function(){return null==this.option},Model2.prototype.restoreData=function(){},Model2.prototype.clone=function(){return new(0,this.constructor)(clone$3(this.option))},Model2.prototype.parsePath=function(path){return"string"==typeof path?path.split("."):path},Model2.prototype.resolveParentPath=function(path){return path},Model2.prototype.isAnimationEnabled=function(){if(!env.node&&this.option){if(null!=this.option.animation)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},Model2.prototype._doGet=function(pathArr,parentModel){var obj=this.option;if(!pathArr)return obj;for(var i=0;i<pathArr.length&&(!pathArr[i]||null!=(obj=obj&&"object"==typeof obj?obj[pathArr[i]]:null));i++);return null==obj&&parentModel&&(obj=parentModel._doGet(this.resolveParentPath(pathArr),parentModel.parentModel)),obj},Model2}();enableClassExtend(Model),target=Model,classAttr=["__\0is_clz",classBase++].join("_"),target.prototype[classAttr]=!0,target.isInstance=function(obj){return!(!obj||!obj[classAttr])},mixin(Model,LineStyleMixin),mixin(Model,ItemStyleMixin),mixin(Model,AreaStyleMixin),mixin(Model,TextStyleMixin);var base=Math.round(10*Math.random());function getUID(type){return[type||"",base++].join("_")}function inheritDefaultOption(superOption,subOption){return merge(merge({},superOption,!0),subOption,!0)}var localeStorage={},localeModels={},SYSTEM_LANG=env.domSupported&&(document.documentElement.lang||navigator.language||navigator.browserLanguage||"EN").toUpperCase().indexOf("ZH")>-1?"ZH":"EN";function registerLocale(locale,localeObj){locale=locale.toUpperCase(),localeModels[locale]=new Model(localeObj),localeStorage[locale]=localeObj}function getLocaleModel(lang){return localeModels[lang]}registerLocale("EN",{time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst",custom:"Custom chart",chart:"Chart"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}}),registerLocale("ZH",{time:{month:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthAbbr:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeek:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayOfWeekAbbr:["日","一","二","三","四","五","六"]},legend:{selector:{all:"全选",inverse:"反选"}},toolbox:{brush:{title:{rect:"矩形选择",polygon:"圈选",lineX:"横向选择",lineY:"纵向选择",keep:"保持选择",clear:"清除选择"}},dataView:{title:"数据视图",lang:["数据视图","关闭","刷新"]},dataZoom:{title:{zoom:"区域缩放",back:"区域缩放还原"}},magicType:{title:{line:"切换为折线图",bar:"切换为柱状图",stack:"切换为堆叠",tiled:"切换为平铺"}},restore:{title:"还原"},saveAsImage:{title:"保存为图片",lang:["右键另存为图片"]}},series:{typeNames:{pie:"饼图",bar:"柱状图",line:"折线图",scatter:"散点图",effectScatter:"涟漪散点图",radar:"雷达图",tree:"树图",treemap:"矩形树图",boxplot:"箱型图",candlestick:"K线图",k:"K线图",heatmap:"热力图",map:"地图",parallel:"平行坐标图",lines:"线图",graph:"关系图",sankey:"桑基图",funnel:"漏斗图",gauge:"仪表盘图",pictorialBar:"象形柱图",themeRiver:"主题河流图",sunburst:"旭日图",custom:"自定义图表",chart:"图表"}},aria:{general:{withTitle:"这是一个关于“{title}”的图表。",withoutTitle:"这是一个图表，"},series:{single:{prefix:"",withName:"图表类型是{seriesType}，表示{seriesName}。",withoutName:"图表类型是{seriesType}。"},multiple:{prefix:"它由{seriesCount}个图表系列组成。",withName:"第{seriesId}个系列是一个表示{seriesName}的{seriesType}，",withoutName:"第{seriesId}个系列是一个{seriesType}，",separator:{middle:"；",end:"。"}}},data:{allData:"其数据是——",partialData:"其中，前{displayCnt}项是——",withName:"{name}的数据是{value}",withoutName:"{value}",separator:{middle:"，",end:""}}}});var defaultLeveledFormatter={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},fullLeveledFormatter={year:"{yyyy}",month:"{yyyy}-{MM}",day:"{yyyy}-{MM}-{dd}",hour:"{yyyy}-{MM}-{dd} "+defaultLeveledFormatter.hour,minute:"{yyyy}-{MM}-{dd} "+defaultLeveledFormatter.minute,second:"{yyyy}-{MM}-{dd} "+defaultLeveledFormatter.second,millisecond:defaultLeveledFormatter.none},primaryTimeUnits=["year","month","day","hour","minute","second","millisecond"],timeUnits=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function pad(str,len2){return"0000".substr(0,len2-(str+="").length)+str}function getPrimaryTimeUnit(timeUnit){switch(timeUnit){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return timeUnit}}function isPrimaryTimeUnit(timeUnit){return timeUnit===getPrimaryTimeUnit(timeUnit)}function format$1(time2,template,isUTC,lang){var date=parseDate(time2),y=date[fullYearGetterName(isUTC)](),M=date[monthGetterName(isUTC)]()+1,q=Math.floor((M-1)/3)+1,d=date[dateGetterName(isUTC)](),e2=date["get"+(isUTC?"UTC":"")+"Day"](),H=date[hoursGetterName(isUTC)](),h=(H-1)%12+1,m2=date[minutesGetterName(isUTC)](),s=date[secondsGetterName(isUTC)](),S=date[millisecondsGetterName(isUTC)](),a=H>=12?"pm":"am",A=a.toUpperCase(),timeModel=(lang instanceof Model?lang:getLocaleModel(lang||SYSTEM_LANG)||localeModels.EN).getModel("time"),month=timeModel.get("month"),monthAbbr=timeModel.get("monthAbbr"),dayOfWeek=timeModel.get("dayOfWeek"),dayOfWeekAbbr=timeModel.get("dayOfWeekAbbr");return(template||"").replace(/{a}/g,a+"").replace(/{A}/g,A+"").replace(/{yyyy}/g,y+"").replace(/{yy}/g,pad(y%100+"",2)).replace(/{Q}/g,q+"").replace(/{MMMM}/g,month[M-1]).replace(/{MMM}/g,monthAbbr[M-1]).replace(/{MM}/g,pad(M,2)).replace(/{M}/g,M+"").replace(/{dd}/g,pad(d,2)).replace(/{d}/g,d+"").replace(/{eeee}/g,dayOfWeek[e2]).replace(/{ee}/g,dayOfWeekAbbr[e2]).replace(/{e}/g,e2+"").replace(/{HH}/g,pad(H,2)).replace(/{H}/g,H+"").replace(/{hh}/g,pad(h+"",2)).replace(/{h}/g,h+"").replace(/{mm}/g,pad(m2,2)).replace(/{m}/g,m2+"").replace(/{ss}/g,pad(s,2)).replace(/{s}/g,s+"").replace(/{SSS}/g,pad(S,3)).replace(/{S}/g,S+"")}function getUnitFromValue(value,isUTC){var date=parseDate(value),M=date[monthGetterName(isUTC)]()+1,d=date[dateGetterName(isUTC)](),h=date[hoursGetterName(isUTC)](),m2=date[minutesGetterName(isUTC)](),s=date[secondsGetterName(isUTC)](),isSecond=0===date[millisecondsGetterName(isUTC)](),isMinute=isSecond&&0===s,isHour=isMinute&&0===m2,isDay=isHour&&0===h,isMonth=isDay&&1===d;return isMonth&&1===M?"year":isMonth?"month":isDay?"day":isHour?"hour":isMinute?"minute":isSecond?"second":"millisecond"}function getUnitValue(value,unit,isUTC){var date=isNumber(value)?parseDate(value):value;switch(unit=unit||getUnitFromValue(value,isUTC)){case"year":return date[fullYearGetterName(isUTC)]();case"half-year":return date[monthGetterName(isUTC)]()>=6?1:0;case"quarter":return Math.floor((date[monthGetterName(isUTC)]()+1)/4);case"month":return date[monthGetterName(isUTC)]();case"day":return date[dateGetterName(isUTC)]();case"half-day":return date[hoursGetterName(isUTC)]()/24;case"hour":return date[hoursGetterName(isUTC)]();case"minute":return date[minutesGetterName(isUTC)]();case"second":return date[secondsGetterName(isUTC)]();case"millisecond":return date[millisecondsGetterName(isUTC)]()}}function fullYearGetterName(isUTC){return isUTC?"getUTCFullYear":"getFullYear"}function monthGetterName(isUTC){return isUTC?"getUTCMonth":"getMonth"}function dateGetterName(isUTC){return isUTC?"getUTCDate":"getDate"}function hoursGetterName(isUTC){return isUTC?"getUTCHours":"getHours"}function minutesGetterName(isUTC){return isUTC?"getUTCMinutes":"getMinutes"}function secondsGetterName(isUTC){return isUTC?"getUTCSeconds":"getSeconds"}function millisecondsGetterName(isUTC){return isUTC?"getUTCMilliseconds":"getMilliseconds"}function fullYearSetterName(isUTC){return isUTC?"setUTCFullYear":"setFullYear"}function monthSetterName(isUTC){return isUTC?"setUTCMonth":"setMonth"}function dateSetterName(isUTC){return isUTC?"setUTCDate":"setDate"}function hoursSetterName(isUTC){return isUTC?"setUTCHours":"setHours"}function minutesSetterName(isUTC){return isUTC?"setUTCMinutes":"setMinutes"}function secondsSetterName(isUTC){return isUTC?"setUTCSeconds":"setSeconds"}function millisecondsSetterName(isUTC){return isUTC?"setUTCMilliseconds":"setMilliseconds"}function addCommas(x){if(!isNumeric(x))return isString(x)?x:"-";var parts=(x+"").split(".");return parts[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(parts.length>1?"."+parts[1]:"")}function toCamelCase(str,upperCaseFirst){return str=(str||"").toLowerCase().replace(/-(.)/g,(function(match,group1){return group1.toUpperCase()})),upperCaseFirst&&str&&(str=str.charAt(0).toUpperCase()+str.slice(1)),str}var normalizeCssArray=normalizeCssArray$1;function makeValueReadable(value,valueType,useUTC){function stringToUserReadable(str){return str&&trim$1(str)?str:"-"}function isNumberUserReadable(num){return!(null==num||isNaN(num)||!isFinite(num))}var isTypeTime="time"===valueType,isValueDate=value instanceof Date;if(isTypeTime||isValueDate){var date=isTypeTime?parseDate(value):value;if(!isNaN(+date))return format$1(date,"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}",useUTC);if(isValueDate)return"-"}if("ordinal"===valueType)return isStringSafe(value)?stringToUserReadable(value):isNumber(value)&&isNumberUserReadable(value)?value+"":"-";var numericResult=numericToNumber(value);return isNumberUserReadable(numericResult)?addCommas(numericResult):isStringSafe(value)?stringToUserReadable(value):"boolean"==typeof value?value+"":"-"}var TPL_VAR_ALIAS=["a","b","c","d","e","f","g"],wrapVar=function(varName,seriesIdx){return"{"+varName+(null==seriesIdx?"":seriesIdx)+"}"};function formatTpl(tpl,paramsList,encode){isArray$1(paramsList)||(paramsList=[paramsList]);var seriesLen=paramsList.length;if(!seriesLen)return"";for(var $vars=paramsList[0].$vars||[],i=0;i<$vars.length;i++){var alias=TPL_VAR_ALIAS[i];tpl=tpl.replace(wrapVar(alias),wrapVar(alias,0))}for(var seriesIdx=0;seriesIdx<seriesLen;seriesIdx++)for(var k=0;k<$vars.length;k++){var val=paramsList[seriesIdx][$vars[k]];tpl=tpl.replace(wrapVar(TPL_VAR_ALIAS[k],seriesIdx),encode?encodeHTML(val):val)}return tpl}function getTooltipMarker(inOpt,extraCssText){var opt=isString(inOpt)?{color:inOpt,extraCssText:extraCssText}:inOpt||{},color2=opt.color,type=opt.type;extraCssText=opt.extraCssText;var renderMode=opt.renderMode||"html";return color2?"html"===renderMode?"subItem"===type?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+encodeHTML(color2)+";"+(extraCssText||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+encodeHTML(color2)+";"+(extraCssText||"")+'"></span>':{renderMode:renderMode,content:"{"+(opt.markerId||"markerX")+"|}  ",style:"subItem"===type?{width:4,height:4,borderRadius:2,backgroundColor:color2}:{width:10,height:10,borderRadius:5,backgroundColor:color2}}:""}function convertToColorString(color2,defaultColor){return defaultColor=defaultColor||"transparent",isString(color2)?color2:isObject$3(color2)&&color2.colorStops&&(color2.colorStops[0]||{}).color||defaultColor}function windowOpen(link,target){if("_blank"===target||"blank"===target){var blank=window.open();blank.opener=null,blank.location.href=link}else window.open(link,target)}var each$c=each$d,LOCATION_PARAMS=["left","right","top","bottom","width","height"],HV_NAMES=[["width","left","right"],["height","top","bottom"]];function boxLayout(orient,group,gap,maxWidth,maxHeight){var x=0,y=0;null==maxWidth&&(maxWidth=Infinity),null==maxHeight&&(maxHeight=Infinity);var currentLineMaxSize=0;group.eachChild((function(child,idx){var nextX,nextY,rect=child.getBoundingRect(),nextChild=group.childAt(idx+1),nextChildRect=nextChild&&nextChild.getBoundingRect();if("horizontal"===orient){var moveX=rect.width+(nextChildRect?-nextChildRect.x+rect.x:0);(nextX=x+moveX)>maxWidth||child.newline?(x=0,nextX=moveX,y+=currentLineMaxSize+gap,currentLineMaxSize=rect.height):currentLineMaxSize=Math.max(currentLineMaxSize,rect.height)}else{var moveY=rect.height+(nextChildRect?-nextChildRect.y+rect.y:0);(nextY=y+moveY)>maxHeight||child.newline?(x+=currentLineMaxSize+gap,y=0,nextY=moveY,currentLineMaxSize=rect.width):currentLineMaxSize=Math.max(currentLineMaxSize,rect.width)}child.newline||(child.x=x,child.y=y,child.markRedraw(),"horizontal"===orient?x=nextX+gap:y=nextY+gap)}))}var box=boxLayout;function getLayoutRect(positionInfo,containerRect,margin){margin=normalizeCssArray(margin||0);var containerWidth=containerRect.width,containerHeight=containerRect.height,left=parsePercent(positionInfo.left,containerWidth),top=parsePercent(positionInfo.top,containerHeight),right=parsePercent(positionInfo.right,containerWidth),bottom=parsePercent(positionInfo.bottom,containerHeight),width=parsePercent(positionInfo.width,containerWidth),height=parsePercent(positionInfo.height,containerHeight),verticalMargin=margin[2]+margin[0],horizontalMargin=margin[1]+margin[3],aspect=positionInfo.aspect;switch(isNaN(width)&&(width=containerWidth-right-horizontalMargin-left),isNaN(height)&&(height=containerHeight-bottom-verticalMargin-top),null!=aspect&&(isNaN(width)&&isNaN(height)&&(aspect>containerWidth/containerHeight?width=.8*containerWidth:height=.8*containerHeight),isNaN(width)&&(width=aspect*height),isNaN(height)&&(height=width/aspect)),isNaN(left)&&(left=containerWidth-right-width-horizontalMargin),isNaN(top)&&(top=containerHeight-bottom-height-verticalMargin),positionInfo.left||positionInfo.right){case"center":left=containerWidth/2-width/2-margin[3];break;case"right":left=containerWidth-width-horizontalMargin}switch(positionInfo.top||positionInfo.bottom){case"middle":case"center":top=containerHeight/2-height/2-margin[0];break;case"bottom":top=containerHeight-height-verticalMargin}left=left||0,top=top||0,isNaN(width)&&(width=containerWidth-horizontalMargin-left-(right||0)),isNaN(height)&&(height=containerHeight-verticalMargin-top-(bottom||0));var rect=new BoundingRect(left+margin[3],top+margin[0],width,height);return rect.margin=margin,rect}function positionElement(el,positionInfo,containerRect,margin,opt,out2){var rect,h=!opt||!opt.hv||opt.hv[0],v=!opt||!opt.hv||opt.hv[1],boundingMode=opt&&opt.boundingMode||"all";if((out2=out2||el).x=el.x,out2.y=el.y,!h&&!v)return!1;if("raw"===boundingMode)rect="group"===el.type?new BoundingRect(0,0,+positionInfo.width||0,+positionInfo.height||0):el.getBoundingRect();else if(rect=el.getBoundingRect(),el.needLocalTransform()){var transform=el.getLocalTransform();(rect=rect.clone()).applyTransform(transform)}var layoutRect=getLayoutRect(defaults({width:rect.width,height:rect.height},positionInfo),containerRect,margin),dx=h?layoutRect.x-rect.x:0,dy=v?layoutRect.y-rect.y:0;return"raw"===boundingMode?(out2.x=dx,out2.y=dy):(out2.x+=dx,out2.y+=dy),out2===el&&el.markRedraw(),!0}function fetchLayoutMode(ins){var layoutMode=ins.layoutMode||ins.constructor.layoutMode;return isObject$3(layoutMode)?layoutMode:layoutMode?{type:layoutMode}:null}function mergeLayoutParam(targetOption,newOption,opt){var ignoreSize=opt&&opt.ignoreSize;!isArray$1(ignoreSize)&&(ignoreSize=[ignoreSize,ignoreSize]);var hResult=merge2(HV_NAMES[0],0),vResult=merge2(HV_NAMES[1],1);function merge2(names,hvIdx){var newParams={},newValueCount=0,merged={},mergedValueCount=0;if(each$c(names,(function(name){merged[name]=targetOption[name]})),each$c(names,(function(name){hasProp(newOption,name)&&(newParams[name]=merged[name]=newOption[name]),hasValue(newParams,name)&&newValueCount++,hasValue(merged,name)&&mergedValueCount++})),ignoreSize[hvIdx])return hasValue(newOption,names[1])?merged[names[2]]=null:hasValue(newOption,names[2])&&(merged[names[1]]=null),merged;if(2!==mergedValueCount&&newValueCount){if(newValueCount>=2)return newParams;for(var i=0;i<names.length;i++){var name_1=names[i];if(!hasProp(newParams,name_1)&&hasProp(targetOption,name_1)){newParams[name_1]=targetOption[name_1];break}}return newParams}return merged}function hasProp(obj,name){return obj.hasOwnProperty(name)}function hasValue(obj,name){return null!=obj[name]&&"auto"!==obj[name]}function copy2(names,target,source){each$c(names,(function(name){target[name]=source[name]}))}copy2(HV_NAMES[0],targetOption,hResult),copy2(HV_NAMES[1],targetOption,vResult)}function getLayoutParams(source){return copyLayoutParams({},source)}function copyLayoutParams(target,source){return source&&target&&each$c(LOCATION_PARAMS,(function(name){source.hasOwnProperty(name)&&(target[name]=source[name])})),target}curry$1(boxLayout,"vertical"),curry$1(boxLayout,"horizontal");var inner$e=makeInner(),ComponentModel=function(_super){function ComponentModel2(option,parentModel,ecModel){var _this=_super.call(this,option,parentModel,ecModel)||this;return _this.uid=getUID("ec_cpt_model"),_this}var proto2;return __extends(ComponentModel2,_super),ComponentModel2.prototype.init=function(option,parentModel,ecModel){this.mergeDefaultAndTheme(option,ecModel)},ComponentModel2.prototype.mergeDefaultAndTheme=function(option,ecModel){var layoutMode=fetchLayoutMode(this),inputPositionParams=layoutMode?getLayoutParams(option):{};merge(option,ecModel.getTheme().get(this.mainType)),merge(option,this.getDefaultOption()),layoutMode&&mergeLayoutParam(option,inputPositionParams,layoutMode)},ComponentModel2.prototype.mergeOption=function(option,ecModel){merge(this.option,option,!0);var layoutMode=fetchLayoutMode(this);layoutMode&&mergeLayoutParam(this.option,option,layoutMode)},ComponentModel2.prototype.optionUpdated=function(newCptOption,isInit){},ComponentModel2.prototype.getDefaultOption=function(){var ctor=this.constructor;if(!function(clz){return!(!clz||!clz.___EC__EXTENDED_CLASS___)}(ctor))return ctor.defaultOption;var fields=inner$e(this);if(!fields.defaultOption){for(var optList=[],clz=ctor;clz;){var opt=clz.prototype.defaultOption;opt&&optList.push(opt),clz=clz.superClass}for(var defaultOption2={},i=optList.length-1;i>=0;i--)defaultOption2=merge(defaultOption2,optList[i],!0);fields.defaultOption=defaultOption2}return fields.defaultOption},ComponentModel2.prototype.getReferringComponents=function(mainType,opt){var indexKey=mainType+"Index",idKey=mainType+"Id";return queryReferringComponents(this.ecModel,mainType,{index:this.get(indexKey,!0),id:this.get(idKey,!0)},opt)},ComponentModel2.prototype.getBoxLayoutParams=function(){return{left:this.get("left"),top:this.get("top"),right:this.get("right"),bottom:this.get("bottom"),width:this.get("width"),height:this.get("height")}},ComponentModel2.prototype.getZLevelKey=function(){return""},ComponentModel2.prototype.setZLevel=function(zlevel){this.option.zlevel=zlevel},ComponentModel2.protoInitialize=((proto2=ComponentModel2.prototype).type="component",proto2.id="",proto2.name="",proto2.mainType="",proto2.subType="",void(proto2.componentIndex=0)),ComponentModel2}(Model);mountExtend(ComponentModel,Model),enableClassManagement(ComponentModel),function(target){var subTypeDefaulters={};target.registerSubTypeDefaulter=function(componentType,defaulter){var componentTypeInfo=parseClassType(componentType);subTypeDefaulters[componentTypeInfo.main]=defaulter},target.determineSubType=function(componentType,option){var type=option.type;if(!type){var componentTypeMain=parseClassType(componentType).main;target.hasSubTypes(componentType)&&subTypeDefaulters[componentTypeMain]&&(type=subTypeDefaulters[componentTypeMain](option))}return type}}(ComponentModel),function(entity,dependencyGetter){function createDependencyGraphItem(graph,name){return graph[name]||(graph[name]={predecessor:[],successor:[]}),graph[name]}entity.topologicalTravel=function(targetNameList,fullNameList,callback,context){if(targetNameList.length){var result=function(fullNameList){var graph={},noEntryList=[];return each$d(fullNameList,(function(name){var thisItem=createDependencyGraphItem(graph,name),availableDeps=function(originalDeps,fullNameList){var availableDeps=[];return each$d(originalDeps,(function(dep){indexOf(fullNameList,dep)>=0&&availableDeps.push(dep)})),availableDeps}(thisItem.originalDeps=dependencyGetter(name),fullNameList);thisItem.entryCount=availableDeps.length,0===thisItem.entryCount&&noEntryList.push(name),each$d(availableDeps,(function(dependentName){indexOf(thisItem.predecessor,dependentName)<0&&thisItem.predecessor.push(dependentName);var thatItem=createDependencyGraphItem(graph,dependentName);indexOf(thatItem.successor,dependentName)<0&&thatItem.successor.push(name)}))})),{graph:graph,noEntryList:noEntryList}}(fullNameList),graph=result.graph,noEntryList=result.noEntryList,targetNameSet={};for(each$d(targetNameList,(function(name){targetNameSet[name]=!0}));noEntryList.length;){var currComponentType=noEntryList.pop(),currVertex=graph[currComponentType],isInTargetNameSet=!!targetNameSet[currComponentType];isInTargetNameSet&&(callback.call(context,currComponentType,currVertex.originalDeps.slice()),delete targetNameSet[currComponentType]),each$d(currVertex.successor,isInTargetNameSet?removeEdgeAndAdd:removeEdge)}each$d(targetNameSet,(function(){throw new Error("")}))}function removeEdge(succComponentType){graph[succComponentType].entryCount--,0===graph[succComponentType].entryCount&&noEntryList.push(succComponentType)}function removeEdgeAndAdd(succComponentType){targetNameSet[succComponentType]=!0,removeEdge(succComponentType)}}}(ComponentModel,(function(componentType){var deps=[];each$d(ComponentModel.getClassesByMainType(componentType),(function(clz){deps=deps.concat(clz.dependencies||clz.prototype.dependencies||[])})),deps=map$1(deps,(function(type){return parseClassType(type).main})),"dataset"!==componentType&&indexOf(deps,"dataset")<=0&&deps.unshift("dataset");return deps}));var platform="";"undefined"!=typeof navigator&&(platform=navigator.platform||"");var decalColor="rgba(0, 0, 0, 0.2)";const globalDefault={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:decalColor,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:decalColor,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:decalColor,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:decalColor,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:decalColor,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:decalColor,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:platform.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var VISUAL_DIMENSIONS=createHashMap(["tooltip","label","itemName","itemId","itemGroupId","itemChildGroupId","seriesName"]),BE_ORDINAL_Must=1,BE_ORDINAL_Might=2,BE_ORDINAL_Not=3,innerGlobalModel=makeInner();function makeSeriesEncodeForAxisCoordSys(coordDimensions,seriesModel,source){var encode={},datasetModel=querySeriesUpstreamDatasetModel(seriesModel);if(!datasetModel||!coordDimensions)return encode;var baseCategoryDimIndex,categoryWayValueDimStart,encodeItemName=[],encodeSeriesName=[],ecModel=seriesModel.ecModel,datasetMap=innerGlobalModel(ecModel).datasetMap,key=datasetModel.uid+"_"+source.seriesLayoutBy;each$d(coordDimensions=coordDimensions.slice(),(function(coordDimInfoLoose,coordDimIdx){var coordDimInfo=isObject$3(coordDimInfoLoose)?coordDimInfoLoose:coordDimensions[coordDimIdx]={name:coordDimInfoLoose};"ordinal"===coordDimInfo.type&&null==baseCategoryDimIndex&&(baseCategoryDimIndex=coordDimIdx,categoryWayValueDimStart=getDataDimCountOnCoordDim(coordDimInfo)),encode[coordDimInfo.name]=[]}));var datasetRecord=datasetMap.get(key)||datasetMap.set(key,{categoryWayDim:categoryWayValueDimStart,valueWayDim:0});function pushDim(dimIdxArr,idxFrom,idxCount){for(var i=0;i<idxCount;i++)dimIdxArr.push(idxFrom+i)}function getDataDimCountOnCoordDim(coordDimInfo){var dimsDef=coordDimInfo.dimsDef;return dimsDef?dimsDef.length:1}return each$d(coordDimensions,(function(coordDimInfo,coordDimIdx){var coordDimName=coordDimInfo.name,count2=getDataDimCountOnCoordDim(coordDimInfo);if(null==baseCategoryDimIndex){var start2=datasetRecord.valueWayDim;pushDim(encode[coordDimName],start2,count2),pushDim(encodeSeriesName,start2,count2),datasetRecord.valueWayDim+=count2}else if(baseCategoryDimIndex===coordDimIdx)pushDim(encode[coordDimName],0,count2),pushDim(encodeItemName,0,count2);else{start2=datasetRecord.categoryWayDim;pushDim(encode[coordDimName],start2,count2),pushDim(encodeSeriesName,start2,count2),datasetRecord.categoryWayDim+=count2}})),encodeItemName.length&&(encode.itemName=encodeItemName),encodeSeriesName.length&&(encode.seriesName=encodeSeriesName),encode}function makeSeriesEncodeForNameBased(seriesModel,source,dimCount){var encode={};if(!querySeriesUpstreamDatasetModel(seriesModel))return encode;var potentialNameDimIndex,sourceFormat=source.sourceFormat,dimensionsDefine=source.dimensionsDefine;"objectRows"!==sourceFormat&&"keyedColumns"!==sourceFormat||each$d(dimensionsDefine,(function(dim,idx){"name"===(isObject$3(dim)?dim.name:dim)&&(potentialNameDimIndex=idx)}));var idxResult=function(){for(var idxRes0={},idxRes1={},guessRecords=[],i=0,len2=Math.min(5,dimCount);i<len2;i++){var guessResult=doGuessOrdinal(source.data,sourceFormat,source.seriesLayoutBy,dimensionsDefine,source.startIndex,i);guessRecords.push(guessResult);var isPureNumber=guessResult===BE_ORDINAL_Not;if(isPureNumber&&null==idxRes0.v&&i!==potentialNameDimIndex&&(idxRes0.v=i),(null==idxRes0.n||idxRes0.n===idxRes0.v||!isPureNumber&&guessRecords[idxRes0.n]===BE_ORDINAL_Not)&&(idxRes0.n=i),fulfilled(idxRes0)&&guessRecords[idxRes0.n]!==BE_ORDINAL_Not)return idxRes0;isPureNumber||(guessResult===BE_ORDINAL_Might&&null==idxRes1.v&&i!==potentialNameDimIndex&&(idxRes1.v=i),null!=idxRes1.n&&idxRes1.n!==idxRes1.v||(idxRes1.n=i))}function fulfilled(idxResult2){return null!=idxResult2.v&&null!=idxResult2.n}return fulfilled(idxRes0)?idxRes0:fulfilled(idxRes1)?idxRes1:null}();if(idxResult){encode.value=[idxResult.v];var nameDimIndex=null!=potentialNameDimIndex?potentialNameDimIndex:idxResult.n;encode.itemName=[nameDimIndex],encode.seriesName=[nameDimIndex]}return encode}function querySeriesUpstreamDatasetModel(seriesModel){if(!seriesModel.get("data",!0))return queryReferringComponents(seriesModel.ecModel,"dataset",{index:seriesModel.get("datasetIndex",!0),id:seriesModel.get("datasetId",!0)},SINGLE_REFERRING).models[0]}function guessOrdinal(source,dimIndex){return doGuessOrdinal(source.data,source.sourceFormat,source.seriesLayoutBy,source.dimensionsDefine,source.startIndex,dimIndex)}function doGuessOrdinal(data,sourceFormat,seriesLayoutBy,dimensionsDefine,startIndex,dimIndex){var result,dimName,dimType;if(isTypedArray(data))return BE_ORDINAL_Not;if(dimensionsDefine){var dimDefItem=dimensionsDefine[dimIndex];isObject$3(dimDefItem)?(dimName=dimDefItem.name,dimType=dimDefItem.type):isString(dimDefItem)&&(dimName=dimDefItem)}if(null!=dimType)return"ordinal"===dimType?BE_ORDINAL_Must:BE_ORDINAL_Not;if("arrayRows"===sourceFormat){var dataArrayRows=data;if("row"===seriesLayoutBy){for(var sample=dataArrayRows[dimIndex],i=0;i<(sample||[]).length&&i<5;i++)if(null!=(result=detectValue(sample[startIndex+i])))return result}else for(i=0;i<dataArrayRows.length&&i<5;i++){var row=dataArrayRows[startIndex+i];if(row&&null!=(result=detectValue(row[dimIndex])))return result}}else if("objectRows"===sourceFormat){var dataObjectRows=data;if(!dimName)return BE_ORDINAL_Not;for(i=0;i<dataObjectRows.length&&i<5;i++){if((item=dataObjectRows[i])&&null!=(result=detectValue(item[dimName])))return result}}else if("keyedColumns"===sourceFormat){if(!dimName)return BE_ORDINAL_Not;if(!(sample=data[dimName])||isTypedArray(sample))return BE_ORDINAL_Not;for(i=0;i<sample.length&&i<5;i++)if(null!=(result=detectValue(sample[i])))return result}else if("original"===sourceFormat){var dataOriginal=data;for(i=0;i<dataOriginal.length&&i<5;i++){var item,val=getDataItemValue(item=dataOriginal[i]);if(!isArray$1(val))return BE_ORDINAL_Not;if(null!=(result=detectValue(val[dimIndex])))return result}}function detectValue(val2){var beStr=isString(val2);return null!=val2&&Number.isFinite(Number(val2))&&""!==val2?beStr?BE_ORDINAL_Might:BE_ORDINAL_Not:beStr&&"-"!==val2?BE_ORDINAL_Must:void 0}return BE_ORDINAL_Not}var internalOptionCreatorMap=createHashMap();var reCreateSeriesIndices,assertSeriesInitialized,initBase,innerColor=makeInner(),innerDecal=makeInner(),PaletteMixin=function(){function PaletteMixin2(){}return PaletteMixin2.prototype.getColorFromPalette=function(name,scope,requestNum){var defaultPalette=normalizeToArray(this.get("color",!0)),layeredPalette=this.get("colorLayer",!0);return getFromPalette(this,innerColor,defaultPalette,layeredPalette,name,scope,requestNum)},PaletteMixin2.prototype.clearColorPalette=function(){var that,inner2;(inner2=innerColor)(that=this).paletteIdx=0,inner2(that).paletteNameMap={}},PaletteMixin2}();function getDecalFromPalette(ecModel,name,scope,requestNum){var defaultDecals=normalizeToArray(ecModel.get(["aria","decal","decals"]));return getFromPalette(ecModel,innerDecal,defaultDecals,null,name,scope,requestNum)}function getFromPalette(that,inner2,defaultPalette,layeredPalette,name,scope,requestNum){var scopeFields=inner2(scope=scope||that),paletteIdx=scopeFields.paletteIdx||0,paletteNameMap=scopeFields.paletteNameMap=scopeFields.paletteNameMap||{};if(paletteNameMap.hasOwnProperty(name))return paletteNameMap[name];var palette=null!=requestNum&&layeredPalette?function(palettes,requestColorNum){for(var paletteNum=palettes.length,i=0;i<paletteNum;i++)if(palettes[i].length>requestColorNum)return palettes[i];return palettes[paletteNum-1]}(layeredPalette,requestNum):defaultPalette;if((palette=palette||defaultPalette)&&palette.length){var pickedPaletteItem=palette[paletteIdx];return name&&(paletteNameMap[name]=pickedPaletteItem),scopeFields.paletteIdx=(paletteIdx+1)%palette.length,pickedPaletteItem}}var GlobalModel=function(_super){function GlobalModel2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(GlobalModel2,_super),GlobalModel2.prototype.init=function(option,parentModel,ecModel,theme2,locale,optionManager){theme2=theme2||{},this.option=null,this._theme=new Model(theme2),this._locale=new Model(locale),this._optionManager=optionManager},GlobalModel2.prototype.setOption=function(option,opts,optionPreprocessorFuncs2){var innerOpt=normalizeSetOptionInput(opts);this._optionManager.setOption(option,optionPreprocessorFuncs2,innerOpt),this._resetOption(null,innerOpt)},GlobalModel2.prototype.resetOption=function(type,opt){return this._resetOption(type,normalizeSetOptionInput(opt))},GlobalModel2.prototype._resetOption=function(type,opt){var optionChanged=!1,optionManager=this._optionManager;if(!type||"recreate"===type){var baseOption=optionManager.mountOption("recreate"===type);this.option&&"recreate"!==type?(this.restoreData(),this._mergeOption(baseOption,opt)):initBase(this,baseOption),optionChanged=!0}if("timeline"!==type&&"media"!==type||this.restoreData(),!type||"recreate"===type||"timeline"===type){var timelineOption=optionManager.getTimelineOption(this);timelineOption&&(optionChanged=!0,this._mergeOption(timelineOption,opt))}if(!type||"recreate"===type||"media"===type){var mediaOptions=optionManager.getMediaOption(this);mediaOptions.length&&each$d(mediaOptions,(function(mediaOption){optionChanged=!0,this._mergeOption(mediaOption,opt)}),this)}return optionChanged},GlobalModel2.prototype.mergeOption=function(option){this._mergeOption(option,null)},GlobalModel2.prototype._mergeOption=function(newOption,opt){var option=this.option,componentsMap=this._componentsMap,componentsCount=this._componentsCount,newCmptTypes=[],newCmptTypeMap=createHashMap(),replaceMergeMainTypeMap=opt&&opt.replaceMergeMainTypeMap;innerGlobalModel(this).datasetMap=createHashMap(),each$d(newOption,(function(componentOption,mainType){null!=componentOption&&(ComponentModel.hasClass(mainType)?mainType&&(newCmptTypes.push(mainType),newCmptTypeMap.set(mainType,!0)):option[mainType]=null==option[mainType]?clone$3(componentOption):merge(option[mainType],componentOption,!0))})),replaceMergeMainTypeMap&&replaceMergeMainTypeMap.each((function(val,mainTypeInReplaceMerge){ComponentModel.hasClass(mainTypeInReplaceMerge)&&!newCmptTypeMap.get(mainTypeInReplaceMerge)&&(newCmptTypes.push(mainTypeInReplaceMerge),newCmptTypeMap.set(mainTypeInReplaceMerge,!0))})),ComponentModel.topologicalTravel(newCmptTypes,ComponentModel.getAllClassMainTypes(),(function(mainType){var newCmptOptionList=function(ecModel,mainType,newCmptOptionList){var internalOptionCreator=internalOptionCreatorMap.get(mainType);if(!internalOptionCreator)return newCmptOptionList;var internalOptions=internalOptionCreator(ecModel);return internalOptions?newCmptOptionList.concat(internalOptions):newCmptOptionList}(this,mainType,normalizeToArray(newOption[mainType])),oldCmptList=componentsMap.get(mainType),mergeMode=oldCmptList?replaceMergeMainTypeMap&&replaceMergeMainTypeMap.get(mainType)?"replaceMerge":"normalMerge":"replaceAll",mappingResult=mappingToExists(oldCmptList,newCmptOptionList,mergeMode);(function(mappingResult,mainType,componentModelCtor){each$d(mappingResult,(function(item){var newOption=item.newOption;isObject$3(newOption)&&(item.keyInfo.mainType=mainType,item.keyInfo.subType=function(mainType,newCmptOption,existComponent,componentModelCtor){return newCmptOption.type?newCmptOption.type:existComponent?existComponent.subType:componentModelCtor.determineSubType(mainType,newCmptOption)}(mainType,newOption,item.existing,componentModelCtor))}))})(mappingResult,mainType,ComponentModel),option[mainType]=null,componentsMap.set(mainType,null),componentsCount.set(mainType,0);var tooltipExists,optionsByMainType=[],cmptsByMainType=[],cmptsCountByMainType=0;each$d(mappingResult,(function(resultItem,index){var componentModel=resultItem.existing,newCmptOption=resultItem.newOption;if(newCmptOption){var isSeriesType="series"===mainType,ComponentModelClass=ComponentModel.getClass(mainType,resultItem.keyInfo.subType,!isSeriesType);if(!ComponentModelClass)return;if("tooltip"===mainType){if(tooltipExists)return;tooltipExists=!0}if(componentModel&&componentModel.constructor===ComponentModelClass)componentModel.name=resultItem.keyInfo.name,componentModel.mergeOption(newCmptOption,this),componentModel.optionUpdated(newCmptOption,!1);else{var extraOpt=extend({componentIndex:index},resultItem.keyInfo);extend(componentModel=new ComponentModelClass(newCmptOption,this,this,extraOpt),extraOpt),resultItem.brandNew&&(componentModel.__requireNewView=!0),componentModel.init(newCmptOption,this,this),componentModel.optionUpdated(null,!0)}}else componentModel&&(componentModel.mergeOption({},this),componentModel.optionUpdated({},!1));componentModel?(optionsByMainType.push(componentModel.option),cmptsByMainType.push(componentModel),cmptsCountByMainType++):(optionsByMainType.push(void 0),cmptsByMainType.push(void 0))}),this),option[mainType]=optionsByMainType,componentsMap.set(mainType,cmptsByMainType),componentsCount.set(mainType,cmptsCountByMainType),"series"===mainType&&reCreateSeriesIndices(this)}),this),this._seriesIndices||reCreateSeriesIndices(this)},GlobalModel2.prototype.getOption=function(){var option=clone$3(this.option);return each$d(option,(function(optInMainType,mainType){if(ComponentModel.hasClass(mainType)){for(var opts=normalizeToArray(optInMainType),realLen=opts.length,metNonInner=!1,i=realLen-1;i>=0;i--)opts[i]&&!isComponentIdInternal(opts[i])?metNonInner=!0:(opts[i]=null,!metNonInner&&realLen--);opts.length=realLen,option[mainType]=opts}})),delete option["\0_ec_inner"],option},GlobalModel2.prototype.getTheme=function(){return this._theme},GlobalModel2.prototype.getLocaleModel=function(){return this._locale},GlobalModel2.prototype.setUpdatePayload=function(payload){this._payload=payload},GlobalModel2.prototype.getUpdatePayload=function(){return this._payload},GlobalModel2.prototype.getComponent=function(mainType,idx){var list=this._componentsMap.get(mainType);if(list){var cmpt=list[idx||0];if(cmpt)return cmpt;if(null==idx)for(var i=0;i<list.length;i++)if(list[i])return list[i]}},GlobalModel2.prototype.queryComponents=function(condition){var mainType=condition.mainType;if(!mainType)return[];var result,index=condition.index,id=condition.id,name=condition.name,cmpts=this._componentsMap.get(mainType);return cmpts&&cmpts.length?(null!=index?(result=[],each$d(normalizeToArray(index),(function(idx){cmpts[idx]&&result.push(cmpts[idx])}))):result=null!=id?queryByIdOrName("id",id,cmpts):null!=name?queryByIdOrName("name",name,cmpts):filter(cmpts,(function(cmpt){return!!cmpt})),filterBySubType(result,condition)):[]},GlobalModel2.prototype.findComponents=function(condition){var q,indexAttr,idAttr,nameAttr,res,query=condition.query,mainType=condition.mainType,queryCond=(indexAttr=mainType+"Index",idAttr=mainType+"Id",nameAttr=mainType+"Name",!(q=query)||null==q[indexAttr]&&null==q[idAttr]&&null==q[nameAttr]?null:{mainType:mainType,index:q[indexAttr],id:q[idAttr],name:q[nameAttr]}),result=queryCond?this.queryComponents(queryCond):filter(this._componentsMap.get(mainType),(function(cmpt){return!!cmpt}));return res=filterBySubType(result,condition),condition.filter?filter(res,condition.filter):res},GlobalModel2.prototype.eachComponent=function(mainType,cb,context){var componentsMap=this._componentsMap;if(isFunction(mainType)){var ctxForAll_1=cb,cbForAll_1=mainType;componentsMap.each((function(cmpts2,componentType){for(var i2=0;cmpts2&&i2<cmpts2.length;i2++){var cmpt2=cmpts2[i2];cmpt2&&cbForAll_1.call(ctxForAll_1,componentType,cmpt2,cmpt2.componentIndex)}}))}else for(var cmpts=isString(mainType)?componentsMap.get(mainType):isObject$3(mainType)?this.findComponents(mainType):null,i=0;cmpts&&i<cmpts.length;i++){var cmpt=cmpts[i];cmpt&&cb.call(context,cmpt,cmpt.componentIndex)}},GlobalModel2.prototype.getSeriesByName=function(name){var nameStr=convertOptionIdName(name,null);return filter(this._componentsMap.get("series"),(function(oneSeries){return!!oneSeries&&null!=nameStr&&oneSeries.name===nameStr}))},GlobalModel2.prototype.getSeriesByIndex=function(seriesIndex){return this._componentsMap.get("series")[seriesIndex]},GlobalModel2.prototype.getSeriesByType=function(subType){return filter(this._componentsMap.get("series"),(function(oneSeries){return!!oneSeries&&oneSeries.subType===subType}))},GlobalModel2.prototype.getSeries=function(){return filter(this._componentsMap.get("series"),(function(oneSeries){return!!oneSeries}))},GlobalModel2.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},GlobalModel2.prototype.eachSeries=function(cb,context){assertSeriesInitialized(this),each$d(this._seriesIndices,(function(rawSeriesIndex){var series=this._componentsMap.get("series")[rawSeriesIndex];cb.call(context,series,rawSeriesIndex)}),this)},GlobalModel2.prototype.eachRawSeries=function(cb,context){each$d(this._componentsMap.get("series"),(function(series){series&&cb.call(context,series,series.componentIndex)}))},GlobalModel2.prototype.eachSeriesByType=function(subType,cb,context){assertSeriesInitialized(this),each$d(this._seriesIndices,(function(rawSeriesIndex){var series=this._componentsMap.get("series")[rawSeriesIndex];series.subType===subType&&cb.call(context,series,rawSeriesIndex)}),this)},GlobalModel2.prototype.eachRawSeriesByType=function(subType,cb,context){return each$d(this.getSeriesByType(subType),cb,context)},GlobalModel2.prototype.isSeriesFiltered=function(seriesModel){return assertSeriesInitialized(this),null==this._seriesIndicesMap.get(seriesModel.componentIndex)},GlobalModel2.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},GlobalModel2.prototype.filterSeries=function(cb,context){assertSeriesInitialized(this);var newSeriesIndices=[];each$d(this._seriesIndices,(function(seriesRawIdx){var series=this._componentsMap.get("series")[seriesRawIdx];cb.call(context,series,seriesRawIdx)&&newSeriesIndices.push(seriesRawIdx)}),this),this._seriesIndices=newSeriesIndices,this._seriesIndicesMap=createHashMap(newSeriesIndices)},GlobalModel2.prototype.restoreData=function(payload){reCreateSeriesIndices(this);var componentsMap=this._componentsMap,componentTypes=[];componentsMap.each((function(components,componentType){ComponentModel.hasClass(componentType)&&componentTypes.push(componentType)})),ComponentModel.topologicalTravel(componentTypes,ComponentModel.getAllClassMainTypes(),(function(componentType){each$d(componentsMap.get(componentType),(function(component){!component||"series"===componentType&&function(seriesModel,payload){if(payload){var index=payload.seriesIndex,id=payload.seriesId,name_1=payload.seriesName;return null!=index&&seriesModel.componentIndex!==index||null!=id&&seriesModel.id!==id||null!=name_1&&seriesModel.name!==name_1}}(component,payload)||component.restoreData()}))}))},GlobalModel2.internalField=(reCreateSeriesIndices=function(ecModel){var seriesIndices=ecModel._seriesIndices=[];each$d(ecModel._componentsMap.get("series"),(function(series){series&&seriesIndices.push(series.componentIndex)})),ecModel._seriesIndicesMap=createHashMap(seriesIndices)},assertSeriesInitialized=function(ecModel){},void(initBase=function(ecModel,baseOption){ecModel.option={},ecModel.option["\0_ec_inner"]=1,ecModel._componentsMap=createHashMap({series:[]}),ecModel._componentsCount=createHashMap();var option,theme2,notMergeColorLayer,airaOption=baseOption.aria;isObject$3(airaOption)&&null==airaOption.enabled&&(airaOption.enabled=!0),option=baseOption,theme2=ecModel._theme.option,notMergeColorLayer=option.color&&!option.colorLayer,each$d(theme2,(function(themeItem,name){"colorLayer"===name&&notMergeColorLayer||ComponentModel.hasClass(name)||("object"==typeof themeItem?option[name]=option[name]?merge(option[name],themeItem,!1):clone$3(themeItem):null==option[name]&&(option[name]=themeItem))})),merge(baseOption,globalDefault,!1),ecModel._mergeOption(baseOption,null)})),GlobalModel2}(Model);function queryByIdOrName(attr,idOrName,cmpts){if(isArray$1(idOrName)){var keyMap_1=createHashMap();return each$d(idOrName,(function(idOrNameItem){null!=idOrNameItem&&(null!=convertOptionIdName(idOrNameItem,null)&&keyMap_1.set(idOrNameItem,!0))})),filter(cmpts,(function(cmpt){return cmpt&&keyMap_1.get(cmpt[attr])}))}var idName_1=convertOptionIdName(idOrName,null);return filter(cmpts,(function(cmpt){return cmpt&&null!=idName_1&&cmpt[attr]===idName_1}))}function filterBySubType(components,condition){return condition.hasOwnProperty("subType")?filter(components,(function(cmpt){return cmpt&&cmpt.subType===condition.subType})):components}function normalizeSetOptionInput(opts){var replaceMergeMainTypeMap=createHashMap();return opts&&each$d(normalizeToArray(opts.replaceMerge),(function(mainType){replaceMergeMainTypeMap.set(mainType,!0)})),{replaceMergeMainTypeMap:replaceMergeMainTypeMap}}mixin(GlobalModel,PaletteMixin);var availableMethods=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],ExtensionAPI=function(){return function(ecInstance){each$d(availableMethods,(function(methodName){this[methodName]=bind$1(ecInstance[methodName],ecInstance)}),this)}}(),coordinateSystemCreators={},CoordinateSystemManager=function(){function CoordinateSystemManager2(){this._coordinateSystems=[]}return CoordinateSystemManager2.prototype.create=function(ecModel,api){var coordinateSystems=[];each$d(coordinateSystemCreators,(function(creator,type){var list=creator.create(ecModel,api);coordinateSystems=coordinateSystems.concat(list||[])})),this._coordinateSystems=coordinateSystems},CoordinateSystemManager2.prototype.update=function(ecModel,api){each$d(this._coordinateSystems,(function(coordSys){coordSys.update&&coordSys.update(ecModel,api)}))},CoordinateSystemManager2.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},CoordinateSystemManager2.register=function(type,creator){coordinateSystemCreators[type]=creator},CoordinateSystemManager2.get=function(type){return coordinateSystemCreators[type]},CoordinateSystemManager2}(),QUERY_REG=/^(min|max)?(.+)$/,OptionManager=function(){function OptionManager2(api){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=api}return OptionManager2.prototype.setOption=function(rawOption,optionPreprocessorFuncs2,opt){rawOption&&(each$d(normalizeToArray(rawOption.series),(function(series){series&&series.data&&isTypedArray(series.data)&&setAsPrimitive(series.data)})),each$d(normalizeToArray(rawOption.dataset),(function(dataset){dataset&&dataset.source&&isTypedArray(dataset.source)&&setAsPrimitive(dataset.source)}))),rawOption=clone$3(rawOption);var optionBackup=this._optionBackup,newParsedOption=function(rawOption,optionPreprocessorFuncs2,isNew){var mediaDefault,baseOption,mediaList=[],declaredBaseOption=rawOption.baseOption,timelineOnRoot=rawOption.timeline,timelineOptionsOnRoot=rawOption.options,mediaOnRoot=rawOption.media,hasMedia=!!rawOption.media,hasTimeline=!!(timelineOptionsOnRoot||timelineOnRoot||declaredBaseOption&&declaredBaseOption.timeline);declaredBaseOption?(baseOption=declaredBaseOption).timeline||(baseOption.timeline=timelineOnRoot):((hasTimeline||hasMedia)&&(rawOption.options=rawOption.media=null),baseOption=rawOption);hasMedia&&isArray$1(mediaOnRoot)&&each$d(mediaOnRoot,(function(singleMedia){singleMedia&&singleMedia.option&&(singleMedia.query?mediaList.push(singleMedia):mediaDefault||(mediaDefault=singleMedia))}));function doPreprocess(option){each$d(optionPreprocessorFuncs2,(function(preProcess){preProcess(option,isNew)}))}return doPreprocess(baseOption),each$d(timelineOptionsOnRoot,(function(option){return doPreprocess(option)})),each$d(mediaList,(function(media){return doPreprocess(media.option)})),{baseOption:baseOption,timelineOptions:timelineOptionsOnRoot||[],mediaDefault:mediaDefault,mediaList:mediaList}}(rawOption,optionPreprocessorFuncs2,!optionBackup);this._newBaseOption=newParsedOption.baseOption,optionBackup?(newParsedOption.timelineOptions.length&&(optionBackup.timelineOptions=newParsedOption.timelineOptions),newParsedOption.mediaList.length&&(optionBackup.mediaList=newParsedOption.mediaList),newParsedOption.mediaDefault&&(optionBackup.mediaDefault=newParsedOption.mediaDefault)):this._optionBackup=newParsedOption},OptionManager2.prototype.mountOption=function(isRecreate){var optionBackup=this._optionBackup;return this._timelineOptions=optionBackup.timelineOptions,this._mediaList=optionBackup.mediaList,this._mediaDefault=optionBackup.mediaDefault,this._currentMediaIndices=[],clone$3(isRecreate?optionBackup.baseOption:this._newBaseOption)},OptionManager2.prototype.getTimelineOption=function(ecModel){var option,timelineOptions=this._timelineOptions;if(timelineOptions.length){var timelineModel=ecModel.getComponent("timeline");timelineModel&&(option=clone$3(timelineOptions[timelineModel.getCurrentIndex()]))}return option},OptionManager2.prototype.getMediaOption=function(ecModel){var indices1,indices2,ecWidth=this._api.getWidth(),ecHeight=this._api.getHeight(),mediaList=this._mediaList,mediaDefault=this._mediaDefault,indices=[],result=[];if(!mediaList.length&&!mediaDefault)return result;for(var i=0,len2=mediaList.length;i<len2;i++)applyMediaQuery(mediaList[i].query,ecWidth,ecHeight)&&indices.push(i);return!indices.length&&mediaDefault&&(indices=[-1]),indices.length&&(indices1=indices,indices2=this._currentMediaIndices,indices1.join(",")!==indices2.join(","))&&(result=map$1(indices,(function(index){return clone$3(-1===index?mediaDefault.option:mediaList[index].option)}))),this._currentMediaIndices=indices,result},OptionManager2}();function applyMediaQuery(query,ecWidth,ecHeight){var realMap={width:ecWidth,height:ecHeight,aspectratio:ecWidth/ecHeight},applicable=!0;return each$d(query,(function(value,attr){var matched=attr.match(QUERY_REG);if(matched&&matched[1]&&matched[2]){var operator=matched[1],realAttr=matched[2].toLowerCase();(function(real,expect,operator){return"min"===operator?real>=expect:"max"===operator?real<=expect:real===expect})(realMap[realAttr],value,operator)||(applicable=!1)}})),applicable}var each$b=each$d,isObject$2=isObject$3,POSSIBLE_STYLES=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function compatEC2ItemStyle(opt){var itemStyleOpt=opt&&opt.itemStyle;if(itemStyleOpt)for(var i=0,len2=POSSIBLE_STYLES.length;i<len2;i++){var styleName=POSSIBLE_STYLES[i],normalItemStyleOpt=itemStyleOpt.normal,emphasisItemStyleOpt=itemStyleOpt.emphasis;normalItemStyleOpt&&normalItemStyleOpt[styleName]&&(opt[styleName]=opt[styleName]||{},opt[styleName].normal?merge(opt[styleName].normal,normalItemStyleOpt[styleName]):opt[styleName].normal=normalItemStyleOpt[styleName],normalItemStyleOpt[styleName]=null),emphasisItemStyleOpt&&emphasisItemStyleOpt[styleName]&&(opt[styleName]=opt[styleName]||{},opt[styleName].emphasis?merge(opt[styleName].emphasis,emphasisItemStyleOpt[styleName]):opt[styleName].emphasis=emphasisItemStyleOpt[styleName],emphasisItemStyleOpt[styleName]=null)}}function convertNormalEmphasis(opt,optType,useExtend){if(opt&&opt[optType]&&(opt[optType].normal||opt[optType].emphasis)){var normalOpt=opt[optType].normal,emphasisOpt=opt[optType].emphasis;normalOpt&&(useExtend?(opt[optType].normal=opt[optType].emphasis=null,defaults(opt[optType],normalOpt)):opt[optType]=normalOpt),emphasisOpt&&(opt.emphasis=opt.emphasis||{},opt.emphasis[optType]=emphasisOpt,emphasisOpt.focus&&(opt.emphasis.focus=emphasisOpt.focus),emphasisOpt.blurScope&&(opt.emphasis.blurScope=emphasisOpt.blurScope))}}function removeEC3NormalStatus(opt){convertNormalEmphasis(opt,"itemStyle"),convertNormalEmphasis(opt,"lineStyle"),convertNormalEmphasis(opt,"areaStyle"),convertNormalEmphasis(opt,"label"),convertNormalEmphasis(opt,"labelLine"),convertNormalEmphasis(opt,"upperLabel"),convertNormalEmphasis(opt,"edgeLabel")}function compatTextStyle(opt,propName){var labelOptSingle=isObject$2(opt)&&opt[propName],textStyle=isObject$2(labelOptSingle)&&labelOptSingle.textStyle;if(textStyle)for(var i=0,len2=TEXT_STYLE_OPTIONS.length;i<len2;i++){var textPropName=TEXT_STYLE_OPTIONS[i];textStyle.hasOwnProperty(textPropName)&&(labelOptSingle[textPropName]=textStyle[textPropName])}}function compatEC3CommonStyles(opt){opt&&(removeEC3NormalStatus(opt),compatTextStyle(opt,"label"),opt.emphasis&&compatTextStyle(opt.emphasis,"label"))}function toArr(o){return isArray$1(o)?o:o?[o]:[]}function toObj(o){return(isArray$1(o)?o[0]:o)||{}}function globalCompatStyle(option,isTheme){each$b(toArr(option.series),(function(seriesOpt){isObject$2(seriesOpt)&&function(seriesOpt){if(isObject$2(seriesOpt)){compatEC2ItemStyle(seriesOpt),removeEC3NormalStatus(seriesOpt),compatTextStyle(seriesOpt,"label"),compatTextStyle(seriesOpt,"upperLabel"),compatTextStyle(seriesOpt,"edgeLabel"),seriesOpt.emphasis&&(compatTextStyle(seriesOpt.emphasis,"label"),compatTextStyle(seriesOpt.emphasis,"upperLabel"),compatTextStyle(seriesOpt.emphasis,"edgeLabel"));var markPoint=seriesOpt.markPoint;markPoint&&(compatEC2ItemStyle(markPoint),compatEC3CommonStyles(markPoint));var markLine=seriesOpt.markLine;markLine&&(compatEC2ItemStyle(markLine),compatEC3CommonStyles(markLine));var markArea=seriesOpt.markArea;markArea&&compatEC3CommonStyles(markArea);var data=seriesOpt.data;if("graph"===seriesOpt.type){data=data||seriesOpt.nodes;var edgeData=seriesOpt.links||seriesOpt.edges;if(edgeData&&!isTypedArray(edgeData))for(var i=0;i<edgeData.length;i++)compatEC3CommonStyles(edgeData[i]);each$d(seriesOpt.categories,(function(opt){removeEC3NormalStatus(opt)}))}if(data&&!isTypedArray(data))for(i=0;i<data.length;i++)compatEC3CommonStyles(data[i]);if((markPoint=seriesOpt.markPoint)&&markPoint.data){var mpData=markPoint.data;for(i=0;i<mpData.length;i++)compatEC3CommonStyles(mpData[i])}if((markLine=seriesOpt.markLine)&&markLine.data){var mlData=markLine.data;for(i=0;i<mlData.length;i++)isArray$1(mlData[i])?(compatEC3CommonStyles(mlData[i][0]),compatEC3CommonStyles(mlData[i][1])):compatEC3CommonStyles(mlData[i])}"gauge"===seriesOpt.type?(compatTextStyle(seriesOpt,"axisLabel"),compatTextStyle(seriesOpt,"title"),compatTextStyle(seriesOpt,"detail")):"treemap"===seriesOpt.type?(convertNormalEmphasis(seriesOpt.breadcrumb,"itemStyle"),each$d(seriesOpt.levels,(function(opt){removeEC3NormalStatus(opt)}))):"tree"===seriesOpt.type&&removeEC3NormalStatus(seriesOpt.leaves)}}(seriesOpt)}));var axes=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];isTheme&&axes.push("valueAxis","categoryAxis","logAxis","timeAxis"),each$b(axes,(function(axisName){each$b(toArr(option[axisName]),(function(axisOpt){axisOpt&&(compatTextStyle(axisOpt,"axisLabel"),compatTextStyle(axisOpt.axisPointer,"label"))}))})),each$b(toArr(option.parallel),(function(parallelOpt){var parallelAxisDefault=parallelOpt&&parallelOpt.parallelAxisDefault;compatTextStyle(parallelAxisDefault,"axisLabel"),compatTextStyle(parallelAxisDefault&&parallelAxisDefault.axisPointer,"label")})),each$b(toArr(option.calendar),(function(calendarOpt){convertNormalEmphasis(calendarOpt,"itemStyle"),compatTextStyle(calendarOpt,"dayLabel"),compatTextStyle(calendarOpt,"monthLabel"),compatTextStyle(calendarOpt,"yearLabel")})),each$b(toArr(option.radar),(function(radarOpt){compatTextStyle(radarOpt,"name"),radarOpt.name&&null==radarOpt.axisName&&(radarOpt.axisName=radarOpt.name,delete radarOpt.name),null!=radarOpt.nameGap&&null==radarOpt.axisNameGap&&(radarOpt.axisNameGap=radarOpt.nameGap,delete radarOpt.nameGap)})),each$b(toArr(option.geo),(function(geoOpt){isObject$2(geoOpt)&&(compatEC3CommonStyles(geoOpt),each$b(toArr(geoOpt.regions),(function(regionObj){compatEC3CommonStyles(regionObj)})))})),each$b(toArr(option.timeline),(function(timelineOpt){compatEC3CommonStyles(timelineOpt),convertNormalEmphasis(timelineOpt,"label"),convertNormalEmphasis(timelineOpt,"itemStyle"),convertNormalEmphasis(timelineOpt,"controlStyle",!0);var data=timelineOpt.data;isArray$1(data)&&each$d(data,(function(item){isObject$3(item)&&(convertNormalEmphasis(item,"label"),convertNormalEmphasis(item,"itemStyle"))}))})),each$b(toArr(option.toolbox),(function(toolboxOpt){convertNormalEmphasis(toolboxOpt,"iconStyle"),each$b(toolboxOpt.feature,(function(featureOpt){convertNormalEmphasis(featureOpt,"iconStyle")}))})),compatTextStyle(toObj(option.axisPointer),"label"),compatTextStyle(toObj(option.tooltip).axisPointer,"label")}function compatLayoutProperties(option){option&&each$d(LAYOUT_PROPERTIES,(function(prop){prop[0]in option&&!(prop[1]in option)&&(option[prop[1]]=option[prop[0]])}))}var LAYOUT_PROPERTIES=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],COMPATITABLE_COMPONENTS=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],BAR_ITEM_STYLE_MAP=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function compatBarItemStyle(option){var itemStyle=option&&option.itemStyle;if(itemStyle)for(var i=0;i<BAR_ITEM_STYLE_MAP.length;i++){var oldName=BAR_ITEM_STYLE_MAP[i][1],newName=BAR_ITEM_STYLE_MAP[i][0];null!=itemStyle[oldName]&&(itemStyle[newName]=itemStyle[oldName])}}function compatPieLabel(option){option&&"edge"===option.alignTo&&null!=option.margin&&null==option.edgeDistance&&(option.edgeDistance=option.margin)}function compatSunburstState(option){option&&option.downplay&&!option.blur&&(option.blur=option.downplay)}function traverseTree(data,cb){if(data)for(var i=0;i<data.length;i++)cb(data[i]),data[i]&&traverseTree(data[i].children,cb)}function globalBackwardCompat(option,isTheme){globalCompatStyle(option,isTheme),option.series=normalizeToArray(option.series),each$d(option.series,(function(seriesOpt){if(isObject$3(seriesOpt)){var seriesType2=seriesOpt.type;if("line"===seriesType2)null!=seriesOpt.clipOverflow&&(seriesOpt.clip=seriesOpt.clipOverflow);else if("pie"===seriesType2||"gauge"===seriesType2){if(null!=seriesOpt.clockWise&&(seriesOpt.clockwise=seriesOpt.clockWise),compatPieLabel(seriesOpt.label),(data=seriesOpt.data)&&!isTypedArray(data))for(var i=0;i<data.length;i++)compatPieLabel(data[i]);null!=seriesOpt.hoverOffset&&(seriesOpt.emphasis=seriesOpt.emphasis||{},(seriesOpt.emphasis.scaleSize=null)&&(seriesOpt.emphasis.scaleSize=seriesOpt.hoverOffset))}else if("gauge"===seriesType2){var pointerColor=function(opt,path){for(var pathArr=path.split(","),obj=opt,i=0;i<pathArr.length&&null!=(obj=obj&&obj[pathArr[i]]);i++);return obj}(seriesOpt,"pointer.color");null!=pointerColor&&function(opt,path,val){for(var key,pathArr=path.split(","),obj=opt,i=0;i<pathArr.length-1;i++)null==obj[key=pathArr[i]]&&(obj[key]={}),obj=obj[key];null==obj[pathArr[i]]&&(obj[pathArr[i]]=val)}(seriesOpt,"itemStyle.color",pointerColor)}else if("bar"===seriesType2){var data;if(compatBarItemStyle(seriesOpt),compatBarItemStyle(seriesOpt.backgroundStyle),compatBarItemStyle(seriesOpt.emphasis),(data=seriesOpt.data)&&!isTypedArray(data))for(i=0;i<data.length;i++)"object"==typeof data[i]&&(compatBarItemStyle(data[i]),compatBarItemStyle(data[i]&&data[i].emphasis))}else if("sunburst"===seriesType2){var highlightPolicy=seriesOpt.highlightPolicy;highlightPolicy&&(seriesOpt.emphasis=seriesOpt.emphasis||{},seriesOpt.emphasis.focus||(seriesOpt.emphasis.focus=highlightPolicy)),compatSunburstState(seriesOpt),traverseTree(seriesOpt.data,compatSunburstState)}else"graph"===seriesType2||"sankey"===seriesType2?function(option){option&&null!=option.focusNodeAdjacency&&(option.emphasis=option.emphasis||{},null==option.emphasis.focus&&(option.emphasis.focus="adjacency"))}(seriesOpt):"map"===seriesType2&&(seriesOpt.mapType&&!seriesOpt.map&&(seriesOpt.map=seriesOpt.mapType),seriesOpt.mapLocation&&defaults(seriesOpt,seriesOpt.mapLocation));null!=seriesOpt.hoverAnimation&&(seriesOpt.emphasis=seriesOpt.emphasis||{},seriesOpt.emphasis&&null==seriesOpt.emphasis.scale&&(seriesOpt.emphasis.scale=seriesOpt.hoverAnimation)),compatLayoutProperties(seriesOpt)}})),option.dataRange&&(option.visualMap=option.dataRange),each$d(COMPATITABLE_COMPONENTS,(function(componentName){var options=option[componentName];options&&(isArray$1(options)||(options=[options]),each$d(options,(function(option2){compatLayoutProperties(option2)})))}))}function calculateStack(stackInfoList){each$d(stackInfoList,(function(targetStackInfo,idxInStack){var resultVal=[],resultNaN=[NaN,NaN],dims=[targetStackInfo.stackResultDimension,targetStackInfo.stackedOverDimension],targetData=targetStackInfo.data,isStackedByIndex=targetStackInfo.isStackedByIndex,stackStrategy=targetStackInfo.seriesModel.get("stackStrategy")||"samesign";targetData.modify(dims,(function(v0,v1,dataIndex){var byValue,stackedDataRawIndex,sum=targetData.get(targetStackInfo.stackedDimension,dataIndex);if(isNaN(sum))return resultNaN;isStackedByIndex?stackedDataRawIndex=targetData.getRawIndex(dataIndex):byValue=targetData.get(targetStackInfo.stackedByDimension,dataIndex);for(var stackedOver=NaN,j=idxInStack-1;j>=0;j--){var stackInfo=stackInfoList[j];if(isStackedByIndex||(stackedDataRawIndex=stackInfo.data.rawIndexOf(stackInfo.stackedByDimension,byValue)),stackedDataRawIndex>=0){var val=stackInfo.data.getByRawIndex(stackInfo.stackResultDimension,stackedDataRawIndex);if("all"===stackStrategy||"positive"===stackStrategy&&val>0||"negative"===stackStrategy&&val<0||"samesign"===stackStrategy&&sum>=0&&val>0||"samesign"===stackStrategy&&sum<=0&&val<0){sum=addSafe(sum,val),stackedOver=val;break}}}return resultVal[0]=sum,resultVal[1]=stackedOver,resultVal}))}))}var _a,_b,_c,providerMethods,mountMethods,SourceImpl=function(){return function(fields){this.data=fields.data||("keyedColumns"===fields.sourceFormat?{}:[]),this.sourceFormat=fields.sourceFormat||"unknown",this.seriesLayoutBy=fields.seriesLayoutBy||"column",this.startIndex=fields.startIndex||0,this.dimensionsDetectedCount=fields.dimensionsDetectedCount,this.metaRawOption=fields.metaRawOption;var dimensionsDefine=this.dimensionsDefine=fields.dimensionsDefine;if(dimensionsDefine)for(var i=0;i<dimensionsDefine.length;i++){var dim=dimensionsDefine[i];null==dim.type&&guessOrdinal(this,i)===BE_ORDINAL_Must&&(dim.type="ordinal")}}}();function isSourceInstance(val){return val instanceof SourceImpl}function createSource(sourceData,thisMetaRawOption,sourceFormat){sourceFormat=sourceFormat||detectSourceFormat(sourceData);var seriesLayoutBy=thisMetaRawOption.seriesLayoutBy,determined=function(data,sourceFormat,seriesLayoutBy,sourceHeader,dimensionsDefine){var dimensionsDetectedCount,startIndex;if(!data)return{dimensionsDefine:normalizeDimensionsOption(dimensionsDefine),startIndex:startIndex,dimensionsDetectedCount:dimensionsDetectedCount};if("arrayRows"===sourceFormat){var dataArrayRows=data;"auto"===sourceHeader||null==sourceHeader?arrayRowsTravelFirst((function(val){null!=val&&"-"!==val&&(isString(val)?null==startIndex&&(startIndex=1):startIndex=0)}),seriesLayoutBy,dataArrayRows,10):startIndex=isNumber(sourceHeader)?sourceHeader:sourceHeader?1:0,dimensionsDefine||1!==startIndex||(dimensionsDefine=[],arrayRowsTravelFirst((function(val,index){dimensionsDefine[index]=null!=val?val+"":""}),seriesLayoutBy,dataArrayRows,Infinity)),dimensionsDetectedCount=dimensionsDefine?dimensionsDefine.length:"row"===seriesLayoutBy?dataArrayRows.length:dataArrayRows[0]?dataArrayRows[0].length:null}else if("objectRows"===sourceFormat)dimensionsDefine||(dimensionsDefine=function(data){var obj,firstIndex=0;for(;firstIndex<data.length&&!(obj=data[firstIndex++]););if(obj)return keys(obj)}(data));else if("keyedColumns"===sourceFormat)dimensionsDefine||(dimensionsDefine=[],each$d(data,(function(colArr,key){dimensionsDefine.push(key)})));else if("original"===sourceFormat){var value0=getDataItemValue(data[0]);dimensionsDetectedCount=isArray$1(value0)&&value0.length||1}return{startIndex:startIndex,dimensionsDefine:normalizeDimensionsOption(dimensionsDefine),dimensionsDetectedCount:dimensionsDetectedCount}}(sourceData,sourceFormat,seriesLayoutBy,thisMetaRawOption.sourceHeader,thisMetaRawOption.dimensions);return new SourceImpl({data:sourceData,sourceFormat:sourceFormat,seriesLayoutBy:seriesLayoutBy,dimensionsDefine:determined.dimensionsDefine,startIndex:determined.startIndex,dimensionsDetectedCount:determined.dimensionsDetectedCount,metaRawOption:clone$3(thisMetaRawOption)})}function createSourceFromSeriesDataOption(data){return new SourceImpl({data:data,sourceFormat:isTypedArray(data)?"typedArray":"original"})}function detectSourceFormat(data){var sourceFormat="unknown";if(isTypedArray(data))sourceFormat="typedArray";else if(isArray$1(data)){0===data.length&&(sourceFormat="arrayRows");for(var i=0,len2=data.length;i<len2;i++){var item=data[i];if(null!=item){if(isArray$1(item)||isTypedArray(item)){sourceFormat="arrayRows";break}if(isObject$3(item)){sourceFormat="objectRows";break}}}}else if(isObject$3(data))for(var key in data)if(hasOwn(data,key)&&isArrayLike(data[key])){sourceFormat="keyedColumns";break}return sourceFormat}function normalizeDimensionsOption(dimensionsDefine){if(dimensionsDefine){var nameMap=createHashMap();return map$1(dimensionsDefine,(function(rawItem,index){var item={name:(rawItem=isObject$3(rawItem)?rawItem:{name:rawItem}).name,displayName:rawItem.displayName,type:rawItem.type};if(null==item.name)return item;item.name+="",null==item.displayName&&(item.displayName=item.name);var exist=nameMap.get(item.name);return exist?item.name+="-"+exist.count++:nameMap.set(item.name,{count:1}),item}))}}function arrayRowsTravelFirst(cb,seriesLayoutBy,data,maxLoop){if("row"===seriesLayoutBy)for(var i=0;i<data.length&&i<maxLoop;i++)cb(data[i]?data[i][0]:null,i);else{var value0=data[0]||[];for(i=0;i<value0.length&&i<maxLoop;i++)cb(value0[i],i)}}function shouldRetrieveDataByName(source){var sourceFormat=source.sourceFormat;return"objectRows"===sourceFormat||"keyedColumns"===sourceFormat}var DefaultDataProvider=function(){function DefaultDataProvider2(sourceParam,dimSize){var source=isSourceInstance(sourceParam)?sourceParam:createSourceFromSeriesDataOption(sourceParam);this._source=source;var data=this._data=source.data;"typedArray"===source.sourceFormat&&(this._offset=0,this._dimSize=dimSize,this._data=data),mountMethods(this,data,source)}var proto2;return DefaultDataProvider2.prototype.getSource=function(){return this._source},DefaultDataProvider2.prototype.count=function(){return 0},DefaultDataProvider2.prototype.getItem=function(idx,out2){},DefaultDataProvider2.prototype.appendData=function(newData){},DefaultDataProvider2.prototype.clean=function(){},DefaultDataProvider2.protoInitialize=((proto2=DefaultDataProvider2.prototype).pure=!1,void(proto2.persistent=!0)),DefaultDataProvider2.internalField=function(){var _a2;mountMethods=function(provider,data,source){var sourceFormat=source.sourceFormat,seriesLayoutBy=source.seriesLayoutBy,startIndex=source.startIndex,dimsDef=source.dimensionsDefine;if(extend(provider,providerMethods[getMethodMapKey(sourceFormat,seriesLayoutBy)]),"typedArray"===sourceFormat)provider.getItem=getItemForTypedArray,provider.count=countForTypedArray,provider.fillStorage=fillStorageForTypedArray;else{var rawItemGetter=getRawSourceItemGetter(sourceFormat,seriesLayoutBy);provider.getItem=bind$1(rawItemGetter,null,data,startIndex,dimsDef);var rawCounter=getRawSourceDataCounter(sourceFormat,seriesLayoutBy);provider.count=bind$1(rawCounter,null,data,startIndex,dimsDef)}};var getItemForTypedArray=function(idx,out2){idx-=this._offset,out2=out2||[];for(var data=this._data,dimSize=this._dimSize,offset=dimSize*idx,i=0;i<dimSize;i++)out2[i]=data[offset+i];return out2},fillStorageForTypedArray=function(start2,end2,storage2,extent3){for(var data=this._data,dimSize=this._dimSize,dim=0;dim<dimSize;dim++){for(var dimExtent=extent3[dim],min3=null==dimExtent[0]?Infinity:dimExtent[0],max3=null==dimExtent[1]?-Infinity:dimExtent[1],count2=end2-start2,arr=storage2[dim],i=0;i<count2;i++){var val=data[i*dimSize+dim];arr[start2+i]=val,val<min3&&(min3=val),val>max3&&(max3=val)}dimExtent[0]=min3,dimExtent[1]=max3}},countForTypedArray=function(){return this._data?this._data.length/this._dimSize:0};function appendDataSimply(newData){for(var i=0;i<newData.length;i++)this._data.push(newData[i])}(_a2={}).arrayRows_column={pure:!0,appendData:appendDataSimply},_a2.arrayRows_row={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},_a2.objectRows={pure:!0,appendData:appendDataSimply},_a2.keyedColumns={pure:!0,appendData:function(newData){var data=this._data;each$d(newData,(function(newCol,key){for(var oldCol=data[key]||(data[key]=[]),i=0;i<(newCol||[]).length;i++)oldCol.push(newCol[i])}))}},_a2.original={appendData:appendDataSimply},_a2.typedArray={persistent:!1,pure:!0,appendData:function(newData){this._data=newData},clean:function(){this._offset+=this.count(),this._data=null}},providerMethods=_a2}(),DefaultDataProvider2}(),getItemSimply=function(rawData,startIndex,dimsDef,idx){return rawData[idx]},rawSourceItemGetterMap=((_a={}).arrayRows_column=function(rawData,startIndex,dimsDef,idx){return rawData[idx+startIndex]},_a.arrayRows_row=function(rawData,startIndex,dimsDef,idx,out2){idx+=startIndex;for(var item=out2||[],data=rawData,i=0;i<data.length;i++){var row=data[i];item[i]=row?row[idx]:null}return item},_a.objectRows=getItemSimply,_a.keyedColumns=function(rawData,startIndex,dimsDef,idx,out2){for(var item=out2||[],i=0;i<dimsDef.length;i++){var col=rawData[dimsDef[i].name];item[i]=col?col[idx]:null}return item},_a.original=getItemSimply,_a);function getRawSourceItemGetter(sourceFormat,seriesLayoutBy){return rawSourceItemGetterMap[getMethodMapKey(sourceFormat,seriesLayoutBy)]}var countSimply=function(rawData,startIndex,dimsDef){return rawData.length},rawSourceDataCounterMap=((_b={}).arrayRows_column=function(rawData,startIndex,dimsDef){return Math.max(0,rawData.length-startIndex)},_b.arrayRows_row=function(rawData,startIndex,dimsDef){var row=rawData[0];return row?Math.max(0,row.length-startIndex):0},_b.objectRows=countSimply,_b.keyedColumns=function(rawData,startIndex,dimsDef){var col=rawData[dimsDef[0].name];return col?col.length:0},_b.original=countSimply,_b);function getRawSourceDataCounter(sourceFormat,seriesLayoutBy){return rawSourceDataCounterMap[getMethodMapKey(sourceFormat,seriesLayoutBy)]}var getRawValueSimply=function(dataItem,dimIndex,property){return dataItem[dimIndex]},rawSourceValueGetterMap=((_c={}).arrayRows=getRawValueSimply,_c.objectRows=function(dataItem,dimIndex,property){return dataItem[property]},_c.keyedColumns=getRawValueSimply,_c.original=function(dataItem,dimIndex,property){var value=getDataItemValue(dataItem);return value instanceof Array?value[dimIndex]:value},_c.typedArray=getRawValueSimply,_c);function getRawSourceValueGetter(sourceFormat){return rawSourceValueGetterMap[sourceFormat]}function getMethodMapKey(sourceFormat,seriesLayoutBy){return"arrayRows"===sourceFormat?sourceFormat+"_"+seriesLayoutBy:sourceFormat}function retrieveRawValue(data,dataIndex,dim){if(data){var dataItem=data.getRawDataItem(dataIndex);if(null!=dataItem){var store=data.getStore(),sourceFormat=store.getSource().sourceFormat;if(null!=dim){var dimIndex=data.getDimensionIndex(dim),property=store.getDimensionProperty(dimIndex);return getRawSourceValueGetter(sourceFormat)(dataItem,dimIndex,property)}var result=dataItem;return"original"===sourceFormat&&(result=getDataItemValue(dataItem)),result}}}var DIMENSION_LABEL_REG=/\{@(.+?)\}/g,DataFormatMixin=function(){function DataFormatMixin2(){}return DataFormatMixin2.prototype.getDataParams=function(dataIndex,dataType){var data=this.getData(dataType),rawValue=this.getRawValue(dataIndex,dataType),rawDataIndex=data.getRawIndex(dataIndex),name=data.getName(dataIndex),itemOpt=data.getRawDataItem(dataIndex),style=data.getItemVisual(dataIndex,"style"),color2=style&&style[data.getItemVisual(dataIndex,"drawType")||"fill"],borderColor=style&&style.stroke,mainType=this.mainType,isSeries2="series"===mainType,userOutput=data.userOutput&&data.userOutput.get();return{componentType:mainType,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:isSeries2?this.subType:null,seriesIndex:this.seriesIndex,seriesId:isSeries2?this.id:null,seriesName:isSeries2?this.name:null,name:name,dataIndex:rawDataIndex,data:itemOpt,dataType:dataType,value:rawValue,color:color2,borderColor:borderColor,dimensionNames:userOutput?userOutput.fullDimensions:null,encode:userOutput?userOutput.encode:null,$vars:["seriesName","name","value"]}},DataFormatMixin2.prototype.getFormattedLabel=function(dataIndex,status,dataType,labelDimIndex,formatter,extendParams){status=status||"normal";var data=this.getData(dataType),params=this.getDataParams(dataIndex,dataType);(extendParams&&(params.value=extendParams.interpolatedValue),null!=labelDimIndex&&isArray$1(params.value)&&(params.value=params.value[labelDimIndex]),formatter)||(formatter=data.getItemModel(dataIndex).get("normal"===status?["label","formatter"]:[status,"label","formatter"]));return isFunction(formatter)?(params.status=status,params.dimensionIndex=labelDimIndex,formatter(params)):isString(formatter)?formatTpl(formatter,params).replace(DIMENSION_LABEL_REG,(function(origin,dimStr){var len2=dimStr.length,dimLoose=dimStr;"["===dimLoose.charAt(0)&&"]"===dimLoose.charAt(len2-1)&&(dimLoose=+dimLoose.slice(1,len2-1));var val=retrieveRawValue(data,dataIndex,dimLoose);if(extendParams&&isArray$1(extendParams.interpolatedValue)){var dimIndex=data.getDimensionIndex(dimLoose);dimIndex>=0&&(val=extendParams.interpolatedValue[dimIndex])}return null!=val?val+"":""})):void 0},DataFormatMixin2.prototype.getRawValue=function(idx,dataType){return retrieveRawValue(this.getData(dataType),idx)},DataFormatMixin2.prototype.formatTooltip=function(dataIndex,multipleSeries,dataType){},DataFormatMixin2}();function normalizeTooltipFormatResult(result){var markupText,markupFragment;return isObject$3(result)?result.type&&(markupFragment=result):markupText=result,{text:markupText,frag:markupFragment}}function createTask(define){return new Task(define)}var Task=function(){function Task2(define){define=define||{},this._reset=define.reset,this._plan=define.plan,this._count=define.count,this._onDirty=define.onDirty,this._dirty=!0}return Task2.prototype.perform=function(performArgs){var planResult,upTask=this._upstream,skip=performArgs&&performArgs.skip;if(this._dirty&&upTask){var context=this.context;context.data=context.outputData=upTask.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this),this._plan&&!skip&&(planResult=this._plan(this.context));var forceFirstProgress,lastModBy=normalizeModBy(this._modBy),lastModDataCount=this._modDataCount||0,modBy=normalizeModBy(performArgs&&performArgs.modBy),modDataCount=performArgs&&performArgs.modDataCount||0;function normalizeModBy(val){return!(val>=1)&&(val=1),val}lastModBy===modBy&&lastModDataCount===modDataCount||(planResult="reset"),(this._dirty||"reset"===planResult)&&(this._dirty=!1,forceFirstProgress=this._doReset(skip)),this._modBy=modBy,this._modDataCount=modDataCount;var step=performArgs&&performArgs.step;if(this._dueEnd=upTask?upTask._outputDueEnd:this._count?this._count(this.context):Infinity,this._progress){var start2=this._dueIndex,end2=Math.min(null!=step?this._dueIndex+step:Infinity,this._dueEnd);if(!skip&&(forceFirstProgress||start2<end2)){var progress=this._progress;if(isArray$1(progress))for(var i=0;i<progress.length;i++)this._doProgress(progress[i],start2,end2,modBy,modDataCount);else this._doProgress(progress,start2,end2,modBy,modDataCount)}this._dueIndex=end2;var outputDueEnd=null!=this._settedOutputEnd?this._settedOutputEnd:end2;this._outputDueEnd=outputDueEnd}else this._dueIndex=this._outputDueEnd=null!=this._settedOutputEnd?this._settedOutputEnd:this._dueEnd;return this.unfinished()},Task2.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},Task2.prototype._doProgress=function(progress,start2,end2,modBy,modDataCount){iterator.reset(start2,end2,modBy,modDataCount),this._callingProgress=progress,this._callingProgress({start:start2,end:end2,count:end2-start2,next:iterator.next},this.context)},Task2.prototype._doReset=function(skip){var progress,forceFirstProgress;this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null,!skip&&this._reset&&((progress=this._reset(this.context))&&progress.progress&&(forceFirstProgress=progress.forceFirstProgress,progress=progress.progress),isArray$1(progress)&&!progress.length&&(progress=null)),this._progress=progress,this._modBy=this._modDataCount=null;var downstream=this._downstream;return downstream&&downstream.dirty(),forceFirstProgress},Task2.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},Task2.prototype.pipe=function(downTask){(this._downstream!==downTask||this._dirty)&&(this._downstream=downTask,downTask._upstream=this,downTask.dirty())},Task2.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},Task2.prototype.getUpstream=function(){return this._upstream},Task2.prototype.getDownstream=function(){return this._downstream},Task2.prototype.setOutputEnd=function(end2){this._outputDueEnd=this._settedOutputEnd=end2},Task2}(),iterator=function(){var end2,current,modBy,modDataCount,winCount,it={reset:function(s,e2,sStep,sCount){current=s,end2=e2,modBy=sStep,modDataCount=sCount,winCount=Math.ceil(modDataCount/modBy),it.next=modBy>1&&modDataCount>0?modNext:sequentialNext}};return it;function sequentialNext(){return current<end2?current++:null}function modNext(){var dataIndex=current%winCount*modBy+Math.ceil(current/winCount),result=current>=end2?null:dataIndex<modDataCount?dataIndex:current;return current++,result}}();function parseDataValue(value,opt){var dimType=opt&&opt.type;return"ordinal"===dimType?value:("time"!==dimType||isNumber(value)||null==value||"-"===value||(value=+parseDate(value)),null==value||""===value?NaN:Number(value))}createHashMap({number:function(val){return parseFloat(val)},time:function(val){return+parseDate(val)},trim:function(val){return isString(val)?trim$1(val):val}});var SortOrderComparator=function(){function SortOrderComparator2(order,incomparable){var isDesc="desc"===order;this._resultLT=isDesc?1:-1,null==incomparable&&(incomparable=isDesc?"min":"max"),this._incomparable="min"===incomparable?-Infinity:Infinity}return SortOrderComparator2.prototype.evaluate=function(lval,rval){var lvalFloat=isNumber(lval)?lval:numericToNumber(lval),rvalFloat=isNumber(rval)?rval:numericToNumber(rval),lvalNotNumeric=isNaN(lvalFloat),rvalNotNumeric=isNaN(rvalFloat);if(lvalNotNumeric&&(lvalFloat=this._incomparable),rvalNotNumeric&&(rvalFloat=this._incomparable),lvalNotNumeric&&rvalNotNumeric){var lvalIsStr=isString(lval),rvalIsStr=isString(rval);lvalIsStr&&(lvalFloat=rvalIsStr?lval:0),rvalIsStr&&(rvalFloat=lvalIsStr?rval:0)}return lvalFloat<rvalFloat?this._resultLT:lvalFloat>rvalFloat?-this._resultLT:0},SortOrderComparator2}(),ExternalSource=function(){function ExternalSource2(){}return ExternalSource2.prototype.getRawData=function(){throw new Error("not supported")},ExternalSource2.prototype.getRawDataItem=function(dataIndex){throw new Error("not supported")},ExternalSource2.prototype.cloneRawData=function(){},ExternalSource2.prototype.getDimensionInfo=function(dim){},ExternalSource2.prototype.cloneAllDimensionInfo=function(){},ExternalSource2.prototype.count=function(){},ExternalSource2.prototype.retrieveValue=function(dataIndex,dimIndex){},ExternalSource2.prototype.retrieveValueFromItem=function(dataItem,dimIndex){},ExternalSource2.prototype.convertValue=function(rawVal,dimInfo){return parseDataValue(rawVal,dimInfo)},ExternalSource2}();function getRawData(upstream){if(!isSupportedSourceFormat(upstream.sourceFormat)){throwError("")}return upstream.data}function cloneRawData(upstream){var sourceFormat=upstream.sourceFormat,data=upstream.data;if(!isSupportedSourceFormat(sourceFormat)){throwError("")}if("arrayRows"===sourceFormat){for(var result=[],i=0,len2=data.length;i<len2;i++)result.push(data[i].slice());return result}if("objectRows"===sourceFormat){for(result=[],i=0,len2=data.length;i<len2;i++)result.push(extend({},data[i]));return result}}function getDimensionInfo(dimensions,dimsByName,dim){if(null!=dim)return isNumber(dim)||!isNaN(dim)&&!hasOwn(dimsByName,dim)?dimensions[dim]:hasOwn(dimsByName,dim)?dimsByName[dim]:void 0}function cloneAllDimensionInfo(dimensions){return clone$3(dimensions)}var externalTransformMap=createHashMap();function applySingleDataTransform(transOption,upSourceList,infoForPrint,pipeIndex){upSourceList.length||throwError(""),isObject$3(transOption)||throwError("");var transType=transOption.type,externalTransform=externalTransformMap.get(transType);externalTransform||throwError("");var extUpSourceList=map$1(upSourceList,(function(upSource){return function(internalSource,externalTransform){var extSource=new ExternalSource,data=internalSource.data,sourceFormat=extSource.sourceFormat=internalSource.sourceFormat,sourceHeaderCount=internalSource.startIndex;"column"!==internalSource.seriesLayoutBy&&throwError("");var dimensions=[],dimsByName={},dimsDef=internalSource.dimensionsDefine;if(dimsDef)each$d(dimsDef,(function(dimDef,idx){var name=dimDef.name,dimDefExt={index:idx,name:name,displayName:dimDef.displayName};dimensions.push(dimDefExt),null!=name&&(hasOwn(dimsByName,name)&&throwError(""),dimsByName[name]=dimDefExt)}));else for(var i=0;i<internalSource.dimensionsDetectedCount;i++)dimensions.push({index:i});var rawItemGetter=getRawSourceItemGetter(sourceFormat,"column");externalTransform.__isBuiltIn&&(extSource.getRawDataItem=function(dataIndex){return rawItemGetter(data,sourceHeaderCount,dimensions,dataIndex)},extSource.getRawData=bind$1(getRawData,null,internalSource)),extSource.cloneRawData=bind$1(cloneRawData,null,internalSource);var rawCounter=getRawSourceDataCounter(sourceFormat,"column");extSource.count=bind$1(rawCounter,null,data,sourceHeaderCount,dimensions);var rawValueGetter=getRawSourceValueGetter(sourceFormat);extSource.retrieveValue=function(dataIndex,dimIndex){var rawItem=rawItemGetter(data,sourceHeaderCount,dimensions,dataIndex);return retrieveValueFromItem(rawItem,dimIndex)};var retrieveValueFromItem=extSource.retrieveValueFromItem=function(dataItem,dimIndex){if(null!=dataItem){var dimDef=dimensions[dimIndex];return dimDef?rawValueGetter(dataItem,dimIndex,dimDef.name):void 0}};return extSource.getDimensionInfo=bind$1(getDimensionInfo,null,dimensions,dimsByName),extSource.cloneAllDimensionInfo=bind$1(cloneAllDimensionInfo,null,dimensions),extSource}(upSource,externalTransform)}));return map$1(normalizeToArray(externalTransform.transform({upstream:extUpSourceList[0],upstreamList:extUpSourceList,config:clone$3(transOption.config)})),(function(result,resultIndex){var resultMetaRawOption;isObject$3(result)||throwError(""),result.data||throwError(""),isSupportedSourceFormat(detectSourceFormat(result.data))||throwError("");var firstUpSource=upSourceList[0];if(firstUpSource&&0===resultIndex&&!result.dimensions){var startIndex=firstUpSource.startIndex;startIndex&&(result.data=firstUpSource.data.slice(0,startIndex).concat(result.data)),resultMetaRawOption={seriesLayoutBy:"column",sourceHeader:startIndex,dimensions:firstUpSource.metaRawOption.dimensions}}else resultMetaRawOption={seriesLayoutBy:"column",sourceHeader:0,dimensions:result.dimensions};return createSource(result.data,resultMetaRawOption,null)}))}function isSupportedSourceFormat(sourceFormat){return"arrayRows"===sourceFormat||"objectRows"===sourceFormat}var defaultDimValueGetters,CtorUint32Array="undefined"==typeof Uint32Array?Array:Uint32Array,CtorUint16Array="undefined"==typeof Uint16Array?Array:Uint16Array,CtorInt32Array$1="undefined"==typeof Int32Array?Array:Int32Array,CtorFloat64Array="undefined"==typeof Float64Array?Array:Float64Array,dataCtors={float:CtorFloat64Array,int:CtorInt32Array$1,ordinal:Array,number:Array,time:CtorFloat64Array};function getIndicesCtor(rawCount){return rawCount>65535?CtorUint32Array:CtorUint16Array}function prepareStore(store,dimIdx,dimType,end2,append){var DataCtor=dataCtors[dimType||"float"];if(append){var oldStore=store[dimIdx],oldLen=oldStore&&oldStore.length;if(oldLen!==end2){for(var newStore=new DataCtor(end2),j=0;j<oldLen;j++)newStore[j]=oldStore[j];store[dimIdx]=newStore}}else store[dimIdx]=new DataCtor(end2)}var DataStore=function(){function DataStore2(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=createHashMap()}return DataStore2.prototype.initData=function(provider,inputDimensions,dimValueGetter){this._provider=provider,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var source=provider.getSource(),defaultGetter=this.defaultDimValueGetter=defaultDimValueGetters[source.sourceFormat];this._dimValueGetter=dimValueGetter||defaultGetter,this._rawExtent=[],shouldRetrieveDataByName(source),this._dimensions=map$1(inputDimensions,(function(dim){return{type:dim.type,property:dim.property}})),this._initDataFromProvider(0,provider.count())},DataStore2.prototype.getProvider=function(){return this._provider},DataStore2.prototype.getSource=function(){return this._provider.getSource()},DataStore2.prototype.ensureCalculationDimension=function(dimName,type){var calcDimNameToIdx=this._calcDimNameToIdx,dimensions=this._dimensions,calcDimIdx=calcDimNameToIdx.get(dimName);if(null!=calcDimIdx){if(dimensions[calcDimIdx].type===type)return calcDimIdx}else calcDimIdx=dimensions.length;return dimensions[calcDimIdx]={type:type},calcDimNameToIdx.set(dimName,calcDimIdx),this._chunks[calcDimIdx]=new dataCtors[type||"float"](this._rawCount),this._rawExtent[calcDimIdx]=[Infinity,-Infinity],calcDimIdx},DataStore2.prototype.collectOrdinalMeta=function(dimIdx,ordinalMeta){var chunk=this._chunks[dimIdx],dim=this._dimensions[dimIdx],rawExtents=this._rawExtent,offset=dim.ordinalOffset||0,len2=chunk.length;0===offset&&(rawExtents[dimIdx]=[Infinity,-Infinity]);for(var dimRawExtent=rawExtents[dimIdx],i=offset;i<len2;i++){var val=chunk[i]=ordinalMeta.parseAndCollect(chunk[i]);isNaN(val)||(dimRawExtent[0]=Math.min(val,dimRawExtent[0]),dimRawExtent[1]=Math.max(val,dimRawExtent[1]))}dim.ordinalMeta=ordinalMeta,dim.ordinalOffset=len2,dim.type="ordinal"},DataStore2.prototype.getOrdinalMeta=function(dimIdx){return this._dimensions[dimIdx].ordinalMeta},DataStore2.prototype.getDimensionProperty=function(dimIndex){var item=this._dimensions[dimIndex];return item&&item.property},DataStore2.prototype.appendData=function(data){var provider=this._provider,start2=this.count();provider.appendData(data);var end2=provider.count();return provider.persistent||(end2+=start2),start2<end2&&this._initDataFromProvider(start2,end2,!0),[start2,end2]},DataStore2.prototype.appendValues=function(values,minFillLen){for(var chunks=this._chunks,dimensions=this._dimensions,dimLen=dimensions.length,rawExtent=this._rawExtent,start2=this.count(),end2=start2+Math.max(values.length,minFillLen||0),i=0;i<dimLen;i++){prepareStore(chunks,i,(dim=dimensions[i]).type,end2,!0)}for(var emptyDataItem=[],idx=start2;idx<end2;idx++)for(var sourceIdx=idx-start2,dimIdx=0;dimIdx<dimLen;dimIdx++){var dim=dimensions[dimIdx],val=defaultDimValueGetters.arrayRows.call(this,values[sourceIdx]||emptyDataItem,dim.property,sourceIdx,dimIdx);chunks[dimIdx][idx]=val;var dimRawExtent=rawExtent[dimIdx];val<dimRawExtent[0]&&(dimRawExtent[0]=val),val>dimRawExtent[1]&&(dimRawExtent[1]=val)}return this._rawCount=this._count=end2,{start:start2,end:end2}},DataStore2.prototype._initDataFromProvider=function(start2,end2,append){for(var provider=this._provider,chunks=this._chunks,dimensions=this._dimensions,dimLen=dimensions.length,rawExtent=this._rawExtent,dimNames=map$1(dimensions,(function(dim2){return dim2.property})),i=0;i<dimLen;i++){var dim=dimensions[i];rawExtent[i]||(rawExtent[i]=[Infinity,-Infinity]),prepareStore(chunks,i,dim.type,end2,append)}if(provider.fillStorage)provider.fillStorage(start2,end2,chunks,rawExtent);else for(var dataItem=[],idx=start2;idx<end2;idx++){dataItem=provider.getItem(idx,dataItem);for(var dimIdx=0;dimIdx<dimLen;dimIdx++){var dimStorage=chunks[dimIdx],val=this._dimValueGetter(dataItem,dimNames[dimIdx],idx,dimIdx);dimStorage[idx]=val;var dimRawExtent=rawExtent[dimIdx];val<dimRawExtent[0]&&(dimRawExtent[0]=val),val>dimRawExtent[1]&&(dimRawExtent[1]=val)}}!provider.persistent&&provider.clean&&provider.clean(),this._rawCount=this._count=end2,this._extent=[]},DataStore2.prototype.count=function(){return this._count},DataStore2.prototype.get=function(dim,idx){if(!(idx>=0&&idx<this._count))return NaN;var dimStore=this._chunks[dim];return dimStore?dimStore[this.getRawIndex(idx)]:NaN},DataStore2.prototype.getValues=function(dimensions,idx){var values=[],dimArr=[];if(null==idx){idx=dimensions,dimensions=[];for(var i=0;i<this._dimensions.length;i++)dimArr.push(i)}else dimArr=dimensions;i=0;for(var len2=dimArr.length;i<len2;i++)values.push(this.get(dimArr[i],idx));return values},DataStore2.prototype.getByRawIndex=function(dim,rawIdx){if(!(rawIdx>=0&&rawIdx<this._rawCount))return NaN;var dimStore=this._chunks[dim];return dimStore?dimStore[rawIdx]:NaN},DataStore2.prototype.getSum=function(dim){var sum=0;if(this._chunks[dim])for(var i=0,len2=this.count();i<len2;i++){var value=this.get(dim,i);isNaN(value)||(sum+=value)}return sum},DataStore2.prototype.getMedian=function(dim){var dimDataArray=[];this.each([dim],(function(val){isNaN(val)||dimDataArray.push(val)}));var sortedDimDataArray=dimDataArray.sort((function(a,b){return a-b})),len2=this.count();return 0===len2?0:len2%2==1?sortedDimDataArray[(len2-1)/2]:(sortedDimDataArray[len2/2]+sortedDimDataArray[len2/2-1])/2},DataStore2.prototype.indexOfRawIndex=function(rawIndex){if(rawIndex>=this._rawCount||rawIndex<0)return-1;if(!this._indices)return rawIndex;var indices=this._indices,rawDataIndex=indices[rawIndex];if(null!=rawDataIndex&&rawDataIndex<this._count&&rawDataIndex===rawIndex)return rawIndex;for(var left=0,right=this._count-1;left<=right;){var mid=(left+right)/2|0;if(indices[mid]<rawIndex)left=mid+1;else{if(!(indices[mid]>rawIndex))return mid;right=mid-1}}return-1},DataStore2.prototype.indicesOfNearest=function(dim,value,maxDistance){var dimData=this._chunks[dim],nearestIndices=[];if(!dimData)return nearestIndices;null==maxDistance&&(maxDistance=Infinity);for(var minDist=Infinity,minDiff=-1,nearestIndicesLen=0,i=0,len2=this.count();i<len2;i++){var diff=value-dimData[this.getRawIndex(i)],dist2=Math.abs(diff);dist2<=maxDistance&&((dist2<minDist||dist2===minDist&&diff>=0&&minDiff<0)&&(minDist=dist2,minDiff=diff,nearestIndicesLen=0),diff===minDiff&&(nearestIndices[nearestIndicesLen++]=i))}return nearestIndices.length=nearestIndicesLen,nearestIndices},DataStore2.prototype.getIndices=function(){var newIndices,indices=this._indices;if(indices){var Ctor=indices.constructor,thisCount=this._count;if(Ctor===Array){newIndices=new Ctor(thisCount);for(var i=0;i<thisCount;i++)newIndices[i]=indices[i]}else newIndices=new Ctor(indices.buffer,0,thisCount)}else{newIndices=new(Ctor=getIndicesCtor(this._rawCount))(this.count());for(i=0;i<newIndices.length;i++)newIndices[i]=i}return newIndices},DataStore2.prototype.filter=function(dims,cb){if(!this._count)return this;for(var newStore=this.clone(),count2=newStore.count(),newIndices=new(getIndicesCtor(newStore._rawCount))(count2),value=[],dimSize=dims.length,offset=0,dim0=dims[0],chunks=newStore._chunks,i=0;i<count2;i++){var keep=void 0,rawIdx=newStore.getRawIndex(i);if(0===dimSize)keep=cb(i);else if(1===dimSize){keep=cb(chunks[dim0][rawIdx],i)}else{for(var k=0;k<dimSize;k++)value[k]=chunks[dims[k]][rawIdx];value[k]=i,keep=cb.apply(null,value)}keep&&(newIndices[offset++]=rawIdx)}return offset<count2&&(newStore._indices=newIndices),newStore._count=offset,newStore._extent=[],newStore._updateGetRawIdx(),newStore},DataStore2.prototype.selectRange=function(range){var newStore=this.clone(),len2=newStore._count;if(!len2)return this;var dims=keys(range),dimSize=dims.length;if(!dimSize)return this;var originalCount=newStore.count(),newIndices=new(getIndicesCtor(newStore._rawCount))(originalCount),offset=0,dim0=dims[0],min3=range[dim0][0],max3=range[dim0][1],storeArr=newStore._chunks,quickFinished=!1;if(!newStore._indices){var idx=0;if(1===dimSize){for(var dimStorage=storeArr[dims[0]],i=0;i<len2;i++){((val=dimStorage[i])>=min3&&val<=max3||isNaN(val))&&(newIndices[offset++]=idx),idx++}quickFinished=!0}else if(2===dimSize){dimStorage=storeArr[dims[0]];var dimStorage2=storeArr[dims[1]],min22=range[dims[1]][0],max22=range[dims[1]][1];for(i=0;i<len2;i++){var val=dimStorage[i],val2=dimStorage2[i];(val>=min3&&val<=max3||isNaN(val))&&(val2>=min22&&val2<=max22||isNaN(val2))&&(newIndices[offset++]=idx),idx++}quickFinished=!0}}if(!quickFinished)if(1===dimSize)for(i=0;i<originalCount;i++){var rawIndex=newStore.getRawIndex(i);((val=storeArr[dims[0]][rawIndex])>=min3&&val<=max3||isNaN(val))&&(newIndices[offset++]=rawIndex)}else for(i=0;i<originalCount;i++){for(var keep=!0,k=(rawIndex=newStore.getRawIndex(i),0);k<dimSize;k++){var dimk=dims[k];((val=storeArr[dimk][rawIndex])<range[dimk][0]||val>range[dimk][1])&&(keep=!1)}keep&&(newIndices[offset++]=newStore.getRawIndex(i))}return offset<originalCount&&(newStore._indices=newIndices),newStore._count=offset,newStore._extent=[],newStore._updateGetRawIdx(),newStore},DataStore2.prototype.map=function(dims,cb){var target=this.clone(dims);return this._updateDims(target,dims,cb),target},DataStore2.prototype.modify=function(dims,cb){this._updateDims(this,dims,cb)},DataStore2.prototype._updateDims=function(target,dims,cb){for(var targetChunks=target._chunks,tmpRetValue=[],dimSize=dims.length,dataCount=target.count(),values=[],rawExtent=target._rawExtent,i=0;i<dims.length;i++)rawExtent[dims[i]]=[Infinity,-Infinity];for(var dataIndex=0;dataIndex<dataCount;dataIndex++){for(var rawIndex=target.getRawIndex(dataIndex),k=0;k<dimSize;k++)values[k]=targetChunks[dims[k]][rawIndex];values[dimSize]=dataIndex;var retValue=cb&&cb.apply(null,values);if(null!=retValue){"object"!=typeof retValue&&(tmpRetValue[0]=retValue,retValue=tmpRetValue);for(i=0;i<retValue.length;i++){var dim=dims[i],val=retValue[i],rawExtentOnDim=rawExtent[dim],dimStore=targetChunks[dim];dimStore&&(dimStore[rawIndex]=val),val<rawExtentOnDim[0]&&(rawExtentOnDim[0]=val),val>rawExtentOnDim[1]&&(rawExtentOnDim[1]=val)}}}},DataStore2.prototype.lttbDownSample=function(valueDimension,rate){var maxArea,area,nextRawIndex,target=this.clone([valueDimension],!0),dimStore=target._chunks[valueDimension],len2=this.count(),sampledIndex=0,frameSize=Math.floor(1/rate),currentRawIndex=this.getRawIndex(0),newIndices=new(getIndicesCtor(this._rawCount))(Math.min(2*(Math.ceil(len2/frameSize)+2),len2));newIndices[sampledIndex++]=currentRawIndex;for(var i=1;i<len2-1;i+=frameSize){for(var nextFrameStart=Math.min(i+frameSize,len2-1),nextFrameEnd=Math.min(i+2*frameSize,len2),avgX=(nextFrameEnd+nextFrameStart)/2,avgY=0,idx=nextFrameStart;idx<nextFrameEnd;idx++){var y=dimStore[rawIndex=this.getRawIndex(idx)];isNaN(y)||(avgY+=y)}avgY/=nextFrameEnd-nextFrameStart;var frameStart=i,frameEnd=Math.min(i+frameSize,len2),pointAX=i-1,pointAY=dimStore[currentRawIndex];maxArea=-1,nextRawIndex=frameStart;var firstNaNIndex=-1,countNaN=0;for(idx=frameStart;idx<frameEnd;idx++){var rawIndex;y=dimStore[rawIndex=this.getRawIndex(idx)];isNaN(y)?(countNaN++,firstNaNIndex<0&&(firstNaNIndex=rawIndex)):(area=Math.abs((pointAX-avgX)*(y-pointAY)-(pointAX-idx)*(avgY-pointAY)))>maxArea&&(maxArea=area,nextRawIndex=rawIndex)}countNaN>0&&countNaN<frameEnd-frameStart&&(newIndices[sampledIndex++]=Math.min(firstNaNIndex,nextRawIndex),nextRawIndex=Math.max(firstNaNIndex,nextRawIndex)),newIndices[sampledIndex++]=nextRawIndex,currentRawIndex=nextRawIndex}return newIndices[sampledIndex++]=this.getRawIndex(len2-1),target._count=sampledIndex,target._indices=newIndices,target.getRawIndex=this._getRawIdx,target},DataStore2.prototype.minmaxDownSample=function(valueDimension,rate){for(var target=this.clone([valueDimension],!0),targetStorage=target._chunks,frameSize=Math.floor(1/rate),dimStore=targetStorage[valueDimension],len2=this.count(),newIndices=new(getIndicesCtor(this._rawCount))(2*Math.ceil(len2/frameSize)),offset=0,i=0;i<len2;i+=frameSize){var minIndex=i,minValue=dimStore[this.getRawIndex(minIndex)],maxIndex=i,maxValue=dimStore[this.getRawIndex(maxIndex)],thisFrameSize=frameSize;i+frameSize>len2&&(thisFrameSize=len2-i);for(var k=0;k<thisFrameSize;k++){var value=dimStore[this.getRawIndex(i+k)];value<minValue&&(minValue=value,minIndex=i+k),value>maxValue&&(maxValue=value,maxIndex=i+k)}var rawMinIndex=this.getRawIndex(minIndex),rawMaxIndex=this.getRawIndex(maxIndex);minIndex<maxIndex?(newIndices[offset++]=rawMinIndex,newIndices[offset++]=rawMaxIndex):(newIndices[offset++]=rawMaxIndex,newIndices[offset++]=rawMinIndex)}return target._count=offset,target._indices=newIndices,target._updateGetRawIdx(),target},DataStore2.prototype.downSample=function(dimension,rate,sampleValue,sampleIndex){for(var target=this.clone([dimension],!0),targetStorage=target._chunks,frameValues=[],frameSize=Math.floor(1/rate),dimStore=targetStorage[dimension],len2=this.count(),rawExtentOnDim=target._rawExtent[dimension]=[Infinity,-Infinity],newIndices=new(getIndicesCtor(this._rawCount))(Math.ceil(len2/frameSize)),offset=0,i=0;i<len2;i+=frameSize){frameSize>len2-i&&(frameSize=len2-i,frameValues.length=frameSize);for(var k=0;k<frameSize;k++){var dataIdx=this.getRawIndex(i+k);frameValues[k]=dimStore[dataIdx]}var value=sampleValue(frameValues),sampleFrameIdx=this.getRawIndex(Math.min(i+sampleIndex(frameValues,value)||0,len2-1));dimStore[sampleFrameIdx]=value,value<rawExtentOnDim[0]&&(rawExtentOnDim[0]=value),value>rawExtentOnDim[1]&&(rawExtentOnDim[1]=value),newIndices[offset++]=sampleFrameIdx}return target._count=offset,target._indices=newIndices,target._updateGetRawIdx(),target},DataStore2.prototype.each=function(dims,cb){if(this._count)for(var dimSize=dims.length,chunks=this._chunks,i=0,len2=this.count();i<len2;i++){var rawIdx=this.getRawIndex(i);switch(dimSize){case 0:cb(i);break;case 1:cb(chunks[dims[0]][rawIdx],i);break;case 2:cb(chunks[dims[0]][rawIdx],chunks[dims[1]][rawIdx],i);break;default:for(var k=0,value=[];k<dimSize;k++)value[k]=chunks[dims[k]][rawIdx];value[k]=i,cb.apply(null,value)}}},DataStore2.prototype.getDataExtent=function(dim){var dimData=this._chunks[dim],initialExtent=[Infinity,-Infinity];if(!dimData)return initialExtent;var dimExtent,currEnd=this.count();if(!this._indices)return this._rawExtent[dim].slice();if(dimExtent=this._extent[dim])return dimExtent.slice();for(var min3=(dimExtent=initialExtent)[0],max3=dimExtent[1],i=0;i<currEnd;i++){var value=dimData[this.getRawIndex(i)];value<min3&&(min3=value),value>max3&&(max3=value)}return dimExtent=[min3,max3],this._extent[dim]=dimExtent,dimExtent},DataStore2.prototype.getRawDataItem=function(idx){var rawIdx=this.getRawIndex(idx);if(this._provider.persistent)return this._provider.getItem(rawIdx);for(var val=[],chunks=this._chunks,i=0;i<chunks.length;i++)val.push(chunks[i][rawIdx]);return val},DataStore2.prototype.clone=function(clonedDims,ignoreIndices){var originalChunk,Ctor,target=new DataStore2,chunks=this._chunks,clonedDimsMap=clonedDims&&reduce(clonedDims,(function(obj,dimIdx){return obj[dimIdx]=!0,obj}),{});if(clonedDimsMap)for(var i=0;i<chunks.length;i++)target._chunks[i]=clonedDimsMap[i]?(originalChunk=chunks[i],Ctor=void 0,(Ctor=originalChunk.constructor)===Array?originalChunk.slice():new Ctor(originalChunk)):chunks[i];else target._chunks=chunks;return this._copyCommonProps(target),ignoreIndices||(target._indices=this._cloneIndices()),target._updateGetRawIdx(),target},DataStore2.prototype._copyCommonProps=function(target){target._count=this._count,target._rawCount=this._rawCount,target._provider=this._provider,target._dimensions=this._dimensions,target._extent=clone$3(this._extent),target._rawExtent=clone$3(this._rawExtent)},DataStore2.prototype._cloneIndices=function(){if(this._indices){var Ctor=this._indices.constructor,indices=void 0;if(Ctor===Array){var thisCount=this._indices.length;indices=new Ctor(thisCount);for(var i=0;i<thisCount;i++)indices[i]=this._indices[i]}else indices=new Ctor(this._indices);return indices}return null},DataStore2.prototype._getRawIdxIdentity=function(idx){return idx},DataStore2.prototype._getRawIdx=function(idx){return idx<this._count&&idx>=0?this._indices[idx]:-1},DataStore2.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},DataStore2.internalField=function(){function getDimValueSimply(dataItem,property,dataIndex,dimIndex){return parseDataValue(dataItem[dimIndex],this._dimensions[dimIndex])}defaultDimValueGetters={arrayRows:getDimValueSimply,objectRows:function(dataItem,property,dataIndex,dimIndex){return parseDataValue(dataItem[property],this._dimensions[dimIndex])},keyedColumns:getDimValueSimply,original:function(dataItem,property,dataIndex,dimIndex){var value=dataItem&&(null==dataItem.value?dataItem:dataItem.value);return parseDataValue(value instanceof Array?value[dimIndex]:value,this._dimensions[dimIndex])},typedArray:function(dataItem,property,dataIndex,dimIndex){return dataItem[dimIndex]}}}(),DataStore2}(),SourceManager=function(){function SourceManager2(sourceHost){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=sourceHost}return SourceManager2.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},SourceManager2.prototype._setLocalSource=function(sourceList,upstreamSignList){this._sourceList=sourceList,this._upstreamSignList=upstreamSignList,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},SourceManager2.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},SourceManager2.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},SourceManager2.prototype._createSource=function(){this._setLocalSource([],[]);var resultSourceList,upstreamSignList,sourceHost=this._sourceHost,upSourceMgrList=this._getUpstreamSourceManagers(),hasUpstream=!!upSourceMgrList.length;if(isSeries(sourceHost)){var seriesModel=sourceHost,data=void 0,sourceFormat=void 0,upSource=void 0;if(hasUpstream){var upSourceMgr=upSourceMgrList[0];upSourceMgr.prepareSource(),data=(upSource=upSourceMgr.getSource()).data,sourceFormat=upSource.sourceFormat,upstreamSignList=[upSourceMgr._getVersionSign()]}else sourceFormat=isTypedArray(data=seriesModel.get("data",!0))?"typedArray":"original",upstreamSignList=[];var newMetaRawOption=this._getSourceMetaRawOption()||{},upMetaRawOption=upSource&&upSource.metaRawOption||{},seriesLayoutBy=retrieve2(newMetaRawOption.seriesLayoutBy,upMetaRawOption.seriesLayoutBy)||null,sourceHeader=retrieve2(newMetaRawOption.sourceHeader,upMetaRawOption.sourceHeader),dimensions=retrieve2(newMetaRawOption.dimensions,upMetaRawOption.dimensions);resultSourceList=seriesLayoutBy!==upMetaRawOption.seriesLayoutBy||!!sourceHeader!=!!upMetaRawOption.sourceHeader||dimensions?[createSource(data,{seriesLayoutBy:seriesLayoutBy,sourceHeader:sourceHeader,dimensions:dimensions},sourceFormat)]:[]}else{var datasetModel=sourceHost;if(hasUpstream){var result=this._applyTransform(upSourceMgrList);resultSourceList=result.sourceList,upstreamSignList=result.upstreamSignList}else{resultSourceList=[createSource(datasetModel.get("source",!0),this._getSourceMetaRawOption(),null)],upstreamSignList=[]}}this._setLocalSource(resultSourceList,upstreamSignList)},SourceManager2.prototype._applyTransform=function(upMgrList){var sourceList,datasetModel=this._sourceHost,transformOption=datasetModel.get("transform",!0),fromTransformResult=datasetModel.get("fromTransformResult",!0);if(null!=fromTransformResult){1!==upMgrList.length&&doThrow("")}var source,upSourceList=[],upstreamSignList=[];return each$d(upMgrList,(function(upMgr){upMgr.prepareSource();var upSource=upMgr.getSource(fromTransformResult||0);null==fromTransformResult||upSource||doThrow(""),upSourceList.push(upSource),upstreamSignList.push(upMgr._getVersionSign())})),transformOption?sourceList=function(rawTransOption,sourceList){var pipedTransOption=normalizeToArray(rawTransOption),pipeLen=pipedTransOption.length;pipeLen||throwError("");for(var i=0,len2=pipeLen;i<len2;i++)sourceList=applySingleDataTransform(pipedTransOption[i],sourceList),i!==len2-1&&(sourceList.length=Math.max(sourceList.length,1));return sourceList}(transformOption,upSourceList,datasetModel.componentIndex):null!=fromTransformResult&&(sourceList=[(source=upSourceList[0],new SourceImpl({data:source.data,sourceFormat:source.sourceFormat,seriesLayoutBy:source.seriesLayoutBy,dimensionsDefine:clone$3(source.dimensionsDefine),startIndex:source.startIndex,dimensionsDetectedCount:source.dimensionsDetectedCount}))]),{sourceList:sourceList,upstreamSignList:upstreamSignList}},SourceManager2.prototype._isDirty=function(){if(this._dirty)return!0;for(var upSourceMgrList=this._getUpstreamSourceManagers(),i=0;i<upSourceMgrList.length;i++){var upSrcMgr=upSourceMgrList[i];if(upSrcMgr._isDirty()||this._upstreamSignList[i]!==upSrcMgr._getVersionSign())return!0}},SourceManager2.prototype.getSource=function(sourceIndex){sourceIndex=sourceIndex||0;var source=this._sourceList[sourceIndex];if(!source){var upSourceMgrList=this._getUpstreamSourceManagers();return upSourceMgrList[0]&&upSourceMgrList[0].getSource(sourceIndex)}return source},SourceManager2.prototype.getSharedDataStore=function(seriesDimRequest){var schema=seriesDimRequest.makeStoreSchema();return this._innerGetDataStore(schema.dimensions,seriesDimRequest.source,schema.hash)},SourceManager2.prototype._innerGetDataStore=function(storeDims,seriesSource,sourceReadKey){var storeList=this._storeList,cachedStoreMap=storeList[0];cachedStoreMap||(cachedStoreMap=storeList[0]={});var cachedStore=cachedStoreMap[sourceReadKey];if(!cachedStore){var upSourceMgr=this._getUpstreamSourceManagers()[0];isSeries(this._sourceHost)&&upSourceMgr?cachedStore=upSourceMgr._innerGetDataStore(storeDims,seriesSource,sourceReadKey):(cachedStore=new DataStore).initData(new DefaultDataProvider(seriesSource,storeDims.length),storeDims),cachedStoreMap[sourceReadKey]=cachedStore}return cachedStore},SourceManager2.prototype._getUpstreamSourceManagers=function(){var sourceHost=this._sourceHost;if(isSeries(sourceHost)){var datasetModel=querySeriesUpstreamDatasetModel(sourceHost);return datasetModel?[datasetModel.getSourceManager()]:[]}return map$1(function(datasetModel){return datasetModel.get("transform",!0)||datasetModel.get("fromTransformResult",!0)?queryReferringComponents(datasetModel.ecModel,"dataset",{index:datasetModel.get("fromDatasetIndex",!0),id:datasetModel.get("fromDatasetId",!0)},SINGLE_REFERRING).models:[]}(sourceHost),(function(datasetModel2){return datasetModel2.getSourceManager()}))},SourceManager2.prototype._getSourceMetaRawOption=function(){var seriesLayoutBy,sourceHeader,dimensions,sourceHost=this._sourceHost;if(isSeries(sourceHost))seriesLayoutBy=sourceHost.get("seriesLayoutBy",!0),sourceHeader=sourceHost.get("sourceHeader",!0),dimensions=sourceHost.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var model=sourceHost;seriesLayoutBy=model.get("seriesLayoutBy",!0),sourceHeader=model.get("sourceHeader",!0),dimensions=model.get("dimensions",!0)}return{seriesLayoutBy:seriesLayoutBy,sourceHeader:sourceHeader,dimensions:dimensions}},SourceManager2}();function isSeries(sourceHost){return"series"===sourceHost.mainType}function doThrow(errMsg){throw new Error(errMsg)}function getTooltipLineHeight(textStyle){var lineHeight=textStyle.lineHeight;return null==lineHeight?"line-height:1":"line-height:"+encodeHTML(lineHeight+"")+"px"}function getTooltipTextStyle(textStyle,renderMode){var nameFontColor=textStyle.color||"#6e7079",nameFontSize=textStyle.fontSize||12,nameFontWeight=textStyle.fontWeight||"400",valueFontColor=textStyle.color||"#464646",valueFontSize=textStyle.fontSize||14,valueFontWeight=textStyle.fontWeight||"900";return"html"===renderMode?{nameStyle:"font-size:"+encodeHTML(nameFontSize+"")+"px;color:"+encodeHTML(nameFontColor)+";font-weight:"+encodeHTML(nameFontWeight+""),valueStyle:"font-size:"+encodeHTML(valueFontSize+"")+"px;color:"+encodeHTML(valueFontColor)+";font-weight:"+encodeHTML(valueFontWeight+"")}:{nameStyle:{fontSize:nameFontSize,fill:nameFontColor,fontWeight:nameFontWeight},valueStyle:{fontSize:valueFontSize,fill:valueFontColor,fontWeight:valueFontWeight}}}var HTML_GAPS=[0,10,20,30],RICH_TEXT_GAPS=["","\n","\n\n","\n\n\n"];function createTooltipMarkup(type,option){return option.type=type,option}function isSectionFragment(frag){return"section"===frag.type}function getBuilder(frag){return isSectionFragment(frag)?buildSection:buildNameValue}function getBlockGapLevel(frag){if(isSectionFragment(frag)){var gapLevel_1=0,subBlockLen=frag.blocks.length,hasInnerGap_1=subBlockLen>1||subBlockLen>0&&!frag.noHeader;return each$d(frag.blocks,(function(subBlock){var subGapLevel=getBlockGapLevel(subBlock);subGapLevel>=gapLevel_1&&(gapLevel_1=subGapLevel+ +(hasInnerGap_1&&(!subGapLevel||isSectionFragment(subBlock)&&!subBlock.noHeader)))})),gapLevel_1}return 0}function buildSection(ctx,fragment,topMarginForOuterGap,toolTipTextStyle){var gapLevel,noHeader=fragment.noHeader,gaps=(gapLevel=getBlockGapLevel(fragment),{html:HTML_GAPS[gapLevel],richText:RICH_TEXT_GAPS[gapLevel]}),subMarkupTextList=[],subBlocks=fragment.blocks||[];assert(!subBlocks||isArray$1(subBlocks)),subBlocks=subBlocks||[];var orderMode=ctx.orderMode;if(fragment.sortBlocks&&orderMode){subBlocks=subBlocks.slice();var orderMap={valueAsc:"asc",valueDesc:"desc"};if(hasOwn(orderMap,orderMode)){var comparator_1=new SortOrderComparator(orderMap[orderMode],null);subBlocks.sort((function(a,b){return comparator_1.evaluate(a.sortParam,b.sortParam)}))}else"seriesDesc"===orderMode&&subBlocks.reverse()}each$d(subBlocks,(function(subBlock,idx){var valueFormatter=fragment.valueFormatter,subMarkupText2=getBuilder(subBlock)(valueFormatter?extend(extend({},ctx),{valueFormatter:valueFormatter}):ctx,subBlock,idx>0?gaps.html:0,toolTipTextStyle);null!=subMarkupText2&&subMarkupTextList.push(subMarkupText2)}));var subMarkupText="richText"===ctx.renderMode?subMarkupTextList.join(gaps.richText):wrapBlockHTML(toolTipTextStyle,subMarkupTextList.join(""),noHeader?topMarginForOuterGap:gaps.html);if(noHeader)return subMarkupText;var displayableHeader=makeValueReadable(fragment.header,"ordinal",ctx.useUTC),nameStyle=getTooltipTextStyle(toolTipTextStyle,ctx.renderMode).nameStyle,tooltipLineHeight=getTooltipLineHeight(toolTipTextStyle);return"richText"===ctx.renderMode?wrapInlineNameRichText(ctx,displayableHeader,nameStyle)+gaps.richText+subMarkupText:wrapBlockHTML(toolTipTextStyle,'<div style="'+nameStyle+";"+tooltipLineHeight+';">'+encodeHTML(displayableHeader)+"</div>"+subMarkupText,topMarginForOuterGap)}function buildNameValue(ctx,fragment,topMarginForOuterGap,toolTipTextStyle){var renderMode=ctx.renderMode,noName=fragment.noName,noValue=fragment.noValue,noMarker=!fragment.markerType,name=fragment.name,useUTC=ctx.useUTC,valueFormatter=fragment.valueFormatter||ctx.valueFormatter||function(value){return map$1(value=isArray$1(value)?value:[value],(function(val,idx){return makeValueReadable(val,isArray$1(valueTypeOption)?valueTypeOption[idx]:valueTypeOption,useUTC)}))};if(!noName||!noValue){var markerStr=noMarker?"":ctx.markupStyleCreator.makeTooltipMarker(fragment.markerType,fragment.markerColor||"#333",renderMode),readableName=noName?"":makeValueReadable(name,"ordinal",useUTC),valueTypeOption=fragment.valueType,readableValueList=noValue?[]:valueFormatter(fragment.value,fragment.dataIndex),valueAlignRight=!noMarker||!noName,valueCloseToMarker=!noMarker&&noName,_a2=getTooltipTextStyle(toolTipTextStyle,renderMode),nameStyle=_a2.nameStyle,valueStyle=_a2.valueStyle;return"richText"===renderMode?(noMarker?"":markerStr)+(noName?"":wrapInlineNameRichText(ctx,readableName,nameStyle))+(noValue?"":function(ctx,values,alignRight,valueCloseToMarker,style){var styles=[style],paddingLeft=valueCloseToMarker?10:20;return alignRight&&styles.push({padding:[0,0,0,paddingLeft],align:"right"}),ctx.markupStyleCreator.wrapRichTextStyle(isArray$1(values)?values.join("  "):values,styles)}(ctx,readableValueList,valueAlignRight,valueCloseToMarker,valueStyle)):wrapBlockHTML(toolTipTextStyle,(noMarker?"":markerStr)+(noName?"":function(name,leftHasMarker,style){return'<span style="'+style+";"+(leftHasMarker?"margin-left:2px":"")+'">'+encodeHTML(name)+"</span>"}(readableName,!noMarker,nameStyle))+(noValue?"":function(valueList,alignRight,valueCloseToMarker,style){var paddingStr=valueCloseToMarker?"10px":"20px",alignCSS=alignRight?"float:right;margin-left:"+paddingStr:"";return valueList=isArray$1(valueList)?valueList:[valueList],'<span style="'+alignCSS+";"+style+'">'+map$1(valueList,(function(value){return encodeHTML(value)})).join("&nbsp;&nbsp;")+"</span>"}(readableValueList,valueAlignRight,valueCloseToMarker,valueStyle)),topMarginForOuterGap)}}function buildTooltipMarkup(fragment,markupStyleCreator,renderMode,orderMode,useUTC,toolTipTextStyle){if(fragment)return getBuilder(fragment)({useUTC:useUTC,renderMode:renderMode,orderMode:orderMode,markupStyleCreator:markupStyleCreator,valueFormatter:fragment.valueFormatter},fragment,0,toolTipTextStyle)}function wrapBlockHTML(textStyle,encodedContent,topGap){return'<div style="'+("margin: "+topGap+"px 0 0")+";"+getTooltipLineHeight(textStyle)+';">'+encodedContent+'<div style="clear:both"></div></div>'}function wrapInlineNameRichText(ctx,name,style){return ctx.markupStyleCreator.wrapRichTextStyle(name,style)}function retrieveVisualColorForTooltipMarker(series,dataIndex){return convertToColorString(series.getData().getItemVisual(dataIndex,"style")[series.visualDrawType])}function getPaddingFromTooltipModel(model,renderMode){var padding=model.get("padding");return null!=padding?padding:"richText"===renderMode?[8,10]:10}var TooltipMarkupStyleCreator=function(){function TooltipMarkupStyleCreator2(){this.richTextStyles={},this._nextStyleNameId=getRandomIdBase()}return TooltipMarkupStyleCreator2.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},TooltipMarkupStyleCreator2.prototype.makeTooltipMarker=function(markerType,colorStr,renderMode){var markerId="richText"===renderMode?this._generateStyleName():null,marker=getTooltipMarker({color:colorStr,type:markerType,renderMode:renderMode,markerId:markerId});return isString(marker)?marker:(this.richTextStyles[markerId]=marker.style,marker.content)},TooltipMarkupStyleCreator2.prototype.wrapRichTextStyle=function(text,styles){var finalStl={};isArray$1(styles)?each$d(styles,(function(stl){return extend(finalStl,stl)})):extend(finalStl,styles);var styleName=this._generateStyleName();return this.richTextStyles[styleName]=finalStl,"{"+styleName+"|"+text+"}"},TooltipMarkupStyleCreator2}();function defaultSeriesFormatTooltip(opt){var inlineValue,inlineValueType,subBlocks,sortParam,series=opt.series,dataIndex=opt.dataIndex,multipleSeries=opt.multipleSeries,data=series.getData(),tooltipDims=data.mapDimensionsAll("defaultedTooltip"),tooltipDimLen=tooltipDims.length,value=series.getRawValue(dataIndex),isValueArr=isArray$1(value),markerColor=retrieveVisualColorForTooltipMarker(series,dataIndex);if(tooltipDimLen>1||isValueArr&&!tooltipDimLen){var formatArrResult=function(value,series,dataIndex,tooltipDims,colorStr){var data=series.getData(),isValueMultipleLine=reduce(value,(function(isValueMultipleLine2,val,idx){var dimItem=data.getDimensionInfo(idx);return isValueMultipleLine2||dimItem&&!1!==dimItem.tooltip&&null!=dimItem.displayName}),!1),inlineValues=[],inlineValueTypes=[],blocks=[];function setEachItem(val,dim){var dimInfo=data.getDimensionInfo(dim);dimInfo&&!1!==dimInfo.otherDims.tooltip&&(isValueMultipleLine?blocks.push(createTooltipMarkup("nameValue",{markerType:"subItem",markerColor:colorStr,name:dimInfo.displayName,value:val,valueType:dimInfo.type})):(inlineValues.push(val),inlineValueTypes.push(dimInfo.type)))}return tooltipDims.length?each$d(tooltipDims,(function(dim){setEachItem(retrieveRawValue(data,dataIndex,dim),dim)})):each$d(value,setEachItem),{inlineValues:inlineValues,inlineValueTypes:inlineValueTypes,blocks:blocks}}(value,series,dataIndex,tooltipDims,markerColor);inlineValue=formatArrResult.inlineValues,inlineValueType=formatArrResult.inlineValueTypes,subBlocks=formatArrResult.blocks,sortParam=formatArrResult.inlineValues[0]}else if(tooltipDimLen){var dimInfo=data.getDimensionInfo(tooltipDims[0]);sortParam=inlineValue=retrieveRawValue(data,dataIndex,tooltipDims[0]),inlineValueType=dimInfo.type}else sortParam=inlineValue=isValueArr?value[0]:value;var seriesNameSpecified=isNameSpecified(series),seriesName=seriesNameSpecified&&series.name||"",itemName=data.getName(dataIndex),inlineName=multipleSeries?seriesName:itemName;return createTooltipMarkup("section",{header:seriesName,noHeader:multipleSeries||!seriesNameSpecified,sortParam:sortParam,blocks:[createTooltipMarkup("nameValue",{markerType:"item",markerColor:markerColor,name:inlineName,noName:!trim$1(inlineName),value:inlineValue,valueType:inlineValueType,dataIndex:dataIndex})].concat(subBlocks||[])})}var inner$d=makeInner();function getSelectionKey(data,dataIndex){return data.getName(dataIndex)||data.getId(dataIndex)}var SeriesModel=function(_super){function SeriesModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this._selectedDataIndicesMap={},_this}var proto2;return __extends(SeriesModel2,_super),SeriesModel2.prototype.init=function(option,parentModel,ecModel){this.seriesIndex=this.componentIndex,this.dataTask=createTask({count:dataTaskCount,reset:dataTaskReset}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(option,ecModel),(inner$d(this).sourceManager=new SourceManager(this)).prepareSource();var data=this.getInitialData(option,ecModel);wrapData(data,this),this.dataTask.context.data=data,inner$d(this).dataBeforeProcessed=data,autoSeriesName(this),this._initSelectedMapFromData(data)},SeriesModel2.prototype.mergeDefaultAndTheme=function(option,ecModel){var layoutMode=fetchLayoutMode(this),inputPositionParams=layoutMode?getLayoutParams(option):{},themeSubType=this.subType;ComponentModel.hasClass(themeSubType)&&(themeSubType+="Series"),merge(option,ecModel.getTheme().get(this.subType)),merge(option,this.getDefaultOption()),defaultEmphasis(option,"label",["show"]),this.fillDataTextStyle(option.data),layoutMode&&mergeLayoutParam(option,inputPositionParams,layoutMode)},SeriesModel2.prototype.mergeOption=function(newSeriesOption,ecModel){newSeriesOption=merge(this.option,newSeriesOption,!0),this.fillDataTextStyle(newSeriesOption.data);var layoutMode=fetchLayoutMode(this);layoutMode&&mergeLayoutParam(this.option,newSeriesOption,layoutMode);var sourceManager=inner$d(this).sourceManager;sourceManager.dirty(),sourceManager.prepareSource();var data=this.getInitialData(newSeriesOption,ecModel);wrapData(data,this),this.dataTask.dirty(),this.dataTask.context.data=data,inner$d(this).dataBeforeProcessed=data,autoSeriesName(this),this._initSelectedMapFromData(data)},SeriesModel2.prototype.fillDataTextStyle=function(data){if(data&&!isTypedArray(data))for(var props=["show"],i=0;i<data.length;i++)data[i]&&data[i].label&&defaultEmphasis(data[i],"label",props)},SeriesModel2.prototype.getInitialData=function(option,ecModel){},SeriesModel2.prototype.appendData=function(params){this.getRawData().appendData(params.data)},SeriesModel2.prototype.getData=function(dataType){var task=getCurrentTask(this);if(task){var data=task.context.data;return null!=dataType&&data.getLinkedData?data.getLinkedData(dataType):data}return inner$d(this).data},SeriesModel2.prototype.getAllData=function(){var mainData=this.getData();return mainData&&mainData.getLinkedDataAll?mainData.getLinkedDataAll():[{data:mainData}]},SeriesModel2.prototype.setData=function(data){var task=getCurrentTask(this);if(task){var context=task.context;context.outputData=data,task!==this.dataTask&&(context.data=data)}inner$d(this).data=data},SeriesModel2.prototype.getEncode=function(){var encode=this.get("encode",!0);if(encode)return createHashMap(encode)},SeriesModel2.prototype.getSourceManager=function(){return inner$d(this).sourceManager},SeriesModel2.prototype.getSource=function(){return this.getSourceManager().getSource()},SeriesModel2.prototype.getRawData=function(){return inner$d(this).dataBeforeProcessed},SeriesModel2.prototype.getColorBy=function(){return this.get("colorBy")||"series"},SeriesModel2.prototype.isColorBySeries=function(){return"series"===this.getColorBy()},SeriesModel2.prototype.getBaseAxis=function(){var coordSys=this.coordinateSystem;return coordSys&&coordSys.getBaseAxis&&coordSys.getBaseAxis()},SeriesModel2.prototype.formatTooltip=function(dataIndex,multipleSeries,dataType){return defaultSeriesFormatTooltip({series:this,dataIndex:dataIndex,multipleSeries:multipleSeries})},SeriesModel2.prototype.isAnimationEnabled=function(){var ecModel=this.ecModel;if(env.node&&(!ecModel||!ecModel.ssr))return!1;var animationEnabled=this.getShallow("animation");return animationEnabled&&this.getData().count()>this.getShallow("animationThreshold")&&(animationEnabled=!1),!!animationEnabled},SeriesModel2.prototype.restoreData=function(){this.dataTask.dirty()},SeriesModel2.prototype.getColorFromPalette=function(name,scope,requestColorNum){var ecModel=this.ecModel,color2=PaletteMixin.prototype.getColorFromPalette.call(this,name,scope,requestColorNum);return color2||(color2=ecModel.getColorFromPalette(name,scope,requestColorNum)),color2},SeriesModel2.prototype.coordDimToDataDim=function(coordDim){return this.getRawData().mapDimensionsAll(coordDim)},SeriesModel2.prototype.getProgressive=function(){return this.get("progressive")},SeriesModel2.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},SeriesModel2.prototype.select=function(innerDataIndices,dataType){this._innerSelect(this.getData(dataType),innerDataIndices)},SeriesModel2.prototype.unselect=function(innerDataIndices,dataType){var selectedMap=this.option.selectedMap;if(selectedMap){var selectedMode=this.option.selectedMode,data=this.getData(dataType);if("series"===selectedMode||"all"===selectedMap)return this.option.selectedMap={},void(this._selectedDataIndicesMap={});for(var i=0;i<innerDataIndices.length;i++){var nameOrId=getSelectionKey(data,innerDataIndices[i]);selectedMap[nameOrId]=!1,this._selectedDataIndicesMap[nameOrId]=-1}}},SeriesModel2.prototype.toggleSelect=function(innerDataIndices,dataType){for(var tmpArr2=[],i=0;i<innerDataIndices.length;i++)tmpArr2[0]=innerDataIndices[i],this.isSelected(innerDataIndices[i],dataType)?this.unselect(tmpArr2,dataType):this.select(tmpArr2,dataType)},SeriesModel2.prototype.getSelectedDataIndices=function(){if("all"===this.option.selectedMap)return[].slice.call(this.getData().getIndices());for(var selectedDataIndicesMap=this._selectedDataIndicesMap,nameOrIds=keys(selectedDataIndicesMap),dataIndices=[],i=0;i<nameOrIds.length;i++){var dataIndex=selectedDataIndicesMap[nameOrIds[i]];dataIndex>=0&&dataIndices.push(dataIndex)}return dataIndices},SeriesModel2.prototype.isSelected=function(dataIndex,dataType){var selectedMap=this.option.selectedMap;if(!selectedMap)return!1;var data=this.getData(dataType);return("all"===selectedMap||selectedMap[getSelectionKey(data,dataIndex)])&&!data.getItemModel(dataIndex).get(["select","disabled"])},SeriesModel2.prototype.isUniversalTransitionEnabled=function(){if(this.__universalTransitionEnabled)return!0;var universalTransitionOpt=this.option.universalTransition;return!!universalTransitionOpt&&(!0===universalTransitionOpt||universalTransitionOpt&&universalTransitionOpt.enabled)},SeriesModel2.prototype._innerSelect=function(data,innerDataIndices){var _a2,_b2,option=this.option,selectedMode=option.selectedMode,len2=innerDataIndices.length;if(selectedMode&&len2)if("series"===selectedMode)option.selectedMap="all";else if("multiple"===selectedMode){isObject$3(option.selectedMap)||(option.selectedMap={});for(var selectedMap=option.selectedMap,i=0;i<len2;i++){var dataIndex=innerDataIndices[i];selectedMap[nameOrId=getSelectionKey(data,dataIndex)]=!0,this._selectedDataIndicesMap[nameOrId]=data.getRawIndex(dataIndex)}}else if("single"===selectedMode||!0===selectedMode){var lastDataIndex=innerDataIndices[len2-1],nameOrId=getSelectionKey(data,lastDataIndex);option.selectedMap=((_a2={})[nameOrId]=!0,_a2),this._selectedDataIndicesMap=((_b2={})[nameOrId]=data.getRawIndex(lastDataIndex),_b2)}},SeriesModel2.prototype._initSelectedMapFromData=function(data){if(!this.option.selectedMap){var dataIndices=[];data.hasItemOption&&data.each((function(idx){var rawItem=data.getRawDataItem(idx);rawItem&&rawItem.selected&&dataIndices.push(idx)})),dataIndices.length>0&&this._innerSelect(data,dataIndices)}},SeriesModel2.registerClass=function(clz){return ComponentModel.registerClass(clz)},SeriesModel2.protoInitialize=((proto2=SeriesModel2.prototype).type="series.__base__",proto2.seriesIndex=0,proto2.ignoreStyleOnData=!1,proto2.hasSymbolVisual=!1,proto2.defaultSymbol="circle",proto2.visualStyleAccessPath="itemStyle",void(proto2.visualDrawType="fill")),SeriesModel2}(ComponentModel);function autoSeriesName(seriesModel){var name=seriesModel.name;isNameSpecified(seriesModel)||(seriesModel.name=function(seriesModel){var data=seriesModel.getRawData(),dataDims=data.mapDimensionsAll("seriesName"),nameArr=[];return each$d(dataDims,(function(dataDim){var dimInfo=data.getDimensionInfo(dataDim);dimInfo.displayName&&nameArr.push(dimInfo.displayName)})),nameArr.join(" ")}(seriesModel)||name)}function dataTaskCount(context){return context.model.getRawData().count()}function dataTaskReset(context){var seriesModel=context.model;return seriesModel.setData(seriesModel.getRawData().cloneShallow()),dataTaskProgress}function dataTaskProgress(param,context){context.outputData&&param.end>context.outputData.count()&&context.model.getRawData().cloneShallow(context.outputData)}function wrapData(data,seriesModel){each$d(concatArray(data.CHANGABLE_METHODS,data.DOWNSAMPLE_METHODS),(function(methodName){data.wrapMethod(methodName,curry$1(onDataChange,seriesModel))}))}function onDataChange(seriesModel,newList){var task=getCurrentTask(seriesModel);return task&&task.setOutputEnd((newList||this).count()),newList}function getCurrentTask(seriesModel){var scheduler=(seriesModel.ecModel||{}).scheduler,pipeline=scheduler&&scheduler.getPipeline(seriesModel.uid);if(pipeline){var task=pipeline.currentTask;if(task){var agentStubMap=task.agentStubMap;agentStubMap&&(task=agentStubMap.get(seriesModel.uid))}return task}}mixin(SeriesModel,DataFormatMixin),mixin(SeriesModel,PaletteMixin),mountExtend(SeriesModel,ComponentModel);var ComponentView=function(){function ComponentView2(){this.group=new Group$2,this.uid=getUID("viewComponent")}return ComponentView2.prototype.init=function(ecModel,api){},ComponentView2.prototype.render=function(model,ecModel,api,payload){},ComponentView2.prototype.dispose=function(ecModel,api){},ComponentView2.prototype.updateView=function(model,ecModel,api,payload){},ComponentView2.prototype.updateLayout=function(model,ecModel,api,payload){},ComponentView2.prototype.updateVisual=function(model,ecModel,api,payload){},ComponentView2.prototype.toggleBlurSeries=function(seriesModels,isBlur,ecModel){},ComponentView2.prototype.eachRendered=function(cb){var group=this.group;group&&group.traverse(cb)},ComponentView2}();function createRenderPlanner(){var inner2=makeInner();return function(seriesModel){var fields=inner2(seriesModel),pipelineContext=seriesModel.pipelineContext,originalLarge=!!fields.large,originalProgressive=!!fields.progressiveRender,large=fields.large=!(!pipelineContext||!pipelineContext.large),progressive=fields.progressiveRender=!(!pipelineContext||!pipelineContext.progressiveRender);return!(originalLarge===large&&originalProgressive===progressive)&&"reset"}}enableClassExtend(ComponentView),enableClassManagement(ComponentView);var inner$c=makeInner(),renderPlanner=createRenderPlanner(),ChartView=function(){function ChartView2(){this.group=new Group$2,this.uid=getUID("viewChart"),this.renderTask=createTask({plan:renderTaskPlan,reset:renderTaskReset}),this.renderTask.context={view:this}}return ChartView2.prototype.init=function(ecModel,api){},ChartView2.prototype.render=function(seriesModel,ecModel,api,payload){},ChartView2.prototype.highlight=function(seriesModel,ecModel,api,payload){var data=seriesModel.getData(payload&&payload.dataType);data&&toggleHighlight(data,payload,"emphasis")},ChartView2.prototype.downplay=function(seriesModel,ecModel,api,payload){var data=seriesModel.getData(payload&&payload.dataType);data&&toggleHighlight(data,payload,"normal")},ChartView2.prototype.remove=function(ecModel,api){this.group.removeAll()},ChartView2.prototype.dispose=function(ecModel,api){},ChartView2.prototype.updateView=function(seriesModel,ecModel,api,payload){this.render(seriesModel,ecModel,api,payload)},ChartView2.prototype.updateLayout=function(seriesModel,ecModel,api,payload){this.render(seriesModel,ecModel,api,payload)},ChartView2.prototype.updateVisual=function(seriesModel,ecModel,api,payload){this.render(seriesModel,ecModel,api,payload)},ChartView2.prototype.eachRendered=function(cb){traverseElements(this.group,cb)},ChartView2.markUpdateMethod=function(payload,methodName){inner$c(payload).updateMethod=methodName},ChartView2.protoInitialize=void(ChartView2.prototype.type="chart"),ChartView2}();function elSetState(el,state,highlightDigit){el&&isHighDownDispatcher(el)&&("emphasis"===state?enterEmphasis:leaveEmphasis)(el,highlightDigit)}function toggleHighlight(data,payload,state){var dataIndex=queryDataIndex(data,payload),highlightDigit=payload&&null!=payload.highlightKey?function(highlightKey){var highlightDigit=_highlightKeyMap[highlightKey];return null==highlightDigit&&_highlightNextDigit<=32&&(highlightDigit=_highlightKeyMap[highlightKey]=_highlightNextDigit++),highlightDigit}(payload.highlightKey):null;null!=dataIndex?each$d(normalizeToArray(dataIndex),(function(dataIdx){elSetState(data.getItemGraphicEl(dataIdx),state,highlightDigit)})):data.eachItemGraphicEl((function(el){elSetState(el,state,highlightDigit)}))}function renderTaskPlan(context){return renderPlanner(context.model)}function renderTaskReset(context){var seriesModel=context.model,ecModel=context.ecModel,api=context.api,payload=context.payload,progressiveRender=seriesModel.pipelineContext.progressiveRender,view=context.view,updateMethod=payload&&inner$c(payload).updateMethod,methodName=progressiveRender?"incrementalPrepareRender":updateMethod&&view[updateMethod]?updateMethod:"render";return"render"!==methodName&&view[methodName](seriesModel,ecModel,api,payload),progressMethodMap[methodName]}enableClassExtend(ChartView),enableClassManagement(ChartView);var progressMethodMap={incrementalPrepareRender:{progress:function(params,context){context.view.incrementalRender(params,context.model,context.ecModel,context.api,context.payload)}},render:{forceFirstProgress:!0,progress:function(params,context){context.view.render(context.model,context.ecModel,context.api,context.payload)}}},ORIGIN_METHOD="\0__throttleOriginMethod",RATE="\0__throttleRate";function throttle(fn,delay,debounce){var currCall,diff,scope,args,debounceNextCall,lastCall=0,lastExec=0,timer=null;function exec(){lastExec=(new Date).getTime(),timer=null,fn.apply(scope,args||[])}delay=delay||0;var cb=function(){for(var cbArgs=[],_i=0;_i<arguments.length;_i++)cbArgs[_i]=arguments[_i];currCall=(new Date).getTime(),scope=this,args=cbArgs;var thisDelay=debounceNextCall||delay,thisDebounce=debounceNextCall||debounce;debounceNextCall=null,diff=currCall-(thisDebounce?lastCall:lastExec)-thisDelay,clearTimeout(timer),thisDebounce?timer=setTimeout(exec,thisDelay):diff>=0?exec():timer=setTimeout(exec,-diff),lastCall=currCall};return cb.clear=function(){timer&&(clearTimeout(timer),timer=null)},cb.debounceNextCall=function(debounceDelay){debounceNextCall=debounceDelay},cb}function createOrUpdate(obj,fnAttr,rate,throttleType){var fn=obj[fnAttr];if(fn){var originFn=fn[ORIGIN_METHOD]||fn,lastThrottleType=fn["\0__throttleType"];if(fn[RATE]!==rate||lastThrottleType!==throttleType){if(null==rate)return obj[fnAttr]=originFn;(fn=obj[fnAttr]=throttle(originFn,rate,"debounce"===throttleType))[ORIGIN_METHOD]=originFn,fn["\0__throttleType"]=throttleType,fn[RATE]=rate}return fn}}function clear$1(obj,fnAttr){var fn=obj[fnAttr];fn&&fn[ORIGIN_METHOD]&&(fn.clear&&fn.clear(),obj[fnAttr]=fn[ORIGIN_METHOD])}var inner$b=makeInner(),defaultStyleMappers={itemStyle:makeStyleMapper(ITEM_STYLE_KEY_MAP,!0),lineStyle:makeStyleMapper(LINE_STYLE_KEY_MAP,!0)},defaultColorKey={lineStyle:"stroke",itemStyle:"fill"};function getStyleMapper(seriesModel,stylePath){var styleMapper=seriesModel.visualStyleMapper||defaultStyleMappers[stylePath];return styleMapper||(console.warn("Unknown style type '"+stylePath+"'."),defaultStyleMappers.itemStyle)}function getDefaultColorKey(seriesModel,stylePath){var colorKey=seriesModel.visualDrawType||defaultColorKey[stylePath];return colorKey||(console.warn("Unknown style type '"+stylePath+"'."),"fill")}var seriesStyleTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(seriesModel,ecModel){var data=seriesModel.getData(),stylePath=seriesModel.visualStyleAccessPath||"itemStyle",styleModel=seriesModel.getModel(stylePath),globalStyle=getStyleMapper(seriesModel,stylePath)(styleModel),decalOption=styleModel.getShallow("decal");decalOption&&(data.setVisual("decal",decalOption),decalOption.dirty=!0);var colorKey=getDefaultColorKey(seriesModel,stylePath),color2=globalStyle[colorKey],colorCallback=isFunction(color2)?color2:null,hasAutoColor="auto"===globalStyle.fill||"auto"===globalStyle.stroke;if(!globalStyle[colorKey]||colorCallback||hasAutoColor){var colorPalette2=seriesModel.getColorFromPalette(seriesModel.name,null,ecModel.getSeriesCount());globalStyle[colorKey]||(globalStyle[colorKey]=colorPalette2,data.setVisual("colorFromPalette",!0)),globalStyle.fill="auto"===globalStyle.fill||isFunction(globalStyle.fill)?colorPalette2:globalStyle.fill,globalStyle.stroke="auto"===globalStyle.stroke||isFunction(globalStyle.stroke)?colorPalette2:globalStyle.stroke}if(data.setVisual("style",globalStyle),data.setVisual("drawType",colorKey),!ecModel.isSeriesFiltered(seriesModel)&&colorCallback)return data.setVisual("colorFromPalette",!1),{dataEach:function(data2,idx){var dataParams=seriesModel.getDataParams(idx),itemStyle=extend({},globalStyle);itemStyle[colorKey]=colorCallback(dataParams),data2.setItemVisual(idx,"style",itemStyle)}}}},sharedModel=new Model,dataStyleTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(seriesModel,ecModel){if(!seriesModel.ignoreStyleOnData&&!ecModel.isSeriesFiltered(seriesModel)){var data=seriesModel.getData(),stylePath=seriesModel.visualStyleAccessPath||"itemStyle",getStyle2=getStyleMapper(seriesModel,stylePath),colorKey=data.getVisual("drawType");return{dataEach:data.hasItemOption?function(data2,idx){var rawItem=data2.getRawDataItem(idx);if(rawItem&&rawItem[stylePath]){sharedModel.option=rawItem[stylePath];var style=getStyle2(sharedModel);extend(data2.ensureUniqueItemVisual(idx,"style"),style),sharedModel.option.decal&&(data2.setItemVisual(idx,"decal",sharedModel.option.decal),sharedModel.option.decal.dirty=!0),colorKey in style&&data2.setItemVisual(idx,"colorFromPalette",!1)}}:null}}}},dataColorPaletteTask={performRawSeries:!0,overallReset:function(ecModel){var paletteScopeGroupByType=createHashMap();ecModel.eachSeries((function(seriesModel){var colorBy=seriesModel.getColorBy();if(!seriesModel.isColorBySeries()){var key=seriesModel.type+"-"+colorBy,colorScope=paletteScopeGroupByType.get(key);colorScope||(colorScope={},paletteScopeGroupByType.set(key,colorScope)),inner$b(seriesModel).scope=colorScope}})),ecModel.eachSeries((function(seriesModel){if(!seriesModel.isColorBySeries()&&!ecModel.isSeriesFiltered(seriesModel)){var dataAll=seriesModel.getRawData(),idxMap={},data=seriesModel.getData(),colorScope=inner$b(seriesModel).scope,stylePath=seriesModel.visualStyleAccessPath||"itemStyle",colorKey=getDefaultColorKey(seriesModel,stylePath);data.each((function(idx){var rawIdx=data.getRawIndex(idx);idxMap[rawIdx]=idx})),dataAll.each((function(rawIdx){var idx=idxMap[rawIdx];if(data.getItemVisual(idx,"colorFromPalette")){var itemStyle=data.ensureUniqueItemVisual(idx,"style"),name_1=dataAll.getName(rawIdx)||rawIdx+"",dataCount=dataAll.count();itemStyle[colorKey]=seriesModel.getColorFromPalette(name_1,colorScope,dataCount)}}))}}))}},PI$4=Math.PI;var Scheduler=function(){function Scheduler2(ecInstance,api,dataProcessorHandlers,visualHandlers){this._stageTaskMap=createHashMap(),this.ecInstance=ecInstance,this.api=api,dataProcessorHandlers=this._dataProcessorHandlers=dataProcessorHandlers.slice(),visualHandlers=this._visualHandlers=visualHandlers.slice(),this._allHandlers=dataProcessorHandlers.concat(visualHandlers)}return Scheduler2.prototype.restoreData=function(ecModel,payload){ecModel.restoreData(payload),this._stageTaskMap.each((function(taskRecord){var overallTask=taskRecord.overallTask;overallTask&&overallTask.dirty()}))},Scheduler2.prototype.getPerformArgs=function(task,isBlock){if(task.__pipeline){var pipeline=this._pipelineMap.get(task.__pipeline.id),pCtx=pipeline.context,step=!isBlock&&pipeline.progressiveEnabled&&(!pCtx||pCtx.progressiveRender)&&task.__idxInPipeline>pipeline.blockIndex?pipeline.step:null,modDataCount=pCtx&&pCtx.modDataCount;return{step:step,modBy:null!=modDataCount?Math.ceil(modDataCount/step):null,modDataCount:modDataCount}}},Scheduler2.prototype.getPipeline=function(pipelineId){return this._pipelineMap.get(pipelineId)},Scheduler2.prototype.updateStreamModes=function(seriesModel,view){var pipeline=this._pipelineMap.get(seriesModel.uid),dataLen=seriesModel.getData().count(),progressiveRender=pipeline.progressiveEnabled&&view.incrementalPrepareRender&&dataLen>=pipeline.threshold,large=seriesModel.get("large")&&dataLen>=seriesModel.get("largeThreshold"),modDataCount="mod"===seriesModel.get("progressiveChunkMode")?dataLen:null;seriesModel.pipelineContext=pipeline.context={progressiveRender:progressiveRender,modDataCount:modDataCount,large:large}},Scheduler2.prototype.restorePipelines=function(ecModel){var scheduler=this,pipelineMap=scheduler._pipelineMap=createHashMap();ecModel.eachSeries((function(seriesModel){var progressive=seriesModel.getProgressive(),pipelineId=seriesModel.uid;pipelineMap.set(pipelineId,{id:pipelineId,head:null,tail:null,threshold:seriesModel.getProgressiveThreshold(),progressiveEnabled:progressive&&!(seriesModel.preventIncremental&&seriesModel.preventIncremental()),blockIndex:-1,step:Math.round(progressive||700),count:0}),scheduler._pipe(seriesModel,seriesModel.dataTask)}))},Scheduler2.prototype.prepareStageTasks=function(){var stageTaskMap=this._stageTaskMap,ecModel=this.api.getModel(),api=this.api;each$d(this._allHandlers,(function(handler){var record=stageTaskMap.get(handler.uid)||stageTaskMap.set(handler.uid,{});assert(!(handler.reset&&handler.overallReset),""),handler.reset&&this._createSeriesStageTask(handler,record,ecModel,api),handler.overallReset&&this._createOverallStageTask(handler,record,ecModel,api)}),this)},Scheduler2.prototype.prepareView=function(view,model,ecModel,api){var renderTask=view.renderTask,context=renderTask.context;context.model=model,context.ecModel=ecModel,context.api=api,renderTask.__block=!view.incrementalPrepareRender,this._pipe(model,renderTask)},Scheduler2.prototype.performDataProcessorTasks=function(ecModel,payload){this._performStageTasks(this._dataProcessorHandlers,ecModel,payload,{block:!0})},Scheduler2.prototype.performVisualTasks=function(ecModel,payload,opt){this._performStageTasks(this._visualHandlers,ecModel,payload,opt)},Scheduler2.prototype._performStageTasks=function(stageHandlers,ecModel,payload,opt){opt=opt||{};var unfinished=!1,scheduler=this;function needSetDirty(opt2,task){return opt2.setDirty&&(!opt2.dirtyMap||opt2.dirtyMap.get(task.__pipeline.id))}each$d(stageHandlers,(function(stageHandler,idx){if(!opt.visualType||opt.visualType===stageHandler.visualType){var stageHandlerRecord=scheduler._stageTaskMap.get(stageHandler.uid),seriesTaskMap=stageHandlerRecord.seriesTaskMap,overallTask=stageHandlerRecord.overallTask;if(overallTask){var overallNeedDirty_1,agentStubMap=overallTask.agentStubMap;agentStubMap.each((function(stub){needSetDirty(opt,stub)&&(stub.dirty(),overallNeedDirty_1=!0)})),overallNeedDirty_1&&overallTask.dirty(),scheduler.updatePayload(overallTask,payload);var performArgs_1=scheduler.getPerformArgs(overallTask,opt.block);agentStubMap.each((function(stub){stub.perform(performArgs_1)})),overallTask.perform(performArgs_1)&&(unfinished=!0)}else seriesTaskMap&&seriesTaskMap.each((function(task,pipelineId){needSetDirty(opt,task)&&task.dirty();var performArgs=scheduler.getPerformArgs(task,opt.block);performArgs.skip=!stageHandler.performRawSeries&&ecModel.isSeriesFiltered(task.context.model),scheduler.updatePayload(task,payload),task.perform(performArgs)&&(unfinished=!0)}))}})),this.unfinished=unfinished||this.unfinished},Scheduler2.prototype.performSeriesTasks=function(ecModel){var unfinished;ecModel.eachSeries((function(seriesModel){unfinished=seriesModel.dataTask.perform()||unfinished})),this.unfinished=unfinished||this.unfinished},Scheduler2.prototype.plan=function(){this._pipelineMap.each((function(pipeline){var task=pipeline.tail;do{if(task.__block){pipeline.blockIndex=task.__idxInPipeline;break}task=task.getUpstream()}while(task)}))},Scheduler2.prototype.updatePayload=function(task,payload){"remain"!==payload&&(task.context.payload=payload)},Scheduler2.prototype._createSeriesStageTask=function(stageHandler,stageHandlerRecord,ecModel,api){var scheduler=this,oldSeriesTaskMap=stageHandlerRecord.seriesTaskMap,newSeriesTaskMap=stageHandlerRecord.seriesTaskMap=createHashMap(),seriesType2=stageHandler.seriesType,getTargetSeries=stageHandler.getTargetSeries;function create2(seriesModel){var pipelineId=seriesModel.uid,task=newSeriesTaskMap.set(pipelineId,oldSeriesTaskMap&&oldSeriesTaskMap.get(pipelineId)||createTask({plan:seriesTaskPlan,reset:seriesTaskReset,count:seriesTaskCount}));task.context={model:seriesModel,ecModel:ecModel,api:api,useClearVisual:stageHandler.isVisual&&!stageHandler.isLayout,plan:stageHandler.plan,reset:stageHandler.reset,scheduler:scheduler},scheduler._pipe(seriesModel,task)}stageHandler.createOnAllSeries?ecModel.eachRawSeries(create2):seriesType2?ecModel.eachRawSeriesByType(seriesType2,create2):getTargetSeries&&getTargetSeries(ecModel,api).each(create2)},Scheduler2.prototype._createOverallStageTask=function(stageHandler,stageHandlerRecord,ecModel,api){var scheduler=this,overallTask=stageHandlerRecord.overallTask=stageHandlerRecord.overallTask||createTask({reset:overallTaskReset});overallTask.context={ecModel:ecModel,api:api,overallReset:stageHandler.overallReset,scheduler:scheduler};var oldAgentStubMap=overallTask.agentStubMap,newAgentStubMap=overallTask.agentStubMap=createHashMap(),seriesType2=stageHandler.seriesType,getTargetSeries=stageHandler.getTargetSeries,overallProgress=!0,shouldOverallTaskDirty=!1;function createStub(seriesModel){var pipelineId=seriesModel.uid,stub=newAgentStubMap.set(pipelineId,oldAgentStubMap&&oldAgentStubMap.get(pipelineId)||(shouldOverallTaskDirty=!0,createTask({reset:stubReset,onDirty:stubOnDirty})));stub.context={model:seriesModel,overallProgress:overallProgress},stub.agent=overallTask,stub.__block=overallProgress,scheduler._pipe(seriesModel,stub)}assert(!stageHandler.createOnAllSeries,""),seriesType2?ecModel.eachRawSeriesByType(seriesType2,createStub):getTargetSeries?getTargetSeries(ecModel,api).each(createStub):(overallProgress=!1,each$d(ecModel.getSeries(),createStub)),shouldOverallTaskDirty&&overallTask.dirty()},Scheduler2.prototype._pipe=function(seriesModel,task){var pipelineId=seriesModel.uid,pipeline=this._pipelineMap.get(pipelineId);!pipeline.head&&(pipeline.head=task),pipeline.tail&&pipeline.tail.pipe(task),pipeline.tail=task,task.__idxInPipeline=pipeline.count++,task.__pipeline=pipeline},Scheduler2.wrapStageHandler=function(stageHandler,visualType){return isFunction(stageHandler)&&(stageHandler={overallReset:stageHandler,seriesType:detectSeriseType(stageHandler)}),stageHandler.uid=getUID("stageHandler"),visualType&&(stageHandler.visualType=visualType),stageHandler},Scheduler2}();function overallTaskReset(context){context.overallReset(context.ecModel,context.api,context.payload)}function stubReset(context){return context.overallProgress&&stubProgress}function stubProgress(){this.agent.dirty(),this.getDownstream().dirty()}function stubOnDirty(){this.agent&&this.agent.dirty()}function seriesTaskPlan(context){return context.plan?context.plan(context.model,context.ecModel,context.api,context.payload):null}function seriesTaskReset(context){context.useClearVisual&&context.data.clearAllVisual();var resetDefines=context.resetDefines=normalizeToArray(context.reset(context.model,context.ecModel,context.api,context.payload));return resetDefines.length>1?map$1(resetDefines,(function(v,idx){return makeSeriesTaskProgress(idx)})):singleSeriesTaskProgress}var singleSeriesTaskProgress=makeSeriesTaskProgress(0);function makeSeriesTaskProgress(resetDefineIdx){return function(params,context){var data=context.data,resetDefine=context.resetDefines[resetDefineIdx];if(resetDefine&&resetDefine.dataEach)for(var i=params.start;i<params.end;i++)resetDefine.dataEach(data,i);else resetDefine&&resetDefine.progress&&resetDefine.progress(params,data)}}function seriesTaskCount(context){return context.data.count()}function detectSeriseType(legacyFunc){seriesType=null;try{legacyFunc(ecModelMock,apiMock)}catch(e2){}return seriesType}var seriesType,ecModelMock={},apiMock={};function mockMethods(target,Clz){for(var name_1 in Clz.prototype)target[name_1]=noop}mockMethods(ecModelMock,GlobalModel),mockMethods(apiMock,ExtensionAPI),ecModelMock.eachSeriesByType=ecModelMock.eachRawSeriesByType=function(type){seriesType=type},ecModelMock.eachComponent=function(cond){"series"===cond.mainType&&cond.subType&&(seriesType=cond.subType)};var colorAll=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"];const lightTheme={color:colorAll,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],colorAll]};var colorPalette=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],theme={darkMode:!0,color:colorPalette,backgroundColor:"#100C2A",axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:"#B9B8CE"},pageTextStyle:{color:"#B9B8CE"}},textStyle:{color:"#B9B8CE"},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:"#B9B8CE"}},dataZoom:{borderColor:"#71708A",textStyle:{color:"#B9B8CE"},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:"#B9B8CE"}},timeline:{lineStyle:{color:"#B9B8CE"},label:{color:"#B9B8CE"},controlStyle:{color:"#B9B8CE",borderColor:"#B9B8CE"}},calendar:{itemStyle:{color:"#100C2A"},dayLabel:{color:"#B9B8CE"},monthLabel:{color:"#B9B8CE"},yearLabel:{color:"#B9B8CE"}},timeAxis:{axisLine:{lineStyle:{color:"#B9B8CE"}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}},logAxis:{axisLine:{lineStyle:{color:"#B9B8CE"}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}},valueAxis:{axisLine:{lineStyle:{color:"#B9B8CE"}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}},categoryAxis:{axisLine:{lineStyle:{color:"#B9B8CE"}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}},line:{symbol:"circle"},graph:{color:colorPalette},gauge:{title:{color:"#B9B8CE"},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:"#B9B8CE"},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};theme.categoryAxis.splitLine.show=!1;var ECEventProcessor=function(){function ECEventProcessor2(){}return ECEventProcessor2.prototype.normalizeQuery=function(query){var cptQuery={},dataQuery={},otherQuery={};if(isString(query)){var condCptType=parseClassType(query);cptQuery.mainType=condCptType.main||null,cptQuery.subType=condCptType.sub||null}else{var suffixes_1=["Index","Name","Id"],dataKeys_1={name:1,dataIndex:1,dataType:1};each$d(query,(function(val,key){for(var reserved=!1,i=0;i<suffixes_1.length;i++){var propSuffix=suffixes_1[i],suffixPos=key.lastIndexOf(propSuffix);if(suffixPos>0&&suffixPos===key.length-propSuffix.length){var mainType=key.slice(0,suffixPos);"data"!==mainType&&(cptQuery.mainType=mainType,cptQuery[propSuffix.toLowerCase()]=val,reserved=!0)}}dataKeys_1.hasOwnProperty(key)&&(dataQuery[key]=val,reserved=!0),reserved||(otherQuery[key]=val)}))}return{cptQuery:cptQuery,dataQuery:dataQuery,otherQuery:otherQuery}},ECEventProcessor2.prototype.filter=function(eventType,query){var eventInfo=this.eventInfo;if(!eventInfo)return!0;var targetEl=eventInfo.targetEl,packedEvent=eventInfo.packedEvent,model=eventInfo.model,view=eventInfo.view;if(!model||!view)return!0;var cptQuery=query.cptQuery,dataQuery=query.dataQuery;return check(cptQuery,model,"mainType")&&check(cptQuery,model,"subType")&&check(cptQuery,model,"index","componentIndex")&&check(cptQuery,model,"name")&&check(cptQuery,model,"id")&&check(dataQuery,packedEvent,"name")&&check(dataQuery,packedEvent,"dataIndex")&&check(dataQuery,packedEvent,"dataType")&&(!view.filterForExposedEvent||view.filterForExposedEvent(eventType,query.otherQuery,targetEl,packedEvent));function check(query2,host,prop,propOnHost){return null==query2[prop]||host[propOnHost||prop]===query2[prop]}},ECEventProcessor2.prototype.afterTrigger=function(){this.eventInfo=null},ECEventProcessor2}(),SYMBOL_PROPS_WITH_CB=["symbol","symbolSize","symbolRotate","symbolOffset"],SYMBOL_PROPS=SYMBOL_PROPS_WITH_CB.concat(["symbolKeepAspect"]),seriesSymbolTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(seriesModel,ecModel){var data=seriesModel.getData();if(seriesModel.legendIcon&&data.setVisual("legendIcon",seriesModel.legendIcon),seriesModel.hasSymbolVisual){for(var symbolOptions={},symbolOptionsCb={},hasCallback=!1,i=0;i<SYMBOL_PROPS_WITH_CB.length;i++){var symbolPropName=SYMBOL_PROPS_WITH_CB[i],val=seriesModel.get(symbolPropName);isFunction(val)?(hasCallback=!0,symbolOptionsCb[symbolPropName]=val):symbolOptions[symbolPropName]=val}if(symbolOptions.symbol=symbolOptions.symbol||seriesModel.defaultSymbol,data.setVisual(extend({legendIcon:seriesModel.legendIcon||symbolOptions.symbol,symbolKeepAspect:seriesModel.get("symbolKeepAspect")},symbolOptions)),!ecModel.isSeriesFiltered(seriesModel)){var symbolPropsCb=keys(symbolOptionsCb);return{dataEach:hasCallback?function(data2,idx){for(var rawValue=seriesModel.getRawValue(idx),params=seriesModel.getDataParams(idx),i2=0;i2<symbolPropsCb.length;i2++){var symbolPropName2=symbolPropsCb[i2];data2.setItemVisual(idx,symbolPropName2,symbolOptionsCb[symbolPropName2](rawValue,params))}}:null}}}}},dataSymbolTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(seriesModel,ecModel){if(seriesModel.hasSymbolVisual&&!ecModel.isSeriesFiltered(seriesModel))return{dataEach:seriesModel.getData().hasItemOption?function(data2,idx){for(var itemModel=data2.getItemModel(idx),i=0;i<SYMBOL_PROPS.length;i++){var symbolPropName=SYMBOL_PROPS[i],val=itemModel.getShallow(symbolPropName,!0);null!=val&&data2.setItemVisual(idx,symbolPropName,val)}}:null}}};function getItemVisualFromData(data,dataIndex,key){switch(key){case"color":return data.getItemVisual(dataIndex,"style")[data.getVisual("drawType")];case"opacity":return data.getItemVisual(dataIndex,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return data.getItemVisual(dataIndex,key)}}function getVisualFromData(data,key){switch(key){case"color":return data.getVisual("style")[data.getVisual("drawType")];case"opacity":return data.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return data.getVisual(key)}}function createLegacyDataSelectAction(seriesType2,ecRegisterAction){function getSeriesIndices(ecModel,payload){var seriesIndices=[];return ecModel.eachComponent({mainType:"series",subType:seriesType2,query:payload},(function(seriesModel){seriesIndices.push(seriesModel.seriesIndex)})),seriesIndices}each$d([[seriesType2+"ToggleSelect","toggleSelect"],[seriesType2+"Select","select"],[seriesType2+"UnSelect","unselect"]],(function(eventsMap){ecRegisterAction(eventsMap[0],(function(payload,ecModel,api){payload=extend({},payload),api.dispatchAction(extend(payload,{type:eventsMap[1],seriesIndex:getSeriesIndices(ecModel,payload)}))}))}))}function handleSeriesLegacySelectEvents(type,eventPostfix,ecIns,ecModel,payload){var legacyEventName=type+eventPostfix;ecIns.isSilent(legacyEventName)||ecModel.eachComponent({mainType:"series",subType:"pie"},(function(seriesModel){for(var seriesIndex=seriesModel.seriesIndex,selectedMap=seriesModel.option.selectedMap,selected=payload.selected,i=0;i<selected.length;i++)if(selected[i].seriesIndex===seriesIndex){var data=seriesModel.getData(),dataIndex=queryDataIndex(data,payload.fromActionPayload);ecIns.trigger(legacyEventName,{type:legacyEventName,seriesId:seriesModel.id,name:isArray$1(dataIndex)?data.getName(dataIndex[0]):data.getName(dataIndex),selected:isString(selectedMap)?selectedMap:extend({},selectedMap)})}}))}function findEventDispatcher(target,det,returnFirstMatch){for(var found;target&&(!det(target)||(found=target,!returnFirstMatch));)target=target.__hostTarget||target.parent;return found}var wmUniqueIndex=Math.round(9*Math.random()),supportDefineProperty="function"==typeof Object.defineProperty,WeakMap=function(){function WeakMap2(){this._id="__ec_inner_"+wmUniqueIndex++}return WeakMap2.prototype.get=function(key){return this._guard(key)[this._id]},WeakMap2.prototype.set=function(key,value){var target=this._guard(key);return supportDefineProperty?Object.defineProperty(target,this._id,{value:value,enumerable:!1,configurable:!0}):target[this._id]=value,this},WeakMap2.prototype.delete=function(key){return!!this.has(key)&&(delete this._guard(key)[this._id],!0)},WeakMap2.prototype.has=function(key){return!!this._guard(key)[this._id]},WeakMap2.prototype._guard=function(key){if(key!==Object(key))throw TypeError("Value of WeakMap is not a non-null object.");return key},WeakMap2}(),Triangle=Path.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(path,shape){var cx=shape.cx,cy=shape.cy,width=shape.width/2,height=shape.height/2;path.moveTo(cx,cy-height),path.lineTo(cx+width,cy+height),path.lineTo(cx-width,cy+height),path.closePath()}}),Diamond=Path.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(path,shape){var cx=shape.cx,cy=shape.cy,width=shape.width/2,height=shape.height/2;path.moveTo(cx,cy-height),path.lineTo(cx+width,cy),path.lineTo(cx,cy+height),path.lineTo(cx-width,cy),path.closePath()}}),Pin=Path.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(path,shape){var x=shape.x,y=shape.y,w=shape.width/5*3,h=Math.max(w,shape.height),r=w/2,dy=r*r/(h-r),cy=y-h+r+dy,angle=Math.asin(dy/r),dx=Math.cos(angle)*r,tanX=Math.sin(angle),tanY=Math.cos(angle),cpLen=.6*r,cpLen2=.7*r;path.moveTo(x-dx,cy+dy),path.arc(x,cy,r,Math.PI-angle,2*Math.PI+angle),path.bezierCurveTo(x+dx-tanX*cpLen,cy+dy+tanY*cpLen,x,y-cpLen2,x,y),path.bezierCurveTo(x,y-cpLen2,x-dx+tanX*cpLen,cy+dy+tanY*cpLen,x-dx,cy+dy),path.closePath()}}),Arrow=Path.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(ctx,shape){var height=shape.height,width=shape.width,x=shape.x,y=shape.y,dx=width/3*2;ctx.moveTo(x,y),ctx.lineTo(x+dx,y+height),ctx.lineTo(x,y+height/4*3),ctx.lineTo(x-dx,y+height),ctx.lineTo(x,y),ctx.closePath()}}),symbolShapeMakers={line:function(x,y,w,h,shape){shape.x1=x,shape.y1=y+h/2,shape.x2=x+w,shape.y2=y+h/2},rect:function(x,y,w,h,shape){shape.x=x,shape.y=y,shape.width=w,shape.height=h},roundRect:function(x,y,w,h,shape){shape.x=x,shape.y=y,shape.width=w,shape.height=h,shape.r=Math.min(w,h)/4},square:function(x,y,w,h,shape){var size=Math.min(w,h);shape.x=x,shape.y=y,shape.width=size,shape.height=size},circle:function(x,y,w,h,shape){shape.cx=x+w/2,shape.cy=y+h/2,shape.r=Math.min(w,h)/2},diamond:function(x,y,w,h,shape){shape.cx=x+w/2,shape.cy=y+h/2,shape.width=w,shape.height=h},pin:function(x,y,w,h,shape){shape.x=x+w/2,shape.y=y+h/2,shape.width=w,shape.height=h},arrow:function(x,y,w,h,shape){shape.x=x+w/2,shape.y=y+h/2,shape.width=w,shape.height=h},triangle:function(x,y,w,h,shape){shape.cx=x+w/2,shape.cy=y+h/2,shape.width=w,shape.height=h}},symbolBuildProxies={};each$d({line:Line,rect:Rect$1,roundRect:Rect$1,square:Rect$1,circle:Circle,diamond:Diamond,pin:Pin,arrow:Arrow,triangle:Triangle},(function(Ctor,name){symbolBuildProxies[name]=new Ctor}));var SymbolClz=Path.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(out2,config,rect){var res=calculateTextPosition(out2,config,rect),shape=this.shape;return shape&&"pin"===shape.symbolType&&"inside"===config.position&&(res.y=rect.y+.4*rect.height),res},buildPath:function(ctx,shape,inBundle){var symbolType=shape.symbolType;if("none"!==symbolType){var proxySymbol=symbolBuildProxies[symbolType];proxySymbol||(proxySymbol=symbolBuildProxies[symbolType="rect"]),symbolShapeMakers[symbolType](shape.x,shape.y,shape.width,shape.height,proxySymbol.shape),proxySymbol.buildPath(ctx,proxySymbol.shape,inBundle)}}});function symbolPathSetColor(color2,innerColor2){if("image"!==this.type){var symbolStyle=this.style;this.__isEmptyBrush?(symbolStyle.stroke=color2,symbolStyle.fill=innerColor2||"#fff",symbolStyle.lineWidth=2):"line"===this.shape.symbolType?symbolStyle.stroke=color2:symbolStyle.fill=color2,this.markRedraw()}}function createSymbol(symbolType,x,y,w,h,color2,keepAspect){var symbolPath,isEmpty=0===symbolType.indexOf("empty");return isEmpty&&(symbolType=symbolType.substr(5,1).toLowerCase()+symbolType.substr(6)),(symbolPath=0===symbolType.indexOf("image://")?makeImage(symbolType.slice(8),new BoundingRect(x,y,w,h),keepAspect?"center":"cover"):0===symbolType.indexOf("path://")?makePath(symbolType.slice(7),{},new BoundingRect(x,y,w,h),keepAspect?"center":"cover"):new SymbolClz({shape:{symbolType:symbolType,x:x,y:y,width:w,height:h}})).__isEmptyBrush=isEmpty,symbolPath.setColor=symbolPathSetColor,color2&&symbolPath.setColor(color2),symbolPath}function normalizeSymbolSize(symbolSize){return isArray$1(symbolSize)||(symbolSize=[+symbolSize,+symbolSize]),[symbolSize[0]||0,symbolSize[1]||0]}function normalizeSymbolOffset(symbolOffset,symbolSize){if(null!=symbolOffset)return isArray$1(symbolOffset)||(symbolOffset=[symbolOffset,symbolOffset]),[parsePercent(symbolOffset[0],symbolSize[0])||0,parsePercent(retrieve2(symbolOffset[1],symbolOffset[0]),symbolSize[1])||0]}function isSafeNum(num){return isFinite(num)}function getCanvasGradient(ctx,obj,rect){for(var canvasGradient="radial"===obj.type?function(ctx,obj,rect){var width=rect.width,height=rect.height,min3=Math.min(width,height),x=null==obj.x?.5:obj.x,y=null==obj.y?.5:obj.y,r=null==obj.r?.5:obj.r;return obj.global||(x=x*width+rect.x,y=y*height+rect.y,r*=min3),x=isSafeNum(x)?x:.5,y=isSafeNum(y)?y:.5,r=r>=0&&isSafeNum(r)?r:.5,ctx.createRadialGradient(x,y,0,x,y,r)}(ctx,obj,rect):function(ctx,obj,rect){var x=null==obj.x?0:obj.x,x2=null==obj.x2?1:obj.x2,y=null==obj.y?0:obj.y,y2=null==obj.y2?0:obj.y2;return obj.global||(x=x*rect.width+rect.x,x2=x2*rect.width+rect.x,y=y*rect.height+rect.y,y2=y2*rect.height+rect.y),x=isSafeNum(x)?x:0,x2=isSafeNum(x2)?x2:1,y=isSafeNum(y)?y:0,y2=isSafeNum(y2)?y2:0,ctx.createLinearGradient(x,y,x2,y2)}(ctx,obj,rect),colorStops=obj.colorStops,i=0;i<colorStops.length;i++)canvasGradient.addColorStop(colorStops[i].offset,colorStops[i].color);return canvasGradient}function parseInt10(val){return parseInt(val,10)}function getSize$1(root,whIdx,opts){var wh=["width","height"][whIdx],cwh=["clientWidth","clientHeight"][whIdx],plt=["paddingLeft","paddingTop"][whIdx],prb=["paddingRight","paddingBottom"][whIdx];if(null!=opts[wh]&&"auto"!==opts[wh])return parseFloat(opts[wh]);var stl=document.defaultView.getComputedStyle(root);return(root[cwh]||parseInt10(stl[wh])||parseInt10(root.style[wh]))-(parseInt10(stl[plt])||0)-(parseInt10(stl[prb])||0)|0}function getLineDash(el){var lineType,lineWidth,style=el.style,lineDash=style.lineDash&&style.lineWidth>0&&(lineType=style.lineDash,lineWidth=style.lineWidth,lineType&&"solid"!==lineType&&lineWidth>0?"dashed"===lineType?[4*lineWidth,2*lineWidth]:"dotted"===lineType?[lineWidth]:isNumber(lineType)?[lineType]:isArray$1(lineType)?lineType:null:null),lineDashOffset=style.lineDashOffset;if(lineDash){var lineScale_1=style.strokeNoScale&&el.getLineScale?el.getLineScale():1;lineScale_1&&1!==lineScale_1&&(lineDash=map$1(lineDash,(function(rawVal){return rawVal/lineScale_1})),lineDashOffset/=lineScale_1)}return[lineDash,lineDashOffset]}var pathProxyForDraw=new PathProxy(!0);function styleHasStroke(style){var stroke=style.stroke;return!(null==stroke||"none"===stroke||!(style.lineWidth>0))}function isValidStrokeFillStyle(strokeOrFill){return"string"==typeof strokeOrFill&&"none"!==strokeOrFill}function styleHasFill(style){var fill=style.fill;return null!=fill&&"none"!==fill}function doFillPath(ctx,style){if(null!=style.fillOpacity&&1!==style.fillOpacity){var originalGlobalAlpha=ctx.globalAlpha;ctx.globalAlpha=style.fillOpacity*style.opacity,ctx.fill(),ctx.globalAlpha=originalGlobalAlpha}else ctx.fill()}function doStrokePath(ctx,style){if(null!=style.strokeOpacity&&1!==style.strokeOpacity){var originalGlobalAlpha=ctx.globalAlpha;ctx.globalAlpha=style.strokeOpacity*style.opacity,ctx.stroke(),ctx.globalAlpha=originalGlobalAlpha}else ctx.stroke()}function createCanvasPattern(ctx,pattern,el){var image=createOrUpdateImage(pattern.image,pattern.__image,el);if(isImageReady(image)){var canvasPattern=ctx.createPattern(image,pattern.repeat||"repeat");if("function"==typeof DOMMatrix&&canvasPattern&&canvasPattern.setTransform){var matrix2=new DOMMatrix;matrix2.translateSelf(pattern.x||0,pattern.y||0),matrix2.rotateSelf(0,0,(pattern.rotation||0)*RADIAN_TO_DEGREE),matrix2.scaleSelf(pattern.scaleX||1,pattern.scaleY||1),canvasPattern.setTransform(matrix2)}return canvasPattern}}var SHADOW_NUMBER_PROPS=["shadowBlur","shadowOffsetX","shadowOffsetY"],STROKE_PROPS=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function bindCommonProps(ctx,style,prevStyle,forceSetAll,scope){var styleChanged=!1;if(!forceSetAll&&style===(prevStyle=prevStyle||{}))return!1;if(forceSetAll||style.opacity!==prevStyle.opacity){flushPathDrawn(ctx,scope),styleChanged=!0;var opacity=Math.max(Math.min(style.opacity,1),0);ctx.globalAlpha=isNaN(opacity)?DEFAULT_COMMON_STYLE.opacity:opacity}(forceSetAll||style.blend!==prevStyle.blend)&&(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),ctx.globalCompositeOperation=style.blend||DEFAULT_COMMON_STYLE.blend);for(var i=0;i<SHADOW_NUMBER_PROPS.length;i++){var propName=SHADOW_NUMBER_PROPS[i];(forceSetAll||style[propName]!==prevStyle[propName])&&(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),ctx[propName]=ctx.dpr*(style[propName]||0))}return(forceSetAll||style.shadowColor!==prevStyle.shadowColor)&&(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),ctx.shadowColor=style.shadowColor||DEFAULT_COMMON_STYLE.shadowColor),styleChanged}function bindPathAndTextCommonStyle(ctx,el,prevEl,forceSetAll,scope){var style=getStyle(el,scope.inHover),prevStyle=forceSetAll?null:prevEl&&getStyle(prevEl,scope.inHover)||{};if(style===prevStyle)return!1;var styleChanged=bindCommonProps(ctx,style,prevStyle,forceSetAll,scope);if((forceSetAll||style.fill!==prevStyle.fill)&&(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),isValidStrokeFillStyle(style.fill)&&(ctx.fillStyle=style.fill)),(forceSetAll||style.stroke!==prevStyle.stroke)&&(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),isValidStrokeFillStyle(style.stroke)&&(ctx.strokeStyle=style.stroke)),(forceSetAll||style.opacity!==prevStyle.opacity)&&(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),ctx.globalAlpha=null==style.opacity?1:style.opacity),el.hasStroke()){var newLineWidth=style.lineWidth/(style.strokeNoScale&&el.getLineScale?el.getLineScale():1);ctx.lineWidth!==newLineWidth&&(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),ctx.lineWidth=newLineWidth)}for(var i=0;i<STROKE_PROPS.length;i++){var prop=STROKE_PROPS[i],propName=prop[0];(forceSetAll||style[propName]!==prevStyle[propName])&&(styleChanged||(flushPathDrawn(ctx,scope),styleChanged=!0),ctx[propName]=style[propName]||prop[1])}return styleChanged}function setContextTransform(ctx,el){var m2=el.transform,dpr2=ctx.dpr||1;m2?ctx.setTransform(dpr2*m2[0],dpr2*m2[1],dpr2*m2[2],dpr2*m2[3],dpr2*m2[4],dpr2*m2[5]):ctx.setTransform(dpr2,0,0,dpr2,0,0)}function flushPathDrawn(ctx,scope){scope.batchFill&&ctx.fill(),scope.batchStroke&&ctx.stroke(),scope.batchFill="",scope.batchStroke=""}function getStyle(el,inHover){return inHover&&el.__hoverStyle||el.style}function brushSingle(ctx,el){brush$1(ctx,el,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function brush$1(ctx,el,scope,isLast){var m2=el.transform;if(!el.shouldBePainted(scope.viewWidth,scope.viewHeight,!1,!1))return el.__dirty&=-2,void(el.__isRendered=!1);var clipPaths=el.__clipPaths,prevElClipPaths=scope.prevElClipPaths,forceSetTransform=!1,forceSetStyle=!1;if(prevElClipPaths&&!function(clipPaths,prevClipPaths){if(clipPaths===prevClipPaths||!clipPaths&&!prevClipPaths)return!1;if(!clipPaths||!prevClipPaths||clipPaths.length!==prevClipPaths.length)return!0;for(var i=0;i<clipPaths.length;i++)if(clipPaths[i]!==prevClipPaths[i])return!0;return!1}(clipPaths,prevElClipPaths)||(prevElClipPaths&&prevElClipPaths.length&&(flushPathDrawn(ctx,scope),ctx.restore(),forceSetStyle=forceSetTransform=!0,scope.prevElClipPaths=null,scope.allClipped=!1,scope.prevEl=null),clipPaths&&clipPaths.length&&(flushPathDrawn(ctx,scope),ctx.save(),function(clipPaths,ctx,scope){for(var allClipped=!1,i=0;i<clipPaths.length;i++){var clipPath=clipPaths[i];allClipped=allClipped||clipPath.isZeroArea(),setContextTransform(ctx,clipPath),ctx.beginPath(),clipPath.buildPath(ctx,clipPath.shape),ctx.clip()}scope.allClipped=allClipped}(clipPaths,ctx,scope),forceSetTransform=!0),scope.prevElClipPaths=clipPaths),scope.allClipped)el.__isRendered=!1;else{el.beforeBrush&&el.beforeBrush(),el.innerBeforeBrush();var prevEl=scope.prevEl;prevEl||(forceSetStyle=forceSetTransform=!0);var m0,m1,canBatchPath=el instanceof Path&&el.autoBatch&&function(style){var hasFill=styleHasFill(style),hasStroke=styleHasStroke(style);return!(style.lineDash||!(+hasFill^+hasStroke)||hasFill&&"string"!=typeof style.fill||hasStroke&&"string"!=typeof style.stroke||style.strokePercent<1||style.strokeOpacity<1||style.fillOpacity<1)}(el.style);forceSetTransform||(m0=m2,m1=prevEl.transform,m0&&m1?m0[0]!==m1[0]||m0[1]!==m1[1]||m0[2]!==m1[2]||m0[3]!==m1[3]||m0[4]!==m1[4]||m0[5]!==m1[5]:m0||m1)?(flushPathDrawn(ctx,scope),setContextTransform(ctx,el)):canBatchPath||flushPathDrawn(ctx,scope);var style=getStyle(el,scope.inHover);el instanceof Path?(1!==scope.lastDrawType&&(forceSetStyle=!0,scope.lastDrawType=1),bindPathAndTextCommonStyle(ctx,el,prevEl,forceSetStyle,scope),canBatchPath&&(scope.batchFill||scope.batchStroke)||ctx.beginPath(),function(ctx,el,style,inBatch){var _a2,hasStroke=styleHasStroke(style),hasFill=styleHasFill(style),strokePercent=style.strokePercent,strokePart=strokePercent<1,firstDraw=!el.path;el.silent&&!strokePart||!firstDraw||el.createPathProxy();var path=el.path||pathProxyForDraw,dirtyFlag=el.__dirty;if(!inBatch){var fill=style.fill,stroke=style.stroke,hasFillGradient=hasFill&&!!fill.colorStops,hasStrokeGradient=hasStroke&&!!stroke.colorStops,hasFillPattern=hasFill&&!!fill.image,hasStrokePattern=hasStroke&&!!stroke.image,fillGradient=void 0,strokeGradient=void 0,fillPattern=void 0,strokePattern=void 0,rect=void 0;(hasFillGradient||hasStrokeGradient)&&(rect=el.getBoundingRect()),hasFillGradient&&(fillGradient=dirtyFlag?getCanvasGradient(ctx,fill,rect):el.__canvasFillGradient,el.__canvasFillGradient=fillGradient),hasStrokeGradient&&(strokeGradient=dirtyFlag?getCanvasGradient(ctx,stroke,rect):el.__canvasStrokeGradient,el.__canvasStrokeGradient=strokeGradient),hasFillPattern&&(fillPattern=dirtyFlag||!el.__canvasFillPattern?createCanvasPattern(ctx,fill,el):el.__canvasFillPattern,el.__canvasFillPattern=fillPattern),hasStrokePattern&&(strokePattern=dirtyFlag||!el.__canvasStrokePattern?createCanvasPattern(ctx,stroke,el):el.__canvasStrokePattern,el.__canvasStrokePattern=fillPattern),hasFillGradient?ctx.fillStyle=fillGradient:hasFillPattern&&(fillPattern?ctx.fillStyle=fillPattern:hasFill=!1),hasStrokeGradient?ctx.strokeStyle=strokeGradient:hasStrokePattern&&(strokePattern?ctx.strokeStyle=strokePattern:hasStroke=!1)}var lineDash,lineDashOffset,scale2=el.getGlobalScale();path.setScale(scale2[0],scale2[1],el.segmentIgnoreThreshold),ctx.setLineDash&&style.lineDash&&(lineDash=(_a2=getLineDash(el))[0],lineDashOffset=_a2[1]);var needsRebuild=!0;(firstDraw||4&dirtyFlag)&&(path.setDPR(ctx.dpr),strokePart?path.setContext(null):(path.setContext(ctx),needsRebuild=!1),path.reset(),el.buildPath(path,el.shape,inBatch),path.toStatic(),el.pathUpdated()),needsRebuild&&path.rebuildPath(ctx,strokePart?strokePercent:1),lineDash&&(ctx.setLineDash(lineDash),ctx.lineDashOffset=lineDashOffset),inBatch||(style.strokeFirst?(hasStroke&&doStrokePath(ctx,style),hasFill&&doFillPath(ctx,style)):(hasFill&&doFillPath(ctx,style),hasStroke&&doStrokePath(ctx,style))),lineDash&&ctx.setLineDash([])}(ctx,el,style,canBatchPath),canBatchPath&&(scope.batchFill=style.fill||"",scope.batchStroke=style.stroke||"")):el instanceof TSpan?(3!==scope.lastDrawType&&(forceSetStyle=!0,scope.lastDrawType=3),bindPathAndTextCommonStyle(ctx,el,prevEl,forceSetStyle,scope),function(ctx,el,style){var _a2,text=style.text;if(null!=text&&(text+=""),text){ctx.font=style.font||DEFAULT_FONT,ctx.textAlign=style.textAlign,ctx.textBaseline=style.textBaseline;var lineDash=void 0,lineDashOffset=void 0;ctx.setLineDash&&style.lineDash&&(lineDash=(_a2=getLineDash(el))[0],lineDashOffset=_a2[1]),lineDash&&(ctx.setLineDash(lineDash),ctx.lineDashOffset=lineDashOffset),style.strokeFirst?(styleHasStroke(style)&&ctx.strokeText(text,style.x,style.y),styleHasFill(style)&&ctx.fillText(text,style.x,style.y)):(styleHasFill(style)&&ctx.fillText(text,style.x,style.y),styleHasStroke(style)&&ctx.strokeText(text,style.x,style.y)),lineDash&&ctx.setLineDash([])}}(ctx,el,style)):el instanceof ZRImage?(2!==scope.lastDrawType&&(forceSetStyle=!0,scope.lastDrawType=2),function(ctx,el,prevEl,forceSetAll,scope){bindCommonProps(ctx,getStyle(el,scope.inHover),prevEl&&getStyle(prevEl,scope.inHover),forceSetAll,scope)}(ctx,el,prevEl,forceSetStyle,scope),function(ctx,el,style){var image=el.__image=createOrUpdateImage(style.image,el.__image,el,el.onload);if(image&&isImageReady(image)){var x=style.x||0,y=style.y||0,width=el.getWidth(),height=el.getHeight(),aspect=image.width/image.height;if(null==width&&null!=height?width=height*aspect:null==height&&null!=width?height=width/aspect:null==width&&null==height&&(width=image.width,height=image.height),style.sWidth&&style.sHeight){var sx=style.sx||0,sy=style.sy||0;ctx.drawImage(image,sx,sy,style.sWidth,style.sHeight,x,y,width,height)}else if(style.sx&&style.sy){var sWidth=width-(sx=style.sx),sHeight=height-(sy=style.sy);ctx.drawImage(image,sx,sy,sWidth,sHeight,x,y,width,height)}else ctx.drawImage(image,x,y,width,height)}}(ctx,el,style)):el.getTemporalDisplayables&&(4!==scope.lastDrawType&&(forceSetStyle=!0,scope.lastDrawType=4),function(ctx,el,scope){var displayables=el.getDisplayables(),temporalDisplayables=el.getTemporalDisplayables();ctx.save();var i,len2,innerScope={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:scope.viewWidth,viewHeight:scope.viewHeight,inHover:scope.inHover};for(i=el.getCursor(),len2=displayables.length;i<len2;i++){(displayable=displayables[i]).beforeBrush&&displayable.beforeBrush(),displayable.innerBeforeBrush(),brush$1(ctx,displayable,innerScope,i===len2-1),displayable.innerAfterBrush(),displayable.afterBrush&&displayable.afterBrush(),innerScope.prevEl=displayable}for(var i_1=0,len_1=temporalDisplayables.length;i_1<len_1;i_1++){var displayable;(displayable=temporalDisplayables[i_1]).beforeBrush&&displayable.beforeBrush(),displayable.innerBeforeBrush(),brush$1(ctx,displayable,innerScope,i_1===len_1-1),displayable.innerAfterBrush(),displayable.afterBrush&&displayable.afterBrush(),innerScope.prevEl=displayable}el.clearTemporalDisplayables(),el.notClear=!0,ctx.restore()}(ctx,el,scope)),canBatchPath&&isLast&&flushPathDrawn(ctx,scope),el.innerAfterBrush(),el.afterBrush&&el.afterBrush(),scope.prevEl=el,el.__dirty=0,el.__isRendered=!0}}var decalMap=new WeakMap,decalCache=new LRU(100),decalKeys=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function createOrUpdatePatternFromDecal(decalObject,api){if("none"===decalObject)return null;var dpr2=api.getDevicePixelRatio(),zr=api.getZr(),isSVG="svg"===zr.painter.type;decalObject.dirty&&decalMap.delete(decalObject);var oldPattern=decalMap.get(decalObject);if(oldPattern)return oldPattern;var decalOpt=defaults(decalObject,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});"none"===decalOpt.backgroundColor&&(decalOpt.backgroundColor=null);var pattern={repeat:"repeat"};return function(pattern2){for(var cacheKey,keys2=[dpr2],isValidKey=!0,i=0;i<decalKeys.length;++i){var value=decalOpt[decalKeys[i]];if(null!=value&&!isArray$1(value)&&!isString(value)&&!isNumber(value)&&"boolean"!=typeof value){isValidKey=!1;break}keys2.push(value)}if(isValidKey){cacheKey=keys2.join(",")+(isSVG?"-svg":"");var cache=decalCache.get(cacheKey);cache&&(isSVG?pattern2.svgElement=cache:pattern2.image=cache)}var ctx,dashArrayX=normalizeDashArrayX(decalOpt.dashArrayX),dashArrayY=function(dash){if(!dash||"object"==typeof dash&&0===dash.length)return[0,0];if(isNumber(dash)){var dashValue_1=Math.ceil(dash);return[dashValue_1,dashValue_1]}var dashValue=map$1(dash,(function(n){return Math.ceil(n)}));return dash.length%2?dashValue.concat(dashValue):dashValue}(decalOpt.dashArrayY),symbolArray=normalizeSymbolArray(decalOpt.symbol),lineBlockLengthsX=(dash=dashArrayX,map$1(dash,(function(line){return getLineBlockLengthY(line)}))),lineBlockLengthY=getLineBlockLengthY(dashArrayY),canvas=!isSVG&&platformApi.createCanvas(),svgRoot=isSVG&&{tag:"g",attrs:{},key:"dcl",children:[]},pSize=function(){for(var width=1,i2=0,xlen=lineBlockLengthsX.length;i2<xlen;++i2)width=getLeastCommonMultiple(width,lineBlockLengthsX[i2]);var symbolRepeats=1;for(i2=0,xlen=symbolArray.length;i2<xlen;++i2)symbolRepeats=getLeastCommonMultiple(symbolRepeats,symbolArray[i2].length);width*=symbolRepeats;var height=lineBlockLengthY*lineBlockLengthsX.length*symbolArray.length;return{width:Math.max(1,Math.min(width,decalOpt.maxTileWidth)),height:Math.max(1,Math.min(height,decalOpt.maxTileHeight))}}();var dash;canvas&&(canvas.width=pSize.width*dpr2,canvas.height=pSize.height*dpr2,ctx=canvas.getContext("2d"));(function(){ctx&&(ctx.clearRect(0,0,canvas.width,canvas.height),decalOpt.backgroundColor&&(ctx.fillStyle=decalOpt.backgroundColor,ctx.fillRect(0,0,canvas.width,canvas.height)));for(var ySum=0,i2=0;i2<dashArrayY.length;++i2)ySum+=dashArrayY[i2];if(ySum<=0)return;var y=-lineBlockLengthY,yId=0,yIdTotal=0,xId0=0;for(;y<pSize.height;){if(yId%2==0){for(var symbolYId=yIdTotal/2%symbolArray.length,x=0,xId1=0,xId1Total=0;x<2*pSize.width;){var xSum=0;for(i2=0;i2<dashArrayX[xId0].length;++i2)xSum+=dashArrayX[xId0][i2];if(xSum<=0)break;if(xId1%2==0){var size=.5*(1-decalOpt.symbolSize),left=x+dashArrayX[xId0][xId1]*size,top_1=y+dashArrayY[yId]*size,width=dashArrayX[xId0][xId1]*decalOpt.symbolSize,height=dashArrayY[yId]*decalOpt.symbolSize,symbolXId=xId1Total/2%symbolArray[symbolYId].length;brushSymbol(left,top_1,width,height,symbolArray[symbolYId][symbolXId])}x+=dashArrayX[xId0][xId1],++xId1Total,++xId1===dashArrayX[xId0].length&&(xId1=0)}++xId0===dashArrayX.length&&(xId0=0)}y+=dashArrayY[yId],++yIdTotal,++yId===dashArrayY.length&&(yId=0)}function brushSymbol(x2,y2,width2,height2,symbolType){var scale2=isSVG?1:dpr2,symbol=createSymbol(symbolType,x2*scale2,y2*scale2,width2*scale2,height2*scale2,decalOpt.color,decalOpt.symbolKeepAspect);if(isSVG){var symbolVNode=zr.painter.renderOneToVNode(symbol);symbolVNode&&svgRoot.children.push(symbolVNode)}else brushSingle(ctx,symbol)}})(),isValidKey&&decalCache.put(cacheKey,canvas||svgRoot);pattern2.image=canvas,pattern2.svgElement=svgRoot,pattern2.svgWidth=pSize.width,pattern2.svgHeight=pSize.height}(pattern),pattern.rotation=decalOpt.rotation,pattern.scaleX=pattern.scaleY=isSVG?1:1/dpr2,decalMap.set(decalObject,pattern),decalObject.dirty=!1,pattern}function normalizeSymbolArray(symbol){if(!symbol||0===symbol.length)return[["rect"]];if(isString(symbol))return[[symbol]];for(var isAllString=!0,i=0;i<symbol.length;++i)if(!isString(symbol[i])){isAllString=!1;break}if(isAllString)return normalizeSymbolArray([symbol]);var result=[];for(i=0;i<symbol.length;++i)isString(symbol[i])?result.push([symbol[i]]):result.push(symbol[i]);return result}function normalizeDashArrayX(dash){if(!dash||0===dash.length)return[[0,0]];if(isNumber(dash))return[[dashValue=Math.ceil(dash),dashValue]];for(var isAllNumber=!0,i=0;i<dash.length;++i)if(!isNumber(dash[i])){isAllNumber=!1;break}if(isAllNumber)return normalizeDashArrayX([dash]);var result=[];for(i=0;i<dash.length;++i)if(isNumber(dash[i])){var dashValue=Math.ceil(dash[i]);result.push([dashValue,dashValue])}else{(dashValue=map$1(dash[i],(function(n){return Math.ceil(n)}))).length%2==1?result.push(dashValue.concat(dashValue)):result.push(dashValue)}return result}function getLineBlockLengthY(dash){for(var blockLength=0,i=0;i<dash.length;++i)blockLength+=dash[i];return dash.length%2==1?2*blockLength:blockLength}var lifecycle=new Eventful,implsStore={};function getImpl(name){return implsStore[name]}var PRIORITY={PROCESSOR:{FILTER:1e3,SERIES_FILTER:800,STATISTIC:5e3},VISUAL:{LAYOUT:1e3,PROGRESSIVE_LAYOUT:1100,GLOBAL:2e3,CHART:3e3,POST_CHART_LAYOUT:4600,COMPONENT:4e3,BRUSH:5e3,CHART_ITEM:4500,ARIA:6e3,DECAL:7e3}},PENDING_UPDATE="__pendingUpdate",ACTION_REG=/^[a-zA-Z0-9_]+$/;function createRegisterEventWithLowercaseECharts(method){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];if(!this.isDisposed())return toLowercaseNameAndCallEventful(this,method,args);this.id}}function createRegisterEventWithLowercaseMessageCenter(method){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return toLowercaseNameAndCallEventful(this,method,args)}}function toLowercaseNameAndCallEventful(host,method,args){return args[0]=args[0]&&args[0].toLowerCase(),Eventful.prototype[method].apply(host,args)}var prepare,prepareView,updateDirectly,updateMethods,doConvertPixel,updateStreamModes,doDispatchAction,flushPendingActions,triggerUpdatedEvent,bindRenderedEvent,bindMouseEvent,render,renderComponents,renderSeries,createExtensionAPI,enableConnect,markStatusToUpdate,applyChangedStates,MessageCenter=function(_super){function MessageCenter2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(MessageCenter2,_super),MessageCenter2}(Eventful),messageCenterProto=MessageCenter.prototype;messageCenterProto.on=createRegisterEventWithLowercaseMessageCenter("on"),messageCenterProto.off=createRegisterEventWithLowercaseMessageCenter("off");var ECharts=function(_super){function ECharts2(dom,theme2,opts){var _this=_super.call(this,new ECEventProcessor)||this;_this._chartsViews=[],_this._chartsMap={},_this._componentsViews=[],_this._componentsMap={},_this._pendingActions=[],opts=opts||{},isString(theme2)&&(theme2=themeStorage[theme2]),_this._dom=dom;opts.ssr&&registerSSRDataGetter((function(el){var ecData=getECData(el),dataIndex=ecData.dataIndex;if(null!=dataIndex){var hashMap=createHashMap();return hashMap.set("series_index",ecData.seriesIndex),hashMap.set("data_index",dataIndex),ecData.ssrType&&hashMap.set("ssr_type",ecData.ssrType),hashMap}}));var zr=_this._zr=init$1(dom,{renderer:opts.renderer||"canvas",devicePixelRatio:opts.devicePixelRatio,width:opts.width,height:opts.height,ssr:opts.ssr,useDirtyRect:retrieve2(opts.useDirtyRect,!1),useCoarsePointer:retrieve2(opts.useCoarsePointer,"auto"),pointerSize:opts.pointerSize});_this._ssr=opts.ssr,_this._throttledZrFlush=throttle(bind$1(zr.flush,zr),17),(theme2=clone$3(theme2))&&globalBackwardCompat(theme2,!0),_this._theme=theme2,_this._locale=function(locale){if(isString(locale)){var localeObj=localeStorage[locale.toUpperCase()]||{};return"ZH"===locale||"EN"===locale?clone$3(localeObj):merge(clone$3(localeObj),clone$3(localeStorage.EN),!1)}return merge(clone$3(locale),clone$3(localeStorage.EN),!1)}(opts.locale||SYSTEM_LANG),_this._coordSysMgr=new CoordinateSystemManager;var api=_this._api=createExtensionAPI(_this);function prioritySortFunc(a,b){return a.__prio-b.__prio}return sort(visualFuncs,prioritySortFunc),sort(dataProcessorFuncs,prioritySortFunc),_this._scheduler=new Scheduler(_this,api,dataProcessorFuncs,visualFuncs),_this._messageCenter=new MessageCenter,_this._initEvents(),_this.resize=bind$1(_this.resize,_this),zr.animation.on("frame",_this._onframe,_this),bindRenderedEvent(zr,_this),bindMouseEvent(zr,_this),setAsPrimitive(_this),_this}return __extends(ECharts2,_super),ECharts2.prototype._onframe=function(){if(!this._disposed){applyChangedStates(this);var scheduler=this._scheduler;if(this[PENDING_UPDATE]){var silent=this[PENDING_UPDATE].silent;this.__flagInMainProcess=!0;try{prepare(this),updateMethods.update.call(this,null,this[PENDING_UPDATE].updateParams)}catch(e2){throw this.__flagInMainProcess=!1,this[PENDING_UPDATE]=null,e2}this._zr.flush(),this.__flagInMainProcess=!1,this[PENDING_UPDATE]=null,flushPendingActions.call(this,silent),triggerUpdatedEvent.call(this,silent)}else if(scheduler.unfinished){var remainTime=1,ecModel=this._model,api=this._api;scheduler.unfinished=!1;do{var startTime=+new Date;scheduler.performSeriesTasks(ecModel),scheduler.performDataProcessorTasks(ecModel),updateStreamModes(this,ecModel),scheduler.performVisualTasks(ecModel),renderSeries(this,this._model,api,"remain",{}),remainTime-=+new Date-startTime}while(remainTime>0&&scheduler.unfinished);scheduler.unfinished||this._zr.flush()}}},ECharts2.prototype.getDom=function(){return this._dom},ECharts2.prototype.getId=function(){return this.id},ECharts2.prototype.getZr=function(){return this._zr},ECharts2.prototype.isSSR=function(){return this._ssr},ECharts2.prototype.setOption=function(option,notMerge,lazyUpdate){if(!this.__flagInMainProcess)if(this._disposed)this.id;else{var silent,replaceMerge,transitionOpt;if(isObject$3(notMerge)&&(lazyUpdate=notMerge.lazyUpdate,silent=notMerge.silent,replaceMerge=notMerge.replaceMerge,transitionOpt=notMerge.transition,notMerge=notMerge.notMerge),this.__flagInMainProcess=!0,!this._model||notMerge){var optionManager=new OptionManager(this._api),theme2=this._theme,ecModel=this._model=new GlobalModel;ecModel.scheduler=this._scheduler,ecModel.ssr=this._ssr,ecModel.init(null,null,null,theme2,this._locale,optionManager)}this._model.setOption(option,{replaceMerge:replaceMerge},optionPreprocessorFuncs);var updateParams={seriesTransition:transitionOpt,optionChanged:!0};if(lazyUpdate)this[PENDING_UPDATE]={silent:silent,updateParams:updateParams},this.__flagInMainProcess=!1,this.getZr().wakeUp();else{try{prepare(this),updateMethods.update.call(this,null,updateParams)}catch(e2){throw this[PENDING_UPDATE]=null,this.__flagInMainProcess=!1,e2}this._ssr||this._zr.flush(),this[PENDING_UPDATE]=null,this.__flagInMainProcess=!1,flushPendingActions.call(this,silent),triggerUpdatedEvent.call(this,silent)}}},ECharts2.prototype.setTheme=function(){},ECharts2.prototype.getModel=function(){return this._model},ECharts2.prototype.getOption=function(){return this._model&&this._model.getOption()},ECharts2.prototype.getWidth=function(){return this._zr.getWidth()},ECharts2.prototype.getHeight=function(){return this._zr.getHeight()},ECharts2.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||env.hasGlobalWindow&&window.devicePixelRatio||1},ECharts2.prototype.getRenderedCanvas=function(opts){return this.renderToCanvas(opts)},ECharts2.prototype.renderToCanvas=function(opts){return opts=opts||{},this._zr.painter.getRenderedCanvas({backgroundColor:opts.backgroundColor||this._model.get("backgroundColor"),pixelRatio:opts.pixelRatio||this.getDevicePixelRatio()})},ECharts2.prototype.renderToSVGString=function(opts){return opts=opts||{},this._zr.painter.renderToString({useViewBox:opts.useViewBox})},ECharts2.prototype.getSvgDataURL=function(){if(env.svgSupported){var zr=this._zr;return each$d(zr.storage.getDisplayList(),(function(el){el.stopAnimation(null,!0)})),zr.painter.toDataURL()}},ECharts2.prototype.getDataURL=function(opts){if(!this._disposed){var excludeComponents=(opts=opts||{}).excludeComponents,ecModel=this._model,excludesComponentViews=[],self2=this;each$d(excludeComponents,(function(componentType){ecModel.eachComponent({mainType:componentType},(function(component){var view=self2._componentsMap[component.__viewId];view.group.ignore||(excludesComponentViews.push(view),view.group.ignore=!0)}))}));var url="svg"===this._zr.painter.getType()?this.getSvgDataURL():this.renderToCanvas(opts).toDataURL("image/"+(opts&&opts.type||"png"));return each$d(excludesComponentViews,(function(view){view.group.ignore=!1})),url}this.id},ECharts2.prototype.getConnectedDataURL=function(opts){if(!this._disposed){var isSvg="svg"===opts.type,groupId=this.group,mathMin2=Math.min,mathMax2=Math.max;if(connectedGroups[groupId]){var left_1=Infinity,top_1=Infinity,right_1=-Infinity,bottom_1=-Infinity,canvasList_1=[],dpr_1=opts&&opts.pixelRatio||this.getDevicePixelRatio();each$d(instances,(function(chart,id){if(chart.group===groupId){var canvas=isSvg?chart.getZr().painter.getSvgDom().innerHTML:chart.renderToCanvas(clone$3(opts)),boundingRect=chart.getDom().getBoundingClientRect();left_1=mathMin2(boundingRect.left,left_1),top_1=mathMin2(boundingRect.top,top_1),right_1=mathMax2(boundingRect.right,right_1),bottom_1=mathMax2(boundingRect.bottom,bottom_1),canvasList_1.push({dom:canvas,left:boundingRect.left,top:boundingRect.top})}}));var width=(right_1*=dpr_1)-(left_1*=dpr_1),height=(bottom_1*=dpr_1)-(top_1*=dpr_1),targetCanvas=platformApi.createCanvas(),zr_1=init$1(targetCanvas,{renderer:isSvg?"svg":"canvas"});if(zr_1.resize({width:width,height:height}),isSvg){var content_1="";return each$d(canvasList_1,(function(item){var x=item.left-left_1,y=item.top-top_1;content_1+='<g transform="translate('+x+","+y+')">'+item.dom+"</g>"})),zr_1.painter.getSvgRoot().innerHTML=content_1,opts.connectedBackgroundColor&&zr_1.painter.setBackgroundColor(opts.connectedBackgroundColor),zr_1.refreshImmediately(),zr_1.painter.toDataURL()}return opts.connectedBackgroundColor&&zr_1.add(new Rect$1({shape:{x:0,y:0,width:width,height:height},style:{fill:opts.connectedBackgroundColor}})),each$d(canvasList_1,(function(item){var img=new ZRImage({style:{x:item.left*dpr_1-left_1,y:item.top*dpr_1-top_1,image:item.dom}});zr_1.add(img)})),zr_1.refreshImmediately(),targetCanvas.toDataURL("image/"+(opts&&opts.type||"png"))}return this.getDataURL(opts)}this.id},ECharts2.prototype.convertToPixel=function(finder,value){return doConvertPixel(this,"convertToPixel",finder,value)},ECharts2.prototype.convertFromPixel=function(finder,value){return doConvertPixel(this,"convertFromPixel",finder,value)},ECharts2.prototype.containPixel=function(finder,value){var result;if(!this._disposed)return each$d(parseFinder$1(this._model,finder),(function(models,key){key.indexOf("Models")>=0&&each$d(models,(function(model){var coordSys=model.coordinateSystem;if(coordSys&&coordSys.containPoint)result=result||!!coordSys.containPoint(value);else if("seriesModels"===key){var view=this._chartsMap[model.__viewId];view&&view.containPoint&&(result=result||view.containPoint(value,model))}}),this)}),this),!!result;this.id},ECharts2.prototype.getVisual=function(finder,visualType){var parsedFinder=parseFinder$1(this._model,finder,{defaultMainType:"series"}),data=parsedFinder.seriesModel.getData(),dataIndexInside=parsedFinder.hasOwnProperty("dataIndexInside")?parsedFinder.dataIndexInside:parsedFinder.hasOwnProperty("dataIndex")?data.indexOfRawIndex(parsedFinder.dataIndex):null;return null!=dataIndexInside?getItemVisualFromData(data,dataIndexInside,visualType):getVisualFromData(data,visualType)},ECharts2.prototype.getViewOfComponentModel=function(componentModel){return this._componentsMap[componentModel.__viewId]},ECharts2.prototype.getViewOfSeriesModel=function(seriesModel){return this._chartsMap[seriesModel.__viewId]},ECharts2.prototype._initEvents=function(){var messageCenter,ecIns,api,_this=this;each$d(MOUSE_EVENT_NAMES,(function(eveName){var handler=function(e2){var params,ecModel=_this.getModel(),el=e2.target;if("globalout"===eveName?params={}:el&&findEventDispatcher(el,(function(parent){var ecData=getECData(parent);if(ecData&&null!=ecData.dataIndex){var dataModel=ecData.dataModel||ecModel.getSeriesByIndex(ecData.seriesIndex);return params=dataModel&&dataModel.getDataParams(ecData.dataIndex,ecData.dataType,el)||{},!0}if(ecData.eventData)return params=extend({},ecData.eventData),!0}),!0),params){var componentType=params.componentType,componentIndex=params.componentIndex;"markLine"!==componentType&&"markPoint"!==componentType&&"markArea"!==componentType||(componentType="series",componentIndex=params.seriesIndex);var model=componentType&&null!=componentIndex&&ecModel.getComponent(componentType,componentIndex),view=model&&_this["series"===model.mainType?"_chartsMap":"_componentsMap"][model.__viewId];params.event=e2,params.type=eveName,_this._$eventProcessor.eventInfo={targetEl:el,packedEvent:params,model:model,view:view},_this.trigger(eveName,params)}};handler.zrEventfulCallAtLast=!0,_this._zr.on(eveName,handler,_this)})),each$d(eventActionMap,(function(actionType,eventType){_this._messageCenter.on(eventType,(function(event){this.trigger(eventType,event)}),_this)})),each$d(["selectchanged"],(function(eventType){_this._messageCenter.on(eventType,(function(event){this.trigger(eventType,event)}),_this)})),messageCenter=this._messageCenter,ecIns=this,api=this._api,messageCenter.on("selectchanged",(function(params){var ecModel=api.getModel();params.isFromClick?(handleSeriesLegacySelectEvents("map","selectchanged",ecIns,ecModel,params),handleSeriesLegacySelectEvents("pie","selectchanged",ecIns,ecModel,params)):"select"===params.fromAction?(handleSeriesLegacySelectEvents("map","selected",ecIns,ecModel,params),handleSeriesLegacySelectEvents("pie","selected",ecIns,ecModel,params)):"unselect"===params.fromAction&&(handleSeriesLegacySelectEvents("map","unselected",ecIns,ecModel,params),handleSeriesLegacySelectEvents("pie","unselected",ecIns,ecModel,params))}))},ECharts2.prototype.isDisposed=function(){return this._disposed},ECharts2.prototype.clear=function(){this._disposed?this.id:this.setOption({series:[]},!0)},ECharts2.prototype.dispose=function(){if(this._disposed)this.id;else{this._disposed=!0,this.getDom()&&setAttribute(this.getDom(),DOM_ATTRIBUTE_KEY,"");var api=this._api,ecModel=this._model;each$d(this._componentsViews,(function(component){component.dispose(ecModel,api)})),each$d(this._chartsViews,(function(chart2){chart2.dispose(ecModel,api)})),this._zr.dispose(),this._dom=this._model=this._chartsMap=this._componentsMap=this._chartsViews=this._componentsViews=this._scheduler=this._api=this._zr=this._throttledZrFlush=this._theme=this._coordSysMgr=this._messageCenter=null,delete instances[this.id]}},ECharts2.prototype.resize=function(opts){if(!this.__flagInMainProcess)if(this._disposed)this.id;else{this._zr.resize(opts);var ecModel=this._model;if(this._loadingFX&&this._loadingFX.resize(),ecModel){var needPrepare=ecModel.resetOption("media"),silent=opts&&opts.silent;this[PENDING_UPDATE]&&(null==silent&&(silent=this[PENDING_UPDATE].silent),needPrepare=!0,this[PENDING_UPDATE]=null),this.__flagInMainProcess=!0;try{needPrepare&&prepare(this),updateMethods.update.call(this,{type:"resize",animation:extend({duration:0},opts&&opts.animation)})}catch(e2){throw this.__flagInMainProcess=!1,e2}this.__flagInMainProcess=!1,flushPendingActions.call(this,silent),triggerUpdatedEvent.call(this,silent)}}},ECharts2.prototype.showLoading=function(name,cfg){if(this._disposed)this.id;else if(isObject$3(name)&&(cfg=name,name=""),name=name||"default",this.hideLoading(),loadingEffects[name]){var el=loadingEffects[name](this._api,cfg),zr=this._zr;this._loadingFX=el,zr.add(el)}},ECharts2.prototype.hideLoading=function(){this._disposed?this.id:(this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null)},ECharts2.prototype.makeActionFromEvent=function(eventObj){var payload=extend({},eventObj);return payload.type=eventActionMap[eventObj.type],payload},ECharts2.prototype.dispatchAction=function(payload,opt){if(this._disposed)this.id;else if(isObject$3(opt)||(opt={silent:!!opt}),actions[payload.type]&&this._model)if(this.__flagInMainProcess)this._pendingActions.push(payload);else{var silent=opt.silent;doDispatchAction.call(this,payload,silent);var flush=opt.flush;flush?this._zr.flush():!1!==flush&&env.browser.weChat&&this._throttledZrFlush(),flushPendingActions.call(this,silent),triggerUpdatedEvent.call(this,silent)}},ECharts2.prototype.updateLabelLayout=function(){lifecycle.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},ECharts2.prototype.appendData=function(params){if(this._disposed)this.id;else{var seriesIndex=params.seriesIndex;this.getModel().getSeriesByIndex(seriesIndex).appendData(params),this._scheduler.unfinished=!0,this.getZr().wakeUp()}},ECharts2.internalField=function(){function clearColorPalette(ecModel){ecModel.clearColorPalette(),ecModel.eachSeries((function(seriesModel){seriesModel.clearColorPalette()}))}function applyElementStates(el){for(var newStates=[],oldStates=el.currentStates,i=0;i<oldStates.length;i++){var stateName=oldStates[i];"emphasis"!==stateName&&"blur"!==stateName&&"select"!==stateName&&newStates.push(stateName)}el.selected&&el.states.select&&newStates.push("select"),2===el.hoverState&&el.states.emphasis?newStates.push("emphasis"):1===el.hoverState&&el.states.blur&&newStates.push("blur"),el.useStates(newStates)}function updateZ2(model,view){if(!model.preventAutoZ){var z=model.get("z")||0,zlevel=model.get("zlevel")||0;view.eachRendered((function(el){return doUpdateZ(el,z,zlevel,-Infinity),!0}))}}function doUpdateZ(el,z,zlevel,maxZ2){var label=el.getTextContent(),labelLine=el.getTextGuideLine();if(el.isGroup)for(var children=el.childrenRef(),i=0;i<children.length;i++)maxZ2=Math.max(doUpdateZ(children[i],z,zlevel,maxZ2),maxZ2);else el.z=z,el.zlevel=zlevel,maxZ2=Math.max(el.z2,maxZ2);if(label&&(label.z=z,label.zlevel=zlevel,isFinite(maxZ2)&&(label.z2=maxZ2+2)),labelLine){var textGuideLineConfig=el.textGuideLineConfig;labelLine.z=z,labelLine.zlevel=zlevel,isFinite(maxZ2)&&(labelLine.z2=maxZ2+(textGuideLineConfig&&textGuideLineConfig.showAbove?1:-1))}return maxZ2}function clearStates(model,view){view.eachRendered((function(el){if(!isElementRemoved(el)){var textContent=el.getTextContent(),textGuide=el.getTextGuideLine();el.stateTransition&&(el.stateTransition=null),textContent&&textContent.stateTransition&&(textContent.stateTransition=null),textGuide&&textGuide.stateTransition&&(textGuide.stateTransition=null),el.hasState()?(el.prevStates=el.currentStates,el.clearStates()):el.prevStates&&(el.prevStates=null)}}))}function updateStates(model,view){var stateAnimationModel=model.getModel("stateAnimation"),enableAnimation=model.isAnimationEnabled(),duration=stateAnimationModel.get("duration"),stateTransition=duration>0?{duration:duration,delay:stateAnimationModel.get("delay"),easing:stateAnimationModel.get("easing")}:null;view.eachRendered((function(el){if(el.states&&el.states.emphasis){if(isElementRemoved(el))return;if(el instanceof Path&&function(el){var store=getSavedStates(el);store.normalFill=el.style.fill,store.normalStroke=el.style.stroke;var selectState=el.states.select||{};store.selectFill=selectState.style&&selectState.style.fill||null,store.selectStroke=selectState.style&&selectState.style.stroke||null}(el),el.__dirty){var prevStates=el.prevStates;prevStates&&el.useStates(prevStates)}if(enableAnimation){el.stateTransition=stateTransition;var textContent=el.getTextContent(),textGuide=el.getTextGuideLine();textContent&&(textContent.stateTransition=stateTransition),textGuide&&(textGuide.stateTransition=stateTransition)}el.__dirty&&applyElementStates(el)}}))}prepare=function(ecIns){var scheduler=ecIns._scheduler;scheduler.restorePipelines(ecIns._model),scheduler.prepareStageTasks(),prepareView(ecIns,!0),prepareView(ecIns,!1),scheduler.plan()},prepareView=function(ecIns,isComponent){for(var ecModel=ecIns._model,scheduler=ecIns._scheduler,viewList=isComponent?ecIns._componentsViews:ecIns._chartsViews,viewMap=isComponent?ecIns._componentsMap:ecIns._chartsMap,zr=ecIns._zr,api=ecIns._api,i=0;i<viewList.length;i++)viewList[i].__alive=!1;function doPrepare(model){var requireNewView=model.__requireNewView;model.__requireNewView=!1;var viewId="_ec_"+model.id+"_"+model.type,view2=!requireNewView&&viewMap[viewId];if(!view2){var classType=parseClassType(model.type);(view2=new(isComponent?ComponentView.getClass(classType.main,classType.sub):ChartView.getClass(classType.sub))).init(ecModel,api),viewMap[viewId]=view2,viewList.push(view2),zr.add(view2.group)}model.__viewId=view2.__id=viewId,view2.__alive=!0,view2.__model=model,view2.group.__ecComponentInfo={mainType:model.mainType,index:model.componentIndex},!isComponent&&scheduler.prepareView(view2,model,ecModel,api)}isComponent?ecModel.eachComponent((function(componentType,model){"series"!==componentType&&doPrepare(model)})):ecModel.eachSeries(doPrepare);for(i=0;i<viewList.length;){var view=viewList[i];view.__alive?i++:(!isComponent&&view.renderTask.dispose(),zr.remove(view.group),view.dispose(ecModel,api),viewList.splice(i,1),viewMap[view.__id]===view&&delete viewMap[view.__id],view.__id=view.group.__ecComponentInfo=null)}},updateDirectly=function(ecIns,method,payload,mainType,subType){var ecModel=ecIns._model;if(ecModel.setUpdatePayload(payload),mainType){var query={};query[mainType+"Id"]=payload[mainType+"Id"],query[mainType+"Index"]=payload[mainType+"Index"],query[mainType+"Name"]=payload[mainType+"Name"];var condition={mainType:mainType,query:query};subType&&(condition.subType=subType);var excludeSeriesIdMap,excludeSeriesId=payload.excludeSeriesId;null!=excludeSeriesId&&(excludeSeriesIdMap=createHashMap(),each$d(normalizeToArray(excludeSeriesId),(function(id){var modelId=convertOptionIdName(id,null);null!=modelId&&excludeSeriesIdMap.set(modelId,!0)}))),ecModel&&ecModel.eachComponent(condition,(function(model){if(!(excludeSeriesIdMap&&null!=excludeSeriesIdMap.get(model.id)))if(isHighDownPayload(payload))if(model instanceof SeriesModel)"highlight"!==payload.type||payload.notBlur||model.get(["emphasis","disabled"])||function(seriesModel,payload,api){var seriesIndex=seriesModel.seriesIndex,data=seriesModel.getData(payload.dataType);if(data){var dataIndex=queryDataIndex(data,payload);dataIndex=(isArray$1(dataIndex)?dataIndex[0]:dataIndex)||0;var el=data.getItemGraphicEl(dataIndex);if(!el)for(var count2=data.count(),current=0;!el&&current<count2;)el=data.getItemGraphicEl(current++);if(el){var ecData=getECData(el);blurSeries(seriesIndex,ecData.focus,ecData.blurScope,api)}else{var focus_1=seriesModel.get(["emphasis","focus"]),blurScope=seriesModel.get(["emphasis","blurScope"]);null!=focus_1&&blurSeries(seriesIndex,focus_1,blurScope,api)}}}(model,payload,ecIns._api);else{var _a2=findComponentHighDownDispatchers(model.mainType,model.componentIndex,payload.name,ecIns._api),focusSelf=_a2.focusSelf,dispatchers=_a2.dispatchers;"highlight"===payload.type&&focusSelf&&!payload.notBlur&&blurComponent(model.mainType,model.componentIndex,ecIns._api),dispatchers&&each$d(dispatchers,(function(dispatcher){"highlight"===payload.type?enterEmphasis(dispatcher):leaveEmphasis(dispatcher)}))}else isSelectChangePayload(payload)&&model instanceof SeriesModel&&(!function(seriesModel,payload){if(isSelectChangePayload(payload)){var dataType=payload.dataType,dataIndex=queryDataIndex(seriesModel.getData(dataType),payload);isArray$1(dataIndex)||(dataIndex=[dataIndex]),seriesModel["toggleSelect"===payload.type?"toggleSelect":"select"===payload.type?"select":"unselect"](dataIndex,dataType)}}(model,payload,ecIns._api),updateSeriesElementSelection(model),markStatusToUpdate(ecIns))}),ecIns),ecModel&&ecModel.eachComponent(condition,(function(model){excludeSeriesIdMap&&null!=excludeSeriesIdMap.get(model.id)||callView(ecIns["series"===mainType?"_chartsMap":"_componentsMap"][model.__viewId])}),ecIns)}else each$d([].concat(ecIns._componentsViews).concat(ecIns._chartsViews),callView);function callView(view){view&&view.__alive&&view[method]&&view[method](view.__model,ecModel,ecIns._api,payload)}},updateMethods={prepareAndUpdate:function(payload){prepare(this),updateMethods.update.call(this,payload,{optionChanged:null!=payload.newOption})},update:function(payload,updateParams){var ecModel=this._model,api=this._api,zr=this._zr,coordSysMgr=this._coordSysMgr,scheduler=this._scheduler;if(ecModel){ecModel.setUpdatePayload(payload),scheduler.restoreData(ecModel,payload),scheduler.performSeriesTasks(ecModel),coordSysMgr.create(ecModel,api),scheduler.performDataProcessorTasks(ecModel,payload),updateStreamModes(this,ecModel),coordSysMgr.update(ecModel,api),clearColorPalette(ecModel),scheduler.performVisualTasks(ecModel,payload),render(this,ecModel,api,payload,updateParams);var backgroundColor2=ecModel.get("backgroundColor")||"transparent",darkMode=ecModel.get("darkMode");zr.setBackgroundColor(backgroundColor2),null!=darkMode&&"auto"!==darkMode&&zr.setDarkMode(darkMode),lifecycle.trigger("afterupdate",ecModel,api)}},updateTransform:function(payload){var _this=this,ecModel=this._model,api=this._api;if(ecModel){ecModel.setUpdatePayload(payload);var componentDirtyList=[];ecModel.eachComponent((function(componentType,componentModel){if("series"!==componentType){var componentView=_this.getViewOfComponentModel(componentModel);if(componentView&&componentView.__alive)if(componentView.updateTransform){var result=componentView.updateTransform(componentModel,ecModel,api,payload);result&&result.update&&componentDirtyList.push(componentView)}else componentDirtyList.push(componentView)}}));var seriesDirtyMap=createHashMap();ecModel.eachSeries((function(seriesModel){var chartView=_this._chartsMap[seriesModel.__viewId];if(chartView.updateTransform){var result=chartView.updateTransform(seriesModel,ecModel,api,payload);result&&result.update&&seriesDirtyMap.set(seriesModel.uid,1)}else seriesDirtyMap.set(seriesModel.uid,1)})),clearColorPalette(ecModel),this._scheduler.performVisualTasks(ecModel,payload,{setDirty:!0,dirtyMap:seriesDirtyMap}),renderSeries(this,ecModel,api,payload,{},seriesDirtyMap),lifecycle.trigger("afterupdate",ecModel,api)}},updateView:function(payload){var ecModel=this._model;ecModel&&(ecModel.setUpdatePayload(payload),ChartView.markUpdateMethod(payload,"updateView"),clearColorPalette(ecModel),this._scheduler.performVisualTasks(ecModel,payload,{setDirty:!0}),render(this,ecModel,this._api,payload,{}),lifecycle.trigger("afterupdate",ecModel,this._api))},updateVisual:function(payload){var _this=this,ecModel=this._model;ecModel&&(ecModel.setUpdatePayload(payload),ecModel.eachSeries((function(seriesModel){seriesModel.getData().clearAllVisual()})),ChartView.markUpdateMethod(payload,"updateVisual"),clearColorPalette(ecModel),this._scheduler.performVisualTasks(ecModel,payload,{visualType:"visual",setDirty:!0}),ecModel.eachComponent((function(componentType,componentModel){if("series"!==componentType){var componentView=_this.getViewOfComponentModel(componentModel);componentView&&componentView.__alive&&componentView.updateVisual(componentModel,ecModel,_this._api,payload)}})),ecModel.eachSeries((function(seriesModel){_this._chartsMap[seriesModel.__viewId].updateVisual(seriesModel,ecModel,_this._api,payload)})),lifecycle.trigger("afterupdate",ecModel,this._api))},updateLayout:function(payload){updateMethods.update.call(this,payload)}},doConvertPixel=function(ecIns,methodName,finder,value){if(ecIns._disposed)ecIns.id;else for(var result,ecModel=ecIns._model,coordSysList=ecIns._coordSysMgr.getCoordinateSystems(),parsedFinder=parseFinder$1(ecModel,finder),i=0;i<coordSysList.length;i++){var coordSys=coordSysList[i];if(coordSys[methodName]&&null!=(result=coordSys[methodName](ecModel,parsedFinder,value)))return result}},updateStreamModes=function(ecIns,ecModel){var chartsMap=ecIns._chartsMap,scheduler=ecIns._scheduler;ecModel.eachSeries((function(seriesModel){scheduler.updateStreamModes(seriesModel,chartsMap[seriesModel.__viewId])}))},doDispatchAction=function(payload,silent){var _this=this,ecModel=this.getModel(),payloadType=payload.type,escapeConnect=payload.escapeConnect,actionWrap=actions[payloadType],actionInfo2=actionWrap.actionInfo,cptTypeTmp=(actionInfo2.update||"update").split(":"),updateMethod=cptTypeTmp.pop(),cptType=null!=cptTypeTmp[0]&&parseClassType(cptTypeTmp[0]);this.__flagInMainProcess=!0;var payloads=[payload],batched=!1;payload.batch&&(batched=!0,payloads=map$1(payload.batch,(function(item){return(item=defaults(extend({},item),payload)).batch=null,item})));var eventObj,eventObjBatch=[],isSelectChange=isSelectChangePayload(payload),isHighDown=isHighDownPayload(payload);if(isHighDown&&allLeaveBlur(this._api),each$d(payloads,(function(batchItem){if((eventObj=(eventObj=actionWrap.action(batchItem,_this._model,_this._api))||extend({},batchItem)).type=actionInfo2.event||eventObj.type,eventObjBatch.push(eventObj),isHighDown){var _a2=preParseFinder(payload),queryOptionMap=_a2.queryOptionMap,componentMainType=_a2.mainTypeSpecified?queryOptionMap.keys()[0]:"series";updateDirectly(_this,updateMethod,batchItem,componentMainType),markStatusToUpdate(_this)}else isSelectChange?(updateDirectly(_this,updateMethod,batchItem,"series"),markStatusToUpdate(_this)):cptType&&updateDirectly(_this,updateMethod,batchItem,cptType.main,cptType.sub)})),"none"!==updateMethod&&!isHighDown&&!isSelectChange&&!cptType)try{this[PENDING_UPDATE]?(prepare(this),updateMethods.update.call(this,payload),this[PENDING_UPDATE]=null):updateMethods[updateMethod].call(this,payload)}catch(e2){throw this.__flagInMainProcess=!1,e2}if(eventObj=batched?{type:actionInfo2.event||payloadType,escapeConnect:escapeConnect,batch:eventObjBatch}:eventObjBatch[0],this.__flagInMainProcess=!1,!silent){var messageCenter=this._messageCenter;if(messageCenter.trigger(eventObj.type,eventObj),isSelectChange){var newObj={type:"selectchanged",escapeConnect:escapeConnect,selected:getAllSelectedIndices(ecModel),isFromClick:payload.isFromClick||!1,fromAction:payload.type,fromActionPayload:payload};messageCenter.trigger(newObj.type,newObj)}}},flushPendingActions=function(silent){for(var pendingActions=this._pendingActions;pendingActions.length;){var payload=pendingActions.shift();doDispatchAction.call(this,payload,silent)}},triggerUpdatedEvent=function(silent){!silent&&this.trigger("updated")},bindRenderedEvent=function(zr,ecIns){zr.on("rendered",(function(params){ecIns.trigger("rendered",params),!zr.animation.isFinished()||ecIns[PENDING_UPDATE]||ecIns._scheduler.unfinished||ecIns._pendingActions.length||ecIns.trigger("finished")}))},bindMouseEvent=function(zr,ecIns){zr.on("mouseover",(function(e2){var dispatcher=findEventDispatcher(e2.target,isHighDownDispatcher);dispatcher&&(!function(dispatcher,e2,api){var ecData=getECData(dispatcher),_a2=findComponentHighDownDispatchers(ecData.componentMainType,ecData.componentIndex,ecData.componentHighDownName,api),dispatchers=_a2.dispatchers,focusSelf=_a2.focusSelf;dispatchers?(focusSelf&&blurComponent(ecData.componentMainType,ecData.componentIndex,api),each$d(dispatchers,(function(dispatcher2){return enterEmphasisWhenMouseOver(dispatcher2,e2)}))):(blurSeries(ecData.seriesIndex,ecData.focus,ecData.blurScope,api),"self"===ecData.focus&&blurComponent(ecData.componentMainType,ecData.componentIndex,api),enterEmphasisWhenMouseOver(dispatcher,e2))}(dispatcher,e2,ecIns._api),markStatusToUpdate(ecIns))})).on("mouseout",(function(e2){var dispatcher=findEventDispatcher(e2.target,isHighDownDispatcher);dispatcher&&(!function(dispatcher,e2,api){allLeaveBlur(api);var ecData=getECData(dispatcher),dispatchers=findComponentHighDownDispatchers(ecData.componentMainType,ecData.componentIndex,ecData.componentHighDownName,api).dispatchers;dispatchers?each$d(dispatchers,(function(dispatcher2){return leaveEmphasisWhenMouseOut(dispatcher2,e2)})):leaveEmphasisWhenMouseOut(dispatcher,e2)}(dispatcher,e2,ecIns._api),markStatusToUpdate(ecIns))})).on("click",(function(e2){var dispatcher=findEventDispatcher(e2.target,(function(target){return null!=getECData(target).dataIndex}),!0);if(dispatcher){var actionType=dispatcher.selected?"unselect":"select",ecData=getECData(dispatcher);ecIns._api.dispatchAction({type:actionType,dataType:ecData.dataType,dataIndexInside:ecData.dataIndex,seriesIndex:ecData.seriesIndex,isFromClick:!0})}}))},render=function(ecIns,ecModel,api,payload,updateParams){!function(ecModel){var componentZLevels=[],seriesZLevels=[],hasSeparateZLevel=!1;if(ecModel.eachComponent((function(componentType,componentModel){var zlevel=componentModel.get("zlevel")||0,z=componentModel.get("z")||0,zlevelKey=componentModel.getZLevelKey();hasSeparateZLevel=hasSeparateZLevel||!!zlevelKey,("series"===componentType?seriesZLevels:componentZLevels).push({zlevel:zlevel,z:z,idx:componentModel.componentIndex,type:componentType,key:zlevelKey})})),hasSeparateZLevel){var lastSeriesZLevel_1,lastSeriesKey_1,zLevels=componentZLevels.concat(seriesZLevels);sort(zLevels,(function(a,b){return a.zlevel===b.zlevel?a.z-b.z:a.zlevel-b.zlevel})),each$d(zLevels,(function(item){var componentModel=ecModel.getComponent(item.type,item.idx),zlevel=item.zlevel,key=item.key;null!=lastSeriesZLevel_1&&(zlevel=Math.max(lastSeriesZLevel_1,zlevel)),key?(zlevel===lastSeriesZLevel_1&&key!==lastSeriesKey_1&&zlevel++,lastSeriesKey_1=key):lastSeriesKey_1&&(zlevel===lastSeriesZLevel_1&&zlevel++,lastSeriesKey_1=""),lastSeriesZLevel_1=zlevel,componentModel.setZLevel(zlevel)}))}}(ecModel),renderComponents(ecIns,ecModel,api,payload,updateParams),each$d(ecIns._chartsViews,(function(chart){chart.__alive=!1})),renderSeries(ecIns,ecModel,api,payload,updateParams),each$d(ecIns._chartsViews,(function(chart){chart.__alive||chart.remove(ecModel,api)}))},renderComponents=function(ecIns,ecModel,api,payload,updateParams,dirtyList){each$d(dirtyList||ecIns._componentsViews,(function(componentView){var componentModel=componentView.__model;clearStates(componentModel,componentView),componentView.render(componentModel,ecModel,api,payload),updateZ2(componentModel,componentView),updateStates(componentModel,componentView)}))},renderSeries=function(ecIns,ecModel,api,payload,updateParams,dirtyMap){var scheduler=ecIns._scheduler;updateParams=extend(updateParams||{},{updatedSeries:ecModel.getSeries()}),lifecycle.trigger("series:beforeupdate",ecModel,api,updateParams);var unfinished=!1;ecModel.eachSeries((function(seriesModel){var chartView=ecIns._chartsMap[seriesModel.__viewId];chartView.__alive=!0;var renderTask=chartView.renderTask;scheduler.updatePayload(renderTask,payload),clearStates(seriesModel,chartView),dirtyMap&&dirtyMap.get(seriesModel.uid)&&renderTask.dirty(),renderTask.perform(scheduler.getPerformArgs(renderTask))&&(unfinished=!0),chartView.group.silent=!!seriesModel.get("silent"),function(seriesModel,chartView){var blendMode=seriesModel.get("blendMode")||null;chartView.eachRendered((function(el){el.isGroup||(el.style.blend=blendMode)}))}(seriesModel,chartView),updateSeriesElementSelection(seriesModel)})),scheduler.unfinished=unfinished||scheduler.unfinished,lifecycle.trigger("series:layoutlabels",ecModel,api,updateParams),lifecycle.trigger("series:transition",ecModel,api,updateParams),ecModel.eachSeries((function(seriesModel){var chartView=ecIns._chartsMap[seriesModel.__viewId];updateZ2(seriesModel,chartView),updateStates(seriesModel,chartView)})),function(ecIns,ecModel){var zr=ecIns._zr,storage2=zr.storage,elCount=0;storage2.traverse((function(el){el.isGroup||elCount++})),elCount>ecModel.get("hoverLayerThreshold")&&!env.node&&!env.worker&&ecModel.eachSeries((function(seriesModel){if(!seriesModel.preventUsingHoverLayer){var chartView=ecIns._chartsMap[seriesModel.__viewId];chartView.__alive&&chartView.eachRendered((function(el){el.states.emphasis&&(el.states.emphasis.hoverLayer=!0)}))}}))}(ecIns,ecModel),lifecycle.trigger("series:afterupdate",ecModel,api,updateParams)},markStatusToUpdate=function(ecIns){ecIns.__needsUpdateStatus=!0,ecIns.getZr().wakeUp()},applyChangedStates=function(ecIns){ecIns.__needsUpdateStatus&&(ecIns.getZr().storage.traverse((function(el){isElementRemoved(el)||applyElementStates(el)})),ecIns.__needsUpdateStatus=!1)},createExtensionAPI=function(ecIns){return new(function(_super2){function class_1(){return null!==_super2&&_super2.apply(this,arguments)||this}return __extends(class_1,_super2),class_1.prototype.getCoordinateSystems=function(){return ecIns._coordSysMgr.getCoordinateSystems()},class_1.prototype.getComponentByElement=function(el){for(;el;){var modelInfo=el.__ecComponentInfo;if(null!=modelInfo)return ecIns._model.getComponent(modelInfo.mainType,modelInfo.index);el=el.parent}},class_1.prototype.enterEmphasis=function(el,highlightDigit){enterEmphasis(el,highlightDigit),markStatusToUpdate(ecIns)},class_1.prototype.leaveEmphasis=function(el,highlightDigit){leaveEmphasis(el,highlightDigit),markStatusToUpdate(ecIns)},class_1.prototype.enterBlur=function(el){!function(el){traverseUpdateState(el,singleEnterBlur)}(el),markStatusToUpdate(ecIns)},class_1.prototype.leaveBlur=function(el){leaveBlur(el),markStatusToUpdate(ecIns)},class_1.prototype.enterSelect=function(el){enterSelect(el),markStatusToUpdate(ecIns)},class_1.prototype.leaveSelect=function(el){leaveSelect(el),markStatusToUpdate(ecIns)},class_1.prototype.getModel=function(){return ecIns.getModel()},class_1.prototype.getViewOfComponentModel=function(componentModel){return ecIns.getViewOfComponentModel(componentModel)},class_1.prototype.getViewOfSeriesModel=function(seriesModel){return ecIns.getViewOfSeriesModel(seriesModel)},class_1}(ExtensionAPI))(ecIns)},enableConnect=function(chart){function updateConnectedChartsStatus(charts,status){for(var i=0;i<charts.length;i++){charts[i].__connectUpdateStatus=status}}each$d(eventActionMap,(function(actionType,eventType){chart._messageCenter.on(eventType,(function(event){if(connectedGroups[chart.group]&&0!==chart.__connectUpdateStatus){if(event&&event.escapeConnect)return;var action_1=chart.makeActionFromEvent(event),otherCharts_1=[];each$d(instances,(function(otherChart){otherChart!==chart&&otherChart.group===chart.group&&otherCharts_1.push(otherChart)})),updateConnectedChartsStatus(otherCharts_1,0),each$d(otherCharts_1,(function(otherChart){1!==otherChart.__connectUpdateStatus&&otherChart.dispatchAction(action_1)})),updateConnectedChartsStatus(otherCharts_1,2)}}))}))}}(),ECharts2}(Eventful),echartsProto=ECharts.prototype;echartsProto.on=createRegisterEventWithLowercaseECharts("on"),echartsProto.off=createRegisterEventWithLowercaseECharts("off"),echartsProto.one=function(eventName,cb,ctx){var self2=this;this.on.call(this,eventName,(function wrapped(){for(var args2=[],_i=0;_i<arguments.length;_i++)args2[_i]=arguments[_i];cb&&cb.apply&&cb.apply(this,args2),self2.off(eventName,wrapped)}),ctx)};var MOUSE_EVENT_NAMES=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];var actions={},eventActionMap={},dataProcessorFuncs=[],optionPreprocessorFuncs=[],visualFuncs=[],themeStorage={},loadingEffects={},instances={},connectedGroups={},idBase=+new Date-0,groupIdBase=+new Date-0,DOM_ATTRIBUTE_KEY="_echarts_instance_";function disconnect(groupId){connectedGroups[groupId]=!1}var disConnect=disconnect;function getInstanceByDom(dom){return instances[function(dom,key){return dom.getAttribute?dom.getAttribute(key):dom[key]}(dom,DOM_ATTRIBUTE_KEY)]}function registerTheme(name,theme2){themeStorage[name]=theme2}function registerPreprocessor(preprocessorFunc){indexOf(optionPreprocessorFuncs,preprocessorFunc)<0&&optionPreprocessorFuncs.push(preprocessorFunc)}function registerProcessor(priority,processor){normalizeRegister(dataProcessorFuncs,priority,processor,2e3)}function registerPostInit(postInitFunc){registerUpdateLifecycle("afterinit",postInitFunc)}function registerPostUpdate(postUpdateFunc){registerUpdateLifecycle("afterupdate",postUpdateFunc)}function registerUpdateLifecycle(name,cb){lifecycle.on(name,cb)}function registerAction(actionInfo2,eventName,action){isFunction(eventName)&&(action=eventName,eventName="");var actionType=isObject$3(actionInfo2)?actionInfo2.type:[actionInfo2,actionInfo2={event:eventName}][0];actionInfo2.event=(actionInfo2.event||actionType).toLowerCase(),eventName=actionInfo2.event,eventActionMap[eventName]||(assert(ACTION_REG.test(actionType)&&ACTION_REG.test(eventName)),actions[actionType]||(actions[actionType]={action:action,actionInfo:actionInfo2}),eventActionMap[eventName]=actionType)}function registerCoordinateSystem(type,coordSysCreator){CoordinateSystemManager.register(type,coordSysCreator)}function registerLayout(priority,layoutTask){normalizeRegister(visualFuncs,priority,layoutTask,1e3,"layout")}function registerVisual(priority,visualTask){normalizeRegister(visualFuncs,priority,visualTask,3e3,"visual")}var registeredTasks=[];function normalizeRegister(targetList,priority,fn,defaultPriority,visualType){if((isFunction(priority)||isObject$3(priority))&&(fn=priority,priority=defaultPriority),!(indexOf(registeredTasks,fn)>=0)){registeredTasks.push(fn);var stageHandler=Scheduler.wrapStageHandler(fn,visualType);stageHandler.__prio=priority,stageHandler.__raw=fn,targetList.push(stageHandler)}}function registerLoading(name,loadingFx){loadingEffects[name]=loadingFx}function registerMap$1(mapName,geoJson,specialAreas){var registerMap2=getImpl("registerMap");registerMap2&&registerMap2(mapName,geoJson,specialAreas)}var registerTransform=function(externalTransform){var type=(externalTransform=clone$3(externalTransform)).type;type||throwError("");var typeParsed=type.split(":");2!==typeParsed.length&&throwError("");var isBuiltIn=!1;"echarts"===typeParsed[0]&&(type=typeParsed[1],isBuiltIn=!0),externalTransform.__isBuiltIn=isBuiltIn,externalTransformMap.set(type,externalTransform)};registerVisual(2e3,seriesStyleTask),registerVisual(4500,dataStyleTask),registerVisual(4500,dataColorPaletteTask),registerVisual(2e3,seriesSymbolTask),registerVisual(4500,dataSymbolTask),registerVisual(7e3,(function(ecModel,api){ecModel.eachRawSeries((function(seriesModel){if(!ecModel.isSeriesFiltered(seriesModel)){var data=seriesModel.getData();data.hasItemVisual()&&data.each((function(idx){var decal2=data.getItemVisual(idx,"decal");decal2&&(data.ensureUniqueItemVisual(idx,"style").decal=createOrUpdatePatternFromDecal(decal2,api))}));var decal=data.getVisual("decal");if(decal)data.getVisual("style").decal=createOrUpdatePatternFromDecal(decal,api)}}))})),registerPreprocessor(globalBackwardCompat),registerProcessor(900,(function(ecModel){var stackInfoMap=createHashMap();ecModel.eachSeries((function(seriesModel){var stack=seriesModel.get("stack");if(stack){var stackInfoList=stackInfoMap.get(stack)||stackInfoMap.set(stack,[]),data=seriesModel.getData(),stackInfo={stackResultDimension:data.getCalculationInfo("stackResultDimension"),stackedOverDimension:data.getCalculationInfo("stackedOverDimension"),stackedDimension:data.getCalculationInfo("stackedDimension"),stackedByDimension:data.getCalculationInfo("stackedByDimension"),isStackedByIndex:data.getCalculationInfo("isStackedByIndex"),data:data,seriesModel:seriesModel};if(!stackInfo.stackedDimension||!stackInfo.isStackedByIndex&&!stackInfo.stackedByDimension)return;stackInfoList.length&&data.setCalculationInfo("stackedOnSeries",stackInfoList[stackInfoList.length-1].seriesModel),stackInfoList.push(stackInfo)}})),stackInfoMap.each(calculateStack)})),registerLoading("default",(function(api,opts){defaults(opts=opts||{},{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var group=new Group$2,mask=new Rect$1({style:{fill:opts.maskColor},zlevel:opts.zlevel,z:1e4});group.add(mask);var arc,textContent=new ZRText({style:{text:opts.text,fill:opts.textColor,fontSize:opts.fontSize,fontWeight:opts.fontWeight,fontStyle:opts.fontStyle,fontFamily:opts.fontFamily},zlevel:opts.zlevel,z:10001}),labelRect=new Rect$1({style:{fill:"none"},textContent:textContent,textConfig:{position:"right",distance:10},zlevel:opts.zlevel,z:10001});return group.add(labelRect),opts.showSpinner&&((arc=new Arc({shape:{startAngle:-PI$4/2,endAngle:-PI$4/2+.1,r:opts.spinnerRadius},style:{stroke:opts.color,lineCap:"round",lineWidth:opts.lineWidth},zlevel:opts.zlevel,z:10001})).animateShape(!0).when(1e3,{endAngle:3*PI$4/2}).start("circularInOut"),arc.animateShape(!0).when(1e3,{startAngle:3*PI$4/2}).delay(300).start("circularInOut"),group.add(arc)),group.resize=function(){var textWidth=textContent.getBoundingRect().width,r=opts.showSpinner?opts.spinnerRadius:0,cx=(api.getWidth()-2*r-(opts.showSpinner&&textWidth?10:0)-textWidth)/2-(opts.showSpinner&&textWidth?0:5+textWidth/2)+(opts.showSpinner?0:textWidth/2)+(textWidth?0:r),cy=api.getHeight()/2;opts.showSpinner&&arc.setShape({cx:cx,cy:cy}),labelRect.setShape({x:cx-r,y:cy-r,width:2*r,height:2*r}),mask.setShape({x:0,y:0,width:api.getWidth(),height:api.getHeight()})},group.resize(),group})),registerAction({type:"highlight",event:"highlight",update:"highlight"},noop),registerAction({type:"downplay",event:"downplay",update:"downplay"},noop),registerAction({type:"select",event:"select",update:"select"},noop),registerAction({type:"unselect",event:"unselect",update:"unselect"},noop),registerAction({type:"toggleSelect",event:"toggleSelect",update:"toggleSelect"},noop),registerTheme("light",lightTheme),registerTheme("dark",theme);function dataIndexMapValueLength(valNumOrArrLengthMoreThan2){return null==valNumOrArrLengthMoreThan2?0:valNumOrArrLengthMoreThan2.length||1}function defaultKeyGetter(item){return item}var DataDiffer=function(){function DataDiffer2(oldArr,newArr,oldKeyGetter,newKeyGetter,context,diffMode){this._old=oldArr,this._new=newArr,this._oldKeyGetter=oldKeyGetter||defaultKeyGetter,this._newKeyGetter=newKeyGetter||defaultKeyGetter,this.context=context,this._diffModeMultiple="multiple"===diffMode}return DataDiffer2.prototype.add=function(func){return this._add=func,this},DataDiffer2.prototype.update=function(func){return this._update=func,this},DataDiffer2.prototype.updateManyToOne=function(func){return this._updateManyToOne=func,this},DataDiffer2.prototype.updateOneToMany=function(func){return this._updateOneToMany=func,this},DataDiffer2.prototype.updateManyToMany=function(func){return this._updateManyToMany=func,this},DataDiffer2.prototype.remove=function(func){return this._remove=func,this},DataDiffer2.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},DataDiffer2.prototype._executeOneToOne=function(){var oldArr=this._old,newArr=this._new,newDataIndexMap={},oldDataKeyArr=new Array(oldArr.length),newDataKeyArr=new Array(newArr.length);this._initIndexMap(oldArr,null,oldDataKeyArr,"_oldKeyGetter"),this._initIndexMap(newArr,newDataIndexMap,newDataKeyArr,"_newKeyGetter");for(var i=0;i<oldArr.length;i++){var oldKey=oldDataKeyArr[i],newIdxMapVal=newDataIndexMap[oldKey],newIdxMapValLen=dataIndexMapValueLength(newIdxMapVal);if(newIdxMapValLen>1){var newIdx=newIdxMapVal.shift();1===newIdxMapVal.length&&(newDataIndexMap[oldKey]=newIdxMapVal[0]),this._update&&this._update(newIdx,i)}else 1===newIdxMapValLen?(newDataIndexMap[oldKey]=null,this._update&&this._update(newIdxMapVal,i)):this._remove&&this._remove(i)}this._performRestAdd(newDataKeyArr,newDataIndexMap)},DataDiffer2.prototype._executeMultiple=function(){var oldArr=this._old,newArr=this._new,oldDataIndexMap={},newDataIndexMap={},oldDataKeyArr=[],newDataKeyArr=[];this._initIndexMap(oldArr,oldDataIndexMap,oldDataKeyArr,"_oldKeyGetter"),this._initIndexMap(newArr,newDataIndexMap,newDataKeyArr,"_newKeyGetter");for(var i=0;i<oldDataKeyArr.length;i++){var oldKey=oldDataKeyArr[i],oldIdxMapVal=oldDataIndexMap[oldKey],newIdxMapVal=newDataIndexMap[oldKey],oldIdxMapValLen=dataIndexMapValueLength(oldIdxMapVal),newIdxMapValLen=dataIndexMapValueLength(newIdxMapVal);if(oldIdxMapValLen>1&&1===newIdxMapValLen)this._updateManyToOne&&this._updateManyToOne(newIdxMapVal,oldIdxMapVal),newDataIndexMap[oldKey]=null;else if(1===oldIdxMapValLen&&newIdxMapValLen>1)this._updateOneToMany&&this._updateOneToMany(newIdxMapVal,oldIdxMapVal),newDataIndexMap[oldKey]=null;else if(1===oldIdxMapValLen&&1===newIdxMapValLen)this._update&&this._update(newIdxMapVal,oldIdxMapVal),newDataIndexMap[oldKey]=null;else if(oldIdxMapValLen>1&&newIdxMapValLen>1)this._updateManyToMany&&this._updateManyToMany(newIdxMapVal,oldIdxMapVal),newDataIndexMap[oldKey]=null;else if(oldIdxMapValLen>1)for(var i_1=0;i_1<oldIdxMapValLen;i_1++)this._remove&&this._remove(oldIdxMapVal[i_1]);else this._remove&&this._remove(oldIdxMapVal)}this._performRestAdd(newDataKeyArr,newDataIndexMap)},DataDiffer2.prototype._performRestAdd=function(newDataKeyArr,newDataIndexMap){for(var i=0;i<newDataKeyArr.length;i++){var newKey=newDataKeyArr[i],newIdxMapVal=newDataIndexMap[newKey],idxMapValLen=dataIndexMapValueLength(newIdxMapVal);if(idxMapValLen>1)for(var j=0;j<idxMapValLen;j++)this._add&&this._add(newIdxMapVal[j]);else 1===idxMapValLen&&this._add&&this._add(newIdxMapVal);newDataIndexMap[newKey]=null}},DataDiffer2.prototype._initIndexMap=function(arr,map2,keyArr,keyGetterName){for(var cbModeMultiple=this._diffModeMultiple,i=0;i<arr.length;i++){var key="_ec_"+this[keyGetterName](arr[i],i);if(cbModeMultiple||(keyArr[i]=key),map2){var idxMapVal=map2[key],idxMapValLen=dataIndexMapValueLength(idxMapVal);0===idxMapValLen?(map2[key]=i,cbModeMultiple&&keyArr.push(key)):1===idxMapValLen?map2[key]=[idxMapVal,i]:idxMapVal.push(i)}}},DataDiffer2}(),DimensionUserOuput=function(){function DimensionUserOuput2(encode,dimRequest){this._encode=encode,this._schema=dimRequest}return DimensionUserOuput2.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},DimensionUserOuput2.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},DimensionUserOuput2}();function getOrCreateEncodeArr(encode,dim){return encode.hasOwnProperty(dim)||(encode[dim]=[]),encode[dim]}var SeriesDimensionDefine=function(){return function(opt){this.otherDims={},null!=opt&&extend(this,opt)}}(),inner$a=makeInner(),dimTypeShort={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},SeriesDataSchema=function(){function SeriesDataSchema2(opt){this.dimensions=opt.dimensions,this._dimOmitted=opt.dimensionOmitted,this.source=opt.source,this._fullDimCount=opt.fullDimensionCount,this._updateDimOmitted(opt.dimensionOmitted)}return SeriesDataSchema2.prototype.isDimensionOmitted=function(){return this._dimOmitted},SeriesDataSchema2.prototype._updateDimOmitted=function(dimensionOmitted){this._dimOmitted=dimensionOmitted,dimensionOmitted&&(this._dimNameMap||(this._dimNameMap=ensureSourceDimNameMap(this.source)))},SeriesDataSchema2.prototype.getSourceDimensionIndex=function(dimName){return retrieve2(this._dimNameMap.get(dimName),-1)},SeriesDataSchema2.prototype.getSourceDimension=function(dimIndex){var dimensionsDefine=this.source.dimensionsDefine;if(dimensionsDefine)return dimensionsDefine[dimIndex]},SeriesDataSchema2.prototype.makeStoreSchema=function(){for(var dimCount=this._fullDimCount,willRetrieveDataByName=shouldRetrieveDataByName(this.source),makeHashStrict=!shouldOmitUnusedDimensions(dimCount),dimHash="",dims=[],fullDimIdx=0,seriesDimIdx=0;fullDimIdx<dimCount;fullDimIdx++){var property=void 0,type=void 0,ordinalMeta=void 0,seriesDimDef=this.dimensions[seriesDimIdx];if(seriesDimDef&&seriesDimDef.storeDimIndex===fullDimIdx)property=willRetrieveDataByName?seriesDimDef.name:null,type=seriesDimDef.type,ordinalMeta=seriesDimDef.ordinalMeta,seriesDimIdx++;else{var sourceDimDef=this.getSourceDimension(fullDimIdx);sourceDimDef&&(property=willRetrieveDataByName?sourceDimDef.name:null,type=sourceDimDef.type)}dims.push({property:property,type:type,ordinalMeta:ordinalMeta}),!willRetrieveDataByName||null==property||seriesDimDef&&seriesDimDef.isCalculationCoord||(dimHash+=makeHashStrict?property.replace(/\`/g,"`1").replace(/\$/g,"`2"):property),dimHash+="$",dimHash+=dimTypeShort[type]||"f",ordinalMeta&&(dimHash+=ordinalMeta.uid),dimHash+="$"}var source=this.source;return{dimensions:dims,hash:[source.seriesLayoutBy,source.startIndex,dimHash].join("$$")}},SeriesDataSchema2.prototype.makeOutputDimensionNames=function(){for(var result=[],fullDimIdx=0,seriesDimIdx=0;fullDimIdx<this._fullDimCount;fullDimIdx++){var name_1=void 0,seriesDimDef=this.dimensions[seriesDimIdx];if(seriesDimDef&&seriesDimDef.storeDimIndex===fullDimIdx)seriesDimDef.isCalculationCoord||(name_1=seriesDimDef.name),seriesDimIdx++;else{var sourceDimDef=this.getSourceDimension(fullDimIdx);sourceDimDef&&(name_1=sourceDimDef.name)}result.push(name_1)}return result},SeriesDataSchema2.prototype.appendCalculationDimension=function(dimDef){this.dimensions.push(dimDef),dimDef.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},SeriesDataSchema2}();function isSeriesDataSchema(schema){return schema instanceof SeriesDataSchema}function createDimNameMap(dimsDef){for(var dataDimNameMap=createHashMap(),i=0;i<(dimsDef||[]).length;i++){var dimDefItemRaw=dimsDef[i],userDimName=isObject$3(dimDefItemRaw)?dimDefItemRaw.name:dimDefItemRaw;null!=userDimName&&null==dataDimNameMap.get(userDimName)&&dataDimNameMap.set(userDimName,i)}return dataDimNameMap}function ensureSourceDimNameMap(source){var innerSource=inner$a(source);return innerSource.dimNameMap||(innerSource.dimNameMap=createDimNameMap(source.dimensionsDefine))}function shouldOmitUnusedDimensions(dimCount){return dimCount>30}var prepareInvertedIndex,getId,getIdNameFromStore,normalizeDimensions,transferProperties,cloneListForMapAndSample,makeIdFromName,isObject$1=isObject$3,map=map$1,CtorInt32Array="undefined"==typeof Int32Array?Array:Int32Array,TRANSFERABLE_PROPERTIES=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],CLONE_PROPERTIES=["_approximateExtent"],SeriesData=function(){function SeriesData2(dimensionsInput,hostModel){var dimensions;this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","minmaxDownSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","minmaxDownSample","lttbDownSample"];var assignStoreDimIdx=!1;isSeriesDataSchema(dimensionsInput)?(dimensions=dimensionsInput.dimensions,this._dimOmitted=dimensionsInput.isDimensionOmitted(),this._schema=dimensionsInput):(assignStoreDimIdx=!0,dimensions=dimensionsInput),dimensions=dimensions||["x","y"];for(var dimensionInfos={},dimensionNames=[],invertedIndicesMap={},needsHasOwn=!1,emptyObj={},i=0;i<dimensions.length;i++){var dimInfoInput=dimensions[i],dimensionInfo=isString(dimInfoInput)?new SeriesDimensionDefine({name:dimInfoInput}):dimInfoInput instanceof SeriesDimensionDefine?dimInfoInput:new SeriesDimensionDefine(dimInfoInput),dimensionName=dimensionInfo.name;dimensionInfo.type=dimensionInfo.type||"float",dimensionInfo.coordDim||(dimensionInfo.coordDim=dimensionName,dimensionInfo.coordDimIndex=0);var otherDims=dimensionInfo.otherDims=dimensionInfo.otherDims||{};dimensionNames.push(dimensionName),dimensionInfos[dimensionName]=dimensionInfo,null!=emptyObj[dimensionName]&&(needsHasOwn=!0),dimensionInfo.createInvertedIndices&&(invertedIndicesMap[dimensionName]=[]),0===otherDims.itemName&&(this._nameDimIdx=i),0===otherDims.itemId&&(this._idDimIdx=i),assignStoreDimIdx&&(dimensionInfo.storeDimIndex=i)}if(this.dimensions=dimensionNames,this._dimInfos=dimensionInfos,this._initGetDimensionInfo(needsHasOwn),this.hostModel=hostModel,this._invertedIndicesMap=invertedIndicesMap,this._dimOmitted){var dimIdxToName_1=this._dimIdxToName=createHashMap();each$d(dimensionNames,(function(dimName){dimIdxToName_1.set(dimensionInfos[dimName].storeDimIndex,dimName)}))}}return SeriesData2.prototype.getDimension=function(dim){var dimIdx=this._recognizeDimIndex(dim);if(null==dimIdx)return dim;if(dimIdx=dim,!this._dimOmitted)return this.dimensions[dimIdx];var dimName=this._dimIdxToName.get(dimIdx);if(null!=dimName)return dimName;var sourceDimDef=this._schema.getSourceDimension(dimIdx);return sourceDimDef?sourceDimDef.name:void 0},SeriesData2.prototype.getDimensionIndex=function(dim){var dimIdx=this._recognizeDimIndex(dim);if(null!=dimIdx)return dimIdx;if(null==dim)return-1;var dimInfo=this._getDimInfo(dim);return dimInfo?dimInfo.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(dim):-1},SeriesData2.prototype._recognizeDimIndex=function(dim){if(isNumber(dim)||null!=dim&&!isNaN(dim)&&!this._getDimInfo(dim)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(dim)<0))return+dim},SeriesData2.prototype._getStoreDimIndex=function(dim){return this.getDimensionIndex(dim)},SeriesData2.prototype.getDimensionInfo=function(dim){return this._getDimInfo(this.getDimension(dim))},SeriesData2.prototype._initGetDimensionInfo=function(needsHasOwn){var dimensionInfos=this._dimInfos;this._getDimInfo=needsHasOwn?function(dimName){return dimensionInfos.hasOwnProperty(dimName)?dimensionInfos[dimName]:void 0}:function(dimName){return dimensionInfos[dimName]}},SeriesData2.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},SeriesData2.prototype.mapDimension=function(coordDim,idx){var dimensionsSummary=this._dimSummary;if(null==idx)return dimensionsSummary.encodeFirstDimNotExtra[coordDim];var dims=dimensionsSummary.encode[coordDim];return dims?dims[idx]:null},SeriesData2.prototype.mapDimensionsAll=function(coordDim){return(this._dimSummary.encode[coordDim]||[]).slice()},SeriesData2.prototype.getStore=function(){return this._store},SeriesData2.prototype.initData=function(data,nameList,dimValueGetter){var store,_this=this;if(data instanceof DataStore&&(store=data),!store){var dimensions=this.dimensions,provider=isSourceInstance(data)||isArrayLike(data)?new DefaultDataProvider(data,dimensions.length):data;store=new DataStore;var dimensionInfos=map(dimensions,(function(dimName){return{type:_this._dimInfos[dimName].type,property:dimName}}));store.initData(provider,dimensionInfos,dimValueGetter)}this._store=store,this._nameList=(nameList||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,store.count()),this._dimSummary=function(data,schema){var summary={},encode=summary.encode={},notExtraCoordDimMap=createHashMap(),defaultedLabel=[],defaultedTooltip=[],userOutputEncode={};each$d(data.dimensions,(function(dimName){var dimType,dimItem=data.getDimensionInfo(dimName),coordDim=dimItem.coordDim;if(coordDim){var coordDimIndex=dimItem.coordDimIndex;getOrCreateEncodeArr(encode,coordDim)[coordDimIndex]=dimName,dimItem.isExtraCoord||(notExtraCoordDimMap.set(coordDim,1),"ordinal"!==(dimType=dimItem.type)&&"time"!==dimType&&(defaultedLabel[0]=dimName),getOrCreateEncodeArr(userOutputEncode,coordDim)[coordDimIndex]=data.getDimensionIndex(dimItem.name)),dimItem.defaultTooltip&&defaultedTooltip.push(dimName)}VISUAL_DIMENSIONS.each((function(v,otherDim){var encodeArr=getOrCreateEncodeArr(encode,otherDim),dimIndex=dimItem.otherDims[otherDim];null!=dimIndex&&!1!==dimIndex&&(encodeArr[dimIndex]=dimItem.name)}))}));var dataDimsOnCoord=[],encodeFirstDimNotExtra={};notExtraCoordDimMap.each((function(v,coordDim){var dimArr=encode[coordDim];encodeFirstDimNotExtra[coordDim]=dimArr[0],dataDimsOnCoord=dataDimsOnCoord.concat(dimArr)})),summary.dataDimsOnCoord=dataDimsOnCoord,summary.dataDimIndicesOnCoord=map$1(dataDimsOnCoord,(function(dimName){return data.getDimensionInfo(dimName).storeDimIndex})),summary.encodeFirstDimNotExtra=encodeFirstDimNotExtra;var encodeLabel=encode.label;encodeLabel&&encodeLabel.length&&(defaultedLabel=encodeLabel.slice());var encodeTooltip=encode.tooltip;return encodeTooltip&&encodeTooltip.length?defaultedTooltip=encodeTooltip.slice():defaultedTooltip.length||(defaultedTooltip=defaultedLabel.slice()),encode.defaultedLabel=defaultedLabel,encode.defaultedTooltip=defaultedTooltip,summary.userOutput=new DimensionUserOuput(userOutputEncode,schema),summary}(this,this._schema),this.userOutput=this._dimSummary.userOutput},SeriesData2.prototype.appendData=function(data){var range=this._store.appendData(data);this._doInit(range[0],range[1])},SeriesData2.prototype.appendValues=function(values,names){var _a2=this._store.appendValues(values,names&&names.length),start2=_a2.start,end2=_a2.end,shouldMakeIdFromName=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),names)for(var idx=start2;idx<end2;idx++){var sourceIdx=idx-start2;this._nameList[idx]=names[sourceIdx],shouldMakeIdFromName&&makeIdFromName(this,idx)}},SeriesData2.prototype._updateOrdinalMeta=function(){for(var store=this._store,dimensions=this.dimensions,i=0;i<dimensions.length;i++){var dimInfo=this._dimInfos[dimensions[i]];dimInfo.ordinalMeta&&store.collectOrdinalMeta(dimInfo.storeDimIndex,dimInfo.ordinalMeta)}},SeriesData2.prototype._shouldMakeIdFromName=function(){var provider=this._store.getProvider();return null==this._idDimIdx&&"typedArray"!==provider.getSource().sourceFormat&&!provider.fillStorage},SeriesData2.prototype._doInit=function(start2,end2){if(!(start2>=end2)){var provider=this._store.getProvider();this._updateOrdinalMeta();var nameList=this._nameList,idList=this._idList;if("original"===provider.getSource().sourceFormat&&!provider.pure)for(var sharedDataItem=[],idx=start2;idx<end2;idx++){var dataItem=provider.getItem(idx,sharedDataItem);if(!this.hasItemOption&&isDataItemOption(dataItem)&&(this.hasItemOption=!0),dataItem){var itemName=dataItem.name;null==nameList[idx]&&null!=itemName&&(nameList[idx]=convertOptionIdName(itemName,null));var itemId=dataItem.id;null==idList[idx]&&null!=itemId&&(idList[idx]=convertOptionIdName(itemId,null))}}if(this._shouldMakeIdFromName())for(idx=start2;idx<end2;idx++)makeIdFromName(this,idx);prepareInvertedIndex(this)}},SeriesData2.prototype.getApproximateExtent=function(dim){return this._approximateExtent[dim]||this._store.getDataExtent(this._getStoreDimIndex(dim))},SeriesData2.prototype.setApproximateExtent=function(extent3,dim){dim=this.getDimension(dim),this._approximateExtent[dim]=extent3.slice()},SeriesData2.prototype.getCalculationInfo=function(key){return this._calculationInfo[key]},SeriesData2.prototype.setCalculationInfo=function(key,value){isObject$1(key)?extend(this._calculationInfo,key):this._calculationInfo[key]=value},SeriesData2.prototype.getName=function(idx){var rawIndex=this.getRawIndex(idx),name=this._nameList[rawIndex];return null==name&&null!=this._nameDimIdx&&(name=getIdNameFromStore(this,this._nameDimIdx,rawIndex)),null==name&&(name=""),name},SeriesData2.prototype._getCategory=function(dimIdx,idx){var ordinal=this._store.get(dimIdx,idx),ordinalMeta=this._store.getOrdinalMeta(dimIdx);return ordinalMeta?ordinalMeta.categories[ordinal]:ordinal},SeriesData2.prototype.getId=function(idx){return getId(this,this.getRawIndex(idx))},SeriesData2.prototype.count=function(){return this._store.count()},SeriesData2.prototype.get=function(dim,idx){var store=this._store,dimInfo=this._dimInfos[dim];if(dimInfo)return store.get(dimInfo.storeDimIndex,idx)},SeriesData2.prototype.getByRawIndex=function(dim,rawIdx){var store=this._store,dimInfo=this._dimInfos[dim];if(dimInfo)return store.getByRawIndex(dimInfo.storeDimIndex,rawIdx)},SeriesData2.prototype.getIndices=function(){return this._store.getIndices()},SeriesData2.prototype.getDataExtent=function(dim){return this._store.getDataExtent(this._getStoreDimIndex(dim))},SeriesData2.prototype.getSum=function(dim){return this._store.getSum(this._getStoreDimIndex(dim))},SeriesData2.prototype.getMedian=function(dim){return this._store.getMedian(this._getStoreDimIndex(dim))},SeriesData2.prototype.getValues=function(dimensions,idx){var _this=this,store=this._store;return isArray$1(dimensions)?store.getValues(map(dimensions,(function(dim){return _this._getStoreDimIndex(dim)})),idx):store.getValues(dimensions)},SeriesData2.prototype.hasValue=function(idx){for(var dataDimIndicesOnCoord=this._dimSummary.dataDimIndicesOnCoord,i=0,len2=dataDimIndicesOnCoord.length;i<len2;i++)if(isNaN(this._store.get(dataDimIndicesOnCoord[i],idx)))return!1;return!0},SeriesData2.prototype.indexOfName=function(name){for(var i=0,len2=this._store.count();i<len2;i++)if(this.getName(i)===name)return i;return-1},SeriesData2.prototype.getRawIndex=function(idx){return this._store.getRawIndex(idx)},SeriesData2.prototype.indexOfRawIndex=function(rawIndex){return this._store.indexOfRawIndex(rawIndex)},SeriesData2.prototype.rawIndexOf=function(dim,value){var invertedIndices=dim&&this._invertedIndicesMap[dim],rawIndex=invertedIndices&&invertedIndices[value];return null==rawIndex||isNaN(rawIndex)?-1:rawIndex},SeriesData2.prototype.indicesOfNearest=function(dim,value,maxDistance){return this._store.indicesOfNearest(this._getStoreDimIndex(dim),value,maxDistance)},SeriesData2.prototype.each=function(dims,cb,ctx){isFunction(dims)&&(ctx=cb,cb=dims,dims=[]);var fCtx=ctx||this,dimIndices=map(normalizeDimensions(dims),this._getStoreDimIndex,this);this._store.each(dimIndices,fCtx?bind$1(cb,fCtx):cb)},SeriesData2.prototype.filterSelf=function(dims,cb,ctx){isFunction(dims)&&(ctx=cb,cb=dims,dims=[]);var fCtx=ctx||this,dimIndices=map(normalizeDimensions(dims),this._getStoreDimIndex,this);return this._store=this._store.filter(dimIndices,fCtx?bind$1(cb,fCtx):cb),this},SeriesData2.prototype.selectRange=function(range){var _this=this,innerRange={};return each$d(keys(range),(function(dim){var dimIdx=_this._getStoreDimIndex(dim);innerRange[dimIdx]=range[dim]})),this._store=this._store.selectRange(innerRange),this},SeriesData2.prototype.mapArray=function(dims,cb,ctx){isFunction(dims)&&(ctx=cb,cb=dims,dims=[]),ctx=ctx||this;var result=[];return this.each(dims,(function(){result.push(cb&&cb.apply(this,arguments))}),ctx),result},SeriesData2.prototype.map=function(dims,cb,ctx,ctxCompat){var fCtx=ctx||ctxCompat||this,dimIndices=map(normalizeDimensions(dims),this._getStoreDimIndex,this),list=cloneListForMapAndSample(this);return list._store=this._store.map(dimIndices,fCtx?bind$1(cb,fCtx):cb),list},SeriesData2.prototype.modify=function(dims,cb,ctx,ctxCompat){var fCtx=ctx||ctxCompat||this,dimIndices=map(normalizeDimensions(dims),this._getStoreDimIndex,this);this._store.modify(dimIndices,fCtx?bind$1(cb,fCtx):cb)},SeriesData2.prototype.downSample=function(dimension,rate,sampleValue,sampleIndex){var list=cloneListForMapAndSample(this);return list._store=this._store.downSample(this._getStoreDimIndex(dimension),rate,sampleValue,sampleIndex),list},SeriesData2.prototype.minmaxDownSample=function(valueDimension,rate){var list=cloneListForMapAndSample(this);return list._store=this._store.minmaxDownSample(this._getStoreDimIndex(valueDimension),rate),list},SeriesData2.prototype.lttbDownSample=function(valueDimension,rate){var list=cloneListForMapAndSample(this);return list._store=this._store.lttbDownSample(this._getStoreDimIndex(valueDimension),rate),list},SeriesData2.prototype.getRawDataItem=function(idx){return this._store.getRawDataItem(idx)},SeriesData2.prototype.getItemModel=function(idx){var hostModel=this.hostModel,dataItem=this.getRawDataItem(idx);return new Model(dataItem,hostModel,hostModel&&hostModel.ecModel)},SeriesData2.prototype.diff=function(otherList){var thisList=this;return new DataDiffer(otherList?otherList.getStore().getIndices():[],this.getStore().getIndices(),(function(idx){return getId(otherList,idx)}),(function(idx){return getId(thisList,idx)}))},SeriesData2.prototype.getVisual=function(key){var visual=this._visual;return visual&&visual[key]},SeriesData2.prototype.setVisual=function(kvObj,val){this._visual=this._visual||{},isObject$1(kvObj)?extend(this._visual,kvObj):this._visual[kvObj]=val},SeriesData2.prototype.getItemVisual=function(idx,key){var itemVisual=this._itemVisuals[idx],val=itemVisual&&itemVisual[key];return null==val?this.getVisual(key):val},SeriesData2.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},SeriesData2.prototype.ensureUniqueItemVisual=function(idx,key){var itemVisuals=this._itemVisuals,itemVisual=itemVisuals[idx];itemVisual||(itemVisual=itemVisuals[idx]={});var val=itemVisual[key];return null==val&&(isArray$1(val=this.getVisual(key))?val=val.slice():isObject$1(val)&&(val=extend({},val)),itemVisual[key]=val),val},SeriesData2.prototype.setItemVisual=function(idx,key,value){var itemVisual=this._itemVisuals[idx]||{};this._itemVisuals[idx]=itemVisual,isObject$1(key)?extend(itemVisual,key):itemVisual[key]=value},SeriesData2.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},SeriesData2.prototype.setLayout=function(key,val){isObject$1(key)?extend(this._layout,key):this._layout[key]=val},SeriesData2.prototype.getLayout=function(key){return this._layout[key]},SeriesData2.prototype.getItemLayout=function(idx){return this._itemLayouts[idx]},SeriesData2.prototype.setItemLayout=function(idx,layout2,merge2){this._itemLayouts[idx]=merge2?extend(this._itemLayouts[idx]||{},layout2):layout2},SeriesData2.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},SeriesData2.prototype.setItemGraphicEl=function(idx,el){!function(seriesIndex,dataType,dataIdx,el){if(el){var ecData=getECData(el);ecData.dataIndex=dataIdx,ecData.dataType=dataType,ecData.seriesIndex=seriesIndex,ecData.ssrType="chart","group"===el.type&&el.traverse((function(child){var childECData=getECData(child);childECData.seriesIndex=seriesIndex,childECData.dataIndex=dataIdx,childECData.dataType=dataType,childECData.ssrType="chart"}))}}(this.hostModel&&this.hostModel.seriesIndex,this.dataType,idx,el),this._graphicEls[idx]=el},SeriesData2.prototype.getItemGraphicEl=function(idx){return this._graphicEls[idx]},SeriesData2.prototype.eachItemGraphicEl=function(cb,context){each$d(this._graphicEls,(function(el,idx){el&&cb&&cb.call(context,el,idx)}))},SeriesData2.prototype.cloneShallow=function(list){return list||(list=new SeriesData2(this._schema?this._schema:map(this.dimensions,this._getDimInfo,this),this.hostModel)),transferProperties(list,this),list._store=this._store,list},SeriesData2.prototype.wrapMethod=function(methodName,injectFunction){var originalMethod=this[methodName];isFunction(originalMethod)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(methodName),this[methodName]=function(){var res=originalMethod.apply(this,arguments);return injectFunction.apply(this,[res].concat(slice(arguments)))})},SeriesData2.internalField=(prepareInvertedIndex=function(data){var invertedIndicesMap=data._invertedIndicesMap;each$d(invertedIndicesMap,(function(invertedIndices,dim){var dimInfo=data._dimInfos[dim],ordinalMeta=dimInfo.ordinalMeta,store=data._store;if(ordinalMeta){invertedIndices=invertedIndicesMap[dim]=new CtorInt32Array(ordinalMeta.categories.length);for(var i=0;i<invertedIndices.length;i++)invertedIndices[i]=-1;for(i=0;i<store.count();i++)invertedIndices[store.get(dimInfo.storeDimIndex,i)]=i}}))},getIdNameFromStore=function(data,dimIdx,idx){return convertOptionIdName(data._getCategory(dimIdx,idx),null)},getId=function(data,rawIndex){var id=data._idList[rawIndex];return null==id&&null!=data._idDimIdx&&(id=getIdNameFromStore(data,data._idDimIdx,rawIndex)),null==id&&(id="e\0\0"+rawIndex),id},normalizeDimensions=function(dimensions){return isArray$1(dimensions)||(dimensions=null!=dimensions?[dimensions]:[]),dimensions},cloneListForMapAndSample=function(original){var list=new SeriesData2(original._schema?original._schema:map(original.dimensions,original._getDimInfo,original),original.hostModel);return transferProperties(list,original),list},transferProperties=function(target,source){each$d(TRANSFERABLE_PROPERTIES.concat(source.__wrappedMethods||[]),(function(propName){source.hasOwnProperty(propName)&&(target[propName]=source[propName])})),target.__wrappedMethods=source.__wrappedMethods,each$d(CLONE_PROPERTIES,(function(propName){target[propName]=clone$3(source[propName])})),target._calculationInfo=extend({},source._calculationInfo)},void(makeIdFromName=function(data,idx){var nameList=data._nameList,idList=data._idList,nameDimIdx=data._nameDimIdx,idDimIdx=data._idDimIdx,name=nameList[idx],id=idList[idx];if(null==name&&null!=nameDimIdx&&(nameList[idx]=name=getIdNameFromStore(data,nameDimIdx,idx)),null==id&&null!=idDimIdx&&(idList[idx]=id=getIdNameFromStore(data,idDimIdx,idx)),null==id&&null!=name){var nameRepeatCount=data._nameRepeatCount,nmCnt=nameRepeatCount[name]=(nameRepeatCount[name]||0)+1;id=name,nmCnt>1&&(id+="__ec__"+nmCnt),idList[idx]=id}})),SeriesData2}();function prepareSeriesDataSchema(source,opt){isSourceInstance(source)||(source=createSourceFromSeriesDataOption(source));var sysDims=(opt=opt||{}).coordDimensions||[],dimsDef=opt.dimensionsDefine||source.dimensionsDefine||[],coordDimNameMap=createHashMap(),resultList=[],dimCount=function(source,sysDims,dimsDef,optDimCount){var dimCount=Math.max(source.dimensionsDetectedCount||1,sysDims.length,dimsDef.length,optDimCount||0);return each$d(sysDims,(function(sysDimItem){var sysDimItemDimsDef;isObject$3(sysDimItem)&&(sysDimItemDimsDef=sysDimItem.dimsDef)&&(dimCount=Math.max(dimCount,sysDimItemDimsDef.length))})),dimCount}(source,sysDims,dimsDef,opt.dimensionsCount),omitUnusedDimensions=opt.canOmitUnusedDimensions&&shouldOmitUnusedDimensions(dimCount),isUsingSourceDimensionsDef=dimsDef===source.dimensionsDefine,dataDimNameMap=isUsingSourceDimensionsDef?ensureSourceDimNameMap(source):createDimNameMap(dimsDef),encodeDef=opt.encodeDefine;!encodeDef&&opt.encodeDefaulter&&(encodeDef=opt.encodeDefaulter(source,dimCount));for(var encodeDefMap=createHashMap(encodeDef),indicesMap=new CtorInt32Array$1(dimCount),i=0;i<indicesMap.length;i++)indicesMap[i]=-1;function getResultItem(dimIdx){var idx=indicesMap[dimIdx];if(idx<0){var dimDefItemRaw=dimsDef[dimIdx],dimDefItem=isObject$3(dimDefItemRaw)?dimDefItemRaw:{name:dimDefItemRaw},resultItem2=new SeriesDimensionDefine,userDimName=dimDefItem.name;null!=userDimName&&null!=dataDimNameMap.get(userDimName)&&(resultItem2.name=resultItem2.displayName=userDimName),null!=dimDefItem.type&&(resultItem2.type=dimDefItem.type),null!=dimDefItem.displayName&&(resultItem2.displayName=dimDefItem.displayName);var newIdx=resultList.length;return indicesMap[dimIdx]=newIdx,resultItem2.storeDimIndex=dimIdx,resultList.push(resultItem2),resultItem2}return resultList[idx]}if(!omitUnusedDimensions)for(i=0;i<dimCount;i++)getResultItem(i);encodeDefMap.each((function(dataDimsRaw,coordDim2){var dataDims=normalizeToArray(dataDimsRaw).slice();if(1===dataDims.length&&!isString(dataDims[0])&&dataDims[0]<0)encodeDefMap.set(coordDim2,!1);else{var validDataDims=encodeDefMap.set(coordDim2,[]);each$d(dataDims,(function(resultDimIdxOrName,idx){var resultDimIdx2=isString(resultDimIdxOrName)?dataDimNameMap.get(resultDimIdxOrName):resultDimIdxOrName;null!=resultDimIdx2&&resultDimIdx2<dimCount&&(validDataDims[idx]=resultDimIdx2,applyDim(getResultItem(resultDimIdx2),coordDim2,idx))}))}}));var availDimIdx=0;function applyDim(resultItem2,coordDim2,coordDimIndex){null!=VISUAL_DIMENSIONS.get(coordDim2)?resultItem2.otherDims[coordDim2]=coordDimIndex:(resultItem2.coordDim=coordDim2,resultItem2.coordDimIndex=coordDimIndex,coordDimNameMap.set(coordDim2,!0))}each$d(sysDims,(function(sysDimItemRaw){var coordDim2,sysDimItemDimsDef,sysDimItemOtherDims,sysDimItem;if(isString(sysDimItemRaw))coordDim2=sysDimItemRaw,sysDimItem={};else{coordDim2=(sysDimItem=sysDimItemRaw).name;var ordinalMeta=sysDimItem.ordinalMeta;sysDimItem.ordinalMeta=null,(sysDimItem=extend({},sysDimItem)).ordinalMeta=ordinalMeta,sysDimItemDimsDef=sysDimItem.dimsDef,sysDimItemOtherDims=sysDimItem.otherDims,sysDimItem.name=sysDimItem.coordDim=sysDimItem.coordDimIndex=sysDimItem.dimsDef=sysDimItem.otherDims=null}var dataDims=encodeDefMap.get(coordDim2);if(!1!==dataDims){if(!(dataDims=normalizeToArray(dataDims)).length)for(var i2=0;i2<(sysDimItemDimsDef&&sysDimItemDimsDef.length||1);i2++){for(;availDimIdx<dimCount&&null!=getResultItem(availDimIdx).coordDim;)availDimIdx++;availDimIdx<dimCount&&dataDims.push(availDimIdx++)}each$d(dataDims,(function(resultDimIdx2,coordDimIndex){var resultItem2=getResultItem(resultDimIdx2);if(isUsingSourceDimensionsDef&&null!=sysDimItem.type&&(resultItem2.type=sysDimItem.type),applyDim(defaults(resultItem2,sysDimItem),coordDim2,coordDimIndex),null==resultItem2.name&&sysDimItemDimsDef){var sysDimItemDimsDefItem=sysDimItemDimsDef[coordDimIndex];!isObject$3(sysDimItemDimsDefItem)&&(sysDimItemDimsDefItem={name:sysDimItemDimsDefItem}),resultItem2.name=resultItem2.displayName=sysDimItemDimsDefItem.name,resultItem2.defaultTooltip=sysDimItemDimsDefItem.defaultTooltip}sysDimItemOtherDims&&defaults(resultItem2.otherDims,sysDimItemOtherDims)}))}}));var generateCoord=opt.generateCoord,generateCoordCount=opt.generateCoordCount,fromZero=null!=generateCoordCount;generateCoordCount=generateCoord?generateCoordCount||1:0;var extra=generateCoord||"value";function ifNoNameFillWithCoordName(resultItem2){null==resultItem2.name&&(resultItem2.name=resultItem2.coordDim)}if(omitUnusedDimensions)each$d(resultList,(function(resultItem2){ifNoNameFillWithCoordName(resultItem2)})),resultList.sort((function(item0,item1){return item0.storeDimIndex-item1.storeDimIndex}));else for(var resultDimIdx=0;resultDimIdx<dimCount;resultDimIdx++){var resultItem=getResultItem(resultDimIdx);null==resultItem.coordDim&&(resultItem.coordDim=genCoordDimName(extra,coordDimNameMap,fromZero),resultItem.coordDimIndex=0,(!generateCoord||generateCoordCount<=0)&&(resultItem.isExtraCoord=!0),generateCoordCount--),ifNoNameFillWithCoordName(resultItem),null!=resultItem.type||guessOrdinal(source,resultDimIdx)!==BE_ORDINAL_Must&&(!resultItem.isExtraCoord||null==resultItem.otherDims.itemName&&null==resultItem.otherDims.seriesName)||(resultItem.type="ordinal")}return function(result){for(var duplicationMap=createHashMap(),i=0;i<result.length;i++){var dim=result[i],dimOriginalName=dim.name,count2=duplicationMap.get(dimOriginalName)||0;count2>0&&(dim.name=dimOriginalName+(count2-1)),count2++,duplicationMap.set(dimOriginalName,count2)}}(resultList),new SeriesDataSchema({source:source,dimensions:resultList,fullDimensionCount:dimCount,dimensionOmitted:omitUnusedDimensions})}function genCoordDimName(name,map2,fromZero){if(fromZero||map2.hasKey(name)){for(var i=0;map2.hasKey(name+i);)i++;name+=i}return map2.set(name,!0),name}var CoordSysInfo=function(){return function(coordSysName){this.coordSysDims=[],this.axisMap=createHashMap(),this.categoryAxisMap=createHashMap(),this.coordSysName=coordSysName}}();var fetchers={cartesian2d:function(seriesModel,result,axisMap,categoryAxisMap){var xAxisModel=seriesModel.getReferringComponents("xAxis",SINGLE_REFERRING).models[0],yAxisModel=seriesModel.getReferringComponents("yAxis",SINGLE_REFERRING).models[0];result.coordSysDims=["x","y"],axisMap.set("x",xAxisModel),axisMap.set("y",yAxisModel),isCategory(xAxisModel)&&(categoryAxisMap.set("x",xAxisModel),result.firstCategoryDimIndex=0),isCategory(yAxisModel)&&(categoryAxisMap.set("y",yAxisModel),null==result.firstCategoryDimIndex&&(result.firstCategoryDimIndex=1))},singleAxis:function(seriesModel,result,axisMap,categoryAxisMap){var singleAxisModel=seriesModel.getReferringComponents("singleAxis",SINGLE_REFERRING).models[0];result.coordSysDims=["single"],axisMap.set("single",singleAxisModel),isCategory(singleAxisModel)&&(categoryAxisMap.set("single",singleAxisModel),result.firstCategoryDimIndex=0)},polar:function(seriesModel,result,axisMap,categoryAxisMap){var polarModel=seriesModel.getReferringComponents("polar",SINGLE_REFERRING).models[0],radiusAxisModel=polarModel.findAxisModel("radiusAxis"),angleAxisModel=polarModel.findAxisModel("angleAxis");result.coordSysDims=["radius","angle"],axisMap.set("radius",radiusAxisModel),axisMap.set("angle",angleAxisModel),isCategory(radiusAxisModel)&&(categoryAxisMap.set("radius",radiusAxisModel),result.firstCategoryDimIndex=0),isCategory(angleAxisModel)&&(categoryAxisMap.set("angle",angleAxisModel),null==result.firstCategoryDimIndex&&(result.firstCategoryDimIndex=1))},geo:function(seriesModel,result,axisMap,categoryAxisMap){result.coordSysDims=["lng","lat"]},parallel:function(seriesModel,result,axisMap,categoryAxisMap){var ecModel=seriesModel.ecModel,parallelModel=ecModel.getComponent("parallel",seriesModel.get("parallelIndex")),coordSysDims=result.coordSysDims=parallelModel.dimensions.slice();each$d(parallelModel.parallelAxisIndex,(function(axisIndex,index){var axisModel=ecModel.getComponent("parallelAxis",axisIndex),axisDim=coordSysDims[index];axisMap.set(axisDim,axisModel),isCategory(axisModel)&&(categoryAxisMap.set(axisDim,axisModel),null==result.firstCategoryDimIndex&&(result.firstCategoryDimIndex=index))}))}};function isCategory(axisModel){return"category"===axisModel.get("type")}function enableDataStack(seriesModel,dimensionsInput,opt){var dimensionDefineList,schema,store,byIndex=(opt=opt||{}).byIndex,stackedCoordDimension=opt.stackedCoordDimension;!function(dimensionsInput){return!isSeriesDataSchema(dimensionsInput.schema)}(dimensionsInput)?(schema=dimensionsInput.schema,dimensionDefineList=schema.dimensions,store=dimensionsInput.store):dimensionDefineList=dimensionsInput;var stackedByDimInfo,stackedDimInfo,stackResultDimension,stackedOverDimension,mayStack=!(!seriesModel||!seriesModel.get("stack"));if(each$d(dimensionDefineList,(function(dimensionInfo,index){isString(dimensionInfo)&&(dimensionDefineList[index]=dimensionInfo={name:dimensionInfo}),mayStack&&!dimensionInfo.isExtraCoord&&(byIndex||stackedByDimInfo||!dimensionInfo.ordinalMeta||(stackedByDimInfo=dimensionInfo),stackedDimInfo||"ordinal"===dimensionInfo.type||"time"===dimensionInfo.type||stackedCoordDimension&&stackedCoordDimension!==dimensionInfo.coordDim||(stackedDimInfo=dimensionInfo))})),!stackedDimInfo||byIndex||stackedByDimInfo||(byIndex=!0),stackedDimInfo){stackResultDimension="__\0ecstackresult_"+seriesModel.id,stackedOverDimension="__\0ecstackedover_"+seriesModel.id,stackedByDimInfo&&(stackedByDimInfo.createInvertedIndices=!0);var stackedDimCoordDim_1=stackedDimInfo.coordDim,stackedDimType=stackedDimInfo.type,stackedDimCoordIndex_1=0;each$d(dimensionDefineList,(function(dimensionInfo){dimensionInfo.coordDim===stackedDimCoordDim_1&&stackedDimCoordIndex_1++}));var stackedOverDimensionDefine={name:stackResultDimension,coordDim:stackedDimCoordDim_1,coordDimIndex:stackedDimCoordIndex_1,type:stackedDimType,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:dimensionDefineList.length},stackResultDimensionDefine={name:stackedOverDimension,coordDim:stackedOverDimension,coordDimIndex:stackedDimCoordIndex_1+1,type:stackedDimType,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:dimensionDefineList.length+1};schema?(store&&(stackedOverDimensionDefine.storeDimIndex=store.ensureCalculationDimension(stackedOverDimension,stackedDimType),stackResultDimensionDefine.storeDimIndex=store.ensureCalculationDimension(stackResultDimension,stackedDimType)),schema.appendCalculationDimension(stackedOverDimensionDefine),schema.appendCalculationDimension(stackResultDimensionDefine)):(dimensionDefineList.push(stackedOverDimensionDefine),dimensionDefineList.push(stackResultDimensionDefine))}return{stackedDimension:stackedDimInfo&&stackedDimInfo.name,stackedByDimension:stackedByDimInfo&&stackedByDimInfo.name,isStackedByIndex:byIndex,stackedOverDimension:stackedOverDimension,stackResultDimension:stackResultDimension}}function isDimensionStacked(data,stackedDim){return!!stackedDim&&stackedDim===data.getCalculationInfo("stackedDimension")}function getStackedDimension(data,targetDim){return isDimensionStacked(data,targetDim)?data.getCalculationInfo("stackResultDimension"):targetDim}function createSeriesData(sourceRaw,seriesModel,opt){opt=opt||{};var source,isOriginalSource,sourceManager=seriesModel.getSourceManager();isOriginalSource="original"===(source=sourceManager.getSource()).sourceFormat;var coordSysInfo=function(seriesModel){var coordSysName=seriesModel.get("coordinateSystem"),result=new CoordSysInfo(coordSysName),fetch=fetchers[coordSysName];if(fetch)return fetch(seriesModel,result,result.axisMap,result.categoryAxisMap),result}(seriesModel),coordSysDimDefs=function(seriesModel,coordSysInfo){var coordSysDimDefs,coordSysName=seriesModel.get("coordinateSystem"),registeredCoordSys=CoordinateSystemManager.get(coordSysName);return coordSysInfo&&coordSysInfo.coordSysDims&&(coordSysDimDefs=map$1(coordSysInfo.coordSysDims,(function(dim){var dimInfo={name:dim},axisModel=coordSysInfo.axisMap.get(dim);if(axisModel){var axisType=axisModel.get("type");dimInfo.type=function(axisType){return"category"===axisType?"ordinal":"time"===axisType?"time":"float"}(axisType)}return dimInfo}))),coordSysDimDefs||(coordSysDimDefs=registeredCoordSys&&(registeredCoordSys.getDimensionsInfo?registeredCoordSys.getDimensionsInfo():registeredCoordSys.dimensions.slice())||["x","y"]),coordSysDimDefs}(seriesModel,coordSysInfo),useEncodeDefaulter=opt.useEncodeDefaulter,encodeDefaulter=isFunction(useEncodeDefaulter)?useEncodeDefaulter:useEncodeDefaulter?curry$1(makeSeriesEncodeForAxisCoordSys,coordSysDimDefs,seriesModel):null,schema=prepareSeriesDataSchema(source,{coordDimensions:coordSysDimDefs,generateCoord:opt.generateCoord,encodeDefine:seriesModel.getEncode(),encodeDefaulter:encodeDefaulter,canOmitUnusedDimensions:!isOriginalSource}),firstCategoryDimIndex=function(dimInfoList,createInvertedIndices,coordSysInfo){var firstCategoryDimIndex,hasNameEncode;return coordSysInfo&&each$d(dimInfoList,(function(dimInfo,dimIndex){var coordDim=dimInfo.coordDim,categoryAxisModel=coordSysInfo.categoryAxisMap.get(coordDim);categoryAxisModel&&(null==firstCategoryDimIndex&&(firstCategoryDimIndex=dimIndex),dimInfo.ordinalMeta=categoryAxisModel.getOrdinalMeta(),createInvertedIndices&&(dimInfo.createInvertedIndices=!0)),null!=dimInfo.otherDims.itemName&&(hasNameEncode=!0)})),hasNameEncode||null==firstCategoryDimIndex||(dimInfoList[firstCategoryDimIndex].otherDims.itemName=0),firstCategoryDimIndex}(schema.dimensions,opt.createInvertedIndices,coordSysInfo),store=isOriginalSource?null:sourceManager.getSharedDataStore(schema),stackCalculationInfo=enableDataStack(seriesModel,{schema:schema,store:store}),data=new SeriesData(schema,seriesModel);data.setCalculationInfo(stackCalculationInfo);var dimValueGetter=null!=firstCategoryDimIndex&&function(source){if("original"===source.sourceFormat){var sampleItem=function(arr){var i=0;for(;i<arr.length&&null==arr[i];)i++;return arr[i]}(source.data||[]);return!isArray$1(getDataItemValue(sampleItem))}}(source)?function(itemOpt,dimName,dataIndex,dimIndex){return dimIndex===firstCategoryDimIndex?dataIndex:this.defaultDimValueGetter(itemOpt,dimName,dataIndex,dimIndex)}:null;return data.hasItemOption=!1,data.initData(isOriginalSource?source:store,null,dimValueGetter),data}var Scale=function(){function Scale2(setting){this._setting=setting||{},this._extent=[Infinity,-Infinity]}return Scale2.prototype.getSetting=function(name){return this._setting[name]},Scale2.prototype.unionExtent=function(other){var extent3=this._extent;other[0]<extent3[0]&&(extent3[0]=other[0]),other[1]>extent3[1]&&(extent3[1]=other[1])},Scale2.prototype.unionExtentFromData=function(data,dim){this.unionExtent(data.getApproximateExtent(dim))},Scale2.prototype.getExtent=function(){return this._extent.slice()},Scale2.prototype.setExtent=function(start2,end2){var thisExtent=this._extent;isNaN(start2)||(thisExtent[0]=start2),isNaN(end2)||(thisExtent[1]=end2)},Scale2.prototype.isInExtentRange=function(value){return this._extent[0]<=value&&this._extent[1]>=value},Scale2.prototype.isBlank=function(){return this._isBlank},Scale2.prototype.setBlank=function(isBlank){this._isBlank=isBlank},Scale2}();enableClassManagement(Scale);var uidBase=0,OrdinalMeta=function(){function OrdinalMeta2(opt){this.categories=opt.categories||[],this._needCollect=opt.needCollect,this._deduplication=opt.deduplication,this.uid=++uidBase}return OrdinalMeta2.createByAxisModel=function(axisModel){var option=axisModel.option,data=option.data,categories=data&&map$1(data,getName);return new OrdinalMeta2({categories:categories,needCollect:!categories,deduplication:!1!==option.dedplication})},OrdinalMeta2.prototype.getOrdinal=function(category){return this._getOrCreateMap().get(category)},OrdinalMeta2.prototype.parseAndCollect=function(category){var index,needCollect=this._needCollect;if(!isString(category)&&!needCollect)return category;if(needCollect&&!this._deduplication)return index=this.categories.length,this.categories[index]=category,index;var map2=this._getOrCreateMap();return null==(index=map2.get(category))&&(needCollect?(index=this.categories.length,this.categories[index]=category,map2.set(category,index)):index=NaN),index},OrdinalMeta2.prototype._getOrCreateMap=function(){return this._map||(this._map=createHashMap(this.categories))},OrdinalMeta2}();function getName(obj){return isObject$3(obj)&&null!=obj.value?obj.value:obj+""}function isIntervalOrLogScale(scale2){return"interval"===scale2.type||"log"===scale2.type}function intervalScaleNiceTicks(extent3,splitNumber,minInterval,maxInterval){var result={},span=extent3[1]-extent3[0],interval=result.interval=nice(span/splitNumber,!0);null!=minInterval&&interval<minInterval&&(interval=result.interval=minInterval),null!=maxInterval&&interval>maxInterval&&(interval=result.interval=maxInterval);var precision=result.intervalPrecision=getIntervalPrecision(interval);return function(niceTickExtent,extent3){!isFinite(niceTickExtent[0])&&(niceTickExtent[0]=extent3[0]),!isFinite(niceTickExtent[1])&&(niceTickExtent[1]=extent3[1]),clamp(niceTickExtent,0,extent3),clamp(niceTickExtent,1,extent3),niceTickExtent[0]>niceTickExtent[1]&&(niceTickExtent[0]=niceTickExtent[1])}(result.niceTickExtent=[round$3(Math.ceil(extent3[0]/interval)*interval,precision),round$3(Math.floor(extent3[1]/interval)*interval,precision)],extent3),result}function increaseInterval(interval){var exp10=Math.pow(10,quantityExponent(interval)),f=interval/exp10;return f?2===f?f=3:3===f?f=5:f*=2:f=1,round$3(f*exp10)}function getIntervalPrecision(interval){return getPrecision(interval)+2}function clamp(niceTickExtent,idx,extent3){niceTickExtent[idx]=Math.max(Math.min(niceTickExtent[idx],extent3[1]),extent3[0])}function contain$1(val,extent3){return val>=extent3[0]&&val<=extent3[1]}function normalize(val,extent3){return extent3[1]===extent3[0]?.5:(val-extent3[0])/(extent3[1]-extent3[0])}function scale(val,extent3){return val*(extent3[1]-extent3[0])+extent3[0]}var OrdinalScale=function(_super){function OrdinalScale2(setting){var _this=_super.call(this,setting)||this;_this.type="ordinal";var ordinalMeta=_this.getSetting("ordinalMeta");return ordinalMeta||(ordinalMeta=new OrdinalMeta({})),isArray$1(ordinalMeta)&&(ordinalMeta=new OrdinalMeta({categories:map$1(ordinalMeta,(function(item){return isObject$3(item)?item.value:item}))})),_this._ordinalMeta=ordinalMeta,_this._extent=_this.getSetting("extent")||[0,ordinalMeta.categories.length-1],_this}return __extends(OrdinalScale2,_super),OrdinalScale2.prototype.parse=function(val){return null==val?NaN:isString(val)?this._ordinalMeta.getOrdinal(val):Math.round(val)},OrdinalScale2.prototype.contain=function(rank){return contain$1(rank=this.parse(rank),this._extent)&&null!=this._ordinalMeta.categories[rank]},OrdinalScale2.prototype.normalize=function(val){return normalize(val=this._getTickNumber(this.parse(val)),this._extent)},OrdinalScale2.prototype.scale=function(val){return val=Math.round(scale(val,this._extent)),this.getRawOrdinalNumber(val)},OrdinalScale2.prototype.getTicks=function(){for(var ticks=[],extent3=this._extent,rank=extent3[0];rank<=extent3[1];)ticks.push({value:rank}),rank++;return ticks},OrdinalScale2.prototype.getMinorTicks=function(splitNumber){},OrdinalScale2.prototype.setSortInfo=function(info){if(null!=info){for(var infoOrdinalNumbers=info.ordinalNumbers,ordinalsByTick=this._ordinalNumbersByTick=[],ticksByOrdinal=this._ticksByOrdinalNumber=[],tickNum=0,allCategoryLen=this._ordinalMeta.categories.length,len2=Math.min(allCategoryLen,infoOrdinalNumbers.length);tickNum<len2;++tickNum){var ordinalNumber=infoOrdinalNumbers[tickNum];ordinalsByTick[tickNum]=ordinalNumber,ticksByOrdinal[ordinalNumber]=tickNum}for(var unusedOrdinal=0;tickNum<allCategoryLen;++tickNum){for(;null!=ticksByOrdinal[unusedOrdinal];)unusedOrdinal++;ordinalsByTick.push(unusedOrdinal),ticksByOrdinal[unusedOrdinal]=tickNum}}else this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null},OrdinalScale2.prototype._getTickNumber=function(ordinal){var ticksByOrdinalNumber=this._ticksByOrdinalNumber;return ticksByOrdinalNumber&&ordinal>=0&&ordinal<ticksByOrdinalNumber.length?ticksByOrdinalNumber[ordinal]:ordinal},OrdinalScale2.prototype.getRawOrdinalNumber=function(tickNumber){var ordinalNumbersByTick=this._ordinalNumbersByTick;return ordinalNumbersByTick&&tickNumber>=0&&tickNumber<ordinalNumbersByTick.length?ordinalNumbersByTick[tickNumber]:tickNumber},OrdinalScale2.prototype.getLabel=function(tick){if(!this.isBlank()){var ordinalNumber=this.getRawOrdinalNumber(tick.value),cateogry=this._ordinalMeta.categories[ordinalNumber];return null==cateogry?"":cateogry+""}},OrdinalScale2.prototype.count=function(){return this._extent[1]-this._extent[0]+1},OrdinalScale2.prototype.unionExtentFromData=function(data,dim){this.unionExtent(data.getApproximateExtent(dim))},OrdinalScale2.prototype.isInExtentRange=function(value){return value=this._getTickNumber(value),this._extent[0]<=value&&this._extent[1]>=value},OrdinalScale2.prototype.getOrdinalMeta=function(){return this._ordinalMeta},OrdinalScale2.prototype.calcNiceTicks=function(){},OrdinalScale2.prototype.calcNiceExtent=function(){},OrdinalScale2.type="ordinal",OrdinalScale2}(Scale);Scale.registerClass(OrdinalScale);var roundNumber=round$3,IntervalScale=function(_super){function IntervalScale2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type="interval",_this._interval=0,_this._intervalPrecision=2,_this}return __extends(IntervalScale2,_super),IntervalScale2.prototype.parse=function(val){return val},IntervalScale2.prototype.contain=function(val){return contain$1(val,this._extent)},IntervalScale2.prototype.normalize=function(val){return normalize(val,this._extent)},IntervalScale2.prototype.scale=function(val){return scale(val,this._extent)},IntervalScale2.prototype.setExtent=function(start2,end2){var thisExtent=this._extent;isNaN(start2)||(thisExtent[0]=parseFloat(start2)),isNaN(end2)||(thisExtent[1]=parseFloat(end2))},IntervalScale2.prototype.unionExtent=function(other){var extent3=this._extent;other[0]<extent3[0]&&(extent3[0]=other[0]),other[1]>extent3[1]&&(extent3[1]=other[1]),this.setExtent(extent3[0],extent3[1])},IntervalScale2.prototype.getInterval=function(){return this._interval},IntervalScale2.prototype.setInterval=function(interval){this._interval=interval,this._niceExtent=this._extent.slice(),this._intervalPrecision=getIntervalPrecision(interval)},IntervalScale2.prototype.getTicks=function(expandToNicedExtent){var interval=this._interval,extent3=this._extent,niceTickExtent=this._niceExtent,intervalPrecision=this._intervalPrecision,ticks=[];if(!interval)return ticks;extent3[0]<niceTickExtent[0]&&(expandToNicedExtent?ticks.push({value:roundNumber(niceTickExtent[0]-interval,intervalPrecision)}):ticks.push({value:extent3[0]}));for(var tick=niceTickExtent[0];tick<=niceTickExtent[1]&&(ticks.push({value:tick}),(tick=roundNumber(tick+interval,intervalPrecision))!==ticks[ticks.length-1].value);)if(ticks.length>1e4)return[];var lastNiceTick=ticks.length?ticks[ticks.length-1].value:niceTickExtent[1];return extent3[1]>lastNiceTick&&(expandToNicedExtent?ticks.push({value:roundNumber(lastNiceTick+interval,intervalPrecision)}):ticks.push({value:extent3[1]})),ticks},IntervalScale2.prototype.getMinorTicks=function(splitNumber){for(var ticks=this.getTicks(!0),minorTicks=[],extent3=this.getExtent(),i=1;i<ticks.length;i++){for(var nextTick2=ticks[i],prevTick=ticks[i-1],count2=0,minorTicksGroup=[],minorInterval=(nextTick2.value-prevTick.value)/splitNumber;count2<splitNumber-1;){var minorTick=roundNumber(prevTick.value+(count2+1)*minorInterval);minorTick>extent3[0]&&minorTick<extent3[1]&&minorTicksGroup.push(minorTick),count2++}minorTicks.push(minorTicksGroup)}return minorTicks},IntervalScale2.prototype.getLabel=function(data,opt){if(null==data)return"";var precision=opt&&opt.precision;return null==precision?precision=getPrecision(data.value)||0:"auto"===precision&&(precision=this._intervalPrecision),addCommas(roundNumber(data.value,precision,!0))},IntervalScale2.prototype.calcNiceTicks=function(splitNumber,minInterval,maxInterval){splitNumber=splitNumber||5;var extent3=this._extent,span=extent3[1]-extent3[0];if(isFinite(span)){span<0&&(span=-span,extent3.reverse());var result=intervalScaleNiceTicks(extent3,splitNumber,minInterval,maxInterval);this._intervalPrecision=result.intervalPrecision,this._interval=result.interval,this._niceExtent=result.niceTickExtent}},IntervalScale2.prototype.calcNiceExtent=function(opt){var extent3=this._extent;if(extent3[0]===extent3[1])if(0!==extent3[0]){var expandSize=Math.abs(extent3[0]);opt.fixMax||(extent3[1]+=expandSize/2),extent3[0]-=expandSize/2}else extent3[1]=1;var span=extent3[1]-extent3[0];isFinite(span)||(extent3[0]=0,extent3[1]=1),this.calcNiceTicks(opt.splitNumber,opt.minInterval,opt.maxInterval);var interval=this._interval;opt.fixMin||(extent3[0]=roundNumber(Math.floor(extent3[0]/interval)*interval)),opt.fixMax||(extent3[1]=roundNumber(Math.ceil(extent3[1]/interval)*interval))},IntervalScale2.prototype.setNiceExtent=function(min3,max3){this._niceExtent=[min3,max3]},IntervalScale2.type="interval",IntervalScale2}(Scale);Scale.registerClass(IntervalScale);var supportFloat32Array="undefined"!=typeof Float32Array,Float32ArrayCtor=supportFloat32Array?Float32Array:Array;function createFloat32Array(arg){return isArray$1(arg)?supportFloat32Array?new Float32Array(arg):arg:new Float32ArrayCtor(arg)}function getSeriesStackId$1(seriesModel){return seriesModel.get("stack")||"__ec_stack_"+seriesModel.seriesIndex}function getAxisKey$1(axis){return axis.dim+axis.index}function prepareLayoutBarSeries(seriesType2,ecModel){var seriesModels=[];return ecModel.eachSeriesByType(seriesType2,(function(seriesModel){isOnCartesian(seriesModel)&&seriesModels.push(seriesModel)})),seriesModels}function makeColumnLayout(barSeries){var axisMinGaps=function(barSeries){var axisValues={};each$d(barSeries,(function(seriesModel){var baseAxis=seriesModel.coordinateSystem.getBaseAxis();if("time"===baseAxis.type||"value"===baseAxis.type)for(var data=seriesModel.getData(),key2=baseAxis.dim+"_"+baseAxis.index,dimIdx=data.getDimensionIndex(data.mapDimension(baseAxis.dim)),store=data.getStore(),i=0,cnt=store.count();i<cnt;++i){var value=store.get(dimIdx,i);axisValues[key2]?axisValues[key2].push(value):axisValues[key2]=[value]}}));var axisMinGaps={};for(var key in axisValues)if(axisValues.hasOwnProperty(key)){var valuesInAxis=axisValues[key];if(valuesInAxis){valuesInAxis.sort((function(a,b){return a-b}));for(var min3=null,j=1;j<valuesInAxis.length;++j){var delta=valuesInAxis[j]-valuesInAxis[j-1];delta>0&&(min3=null===min3?delta:Math.min(min3,delta))}axisMinGaps[key]=min3}}return axisMinGaps}(barSeries),seriesInfoList=[];return each$d(barSeries,(function(seriesModel){var bandWidth,baseAxis=seriesModel.coordinateSystem.getBaseAxis(),axisExtent=baseAxis.getExtent();if("category"===baseAxis.type)bandWidth=baseAxis.getBandWidth();else if("value"===baseAxis.type||"time"===baseAxis.type){var key=baseAxis.dim+"_"+baseAxis.index,minGap=axisMinGaps[key],extentSpan=Math.abs(axisExtent[1]-axisExtent[0]),scale2=baseAxis.scale.getExtent(),scaleSpan=Math.abs(scale2[1]-scale2[0]);bandWidth=minGap?extentSpan/scaleSpan*minGap:extentSpan}else{var data=seriesModel.getData();bandWidth=Math.abs(axisExtent[1]-axisExtent[0])/data.count()}var barWidth=parsePercent(seriesModel.get("barWidth"),bandWidth),barMaxWidth=parsePercent(seriesModel.get("barMaxWidth"),bandWidth),barMinWidth=parsePercent(seriesModel.get("barMinWidth")||(isInLargeMode(seriesModel)?.5:1),bandWidth),barGap=seriesModel.get("barGap"),barCategoryGap=seriesModel.get("barCategoryGap");seriesInfoList.push({bandWidth:bandWidth,barWidth:barWidth,barMaxWidth:barMaxWidth,barMinWidth:barMinWidth,barGap:barGap,barCategoryGap:barCategoryGap,axisKey:getAxisKey$1(baseAxis),stackId:getSeriesStackId$1(seriesModel)})})),function(seriesInfoList){var columnsMap={};each$d(seriesInfoList,(function(seriesInfo,idx){var axisKey=seriesInfo.axisKey,bandWidth=seriesInfo.bandWidth,columnsOnAxis=columnsMap[axisKey]||{bandWidth:bandWidth,remainedWidth:bandWidth,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},stacks=columnsOnAxis.stacks;columnsMap[axisKey]=columnsOnAxis;var stackId=seriesInfo.stackId;stacks[stackId]||columnsOnAxis.autoWidthCount++,stacks[stackId]=stacks[stackId]||{width:0,maxWidth:0};var barWidth=seriesInfo.barWidth;barWidth&&!stacks[stackId].width&&(stacks[stackId].width=barWidth,barWidth=Math.min(columnsOnAxis.remainedWidth,barWidth),columnsOnAxis.remainedWidth-=barWidth);var barMaxWidth=seriesInfo.barMaxWidth;barMaxWidth&&(stacks[stackId].maxWidth=barMaxWidth);var barMinWidth=seriesInfo.barMinWidth;barMinWidth&&(stacks[stackId].minWidth=barMinWidth);var barGap=seriesInfo.barGap;null!=barGap&&(columnsOnAxis.gap=barGap);var barCategoryGap=seriesInfo.barCategoryGap;null!=barCategoryGap&&(columnsOnAxis.categoryGap=barCategoryGap)}));var result={};return each$d(columnsMap,(function(columnsOnAxis,coordSysName){result[coordSysName]={};var stacks=columnsOnAxis.stacks,bandWidth=columnsOnAxis.bandWidth,categoryGapPercent=columnsOnAxis.categoryGap;if(null==categoryGapPercent){var columnCount=keys(stacks).length;categoryGapPercent=Math.max(35-4*columnCount,15)+"%"}var categoryGap=parsePercent(categoryGapPercent,bandWidth),barGapPercent=parsePercent(columnsOnAxis.gap,1),remainedWidth=columnsOnAxis.remainedWidth,autoWidthCount=columnsOnAxis.autoWidthCount,autoWidth=(remainedWidth-categoryGap)/(autoWidthCount+(autoWidthCount-1)*barGapPercent);autoWidth=Math.max(autoWidth,0),each$d(stacks,(function(column){var maxWidth=column.maxWidth,minWidth=column.minWidth;if(column.width){finalWidth=column.width;maxWidth&&(finalWidth=Math.min(finalWidth,maxWidth)),minWidth&&(finalWidth=Math.max(finalWidth,minWidth)),column.width=finalWidth,remainedWidth-=finalWidth+barGapPercent*finalWidth,autoWidthCount--}else{var finalWidth=autoWidth;maxWidth&&maxWidth<finalWidth&&(finalWidth=Math.min(maxWidth,remainedWidth)),minWidth&&minWidth>finalWidth&&(finalWidth=minWidth),finalWidth!==autoWidth&&(column.width=finalWidth,remainedWidth-=finalWidth+barGapPercent*finalWidth,autoWidthCount--)}})),autoWidth=(remainedWidth-categoryGap)/(autoWidthCount+(autoWidthCount-1)*barGapPercent),autoWidth=Math.max(autoWidth,0);var lastColumn,widthSum=0;each$d(stacks,(function(column,idx){column.width||(column.width=autoWidth),lastColumn=column,widthSum+=column.width*(1+barGapPercent)})),lastColumn&&(widthSum-=lastColumn.width*barGapPercent);var offset=-widthSum/2;each$d(stacks,(function(column,stackId){result[coordSysName][stackId]=result[coordSysName][stackId]||{bandWidth:bandWidth,offset:offset,width:column.width},offset+=column.width*(1+barGapPercent)}))})),result}(seriesInfoList)}function layout$2(seriesType2,ecModel){var seriesModels=prepareLayoutBarSeries(seriesType2,ecModel),barWidthAndOffset=makeColumnLayout(seriesModels);each$d(seriesModels,(function(seriesModel){var data=seriesModel.getData(),baseAxis=seriesModel.coordinateSystem.getBaseAxis(),stackId=getSeriesStackId$1(seriesModel),columnLayoutInfo=barWidthAndOffset[getAxisKey$1(baseAxis)][stackId],columnOffset=columnLayoutInfo.offset,columnWidth=columnLayoutInfo.width;data.setLayout({bandWidth:columnLayoutInfo.bandWidth,offset:columnOffset,size:columnWidth})}))}function createProgressiveLayout(seriesType2){return{seriesType:seriesType2,plan:createRenderPlanner(),reset:function(seriesModel){if(isOnCartesian(seriesModel)){var data=seriesModel.getData(),cartesian=seriesModel.coordinateSystem,baseAxis=cartesian.getBaseAxis(),valueAxis2=cartesian.getOtherAxis(baseAxis),valueDimIdx=data.getDimensionIndex(data.mapDimension(valueAxis2.dim)),baseDimIdx=data.getDimensionIndex(data.mapDimension(baseAxis.dim)),drawBackground=seriesModel.get("showBackground",!0),valueDim=data.mapDimension(valueAxis2.dim),stackResultDim=data.getCalculationInfo("stackResultDimension"),stacked=isDimensionStacked(data,valueDim)&&!!data.getCalculationInfo("stackedOnSeries"),isValueAxisH=valueAxis2.isHorizontal(),valueAxisStart=function(baseAxis,valueAxis2){var startValue=valueAxis2.model.get("startValue");startValue||(startValue=0);return valueAxis2.toGlobalCoord(valueAxis2.dataToCoord("log"===valueAxis2.type?startValue>0?startValue:1:startValue))}(0,valueAxis2),isLarge=isInLargeMode(seriesModel),barMinHeight=seriesModel.get("barMinHeight")||0,stackedDimIdx=stackResultDim&&data.getDimensionIndex(stackResultDim),columnWidth=data.getLayout("size"),columnOffset=data.getLayout("offset");return{progress:function(params,data2){for(var dataIndex,count2=params.count,largePoints=isLarge&&createFloat32Array(3*count2),largeBackgroundPoints=isLarge&&drawBackground&&createFloat32Array(3*count2),largeDataIndices=isLarge&&createFloat32Array(count2),coordLayout=cartesian.master.getRect(),bgSize=isValueAxisH?coordLayout.width:coordLayout.height,store=data2.getStore(),idxOffset=0;null!=(dataIndex=params.next());){var value=store.get(stacked?stackedDimIdx:valueDimIdx,dataIndex),baseValue=store.get(baseDimIdx,dataIndex),baseCoord=valueAxisStart,stackStartValue=void 0;stacked&&(stackStartValue=+value-store.get(valueDimIdx,dataIndex));var x=void 0,y=void 0,width=void 0,height=void 0;if(isValueAxisH){var coord=cartesian.dataToPoint([value,baseValue]);if(stacked)baseCoord=cartesian.dataToPoint([stackStartValue,baseValue])[0];x=baseCoord,y=coord[1]+columnOffset,width=coord[0]-baseCoord,height=columnWidth,Math.abs(width)<barMinHeight&&(width=(width<0?-1:1)*barMinHeight)}else{coord=cartesian.dataToPoint([baseValue,value]);if(stacked)baseCoord=cartesian.dataToPoint([baseValue,stackStartValue])[1];x=coord[0]+columnOffset,y=baseCoord,width=columnWidth,height=coord[1]-baseCoord,Math.abs(height)<barMinHeight&&(height=(height<=0?-1:1)*barMinHeight)}isLarge?(largePoints[idxOffset]=x,largePoints[idxOffset+1]=y,largePoints[idxOffset+2]=isValueAxisH?width:height,largeBackgroundPoints&&(largeBackgroundPoints[idxOffset]=isValueAxisH?coordLayout.x:x,largeBackgroundPoints[idxOffset+1]=isValueAxisH?y:coordLayout.y,largeBackgroundPoints[idxOffset+2]=bgSize),largeDataIndices[dataIndex]=dataIndex):data2.setItemLayout(dataIndex,{x:x,y:y,width:width,height:height}),idxOffset+=3}isLarge&&data2.setLayout({largePoints:largePoints,largeDataIndices:largeDataIndices,largeBackgroundPoints:largeBackgroundPoints,valueAxisHorizontal:isValueAxisH})}}}}}}function isOnCartesian(seriesModel){return seriesModel.coordinateSystem&&"cartesian2d"===seriesModel.coordinateSystem.type}function isInLargeMode(seriesModel){return seriesModel.pipelineContext&&seriesModel.pipelineContext.large}var TimeScale=function(_super){function TimeScale2(settings){var _this=_super.call(this,settings)||this;return _this.type="time",_this}return __extends(TimeScale2,_super),TimeScale2.prototype.getLabel=function(tick){var useUTC=this.getSetting("useUTC");return format$1(tick.value,fullLeveledFormatter[function(timeUnit){switch(timeUnit){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}(getPrimaryTimeUnit(this._minLevelUnit))]||fullLeveledFormatter.second,useUTC,this.getSetting("locale"))},TimeScale2.prototype.getFormattedLabel=function(tick,idx,labelFormatter){var isUTC=this.getSetting("useUTC");return function(tick,idx,formatter,lang,isUTC){var template=null;if(isString(formatter))template=formatter;else if(isFunction(formatter))template=formatter(tick.value,idx,{level:tick.level});else{var defaults$1=extend({},defaultLeveledFormatter);if(tick.level>0)for(var i=0;i<primaryTimeUnits.length;++i)defaults$1[primaryTimeUnits[i]]="{primary|"+defaults$1[primaryTimeUnits[i]]+"}";var mergedFormatter=formatter?!1===formatter.inherit?formatter:defaults(formatter,defaults$1):defaults$1,unit=getUnitFromValue(tick.value,isUTC);if(mergedFormatter[unit])template=mergedFormatter[unit];else if(mergedFormatter.inherit){for(i=timeUnits.indexOf(unit)-1;i>=0;--i)if(mergedFormatter[unit]){template=mergedFormatter[unit];break}template=template||defaults$1.none}if(isArray$1(template)){var levelId=null==tick.level?0:tick.level>=0?tick.level:template.length+tick.level;template=template[levelId=Math.min(levelId,template.length-1)]}}return format$1(new Date(tick.value),template,isUTC,lang)}(tick,idx,labelFormatter,this.getSetting("locale"),isUTC)},TimeScale2.prototype.getTicks=function(){var interval=this._interval,extent3=this._extent,ticks=[];if(!interval)return ticks;ticks.push({value:extent3[0],level:0});var useUTC=this.getSetting("useUTC"),innerTicks=function(bottomUnitName,approxInterval,isUTC,extent3){var safeLimit=1e4,unitNames=timeUnits,iter=0;function addTicksInSpan(interval,minTimestamp,maxTimestamp,getMethodName,setMethodName,isDate,out2){for(var date=new Date(minTimestamp),dateTime=minTimestamp,d=date[getMethodName]();dateTime<maxTimestamp&&dateTime<=extent3[1];)out2.push({value:dateTime}),d+=interval,date[setMethodName](d),dateTime=date.getTime();out2.push({value:dateTime,notAdd:!0})}function addLevelTicks(unitName,lastLevelTicks,levelTicks2){var newAddedTicks=[],isFirstLevel=!lastLevelTicks.length;if(!function(unit,valueA,valueB,isUTC){var dateA=parseDate(valueA),dateB=parseDate(valueB),isSame=function(unit2){return getUnitValue(dateA,unit2,isUTC)===getUnitValue(dateB,unit2,isUTC)},isSameYear=function(){return isSame("year")},isSameMonth=function(){return isSameYear()&&isSame("month")},isSameDay=function(){return isSameMonth()&&isSame("day")},isSameHour=function(){return isSameDay()&&isSame("hour")},isSameMinute=function(){return isSameHour()&&isSame("minute")},isSameSecond=function(){return isSameMinute()&&isSame("second")},isSameMilliSecond=function(){return isSameSecond()&&isSame("millisecond")};switch(unit){case"year":return isSameYear();case"month":return isSameMonth();case"day":return isSameDay();case"hour":return isSameHour();case"minute":return isSameMinute();case"second":return isSameSecond();case"millisecond":return isSameMilliSecond()}}(getPrimaryTimeUnit(unitName),extent3[0],extent3[1],isUTC)){isFirstLevel&&(lastLevelTicks=[{value:getFirstTimestampOfUnit(new Date(extent3[0]),unitName,isUTC)},{value:extent3[1]}]);for(var i2=0;i2<lastLevelTicks.length-1;i2++){var startTick=lastLevelTicks[i2].value,endTick=lastLevelTicks[i2+1].value;if(startTick!==endTick){var interval=void 0,getterName=void 0,setterName=void 0,isDate=!1;switch(unitName){case"year":interval=Math.max(1,Math.round(approxInterval/864e5/365)),getterName=fullYearGetterName(isUTC),setterName=fullYearSetterName(isUTC);break;case"half-year":case"quarter":case"month":interval=getMonthInterval(approxInterval),getterName=monthGetterName(isUTC),setterName=monthSetterName(isUTC);break;case"week":case"half-week":case"day":interval=getDateInterval(approxInterval),getterName=dateGetterName(isUTC),setterName=dateSetterName(isUTC),isDate=!0;break;case"half-day":case"quarter-day":case"hour":interval=getHourInterval(approxInterval),getterName=hoursGetterName(isUTC),setterName=hoursSetterName(isUTC);break;case"minute":interval=getMinutesAndSecondsInterval(approxInterval,!0),getterName=minutesGetterName(isUTC),setterName=minutesSetterName(isUTC);break;case"second":interval=getMinutesAndSecondsInterval(approxInterval,!1),getterName=secondsGetterName(isUTC),setterName=secondsSetterName(isUTC);break;case"millisecond":interval=getMillisecondsInterval(approxInterval),getterName=millisecondsGetterName(isUTC),setterName=millisecondsSetterName(isUTC)}addTicksInSpan(interval,startTick,endTick,getterName,setterName,isDate,newAddedTicks),"year"===unitName&&levelTicks2.length>1&&0===i2&&levelTicks2.unshift({value:levelTicks2[0].value-interval})}}for(i2=0;i2<newAddedTicks.length;i2++)levelTicks2.push(newAddedTicks[i2]);return newAddedTicks}}for(var levelsTicks=[],currentLevelTicks=[],tickCount=0,lastLevelTickCount=0,i=0;i<unitNames.length&&iter++<safeLimit;++i){var primaryTimeUnit=getPrimaryTimeUnit(unitNames[i]);if(isPrimaryTimeUnit(unitNames[i]))if(addLevelTicks(unitNames[i],levelsTicks[levelsTicks.length-1]||[],currentLevelTicks),primaryTimeUnit!==(unitNames[i+1]?getPrimaryTimeUnit(unitNames[i+1]):null)){if(currentLevelTicks.length){lastLevelTickCount=tickCount,currentLevelTicks.sort((function(a,b){return a.value-b.value}));for(var levelTicksRemoveDuplicated=[],i_1=0;i_1<currentLevelTicks.length;++i_1){var tickValue=currentLevelTicks[i_1].value;0!==i_1&&currentLevelTicks[i_1-1].value===tickValue||(levelTicksRemoveDuplicated.push(currentLevelTicks[i_1]),tickValue>=extent3[0]&&tickValue<=extent3[1]&&tickCount++)}var targetTickNum=(extent3[1]-extent3[0])/approxInterval;if(tickCount>1.5*targetTickNum&&lastLevelTickCount>targetTickNum/1.5)break;if(levelsTicks.push(levelTicksRemoveDuplicated),tickCount>targetTickNum||bottomUnitName===unitNames[i])break}currentLevelTicks=[]}}var levelsTicksInExtent=filter(map$1(levelsTicks,(function(levelTicks2){return filter(levelTicks2,(function(tick){return tick.value>=extent3[0]&&tick.value<=extent3[1]&&!tick.notAdd}))})),(function(levelTicks2){return levelTicks2.length>0})),ticks=[],maxLevel=levelsTicksInExtent.length-1;for(i=0;i<levelsTicksInExtent.length;++i)for(var levelTicks=levelsTicksInExtent[i],k=0;k<levelTicks.length;++k)ticks.push({value:levelTicks[k].value,level:maxLevel-i});ticks.sort((function(a,b){return a.value-b.value}));var result=[];for(i=0;i<ticks.length;++i)0!==i&&ticks[i].value===ticks[i-1].value||result.push(ticks[i]);return result}(this._minLevelUnit,this._approxInterval,useUTC,extent3);return(ticks=ticks.concat(innerTicks)).push({value:extent3[1],level:0}),ticks},TimeScale2.prototype.calcNiceExtent=function(opt){var extent3=this._extent;if(extent3[0]===extent3[1]&&(extent3[0]-=864e5,extent3[1]+=864e5),-Infinity===extent3[1]&&Infinity===extent3[0]){var d=new Date;extent3[1]=+new Date(d.getFullYear(),d.getMonth(),d.getDate()),extent3[0]=extent3[1]-864e5}this.calcNiceTicks(opt.splitNumber,opt.minInterval,opt.maxInterval)},TimeScale2.prototype.calcNiceTicks=function(approxTickNum,minInterval,maxInterval){approxTickNum=approxTickNum||10;var extent3=this._extent,span=extent3[1]-extent3[0];this._approxInterval=span/approxTickNum,null!=minInterval&&this._approxInterval<minInterval&&(this._approxInterval=minInterval),null!=maxInterval&&this._approxInterval>maxInterval&&(this._approxInterval=maxInterval);var scaleIntervalsLen=scaleIntervals.length,idx=Math.min(function(a,x,lo,hi){for(;lo<hi;){var mid=lo+hi>>>1;a[mid][1]<x?lo=mid+1:hi=mid}return lo}(scaleIntervals,this._approxInterval,0,scaleIntervalsLen),scaleIntervalsLen-1);this._interval=scaleIntervals[idx][1],this._minLevelUnit=scaleIntervals[Math.max(idx-1,0)][0]},TimeScale2.prototype.parse=function(val){return isNumber(val)?val:+parseDate(val)},TimeScale2.prototype.contain=function(val){return contain$1(this.parse(val),this._extent)},TimeScale2.prototype.normalize=function(val){return normalize(this.parse(val),this._extent)},TimeScale2.prototype.scale=function(val){return scale(val,this._extent)},TimeScale2.type="time",TimeScale2}(IntervalScale),scaleIntervals=[["second",1e3],["minute",6e4],["hour",36e5],["quarter-day",216e5],["half-day",432e5],["day",10368e4],["half-week",3024e5],["week",6048e5],["month",26784e5],["quarter",8208e6],["half-year",15768e6],["year",31536e6]];function getDateInterval(approxInterval,daysInMonth){return(approxInterval/=864e5)>16?16:approxInterval>7.5?7:approxInterval>3.5?4:approxInterval>1.5?2:1}function getMonthInterval(approxInterval){return(approxInterval/=2592e6)>6?6:approxInterval>3?3:approxInterval>2?2:1}function getHourInterval(approxInterval){return(approxInterval/=36e5)>12?12:approxInterval>6?6:approxInterval>3.5?4:approxInterval>2?2:1}function getMinutesAndSecondsInterval(approxInterval,isMinutes){return(approxInterval/=isMinutes?6e4:1e3)>30?30:approxInterval>20?20:approxInterval>15?15:approxInterval>10?10:approxInterval>5?5:approxInterval>2?2:1}function getMillisecondsInterval(approxInterval){return nice(approxInterval,!0)}function getFirstTimestampOfUnit(date,unitName,isUTC){var outDate=new Date(date);switch(getPrimaryTimeUnit(unitName)){case"year":case"month":outDate[monthSetterName(isUTC)](0);case"day":outDate[dateSetterName(isUTC)](1);case"hour":outDate[hoursSetterName(isUTC)](0);case"minute":outDate[minutesSetterName(isUTC)](0);case"second":outDate[secondsSetterName(isUTC)](0),outDate[millisecondsSetterName(isUTC)](0)}return outDate.getTime()}Scale.registerClass(TimeScale);var scaleProto=Scale.prototype,intervalScaleProto=IntervalScale.prototype,roundingErrorFix=round$3,mathFloor$1=Math.floor,mathCeil$1=Math.ceil,mathPow$1=Math.pow,mathLog$1=Math.log,LogScale=function(_super){function LogScale2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type="log",_this.base=10,_this._originalScale=new IntervalScale,_this._interval=0,_this}return __extends(LogScale2,_super),LogScale2.prototype.getTicks=function(expandToNicedExtent){var originalScale=this._originalScale,extent3=this._extent,originalExtent=originalScale.getExtent();return map$1(intervalScaleProto.getTicks.call(this,expandToNicedExtent),(function(tick){var val=tick.value,powVal=round$3(mathPow$1(this.base,val));return powVal=val===extent3[0]&&this._fixMin?fixRoundingError(powVal,originalExtent[0]):powVal,{value:powVal=val===extent3[1]&&this._fixMax?fixRoundingError(powVal,originalExtent[1]):powVal}}),this)},LogScale2.prototype.setExtent=function(start2,end2){var base2=mathLog$1(this.base);start2=mathLog$1(Math.max(0,start2))/base2,end2=mathLog$1(Math.max(0,end2))/base2,intervalScaleProto.setExtent.call(this,start2,end2)},LogScale2.prototype.getExtent=function(){var base2=this.base,extent3=scaleProto.getExtent.call(this);extent3[0]=mathPow$1(base2,extent3[0]),extent3[1]=mathPow$1(base2,extent3[1]);var originalExtent=this._originalScale.getExtent();return this._fixMin&&(extent3[0]=fixRoundingError(extent3[0],originalExtent[0])),this._fixMax&&(extent3[1]=fixRoundingError(extent3[1],originalExtent[1])),extent3},LogScale2.prototype.unionExtent=function(extent3){this._originalScale.unionExtent(extent3);var base2=this.base;extent3[0]=mathLog$1(extent3[0])/mathLog$1(base2),extent3[1]=mathLog$1(extent3[1])/mathLog$1(base2),scaleProto.unionExtent.call(this,extent3)},LogScale2.prototype.unionExtentFromData=function(data,dim){this.unionExtent(data.getApproximateExtent(dim))},LogScale2.prototype.calcNiceTicks=function(approxTickNum){approxTickNum=approxTickNum||10;var extent3=this._extent,span=extent3[1]-extent3[0];if(!(Infinity===span||span<=0)){var interval=quantity(span);for(approxTickNum/span*interval<=.5&&(interval*=10);!isNaN(interval)&&Math.abs(interval)<1&&Math.abs(interval)>0;)interval*=10;var niceExtent=[round$3(mathCeil$1(extent3[0]/interval)*interval),round$3(mathFloor$1(extent3[1]/interval)*interval)];this._interval=interval,this._niceExtent=niceExtent}},LogScale2.prototype.calcNiceExtent=function(opt){intervalScaleProto.calcNiceExtent.call(this,opt),this._fixMin=opt.fixMin,this._fixMax=opt.fixMax},LogScale2.prototype.parse=function(val){return val},LogScale2.prototype.contain=function(val){return contain$1(val=mathLog$1(val)/mathLog$1(this.base),this._extent)},LogScale2.prototype.normalize=function(val){return normalize(val=mathLog$1(val)/mathLog$1(this.base),this._extent)},LogScale2.prototype.scale=function(val){return val=scale(val,this._extent),mathPow$1(this.base,val)},LogScale2.type="log",LogScale2}(Scale),proto=LogScale.prototype;function fixRoundingError(val,originalVal){return roundingErrorFix(val,getPrecision(originalVal))}proto.getMinorTicks=intervalScaleProto.getMinorTicks,proto.getLabel=intervalScaleProto.getLabel,Scale.registerClass(LogScale);var ScaleRawExtentInfo=function(){function ScaleRawExtentInfo2(scale2,model,originalExtent){this._prepareParams(scale2,model,originalExtent)}return ScaleRawExtentInfo2.prototype._prepareParams=function(scale2,model,dataExtent){dataExtent[1]<dataExtent[0]&&(dataExtent=[NaN,NaN]),this._dataMin=dataExtent[0],this._dataMax=dataExtent[1];var isOrdinal=this._isOrdinal="ordinal"===scale2.type;this._needCrossZero="interval"===scale2.type&&model.getNeedCrossZero&&model.getNeedCrossZero();var axisMinValue=model.get("min",!0);null==axisMinValue&&(axisMinValue=model.get("startValue",!0));var modelMinRaw=this._modelMinRaw=axisMinValue;isFunction(modelMinRaw)?this._modelMinNum=parseAxisModelMinMax(scale2,modelMinRaw({min:dataExtent[0],max:dataExtent[1]})):"dataMin"!==modelMinRaw&&(this._modelMinNum=parseAxisModelMinMax(scale2,modelMinRaw));var modelMaxRaw=this._modelMaxRaw=model.get("max",!0);if(isFunction(modelMaxRaw)?this._modelMaxNum=parseAxisModelMinMax(scale2,modelMaxRaw({min:dataExtent[0],max:dataExtent[1]})):"dataMax"!==modelMaxRaw&&(this._modelMaxNum=parseAxisModelMinMax(scale2,modelMaxRaw)),isOrdinal)this._axisDataLen=model.getCategories().length;else{var boundaryGap=model.get("boundaryGap"),boundaryGapArr=isArray$1(boundaryGap)?boundaryGap:[boundaryGap||0,boundaryGap||0];"boolean"==typeof boundaryGapArr[0]||"boolean"==typeof boundaryGapArr[1]?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[parsePercent$1(boundaryGapArr[0],1),parsePercent$1(boundaryGapArr[1],1)]}},ScaleRawExtentInfo2.prototype.calculate=function(){var isOrdinal=this._isOrdinal,dataMin=this._dataMin,dataMax=this._dataMax,axisDataLen=this._axisDataLen,boundaryGapInner=this._boundaryGapInner,span=isOrdinal?null:dataMax-dataMin||Math.abs(dataMin),min3="dataMin"===this._modelMinRaw?dataMin:this._modelMinNum,max3="dataMax"===this._modelMaxRaw?dataMax:this._modelMaxNum,minFixed=null!=min3,maxFixed=null!=max3;null==min3&&(min3=isOrdinal?axisDataLen?0:NaN:dataMin-boundaryGapInner[0]*span),null==max3&&(max3=isOrdinal?axisDataLen?axisDataLen-1:NaN:dataMax+boundaryGapInner[1]*span),(null==min3||!isFinite(min3))&&(min3=NaN),(null==max3||!isFinite(max3))&&(max3=NaN);var isBlank=eqNaN(min3)||eqNaN(max3)||isOrdinal&&!axisDataLen;this._needCrossZero&&(min3>0&&max3>0&&!minFixed&&(min3=0),min3<0&&max3<0&&!maxFixed&&(max3=0));var determinedMin=this._determinedMin,determinedMax=this._determinedMax;return null!=determinedMin&&(min3=determinedMin,minFixed=!0),null!=determinedMax&&(max3=determinedMax,maxFixed=!0),{min:min3,max:max3,minFixed:minFixed,maxFixed:maxFixed,isBlank:isBlank}},ScaleRawExtentInfo2.prototype.modifyDataMinMax=function(minMaxName,val){this[DATA_MIN_MAX_ATTR[minMaxName]]=val},ScaleRawExtentInfo2.prototype.setDeterminedMinMax=function(minMaxName,val){this[DETERMINED_MIN_MAX_ATTR[minMaxName]]=val},ScaleRawExtentInfo2.prototype.freeze=function(){this.frozen=!0},ScaleRawExtentInfo2}(),DETERMINED_MIN_MAX_ATTR={min:"_determinedMin",max:"_determinedMax"},DATA_MIN_MAX_ATTR={min:"_dataMin",max:"_dataMax"};function ensureScaleRawExtentInfo(scale2,model,originalExtent){var rawExtentInfo=scale2.rawExtentInfo;return rawExtentInfo||(rawExtentInfo=new ScaleRawExtentInfo(scale2,model,originalExtent),scale2.rawExtentInfo=rawExtentInfo,rawExtentInfo)}function parseAxisModelMinMax(scale2,minMax){return null==minMax?null:eqNaN(minMax)?NaN:scale2.parse(minMax)}function getScaleExtent(scale2,model){var scaleType=scale2.type,rawExtentResult=ensureScaleRawExtentInfo(scale2,model,scale2.getExtent()).calculate();scale2.setBlank(rawExtentResult.isBlank);var min3=rawExtentResult.min,max3=rawExtentResult.max,ecModel=model.ecModel;if(ecModel&&"time"===scaleType){var barSeriesModels=prepareLayoutBarSeries("bar",ecModel),isBaseAxisAndHasBarSeries_1=!1;if(each$d(barSeriesModels,(function(seriesModel){isBaseAxisAndHasBarSeries_1=isBaseAxisAndHasBarSeries_1||seriesModel.getBaseAxis()===model.axis})),isBaseAxisAndHasBarSeries_1){var barWidthAndOffset=makeColumnLayout(barSeriesModels),adjustedScale=function(min3,max3,model,barWidthAndOffset){var axisExtent=model.axis.getExtent(),axisLength=Math.abs(axisExtent[1]-axisExtent[0]),barsOnCurrentAxis=function(barWidthAndOffset,axis){if(barWidthAndOffset&&axis)return barWidthAndOffset[getAxisKey$1(axis)]}(barWidthAndOffset,model.axis);if(void 0===barsOnCurrentAxis)return{min:min3,max:max3};var minOverflow=Infinity;each$d(barsOnCurrentAxis,(function(item){minOverflow=Math.min(item.offset,minOverflow)}));var maxOverflow=-Infinity;each$d(barsOnCurrentAxis,(function(item){maxOverflow=Math.max(item.offset+item.width,maxOverflow)})),minOverflow=Math.abs(minOverflow),maxOverflow=Math.abs(maxOverflow);var totalOverFlow=minOverflow+maxOverflow,oldRange=max3-min3,overflowBuffer=oldRange/(1-(minOverflow+maxOverflow)/axisLength)-oldRange;return max3+=overflowBuffer*(maxOverflow/totalOverFlow),min3-=overflowBuffer*(minOverflow/totalOverFlow),{min:min3,max:max3}}(min3,max3,model,barWidthAndOffset);min3=adjustedScale.min,max3=adjustedScale.max}}return{extent:[min3,max3],fixMin:rawExtentResult.minFixed,fixMax:rawExtentResult.maxFixed}}function niceScaleExtent(scale2,inModel){var model=inModel,extentInfo=getScaleExtent(scale2,model),extent3=extentInfo.extent,splitNumber=model.get("splitNumber");scale2 instanceof LogScale&&(scale2.base=model.get("logBase"));var scaleType=scale2.type,interval=model.get("interval"),isIntervalOrTime="interval"===scaleType||"time"===scaleType;scale2.setExtent(extent3[0],extent3[1]),scale2.calcNiceExtent({splitNumber:splitNumber,fixMin:extentInfo.fixMin,fixMax:extentInfo.fixMax,minInterval:isIntervalOrTime?model.get("minInterval"):null,maxInterval:isIntervalOrTime?model.get("maxInterval"):null}),null!=interval&&scale2.setInterval&&scale2.setInterval(interval)}function createScaleByModel$1(model,axisType){if(axisType=axisType||model.get("type"))switch(axisType){case"category":return new OrdinalScale({ordinalMeta:model.getOrdinalMeta?model.getOrdinalMeta():model.getCategories(),extent:[Infinity,-Infinity]});case"time":return new TimeScale({locale:model.ecModel.getLocaleModel(),useUTC:model.ecModel.get("useUTC")});default:return new(Scale.getClass(axisType)||IntervalScale)}}function makeLabelFormatter(axis){var labelFormatter=axis.getLabelModel().get("formatter"),categoryTickStart="category"===axis.type?axis.scale.getExtent()[0]:null;return"time"===axis.scale.type?function(tpl){return function(tick,idx){return axis.scale.getFormattedLabel(tick,idx,tpl)}}(labelFormatter):isString(labelFormatter)?function(tpl){return function(tick){var label=axis.scale.getLabel(tick);return tpl.replace("{value}",null!=label?label:"")}}(labelFormatter):isFunction(labelFormatter)?function(cb){return function(tick,idx){return null!=categoryTickStart&&(idx=tick.value-categoryTickStart),cb(getAxisRawValue(axis,tick),idx,null!=tick.level?{level:tick.level}:null)}}(labelFormatter):function(tick){return axis.scale.getLabel(tick)}}function getAxisRawValue(axis,tick){return"category"===axis.type?axis.scale.getLabel(tick):tick.value}function getOptionCategoryInterval(model){var interval=model.get("interval");return null==interval?"auto":interval}function shouldShowAllLabels(axis){return"category"===axis.type&&0===getOptionCategoryInterval(axis.getLabelModel())}function getDataDimensionsOnAxis(data,axisDim){var dataDimMap={};return each$d(data.mapDimensionsAll(axisDim),(function(dataDim){dataDimMap[getStackedDimension(data,dataDim)]=!0})),keys(dataDimMap)}var AxisModelCommonMixin=function(){function AxisModelCommonMixin2(){}return AxisModelCommonMixin2.prototype.getNeedCrossZero=function(){return!this.option.scale},AxisModelCommonMixin2.prototype.getCoordSysModel=function(){},AxisModelCommonMixin2}();var dataStack={isDimensionStacked:isDimensionStacked,enableDataStack:enableDataStack,getStackedDimension:getStackedDimension};const helper=Object.freeze(Object.defineProperty({__proto__:null,createDimensions:function(source,opt){return prepareSeriesDataSchema(source,opt).dimensions},createList:function(seriesModel){return createSeriesData(0,seriesModel)},createScale:function(dataExtent,option){var axisModel=option;option instanceof Model||(axisModel=new Model(option));var scale2=createScaleByModel$1(axisModel);return scale2.setExtent(dataExtent[0],dataExtent[1]),niceScaleExtent(scale2,axisModel),scale2},createSymbol:createSymbol,createTextStyle:function(textStyleModel,opts){return createTextStyle$1(textStyleModel,null,null,"normal"!==(opts=opts||{}).state)},dataStack:dataStack,enableHoverEmphasis:enableHoverEmphasis,getECData:getECData,getLayoutRect:getLayoutRect,mixinAxisModelCommonMethods:function(Model2){mixin(Model2,AxisModelCommonMixin)}},Symbol.toStringTag,{value:"Module"}));var extensions=[],extensionRegisters={registerPreprocessor:registerPreprocessor,registerProcessor:registerProcessor,registerPostInit:registerPostInit,registerPostUpdate:registerPostUpdate,registerUpdateLifecycle:registerUpdateLifecycle,registerAction:registerAction,registerCoordinateSystem:registerCoordinateSystem,registerLayout:registerLayout,registerVisual:registerVisual,registerTransform:registerTransform,registerLoading:registerLoading,registerMap:registerMap$1,registerImpl:function(name,impl){implsStore[name]=impl},PRIORITY:PRIORITY,ComponentModel:ComponentModel,ComponentView:ComponentView,SeriesModel:SeriesModel,ChartView:ChartView,registerComponentModel:function(ComponentModelClass){ComponentModel.registerClass(ComponentModelClass)},registerComponentView:function(ComponentViewClass){ComponentView.registerClass(ComponentViewClass)},registerSeriesModel:function(SeriesModelClass){SeriesModel.registerClass(SeriesModelClass)},registerChartView:function(ChartViewClass){ChartView.registerClass(ChartViewClass)},registerSubTypeDefaulter:function(componentType,defaulter){ComponentModel.registerSubTypeDefaulter(componentType,defaulter)},registerPainter:function(painterType,PainterCtor){registerPainter(painterType,PainterCtor)}};function use(ext){isArray$1(ext)?each$d(ext,(function(singleExt){use(singleExt)})):indexOf(extensions,ext)>=0||(extensions.push(ext),isFunction(ext)&&(ext={install:ext}),ext.install(extensionRegisters))}function isAroundEqual(a,b){return Math.abs(a-b)<1e-8}function contain(points2,x,y){var w=0,p=points2[0];if(!p)return!1;for(var i=1;i<points2.length;i++){var p2=points2[i];w+=windingLine(p[0],p[1],p2[0],p2[1],x,y),p=p2}var p0=points2[0];return isAroundEqual(p[0],p0[0])&&isAroundEqual(p[1],p0[1])||(w+=windingLine(p[0],p[1],p0[0],p0[1],x,y)),0!==w}var TMP_TRANSFORM=[];function transformPoints(points2,transform){for(var p=0;p<points2.length;p++)applyTransform$1(points2[p],points2[p],transform)}function updateBBoxFromPoints(points2,min3,max3,projection){for(var i=0;i<points2.length;i++){var p=points2[i];projection&&(p=projection.project(p)),p&&isFinite(p[0])&&isFinite(p[1])&&(min$1(min3,min3,p),max$1(max3,max3,p))}}var Region=function(){function Region2(name){this.name=name}return Region2.prototype.setCenter=function(center2){this._center=center2},Region2.prototype.getCenter=function(){var center2=this._center;return center2||(center2=this._center=this.calcCenter()),center2},Region2}(),GeoJSONPolygonGeometry=function(){return function(exterior,interiors){this.type="polygon",this.exterior=exterior,this.interiors=interiors}}(),GeoJSONLineStringGeometry=function(){return function(points2){this.type="linestring",this.points=points2}}(),GeoJSONRegion=function(_super){function GeoJSONRegion2(name,geometries,cp){var _this=_super.call(this,name)||this;return _this.type="geoJSON",_this.geometries=geometries,_this._center=cp&&[cp[0],cp[1]],_this}return __extends(GeoJSONRegion2,_super),GeoJSONRegion2.prototype.calcCenter=function(){for(var largestGeo,geometries=this.geometries,largestGeoSize=0,i=0;i<geometries.length;i++){var geo=geometries[i],exterior=geo.exterior,size=exterior&&exterior.length;size>largestGeoSize&&(largestGeo=geo,largestGeoSize=size)}if(largestGeo)return function(points2){for(var signedArea=0,cx=0,cy=0,len2=points2.length,x0=points2[len2-1][0],y0=points2[len2-1][1],i=0;i<len2;i++){var x1=points2[i][0],y1=points2[i][1],a=x0*y1-x1*y0;signedArea+=a,cx+=(x0+x1)*a,cy+=(y0+y1)*a,x0=x1,y0=y1}return signedArea?[cx/signedArea/3,cy/signedArea/3,signedArea]:[points2[0][0]||0,points2[0][1]||0]}(largestGeo.exterior);var rect=this.getBoundingRect();return[rect.x+rect.width/2,rect.y+rect.height/2]},GeoJSONRegion2.prototype.getBoundingRect=function(projection){var rect=this._rect;if(rect&&!projection)return rect;var min3=[Infinity,Infinity],max3=[-Infinity,-Infinity];return each$d(this.geometries,(function(geo){"polygon"===geo.type?updateBBoxFromPoints(geo.exterior,min3,max3,projection):each$d(geo.points,(function(points2){updateBBoxFromPoints(points2,min3,max3,projection)}))})),isFinite(min3[0])&&isFinite(min3[1])&&isFinite(max3[0])&&isFinite(max3[1])||(min3[0]=min3[1]=max3[0]=max3[1]=0),rect=new BoundingRect(min3[0],min3[1],max3[0]-min3[0],max3[1]-min3[1]),projection||(this._rect=rect),rect},GeoJSONRegion2.prototype.contain=function(coord){var rect=this.getBoundingRect(),geometries=this.geometries;if(!rect.contain(coord[0],coord[1]))return!1;loopGeo:for(var i=0,len2=geometries.length;i<len2;i++){var geo=geometries[i];if("polygon"===geo.type){var exterior=geo.exterior,interiors=geo.interiors;if(contain(exterior,coord[0],coord[1])){for(var k=0;k<(interiors?interiors.length:0);k++)if(contain(interiors[k],coord[0],coord[1]))continue loopGeo;return!0}}}return!1},GeoJSONRegion2.prototype.transformTo=function(x,y,width,height){var rect=this.getBoundingRect(),aspect=rect.width/rect.height;width?height||(height=width/aspect):width=aspect*height;for(var target=new BoundingRect(x,y,width,height),transform=rect.calculateTransform(target),geometries=this.geometries,i=0;i<geometries.length;i++){var geo=geometries[i];"polygon"===geo.type?(transformPoints(geo.exterior,transform),each$d(geo.interiors,(function(interior){transformPoints(interior,transform)}))):each$d(geo.points,(function(points2){transformPoints(points2,transform)}))}(rect=this._rect).copy(target),this._center=[rect.x+rect.width/2,rect.y+rect.height/2]},GeoJSONRegion2.prototype.cloneShallow=function(name){null==name&&(name=this.name);var newRegion=new GeoJSONRegion2(name,this.geometries,this._center);return newRegion._rect=this._rect,newRegion.transformTo=null,newRegion},GeoJSONRegion2}(Region),GeoSVGRegion=function(_super){function GeoSVGRegion2(name,elOnlyForCalculate){var _this=_super.call(this,name)||this;return _this.type="geoSVG",_this._elOnlyForCalculate=elOnlyForCalculate,_this}return __extends(GeoSVGRegion2,_super),GeoSVGRegion2.prototype.calcCenter=function(){for(var el=this._elOnlyForCalculate,rect=el.getBoundingRect(),center2=[rect.x+rect.width/2,rect.y+rect.height/2],mat=identity(TMP_TRANSFORM),target=el;target&&!target.isGeoSVGGraphicRoot;)mul(mat,target.getLocalTransform(),mat),target=target.parent;return invert(mat,mat),applyTransform$1(center2,center2,mat),center2},GeoSVGRegion2}(Region);function decodeRings(rings,encodeOffsets,encodeScale){for(var c=0;c<rings.length;c++)rings[c]=decodeRing(rings[c],encodeOffsets[c],encodeScale)}function decodeRing(coordinate,encodeOffsets,encodeScale){for(var result=[],prevX=encodeOffsets[0],prevY=encodeOffsets[1],i=0;i<coordinate.length;i+=2){var x=coordinate.charCodeAt(i)-64,y=coordinate.charCodeAt(i+1)-64;x=x>>1^-(1&x),y=y>>1^-(1&y),prevX=x+=prevX,prevY=y+=prevY,result.push([x/encodeScale,y/encodeScale])}return result}function parseGeoJSON(geoJson,nameProperty){return map$1(filter((geoJson=function(json){if(!json.UTF8Encoding)return json;var jsonCompressed=json,encodeScale=jsonCompressed.UTF8Scale;return null==encodeScale&&(encodeScale=1024),each$d(jsonCompressed.features,(function(feature){var geometry=feature.geometry,encodeOffsets=geometry.encodeOffsets,coordinates=geometry.coordinates;if(encodeOffsets)switch(geometry.type){case"LineString":geometry.coordinates=decodeRing(coordinates,encodeOffsets,encodeScale);break;case"Polygon":case"MultiLineString":decodeRings(coordinates,encodeOffsets,encodeScale);break;case"MultiPolygon":each$d(coordinates,(function(rings,idx){return decodeRings(rings,encodeOffsets[idx],encodeScale)}))}})),jsonCompressed.UTF8Encoding=!1,jsonCompressed}(geoJson)).features,(function(featureObj){return featureObj.geometry&&featureObj.properties&&featureObj.geometry.coordinates.length>0})),(function(featureObj){var properties=featureObj.properties,geo=featureObj.geometry,geometries=[];switch(geo.type){case"Polygon":var coordinates=geo.coordinates;geometries.push(new GeoJSONPolygonGeometry(coordinates[0],coordinates.slice(1)));break;case"MultiPolygon":each$d(geo.coordinates,(function(item){item[0]&&geometries.push(new GeoJSONPolygonGeometry(item[0],item.slice(1)))}));break;case"LineString":geometries.push(new GeoJSONLineStringGeometry([geo.coordinates]));break;case"MultiLineString":geometries.push(new GeoJSONLineStringGeometry(geo.coordinates))}var region=new GeoJSONRegion(properties[nameProperty||"name"],geometries,properties.cp);return region.properties=properties,region}))}const number=Object.freeze(Object.defineProperty({__proto__:null,MAX_SAFE_INTEGER:9007199254740991,asc:asc$2,getPercentWithPrecision:function(valueList,idx,precision){return valueList[idx]&&getPercentSeats(valueList,precision)[idx]||0},getPixelPrecision:getPixelPrecision,getPrecision:getPrecision,getPrecisionSafe:getPrecisionSafe,isNumeric:isNumeric,isRadianAroundZero:isRadianAroundZero,linearMap:linearMap$2,nice:nice,numericToNumber:numericToNumber,parseDate:parseDate,quantile:function(ascArr,p){var H=(ascArr.length-1)*p+1,h=Math.floor(H),v=+ascArr[h-1],e2=H-h;return e2?v+e2*(ascArr[h]-v):v},quantity:quantity,quantityExponent:quantityExponent,reformIntervals:reformIntervals,remRadian:remRadian,round:round$3},Symbol.toStringTag,{value:"Module"})),time=Object.freeze(Object.defineProperty({__proto__:null,format:format$1,parse:parseDate},Symbol.toStringTag,{value:"Module"})),graphic=Object.freeze(Object.defineProperty({__proto__:null,Arc:Arc,BezierCurve:BezierCurve,BoundingRect:BoundingRect,Circle:Circle,CompoundPath:CompoundPath,Ellipse:Ellipse,Group:Group$2,Image:ZRImage,IncrementalDisplayable:IncrementalDisplayable,Line:Line,LinearGradient:LinearGradient,Polygon:Polygon,Polyline:Polyline,RadialGradient:RadialGradient,Rect:Rect$1,Ring:Ring,Sector:Sector,Text:ZRText,clipPointsByRect:clipPointsByRect,clipRectByRect:clipRectByRect,createIcon:createIcon,extendPath:extendPath,extendShape:extendShape,getShapeClass:getShapeClass,getTransform:getTransform$1,initProps:initProps,makeImage:makeImage,makePath:makePath,mergePath:mergePath,registerShape:registerShape,resizePath:resizePath,updateProps:updateProps$1},Symbol.toStringTag,{value:"Module"})),format=Object.freeze(Object.defineProperty({__proto__:null,addCommas:addCommas,capitalFirst:function(str){return str?str.charAt(0).toUpperCase()+str.substr(1):str},encodeHTML:encodeHTML,formatTime:function(tpl,value,isUTC){"week"!==tpl&&"month"!==tpl&&"quarter"!==tpl&&"half-year"!==tpl&&"year"!==tpl||(tpl="MM-dd\nyyyy");var date=parseDate(value),getUTC=isUTC?"getUTC":"get",y=date[getUTC+"FullYear"](),M=date[getUTC+"Month"]()+1,d=date[getUTC+"Date"](),h=date[getUTC+"Hours"](),m2=date[getUTC+"Minutes"](),s=date[getUTC+"Seconds"](),S=date[getUTC+"Milliseconds"]();return tpl=tpl.replace("MM",pad(M,2)).replace("M",M).replace("yyyy",y).replace("yy",pad(y%100+"",2)).replace("dd",pad(d,2)).replace("d",d).replace("hh",pad(h,2)).replace("h",h).replace("mm",pad(m2,2)).replace("m",m2).replace("ss",pad(s,2)).replace("s",s).replace("SSS",pad(S,3))},formatTpl:formatTpl,getTextRect:function(text,font,align,verticalAlign,padding,rich,truncate,lineHeight){return new ZRText({style:{text:text,font:font,align:align,verticalAlign:verticalAlign,padding:padding,rich:rich,overflow:truncate?"truncate":null,lineHeight:lineHeight}}).getBoundingRect()},getTooltipMarker:getTooltipMarker,normalizeCssArray:normalizeCssArray,toCamelCase:toCamelCase,truncateText:function(text,containerWidth,font,ellipsis,options){var out2={};return truncateText2(out2,text,containerWidth,font,ellipsis,options),out2.text}},Symbol.toStringTag,{value:"Module"})),util=Object.freeze(Object.defineProperty({__proto__:null,bind:bind$1,clone:clone$3,curry:curry$1,defaults:defaults,each:each$d,extend:extend,filter:filter,indexOf:indexOf,inherits:inherits,isArray:isArray$1,isFunction:isFunction,isObject:isObject$3,isString:isString,map:map$1,merge:merge,reduce:reduce},Symbol.toStringTag,{value:"Module"}));var inner$9=makeInner();function tickValuesToNumbers(axis,values){var nums=map$1(values,(function(val){return axis.scale.parse(val)}));return"time"===axis.type&&nums.length>0&&(nums.sort(),nums.unshift(nums[0]),nums.push(nums[nums.length-1])),nums}function createAxisLabels(axis){var custom=axis.getLabelModel().get("customValues");if(custom){var labelFormatter_1=makeLabelFormatter(axis),extent_1=axis.scale.getExtent();return{labels:map$1(filter(tickValuesToNumbers(axis,custom),(function(val){return val>=extent_1[0]&&val<=extent_1[1]})),(function(numval){var tick={value:numval};return{formattedLabel:labelFormatter_1(tick),rawLabel:axis.scale.getLabel(tick),tickValue:numval}}))}}return"category"===axis.type?function(axis){var labelModel=axis.getLabelModel(),result=makeCategoryLabelsActually(axis,labelModel);return!labelModel.get("show")||axis.scale.isBlank()?{labels:[],labelCategoryInterval:result.labelCategoryInterval}:result}(axis):function(axis){var ticks=axis.scale.getTicks(),labelFormatter=makeLabelFormatter(axis);return{labels:map$1(ticks,(function(tick,idx){return{level:tick.level,formattedLabel:labelFormatter(tick,idx),rawLabel:axis.scale.getLabel(tick),tickValue:tick.value}}))}}(axis)}function createAxisTicks(axis,tickModel){var custom=axis.getTickModel().get("customValues");if(custom){var extent_2=axis.scale.getExtent();return{ticks:filter(tickValuesToNumbers(axis,custom),(function(val){return val>=extent_2[0]&&val<=extent_2[1]}))}}return"category"===axis.type?function(axis,tickModel){var ticks,tickCategoryInterval,ticksCache=getListCache(axis,"ticks"),optionTickInterval=getOptionCategoryInterval(tickModel),result=listCacheGet(ticksCache,optionTickInterval);if(result)return result;tickModel.get("show")&&!axis.scale.isBlank()||(ticks=[]);if(isFunction(optionTickInterval))ticks=makeLabelsByCustomizedCategoryInterval(axis,optionTickInterval,!0);else if("auto"===optionTickInterval){var labelsResult=makeCategoryLabelsActually(axis,axis.getLabelModel());tickCategoryInterval=labelsResult.labelCategoryInterval,ticks=map$1(labelsResult.labels,(function(labelItem){return labelItem.tickValue}))}else ticks=makeLabelsByNumericCategoryInterval(axis,tickCategoryInterval=optionTickInterval,!0);return listCacheSet(ticksCache,optionTickInterval,{ticks:ticks,tickCategoryInterval:tickCategoryInterval})}(axis,tickModel):{ticks:map$1(axis.scale.getTicks(),(function(tick){return tick.value}))}}function makeCategoryLabelsActually(axis,labelModel){var labels,numericLabelInterval,labelsCache=getListCache(axis,"labels"),optionLabelInterval=getOptionCategoryInterval(labelModel),result=listCacheGet(labelsCache,optionLabelInterval);return result||(isFunction(optionLabelInterval)?labels=makeLabelsByCustomizedCategoryInterval(axis,optionLabelInterval):(numericLabelInterval="auto"===optionLabelInterval?function(axis){var result=inner$9(axis).autoInterval;return null!=result?result:inner$9(axis).autoInterval=axis.calculateCategoryInterval()}(axis):optionLabelInterval,labels=makeLabelsByNumericCategoryInterval(axis,numericLabelInterval)),listCacheSet(labelsCache,optionLabelInterval,{labels:labels,labelCategoryInterval:numericLabelInterval}))}function getListCache(axis,prop){return inner$9(axis)[prop]||(inner$9(axis)[prop]=[])}function listCacheGet(cache,key){for(var i=0;i<cache.length;i++)if(cache[i].key===key)return cache[i].value}function listCacheSet(cache,key,value){return cache.push({key:key,value:value}),value}function makeLabelsByNumericCategoryInterval(axis,categoryInterval,onlyTick){var labelFormatter=makeLabelFormatter(axis),ordinalScale=axis.scale,ordinalExtent=ordinalScale.getExtent(),labelModel=axis.getLabelModel(),result=[],step=Math.max((categoryInterval||0)+1,1),startTick=ordinalExtent[0],tickCount=ordinalScale.count();0!==startTick&&step>1&&tickCount/step>2&&(startTick=Math.round(Math.ceil(startTick/step)*step));var showAllLabel=shouldShowAllLabels(axis),includeMinLabel=labelModel.get("showMinLabel")||showAllLabel,includeMaxLabel=labelModel.get("showMaxLabel")||showAllLabel;includeMinLabel&&startTick!==ordinalExtent[0]&&addItem(ordinalExtent[0]);for(var tickValue=startTick;tickValue<=ordinalExtent[1];tickValue+=step)addItem(tickValue);function addItem(tickValue2){var tickObj={value:tickValue2};result.push(onlyTick?tickValue2:{formattedLabel:labelFormatter(tickObj),rawLabel:ordinalScale.getLabel(tickObj),tickValue:tickValue2})}return includeMaxLabel&&tickValue-step!==ordinalExtent[1]&&addItem(ordinalExtent[1]),result}function makeLabelsByCustomizedCategoryInterval(axis,categoryInterval,onlyTick){var ordinalScale=axis.scale,labelFormatter=makeLabelFormatter(axis),result=[];return each$d(ordinalScale.getTicks(),(function(tick){var rawLabel=ordinalScale.getLabel(tick),tickValue=tick.value;categoryInterval(tick.value,rawLabel)&&result.push(onlyTick?tickValue:{formattedLabel:labelFormatter(tick),rawLabel:rawLabel,tickValue:tickValue})})),result}var NORMALIZED_EXTENT=[0,1],Axis=function(){function Axis2(dim,scale2,extent3){this.onBand=!1,this.inverse=!1,this.dim=dim,this.scale=scale2,this._extent=extent3||[0,0]}return Axis2.prototype.contain=function(coord){var extent3=this._extent,min3=Math.min(extent3[0],extent3[1]),max3=Math.max(extent3[0],extent3[1]);return coord>=min3&&coord<=max3},Axis2.prototype.containData=function(data){return this.scale.contain(data)},Axis2.prototype.getExtent=function(){return this._extent.slice()},Axis2.prototype.getPixelPrecision=function(dataExtent){return getPixelPrecision(dataExtent||this.scale.getExtent(),this._extent)},Axis2.prototype.setExtent=function(start2,end2){var extent3=this._extent;extent3[0]=start2,extent3[1]=end2},Axis2.prototype.dataToCoord=function(data,clamp2){var extent3=this._extent,scale2=this.scale;return data=scale2.normalize(data),this.onBand&&"ordinal"===scale2.type&&fixExtentWithBands(extent3=extent3.slice(),scale2.count()),linearMap$2(data,NORMALIZED_EXTENT,extent3,clamp2)},Axis2.prototype.coordToData=function(coord,clamp2){var extent3=this._extent,scale2=this.scale;this.onBand&&"ordinal"===scale2.type&&fixExtentWithBands(extent3=extent3.slice(),scale2.count());var t=linearMap$2(coord,extent3,NORMALIZED_EXTENT,clamp2);return this.scale.scale(t)},Axis2.prototype.pointToData=function(point,clamp2){},Axis2.prototype.getTicksCoords=function(opt){var tickModel=(opt=opt||{}).tickModel||this.getTickModel(),ticksCoords=map$1(createAxisTicks(this,tickModel).ticks,(function(tickVal){return{coord:this.dataToCoord("ordinal"===this.scale.type?this.scale.getRawOrdinalNumber(tickVal):tickVal),tickValue:tickVal}}),this);return function(axis,ticksCoords,alignWithLabel,clamp2){var ticksLen=ticksCoords.length;if(!axis.onBand||alignWithLabel||!ticksLen)return;var last,diffSize,axisExtent=axis.getExtent();if(1===ticksLen)ticksCoords[0].coord=axisExtent[0],last=ticksCoords[1]={coord:axisExtent[1],tickValue:ticksCoords[0].tickValue};else{var crossLen=ticksCoords[ticksLen-1].tickValue-ticksCoords[0].tickValue,shift_1=(ticksCoords[ticksLen-1].coord-ticksCoords[0].coord)/crossLen;each$d(ticksCoords,(function(ticksItem){ticksItem.coord-=shift_1/2}));var dataExtent=axis.scale.getExtent();diffSize=1+dataExtent[1]-ticksCoords[ticksLen-1].tickValue,last={coord:ticksCoords[ticksLen-1].coord+shift_1*diffSize,tickValue:dataExtent[1]+1},ticksCoords.push(last)}var inverse=axisExtent[0]>axisExtent[1];littleThan2(ticksCoords[0].coord,axisExtent[0])&&(clamp2?ticksCoords[0].coord=axisExtent[0]:ticksCoords.shift());clamp2&&littleThan2(axisExtent[0],ticksCoords[0].coord)&&ticksCoords.unshift({coord:axisExtent[0]});littleThan2(axisExtent[1],last.coord)&&(clamp2?last.coord=axisExtent[1]:ticksCoords.pop());clamp2&&littleThan2(last.coord,axisExtent[1])&&ticksCoords.push({coord:axisExtent[1]});function littleThan2(a,b){return a=round$3(a),b=round$3(b),inverse?a>b:a<b}}(this,ticksCoords,tickModel.get("alignWithLabel"),opt.clamp),ticksCoords},Axis2.prototype.getMinorTicksCoords=function(){if("ordinal"===this.scale.type)return[];var splitNumber=this.model.getModel("minorTick").get("splitNumber");return splitNumber>0&&splitNumber<100||(splitNumber=5),map$1(this.scale.getMinorTicks(splitNumber),(function(minorTicksGroup){return map$1(minorTicksGroup,(function(minorTick){return{coord:this.dataToCoord(minorTick),tickValue:minorTick}}),this)}),this)},Axis2.prototype.getViewLabels=function(){return createAxisLabels(this).labels},Axis2.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},Axis2.prototype.getTickModel=function(){return this.model.getModel("axisTick")},Axis2.prototype.getBandWidth=function(){var axisExtent=this._extent,dataExtent=this.scale.getExtent(),len2=dataExtent[1]-dataExtent[0]+(this.onBand?1:0);0===len2&&(len2=1);var size=Math.abs(axisExtent[1]-axisExtent[0]);return Math.abs(size)/len2},Axis2.prototype.calculateCategoryInterval=function(){return function(axis){var params=function(axis){var labelModel=axis.getLabelModel();return{axisRotate:axis.getRotate?axis.getRotate():axis.isHorizontal&&!axis.isHorizontal()?90:0,labelRotate:labelModel.get("rotate")||0,font:labelModel.getFont()}}(axis),labelFormatter=makeLabelFormatter(axis),rotation=(params.axisRotate-params.labelRotate)/180*Math.PI,ordinalScale=axis.scale,ordinalExtent=ordinalScale.getExtent(),tickCount=ordinalScale.count();if(ordinalExtent[1]-ordinalExtent[0]<1)return 0;var step=1;tickCount>40&&(step=Math.max(1,Math.floor(tickCount/40)));for(var tickValue=ordinalExtent[0],unitSpan=axis.dataToCoord(tickValue+1)-axis.dataToCoord(tickValue),unitW=Math.abs(unitSpan*Math.cos(rotation)),unitH=Math.abs(unitSpan*Math.sin(rotation)),maxW=0,maxH=0;tickValue<=ordinalExtent[1];tickValue+=step){var width,height,rect=getBoundingRect(labelFormatter({value:tickValue}),params.font,"center","top");width=1.3*rect.width,height=1.3*rect.height,maxW=Math.max(maxW,width,7),maxH=Math.max(maxH,height,7)}var dw=maxW/unitW,dh=maxH/unitH;isNaN(dw)&&(dw=Infinity),isNaN(dh)&&(dh=Infinity);var interval=Math.max(0,Math.floor(Math.min(dw,dh))),cache=inner$9(axis.model),axisExtent=axis.getExtent(),lastAutoInterval=cache.lastAutoInterval,lastTickCount=cache.lastTickCount;return null!=lastAutoInterval&&null!=lastTickCount&&Math.abs(lastAutoInterval-interval)<=1&&Math.abs(lastTickCount-tickCount)<=1&&lastAutoInterval>interval&&cache.axisExtent0===axisExtent[0]&&cache.axisExtent1===axisExtent[1]?interval=lastAutoInterval:(cache.lastTickCount=tickCount,cache.lastAutoInterval=interval,cache.axisExtent0=axisExtent[0],cache.axisExtent1=axisExtent[1]),interval}(this)},Axis2}();function fixExtentWithBands(extent3,nTick){var margin=(extent3[1]-extent3[0])/nTick/2;extent3[0]+=margin,extent3[1]-=margin}function projectPointToLine(x1,y1,x2,y2,x,y,out2,limitToEnds){var dx=x-x1,dy=y-y1,dx1=x2-x1,dy1=y2-y1,lineLen=Math.sqrt(dx1*dx1+dy1*dy1),t=(dx*(dx1/=lineLen)+dy*(dy1/=lineLen))/lineLen;t*=lineLen;var ox=out2[0]=x1+t*dx1,oy=out2[1]=y1+t*dy1;return Math.sqrt((ox-x)*(ox-x)+(oy-y)*(oy-y))}var pt0=new Point,pt1=new Point,pt2=new Point,dir=new Point,dir2=new Point,tmpArr=[],tmpProjPoint=new Point;function limitTurnAngle(linePoints,minTurnAngle){if(minTurnAngle<=180&&minTurnAngle>0){minTurnAngle=minTurnAngle/180*Math.PI,pt0.fromArray(linePoints[0]),pt1.fromArray(linePoints[1]),pt2.fromArray(linePoints[2]),Point.sub(dir,pt0,pt1),Point.sub(dir2,pt2,pt1);var len1=dir.len(),len2=dir2.len();if(!(len1<.001||len2<.001)){dir.scale(1/len1),dir2.scale(1/len2);var angleCos=dir.dot(dir2);if(Math.cos(minTurnAngle)<angleCos){var d=projectPointToLine(pt1.x,pt1.y,pt2.x,pt2.y,pt0.x,pt0.y,tmpArr);tmpProjPoint.fromArray(tmpArr),tmpProjPoint.scaleAndAdd(dir2,d/Math.tan(Math.PI-minTurnAngle));var t=pt2.x!==pt1.x?(tmpProjPoint.x-pt1.x)/(pt2.x-pt1.x):(tmpProjPoint.y-pt1.y)/(pt2.y-pt1.y);if(isNaN(t))return;t<0?Point.copy(tmpProjPoint,pt1):t>1&&Point.copy(tmpProjPoint,pt2),tmpProjPoint.toArray(linePoints[1])}}}}function limitSurfaceAngle(linePoints,surfaceNormal,maxSurfaceAngle){if(maxSurfaceAngle<=180&&maxSurfaceAngle>0){maxSurfaceAngle=maxSurfaceAngle/180*Math.PI,pt0.fromArray(linePoints[0]),pt1.fromArray(linePoints[1]),pt2.fromArray(linePoints[2]),Point.sub(dir,pt1,pt0),Point.sub(dir2,pt2,pt1);var len1=dir.len(),len2=dir2.len();if(!(len1<.001||len2<.001))if(dir.scale(1/len1),dir2.scale(1/len2),dir.dot(surfaceNormal)<Math.cos(maxSurfaceAngle)){var d=projectPointToLine(pt1.x,pt1.y,pt2.x,pt2.y,pt0.x,pt0.y,tmpArr);tmpProjPoint.fromArray(tmpArr);var HALF_PI=Math.PI/2,newAngle=HALF_PI+Math.acos(dir2.dot(surfaceNormal))-maxSurfaceAngle;if(newAngle>=HALF_PI)Point.copy(tmpProjPoint,pt2);else{tmpProjPoint.scaleAndAdd(dir2,d/Math.tan(Math.PI/2-newAngle));var t=pt2.x!==pt1.x?(tmpProjPoint.x-pt1.x)/(pt2.x-pt1.x):(tmpProjPoint.y-pt1.y)/(pt2.y-pt1.y);if(isNaN(t))return;t<0?Point.copy(tmpProjPoint,pt1):t>1&&Point.copy(tmpProjPoint,pt2)}tmpProjPoint.toArray(linePoints[1])}}}function setLabelLineState(labelLine,ignore,stateName,stateModel){var isNormal="normal"===stateName,stateObj=isNormal?labelLine:labelLine.ensureState(stateName);stateObj.ignore=ignore;var smooth=stateModel.get("smooth");smooth&&!0===smooth&&(smooth=.3),stateObj.shape=stateObj.shape||{},smooth>0&&(stateObj.shape.smooth=smooth);var styleObj=stateModel.getModel("lineStyle").getLineStyle();isNormal?labelLine.useStyle(styleObj):stateObj.style=styleObj}function buildLabelLinePath(path,shape){var smooth=shape.smooth,points2=shape.points;if(points2)if(path.moveTo(points2[0][0],points2[0][1]),smooth>0&&points2.length>=3){var len1=dist$1(points2[0],points2[1]),len2=dist$1(points2[1],points2[2]);if(!len1||!len2)return path.lineTo(points2[1][0],points2[1][1]),void path.lineTo(points2[2][0],points2[2][1]);var moveLen=Math.min(len1,len2)*smooth,midPoint0=lerp$1([],points2[1],points2[0],moveLen/len1),midPoint2=lerp$1([],points2[1],points2[2],moveLen/len2),midPoint1=lerp$1([],midPoint0,midPoint2,.5);path.bezierCurveTo(midPoint0[0],midPoint0[1],midPoint0[0],midPoint0[1],midPoint1[0],midPoint1[1]),path.bezierCurveTo(midPoint2[0],midPoint2[1],midPoint2[0],midPoint2[1],points2[2][0],points2[2][1])}else for(var i=1;i<points2.length;i++)path.lineTo(points2[i][0],points2[i][1])}function shiftLayoutOnY(list,topBound,bottomBound,balanceShift){return function(list,xyDim,sizeDim,minBound,maxBound){var len2=list.length;if(!(len2<2)){list.sort((function(a,b){return a.rect[xyDim]-b.rect[xyDim]}));for(var delta,lastPos=0,adjusted=!1,i=0;i<len2;i++){var item=list[i],rect=item.rect;(delta=rect[xyDim]-lastPos)<0&&(rect[xyDim]-=delta,item.label[xyDim]-=delta,adjusted=!0),lastPos=rect[xyDim]+rect[sizeDim]}var minGap,maxGap,first=list[0],last=list[len2-1];return updateMinMaxGap(),minGap<0&&squeezeGaps(-minGap,.8),maxGap<0&&squeezeGaps(maxGap,.8),updateMinMaxGap(),takeBoundsGap(minGap,maxGap,1),takeBoundsGap(maxGap,minGap,-1),updateMinMaxGap(),minGap<0&&squeezeWhenBailout(-minGap),maxGap<0&&squeezeWhenBailout(maxGap),adjusted}function updateMinMaxGap(){minGap=first.rect[xyDim]-minBound,maxGap=maxBound-last.rect[xyDim]-last.rect[sizeDim]}function takeBoundsGap(gapThisBound,gapOtherBound,moveDir){if(gapThisBound<0){var moveFromMaxGap=Math.min(gapOtherBound,-gapThisBound);if(moveFromMaxGap>0){shiftList(moveFromMaxGap*moveDir,0,len2);var remained=moveFromMaxGap+gapThisBound;remained<0&&squeezeGaps(-remained*moveDir,1)}else squeezeGaps(-gapThisBound*moveDir,1)}}function shiftList(delta2,start2,end2){0!==delta2&&(adjusted=!0);for(var i2=start2;i2<end2;i2++){var item2=list[i2];item2.rect[xyDim]+=delta2,item2.label[xyDim]+=delta2}}function squeezeGaps(delta2,maxSqeezePercent){for(var gaps=[],totalGaps=0,i2=1;i2<len2;i2++){var prevItemRect=list[i2-1].rect,gap=Math.max(list[i2].rect[xyDim]-prevItemRect[xyDim]-prevItemRect[sizeDim],0);gaps.push(gap),totalGaps+=gap}if(totalGaps){var squeezePercent=Math.min(Math.abs(delta2)/totalGaps,maxSqeezePercent);if(delta2>0)for(i2=0;i2<len2-1;i2++)shiftList(gaps[i2]*squeezePercent,0,i2+1);else for(i2=len2-1;i2>0;i2--)shiftList(-gaps[i2-1]*squeezePercent,i2,len2)}}function squeezeWhenBailout(delta2){var dir3=delta2<0?-1:1;delta2=Math.abs(delta2);for(var moveForEachLabel=Math.ceil(delta2/(len2-1)),i2=0;i2<len2-1;i2++)if(dir3>0?shiftList(moveForEachLabel,0,i2+1):shiftList(-moveForEachLabel,len2-i2-1,len2),(delta2-=moveForEachLabel)<=0)return}}(list,"y","height",topBound,bottomBound)}const echarts=Object.freeze(Object.defineProperty({__proto__:null,Axis:Axis,ChartView:ChartView,ComponentModel:ComponentModel,ComponentView:ComponentView,List:SeriesData,Model:Model,PRIORITY:PRIORITY,SeriesModel:SeriesModel,color:color,connect:function(groupId){if(isArray$1(groupId)){var charts=groupId;groupId=null,each$d(charts,(function(chart){null!=chart.group&&(groupId=chart.group)})),groupId=groupId||"g_"+groupIdBase++,each$d(charts,(function(chart){chart.group=groupId}))}return connectedGroups[groupId]=!0,groupId},dataTool:{},dependencies:{zrender:"5.6.1"},disConnect:disConnect,disconnect:disconnect,dispose:function(chart){isString(chart)?chart=instances[chart]:chart instanceof ECharts||(chart=getInstanceByDom(chart)),chart instanceof ECharts&&!chart.isDisposed()&&chart.dispose()},env:env,extendChartView:function(proto2){var View2=ChartView.extend(proto2);return ChartView.registerClass(View2),View2},extendComponentModel:function(proto2){var Model2=ComponentModel.extend(proto2);return ComponentModel.registerClass(Model2),Model2},extendComponentView:function(proto2){var View2=ComponentView.extend(proto2);return ComponentView.registerClass(View2),View2},extendSeriesModel:function(proto2){var Model2=SeriesModel.extend(proto2);return SeriesModel.registerClass(Model2),Model2},format:format,getCoordinateSystemDimensions:function(type){var coordSysCreator=CoordinateSystemManager.get(type);if(coordSysCreator)return coordSysCreator.getDimensionsInfo?coordSysCreator.getDimensionsInfo():coordSysCreator.dimensions.slice()},getInstanceByDom:getInstanceByDom,getInstanceById:function(key){return instances[key]},getMap:function(mapName){var getMap2=getImpl("getMap");return getMap2&&getMap2(mapName)},graphic:graphic,helper:helper,init:function(dom,theme2,opts){var isClient=!(opts&&opts.ssr);if(isClient){var existInstance=getInstanceByDom(dom);if(existInstance)return existInstance}var chart=new ECharts(dom,theme2,opts);return chart.id="ec_"+idBase++,instances[chart.id]=chart,isClient&&setAttribute(dom,DOM_ATTRIBUTE_KEY,chart.id),enableConnect(chart),lifecycle.trigger("afterinit",chart),chart},innerDrawElementOnCanvas:brushSingle,matrix:matrix,number:number,parseGeoJSON:parseGeoJSON,parseGeoJson:parseGeoJSON,registerAction:registerAction,registerCoordinateSystem:registerCoordinateSystem,registerLayout:registerLayout,registerLoading:registerLoading,registerLocale:registerLocale,registerMap:registerMap$1,registerPostInit:registerPostInit,registerPostUpdate:registerPostUpdate,registerPreprocessor:registerPreprocessor,registerProcessor:registerProcessor,registerTheme:registerTheme,registerTransform:registerTransform,registerUpdateLifecycle:registerUpdateLifecycle,registerVisual:registerVisual,setCanvasCreator:function(creator){setPlatformAPI({createCanvas:creator})},setPlatformAPI:setPlatformAPI,throttle:throttle,time:time,use:use,util:util,vector:vector,version:"5.6.0",zrUtil:util$1,zrender:zrender},Symbol.toStringTag,{value:"Module"}));var LineSeriesModel=function(_super){function LineSeriesModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=LineSeriesModel2.type,_this.hasSymbolVisual=!0,_this}return __extends(LineSeriesModel2,_super),LineSeriesModel2.prototype.getInitialData=function(option){return createSeriesData(0,this,{useEncodeDefaulter:!0})},LineSeriesModel2.prototype.getLegendIcon=function(opt){var group=new Group$2,line=createSymbol("line",0,opt.itemHeight/2,opt.itemWidth,0,opt.lineStyle.stroke,!1);group.add(line),line.setStyle(opt.lineStyle);var visualType=this.getData().getVisual("symbol"),visualRotate=this.getData().getVisual("symbolRotate"),symbolType="none"===visualType?"circle":visualType,size=.8*opt.itemHeight,symbol=createSymbol(symbolType,(opt.itemWidth-size)/2,(opt.itemHeight-size)/2,size,size,opt.itemStyle.fill);group.add(symbol),symbol.setStyle(opt.itemStyle);var symbolRotate="inherit"===opt.iconRotate?visualRotate:opt.iconRotate||0;return symbol.rotation=symbolRotate*Math.PI/180,symbol.setOrigin([opt.itemWidth/2,opt.itemHeight/2]),symbolType.indexOf("empty")>-1&&(symbol.style.stroke=symbol.style.fill,symbol.style.fill="#fff",symbol.style.lineWidth=2),group},LineSeriesModel2.type="series.line",LineSeriesModel2.dependencies=["grid","polar"],LineSeriesModel2.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:Infinity,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},LineSeriesModel2}(SeriesModel);function getDefaultLabel(data,dataIndex){var labelDims=data.mapDimensionsAll("defaultedLabel"),len2=labelDims.length;if(1===len2){var rawVal=retrieveRawValue(data,dataIndex,labelDims[0]);return null!=rawVal?rawVal+"":null}if(len2){for(var vals=[],i=0;i<labelDims.length;i++)vals.push(retrieveRawValue(data,dataIndex,labelDims[i]));return vals.join(" ")}}function getDefaultInterpolatedLabel(data,interpolatedValue){var labelDims=data.mapDimensionsAll("defaultedLabel");if(!isArray$1(interpolatedValue))return interpolatedValue+"";for(var vals=[],i=0;i<labelDims.length;i++){var dimIndex=data.getDimensionIndex(labelDims[i]);dimIndex>=0&&vals.push(interpolatedValue[dimIndex])}return vals.join(" ")}var Symbol$1=function(_super){function Symbol2(data,idx,seriesScope,opts){var _this=_super.call(this)||this;return _this.updateData(data,idx,seriesScope,opts),_this}return __extends(Symbol2,_super),Symbol2.prototype._createSymbol=function(symbolType,data,idx,symbolSize,keepAspect){this.removeAll();var symbolPath=createSymbol(symbolType,-1,-1,2,2,null,keepAspect);symbolPath.attr({z2:100,culling:!0,scaleX:symbolSize[0]/2,scaleY:symbolSize[1]/2}),symbolPath.drift=driftSymbol,this._symbolType=symbolType,this.add(symbolPath)},Symbol2.prototype.stopSymbolAnimation=function(toLastFrame){this.childAt(0).stopAnimation(null,toLastFrame)},Symbol2.prototype.getSymbolType=function(){return this._symbolType},Symbol2.prototype.getSymbolPath=function(){return this.childAt(0)},Symbol2.prototype.highlight=function(){enterEmphasis(this.childAt(0))},Symbol2.prototype.downplay=function(){leaveEmphasis(this.childAt(0))},Symbol2.prototype.setZ=function(zlevel,z){var symbolPath=this.childAt(0);symbolPath.zlevel=zlevel,symbolPath.z=z},Symbol2.prototype.setDraggable=function(draggable,hasCursorOption){var symbolPath=this.childAt(0);symbolPath.draggable=draggable,symbolPath.cursor=!hasCursorOption&&draggable?"move":symbolPath.cursor},Symbol2.prototype.updateData=function(data,idx,seriesScope,opts){this.silent=!1;var symbolType=data.getItemVisual(idx,"symbol")||"circle",seriesModel=data.hostModel,symbolSize=Symbol2.getSymbolSize(data,idx),isInit=symbolType!==this._symbolType,disableAnimation=opts&&opts.disableAnimation;if(isInit){var keepAspect=data.getItemVisual(idx,"symbolKeepAspect");this._createSymbol(symbolType,data,idx,symbolSize,keepAspect)}else{(symbolPath=this.childAt(0)).silent=!1;var target={scaleX:symbolSize[0]/2,scaleY:symbolSize[1]/2};disableAnimation?symbolPath.attr(target):updateProps$1(symbolPath,target,seriesModel,idx),saveOldStyle(symbolPath)}if(this._updateCommon(data,idx,symbolSize,seriesScope,opts),isInit){var symbolPath=this.childAt(0);if(!disableAnimation){target={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:symbolPath.style.opacity}};symbolPath.scaleX=symbolPath.scaleY=0,symbolPath.style.opacity=0,initProps(symbolPath,target,seriesModel,idx)}}disableAnimation&&this.childAt(0).stopAnimation("leave")},Symbol2.prototype._updateCommon=function(data,idx,symbolSize,seriesScope,opts){var emphasisItemStyle,blurItemStyle,selectItemStyle,focus,blurScope,emphasisDisabled,labelStatesModels,hoverScale,cursorStyle,symbolPath=this.childAt(0),seriesModel=data.hostModel;if(seriesScope&&(emphasisItemStyle=seriesScope.emphasisItemStyle,blurItemStyle=seriesScope.blurItemStyle,selectItemStyle=seriesScope.selectItemStyle,focus=seriesScope.focus,blurScope=seriesScope.blurScope,labelStatesModels=seriesScope.labelStatesModels,hoverScale=seriesScope.hoverScale,cursorStyle=seriesScope.cursorStyle,emphasisDisabled=seriesScope.emphasisDisabled),!seriesScope||data.hasItemOption){var itemModel=seriesScope&&seriesScope.itemModel?seriesScope.itemModel:data.getItemModel(idx),emphasisModel=itemModel.getModel("emphasis");emphasisItemStyle=emphasisModel.getModel("itemStyle").getItemStyle(),selectItemStyle=itemModel.getModel(["select","itemStyle"]).getItemStyle(),blurItemStyle=itemModel.getModel(["blur","itemStyle"]).getItemStyle(),focus=emphasisModel.get("focus"),blurScope=emphasisModel.get("blurScope"),emphasisDisabled=emphasisModel.get("disabled"),labelStatesModels=getLabelStatesModels(itemModel),hoverScale=emphasisModel.getShallow("scale"),cursorStyle=itemModel.getShallow("cursor")}var symbolRotate=data.getItemVisual(idx,"symbolRotate");symbolPath.attr("rotation",(symbolRotate||0)*Math.PI/180||0);var symbolOffset=normalizeSymbolOffset(data.getItemVisual(idx,"symbolOffset"),symbolSize);symbolOffset&&(symbolPath.x=symbolOffset[0],symbolPath.y=symbolOffset[1]),cursorStyle&&symbolPath.attr("cursor",cursorStyle);var symbolStyle=data.getItemVisual(idx,"style"),visualColor=symbolStyle.fill;if(symbolPath instanceof ZRImage){var pathStyle=symbolPath.style;symbolPath.useStyle(extend({image:pathStyle.image,x:pathStyle.x,y:pathStyle.y,width:pathStyle.width,height:pathStyle.height},symbolStyle))}else symbolPath.__isEmptyBrush?symbolPath.useStyle(extend({},symbolStyle)):symbolPath.useStyle(symbolStyle),symbolPath.style.decal=null,symbolPath.setColor(visualColor,opts&&opts.symbolInnerColor),symbolPath.style.strokeNoScale=!0;var liftZ=data.getItemVisual(idx,"liftZ"),z2Origin=this._z2;null!=liftZ?null==z2Origin&&(this._z2=symbolPath.z2,symbolPath.z2+=liftZ):null!=z2Origin&&(symbolPath.z2=z2Origin,this._z2=null);var useNameLabel=opts&&opts.useNameLabel;setLabelStyle(symbolPath,labelStatesModels,{labelFetcher:seriesModel,labelDataIndex:idx,defaultText:function(idx2){return useNameLabel?data.getName(idx2):getDefaultLabel(data,idx2)},inheritColor:visualColor,defaultOpacity:symbolStyle.opacity}),this._sizeX=symbolSize[0]/2,this._sizeY=symbolSize[1]/2;var emphasisState=symbolPath.ensureState("emphasis");emphasisState.style=emphasisItemStyle,symbolPath.ensureState("select").style=selectItemStyle,symbolPath.ensureState("blur").style=blurItemStyle;var scaleRatio=null==hoverScale||!0===hoverScale?Math.max(1.1,3/this._sizeY):isFinite(hoverScale)&&hoverScale>0?+hoverScale:1;emphasisState.scaleX=this._sizeX*scaleRatio,emphasisState.scaleY=this._sizeY*scaleRatio,this.setSymbolScale(1),toggleHoverEmphasis(this,focus,blurScope,emphasisDisabled)},Symbol2.prototype.setSymbolScale=function(scale2){this.scaleX=this.scaleY=scale2},Symbol2.prototype.fadeOut=function(cb,seriesModel,opt){var symbolPath=this.childAt(0),dataIndex=getECData(this).dataIndex,animationOpt=opt&&opt.animation;if(this.silent=symbolPath.silent=!0,opt&&opt.fadeLabel){var textContent=symbolPath.getTextContent();textContent&&removeElement(textContent,{style:{opacity:0}},seriesModel,{dataIndex:dataIndex,removeOpt:animationOpt,cb:function(){symbolPath.removeTextContent()}})}else symbolPath.removeTextContent();removeElement(symbolPath,{style:{opacity:0},scaleX:0,scaleY:0},seriesModel,{dataIndex:dataIndex,cb:cb,removeOpt:animationOpt})},Symbol2.getSymbolSize=function(data,idx){return normalizeSymbolSize(data.getItemVisual(idx,"symbolSize"))},Symbol2}(Group$2);function driftSymbol(dx,dy){this.parent.drift(dx,dy)}function symbolNeedsDraw(data,point,idx,opt){return point&&!isNaN(point[0])&&!isNaN(point[1])&&!(opt.isIgnore&&opt.isIgnore(idx))&&!(opt.clipShape&&!opt.clipShape.contain(point[0],point[1]))&&"none"!==data.getItemVisual(idx,"symbol")}function normalizeUpdateOpt(opt){return null==opt||isObject$3(opt)||(opt={isIgnore:opt}),opt||{}}function makeSeriesScope(data){var seriesModel=data.hostModel,emphasisModel=seriesModel.getModel("emphasis");return{emphasisItemStyle:emphasisModel.getModel("itemStyle").getItemStyle(),blurItemStyle:seriesModel.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:seriesModel.getModel(["select","itemStyle"]).getItemStyle(),focus:emphasisModel.get("focus"),blurScope:emphasisModel.get("blurScope"),emphasisDisabled:emphasisModel.get("disabled"),hoverScale:emphasisModel.get("scale"),labelStatesModels:getLabelStatesModels(seriesModel),cursorStyle:seriesModel.get("cursor")}}var SymbolDraw=function(){function SymbolDraw2(SymbolCtor){this.group=new Group$2,this._SymbolCtor=SymbolCtor||Symbol$1}return SymbolDraw2.prototype.updateData=function(data,opt){this._progressiveEls=null,opt=normalizeUpdateOpt(opt);var group=this.group,seriesModel=data.hostModel,oldData=this._data,SymbolCtor=this._SymbolCtor,disableAnimation=opt.disableAnimation,seriesScope=makeSeriesScope(data),symbolUpdateOpt={disableAnimation:disableAnimation},getSymbolPoint=opt.getSymbolPoint||function(idx){return data.getItemLayout(idx)};oldData||group.removeAll(),data.diff(oldData).add((function(newIdx){var point=getSymbolPoint(newIdx);if(symbolNeedsDraw(data,point,newIdx,opt)){var symbolEl=new SymbolCtor(data,newIdx,seriesScope,symbolUpdateOpt);symbolEl.setPosition(point),data.setItemGraphicEl(newIdx,symbolEl),group.add(symbolEl)}})).update((function(newIdx,oldIdx){var symbolEl=oldData.getItemGraphicEl(oldIdx),point=getSymbolPoint(newIdx);if(symbolNeedsDraw(data,point,newIdx,opt)){var newSymbolType=data.getItemVisual(newIdx,"symbol")||"circle",oldSymbolType=symbolEl&&symbolEl.getSymbolType&&symbolEl.getSymbolType();if(!symbolEl||oldSymbolType&&oldSymbolType!==newSymbolType)group.remove(symbolEl),(symbolEl=new SymbolCtor(data,newIdx,seriesScope,symbolUpdateOpt)).setPosition(point);else{symbolEl.updateData(data,newIdx,seriesScope,symbolUpdateOpt);var target={x:point[0],y:point[1]};disableAnimation?symbolEl.attr(target):updateProps$1(symbolEl,target,seriesModel)}group.add(symbolEl),data.setItemGraphicEl(newIdx,symbolEl)}else group.remove(symbolEl)})).remove((function(oldIdx){var el=oldData.getItemGraphicEl(oldIdx);el&&el.fadeOut((function(){group.remove(el)}),seriesModel)})).execute(),this._getSymbolPoint=getSymbolPoint,this._data=data},SymbolDraw2.prototype.updateLayout=function(){var _this=this,data=this._data;data&&data.eachItemGraphicEl((function(el,idx){var point=_this._getSymbolPoint(idx);el.setPosition(point),el.markRedraw()}))},SymbolDraw2.prototype.incrementalPrepareUpdate=function(data){this._seriesScope=makeSeriesScope(data),this._data=null,this.group.removeAll()},SymbolDraw2.prototype.incrementalUpdate=function(taskParams,data,opt){function updateIncrementalAndHover(el2){el2.isGroup||(el2.incremental=!0,el2.ensureState("emphasis").hoverLayer=!0)}this._progressiveEls=[],opt=normalizeUpdateOpt(opt);for(var idx=taskParams.start;idx<taskParams.end;idx++){var point=data.getItemLayout(idx);if(symbolNeedsDraw(data,point,idx,opt)){var el=new this._SymbolCtor(data,idx,this._seriesScope);el.traverse(updateIncrementalAndHover),el.setPosition(point),this.group.add(el),data.setItemGraphicEl(idx,el),this._progressiveEls.push(el)}}},SymbolDraw2.prototype.eachRendered=function(cb){traverseElements(this._progressiveEls||this.group,cb)},SymbolDraw2.prototype.remove=function(enableAnimation){var group=this.group,data=this._data;data&&enableAnimation?data.eachItemGraphicEl((function(el){el.fadeOut((function(){group.remove(el)}),data.hostModel)})):group.removeAll()},SymbolDraw2}();function prepareDataCoordInfo(coordSys,data,valueOrigin){var baseAxis=coordSys.getBaseAxis(),valueAxis2=coordSys.getOtherAxis(baseAxis),valueStart=function(valueAxis2,valueOrigin){var valueStart=0,extent3=valueAxis2.scale.getExtent();"start"===valueOrigin?valueStart=extent3[0]:"end"===valueOrigin?valueStart=extent3[1]:isNumber(valueOrigin)&&!isNaN(valueOrigin)?valueStart=valueOrigin:extent3[0]>0?valueStart=extent3[0]:extent3[1]<0&&(valueStart=extent3[1]);return valueStart}(valueAxis2,valueOrigin),baseAxisDim=baseAxis.dim,valueAxisDim=valueAxis2.dim,valueDim=data.mapDimension(valueAxisDim),baseDim=data.mapDimension(baseAxisDim),baseDataOffset="x"===valueAxisDim||"radius"===valueAxisDim?1:0,dims=map$1(coordSys.dimensions,(function(coordDim){return data.mapDimension(coordDim)})),stacked=!1,stackResultDim=data.getCalculationInfo("stackResultDimension");return isDimensionStacked(data,dims[0])&&(stacked=!0,dims[0]=stackResultDim),isDimensionStacked(data,dims[1])&&(stacked=!0,dims[1]=stackResultDim),{dataDimsForPoint:dims,valueStart:valueStart,valueAxisDim:valueAxisDim,baseAxisDim:baseAxisDim,stacked:!!stacked,valueDim:valueDim,baseDim:baseDim,baseDataOffset:baseDataOffset,stackedOverDimension:data.getCalculationInfo("stackedOverDimension")}}function getStackedOnPoint(dataCoordInfo,coordSys,data,idx){var value=NaN;dataCoordInfo.stacked&&(value=data.get(data.getCalculationInfo("stackedOverDimension"),idx)),isNaN(value)&&(value=dataCoordInfo.valueStart);var baseDataOffset=dataCoordInfo.baseDataOffset,stackedData=[];return stackedData[baseDataOffset]=data.get(dataCoordInfo.baseDim,idx),stackedData[1-baseDataOffset]=value,coordSys.dataToPoint(stackedData)}var mathMin$4=Math.min,mathMax$4=Math.max;function isPointNull$1(x,y){return isNaN(x)||isNaN(y)}function drawSegment(ctx,points2,start2,segLen,allLen,dir3,smooth,smoothMonotone,connectNulls){for(var prevX,prevY,cpx0,cpy0,cpx1,cpy1,idx=start2,k=0;k<segLen;k++){var x=points2[2*idx],y=points2[2*idx+1];if(idx>=allLen||idx<0)break;if(isPointNull$1(x,y)){if(connectNulls){idx+=dir3;continue}break}if(idx===start2)ctx[dir3>0?"moveTo":"lineTo"](x,y),cpx0=x,cpy0=y;else{var dx=x-prevX,dy=y-prevY;if(dx*dx+dy*dy<.5){idx+=dir3;continue}if(smooth>0){for(var nextIdx=idx+dir3,nextX=points2[2*nextIdx],nextY=points2[2*nextIdx+1];nextX===x&&nextY===y&&k<segLen;)k++,idx+=dir3,nextX=points2[2*(nextIdx+=dir3)],nextY=points2[2*nextIdx+1],dx=(x=points2[2*idx])-prevX,dy=(y=points2[2*idx+1])-prevY;var tmpK=k+1;if(connectNulls)for(;isPointNull$1(nextX,nextY)&&tmpK<segLen;)tmpK++,nextX=points2[2*(nextIdx+=dir3)],nextY=points2[2*nextIdx+1];var ratioNextSeg=.5,vx=0,vy=0,nextCpx0=void 0,nextCpy0=void 0;if(tmpK>=segLen||isPointNull$1(nextX,nextY))cpx1=x,cpy1=y;else{vx=nextX-prevX,vy=nextY-prevY;var dx0=x-prevX,dx1=nextX-x,dy0=y-prevY,dy1=nextY-y,lenPrevSeg=void 0,lenNextSeg=void 0;if("x"===smoothMonotone){var dir_1=vx>0?1:-1;cpx1=x-dir_1*(lenPrevSeg=Math.abs(dx0))*smooth,cpy1=y,nextCpx0=x+dir_1*(lenNextSeg=Math.abs(dx1))*smooth,nextCpy0=y}else if("y"===smoothMonotone){var dir_2=vy>0?1:-1;cpx1=x,cpy1=y-dir_2*(lenPrevSeg=Math.abs(dy0))*smooth,nextCpx0=x,nextCpy0=y+dir_2*(lenNextSeg=Math.abs(dy1))*smooth}else lenPrevSeg=Math.sqrt(dx0*dx0+dy0*dy0),cpx1=x-vx*smooth*(1-(ratioNextSeg=(lenNextSeg=Math.sqrt(dx1*dx1+dy1*dy1))/(lenNextSeg+lenPrevSeg))),cpy1=y-vy*smooth*(1-ratioNextSeg),nextCpy0=y+vy*smooth*ratioNextSeg,nextCpx0=mathMin$4(nextCpx0=x+vx*smooth*ratioNextSeg,mathMax$4(nextX,x)),nextCpy0=mathMin$4(nextCpy0,mathMax$4(nextY,y)),nextCpx0=mathMax$4(nextCpx0,mathMin$4(nextX,x)),cpy1=y-(vy=(nextCpy0=mathMax$4(nextCpy0,mathMin$4(nextY,y)))-y)*lenPrevSeg/lenNextSeg,cpx1=mathMin$4(cpx1=x-(vx=nextCpx0-x)*lenPrevSeg/lenNextSeg,mathMax$4(prevX,x)),cpy1=mathMin$4(cpy1,mathMax$4(prevY,y)),nextCpx0=x+(vx=x-(cpx1=mathMax$4(cpx1,mathMin$4(prevX,x))))*lenNextSeg/lenPrevSeg,nextCpy0=y+(vy=y-(cpy1=mathMax$4(cpy1,mathMin$4(prevY,y))))*lenNextSeg/lenPrevSeg}ctx.bezierCurveTo(cpx0,cpy0,cpx1,cpy1,x,y),cpx0=nextCpx0,cpy0=nextCpy0}else ctx.lineTo(x,y)}prevX=x,prevY=y,idx+=dir3}return k}var ECPolylineShape=function(){return function(){this.smooth=0,this.smoothConstraint=!0}}(),ECPolyline=function(_super){function ECPolyline2(opts){var _this=_super.call(this,opts)||this;return _this.type="ec-polyline",_this}return __extends(ECPolyline2,_super),ECPolyline2.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},ECPolyline2.prototype.getDefaultShape=function(){return new ECPolylineShape},ECPolyline2.prototype.buildPath=function(ctx,shape){var points2=shape.points,i=0,len2=points2.length/2;if(shape.connectNulls){for(;len2>0&&isPointNull$1(points2[2*len2-2],points2[2*len2-1]);len2--);for(;i<len2&&isPointNull$1(points2[2*i],points2[2*i+1]);i++);}for(;i<len2;)i+=drawSegment(ctx,points2,i,len2,len2,1,shape.smooth,shape.smoothMonotone,shape.connectNulls)+1},ECPolyline2.prototype.getPointOn=function(xOrY,dim){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var x0,y0,data=this.path.data,CMD2=PathProxy.CMD,isDimX="x"===dim,roots2=[],i=0;i<data.length;){var x=void 0,y=void 0,x2=void 0,y2=void 0,x3=void 0,y3=void 0,t=void 0;switch(data[i++]){case CMD2.M:x0=data[i++],y0=data[i++];break;case CMD2.L:if(x=data[i++],y=data[i++],(t=isDimX?(xOrY-x0)/(x-x0):(xOrY-y0)/(y-y0))<=1&&t>=0){var val=isDimX?(y-y0)*t+y0:(x-x0)*t+x0;return isDimX?[xOrY,val]:[val,xOrY]}x0=x,y0=y;break;case CMD2.C:x=data[i++],y=data[i++],x2=data[i++],y2=data[i++],x3=data[i++],y3=data[i++];var nRoot=isDimX?cubicRootAt(x0,x,x2,x3,xOrY,roots2):cubicRootAt(y0,y,y2,y3,xOrY,roots2);if(nRoot>0)for(var i_1=0;i_1<nRoot;i_1++){var t_1=roots2[i_1];if(t_1<=1&&t_1>=0){val=isDimX?cubicAt(y0,y,y2,y3,t_1):cubicAt(x0,x,x2,x3,t_1);return isDimX?[xOrY,val]:[val,xOrY]}}x0=x3,y0=y3}}},ECPolyline2}(Path),ECPolygonShape=function(_super){function ECPolygonShape2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ECPolygonShape2,_super),ECPolygonShape2}(ECPolylineShape),ECPolygon=function(_super){function ECPolygon2(opts){var _this=_super.call(this,opts)||this;return _this.type="ec-polygon",_this}return __extends(ECPolygon2,_super),ECPolygon2.prototype.getDefaultShape=function(){return new ECPolygonShape},ECPolygon2.prototype.buildPath=function(ctx,shape){var points2=shape.points,stackedOnPoints=shape.stackedOnPoints,i=0,len2=points2.length/2,smoothMonotone=shape.smoothMonotone;if(shape.connectNulls){for(;len2>0&&isPointNull$1(points2[2*len2-2],points2[2*len2-1]);len2--);for(;i<len2&&isPointNull$1(points2[2*i],points2[2*i+1]);i++);}for(;i<len2;){var k=drawSegment(ctx,points2,i,len2,len2,1,shape.smooth,smoothMonotone,shape.connectNulls);drawSegment(ctx,stackedOnPoints,i+k-1,k,len2,-1,shape.stackedOnSmooth,smoothMonotone,shape.connectNulls),i+=k+1,ctx.closePath()}},ECPolygon2}(Path);function createGridClipPath(cartesian,hasAnimation,seriesModel,done,during){var rect=cartesian.getArea(),x=rect.x,y=rect.y,width=rect.width,height=rect.height,lineWidth=seriesModel.get(["lineStyle","width"])||0;x-=lineWidth/2,y-=lineWidth/2,width+=lineWidth,height+=lineWidth,width=Math.ceil(width),x!==Math.floor(x)&&(x=Math.floor(x),width++);var clipPath=new Rect$1({shape:{x:x,y:y,width:width,height:height}});if(hasAnimation){var baseAxis=cartesian.getBaseAxis(),isHorizontal=baseAxis.isHorizontal(),isAxisInversed=baseAxis.inverse;isHorizontal?(isAxisInversed&&(clipPath.shape.x+=width),clipPath.shape.width=0):(isAxisInversed||(clipPath.shape.y+=height),clipPath.shape.height=0);var duringCb=isFunction(during)?function(percent){during(percent,clipPath)}:null;initProps(clipPath,{shape:{width:width,height:height,x:x,y:y}},seriesModel,null,done,duringCb)}return clipPath}function createPolarClipPath(polar,hasAnimation,seriesModel){var sectorArea=polar.getArea(),r0=round$3(sectorArea.r0,1),r=round$3(sectorArea.r,1),clipPath=new Sector({shape:{cx:round$3(polar.cx,1),cy:round$3(polar.cy,1),r0:r0,r:r,startAngle:sectorArea.startAngle,endAngle:sectorArea.endAngle,clockwise:sectorArea.clockwise}});hasAnimation&&("angle"===polar.getBaseAxis().dim?clipPath.shape.endAngle=sectorArea.startAngle:clipPath.shape.r=r0,initProps(clipPath,{shape:{endAngle:sectorArea.endAngle,r:r}},seriesModel));return clipPath}function createClipPath(coordSys,hasAnimation,seriesModel,done,during){return coordSys?"polar"===coordSys.type?createPolarClipPath(coordSys,hasAnimation,seriesModel):"cartesian2d"===coordSys.type?createGridClipPath(coordSys,hasAnimation,seriesModel,done,during):null:null}function isCoordinateSystemType(coordSys,type){return coordSys.type===type}function isPointsSame(points1,points2){if(points1.length===points2.length){for(var i=0;i<points1.length;i++)if(points1[i]!==points2[i])return;return!0}}function bboxFromPoints(points2){for(var minX=Infinity,minY=Infinity,maxX=-Infinity,maxY=-Infinity,i=0;i<points2.length;){var x=points2[i++],y=points2[i++];isNaN(x)||(minX=Math.min(x,minX),maxX=Math.max(x,maxX)),isNaN(y)||(minY=Math.min(y,minY),maxY=Math.max(y,maxY))}return[[minX,minY],[maxX,maxY]]}function getBoundingDiff(points1,points2){var _a2=bboxFromPoints(points1),min1=_a2[0],max1=_a2[1],_b2=bboxFromPoints(points2),min22=_b2[0],max22=_b2[1];return Math.max(Math.abs(min1[0]-min22[0]),Math.abs(min1[1]-min22[1]),Math.abs(max1[0]-max22[0]),Math.abs(max1[1]-max22[1]))}function getSmooth(smooth){return isNumber(smooth)?smooth:smooth?.5:0}function turnPointsIntoStep(points2,basePoints,coordSys,stepTurnAt,connectNulls){var baseAxis=coordSys.getBaseAxis(),baseIndex="x"===baseAxis.dim||"radius"===baseAxis.dim?0:1,stepPoints=[],i=0,stepPt=[],pt=[],nextPt=[],filteredPoints=[];if(connectNulls){for(i=0;i<points2.length;i+=2){var reference=basePoints||points2;isNaN(reference[i])||isNaN(reference[i+1])||filteredPoints.push(points2[i],points2[i+1])}points2=filteredPoints}for(i=0;i<points2.length-2;i+=2)switch(nextPt[0]=points2[i+2],nextPt[1]=points2[i+3],pt[0]=points2[i],pt[1]=points2[i+1],stepPoints.push(pt[0],pt[1]),stepTurnAt){case"end":stepPt[baseIndex]=nextPt[baseIndex],stepPt[1-baseIndex]=pt[1-baseIndex],stepPoints.push(stepPt[0],stepPt[1]);break;case"middle":var middle=(pt[baseIndex]+nextPt[baseIndex])/2,stepPt2=[];stepPt[baseIndex]=stepPt2[baseIndex]=middle,stepPt[1-baseIndex]=pt[1-baseIndex],stepPt2[1-baseIndex]=nextPt[1-baseIndex],stepPoints.push(stepPt[0],stepPt[1]),stepPoints.push(stepPt2[0],stepPt2[1]);break;default:stepPt[baseIndex]=pt[baseIndex],stepPt[1-baseIndex]=nextPt[1-baseIndex],stepPoints.push(stepPt[0],stepPt[1])}return stepPoints.push(points2[i++],points2[i++]),stepPoints}function getVisualGradient(data,coordSys,api){var visualMetaList=data.getVisual("visualMeta");if(visualMetaList&&visualMetaList.length&&data.count()&&"cartesian2d"===coordSys.type){for(var coordDim,visualMeta,i=visualMetaList.length-1;i>=0;i--){var dimInfo=data.getDimensionInfo(visualMetaList[i].dimension);if("x"===(coordDim=dimInfo&&dimInfo.coordDim)||"y"===coordDim){visualMeta=visualMetaList[i];break}}if(visualMeta){var axis=coordSys.getAxis(coordDim),colorStops=map$1(visualMeta.stops,(function(stop2){return{coord:axis.toGlobalCoord(axis.dataToCoord(stop2.value)),color:stop2.color}})),stopLen=colorStops.length,outerColors=visualMeta.outerColors.slice();stopLen&&colorStops[0].coord>colorStops[stopLen-1].coord&&(colorStops.reverse(),outerColors.reverse());var colorStopsInRange=function(colorStops,maxSize){var prevOutOfRangeColorStop,prevInRangeColorStop,newColorStops=[],len2=colorStops.length;function lerpStop(stop0,stop1,clippedCoord){var coord0=stop0.coord;return{coord:clippedCoord,color:lerp((clippedCoord-coord0)/(stop1.coord-coord0),[stop0.color,stop1.color])}}for(var i=0;i<len2;i++){var stop_1=colorStops[i],coord=stop_1.coord;if(coord<0)prevOutOfRangeColorStop=stop_1;else{if(coord>maxSize){prevInRangeColorStop?newColorStops.push(lerpStop(prevInRangeColorStop,stop_1,maxSize)):prevOutOfRangeColorStop&&newColorStops.push(lerpStop(prevOutOfRangeColorStop,stop_1,0),lerpStop(prevOutOfRangeColorStop,stop_1,maxSize));break}prevOutOfRangeColorStop&&(newColorStops.push(lerpStop(prevOutOfRangeColorStop,stop_1,0)),prevOutOfRangeColorStop=null),newColorStops.push(stop_1),prevInRangeColorStop=stop_1}}return newColorStops}(colorStops,"x"===coordDim?api.getWidth():api.getHeight()),inRangeStopLen=colorStopsInRange.length;if(!inRangeStopLen&&stopLen)return colorStops[0].coord<0?outerColors[1]?outerColors[1]:colorStops[stopLen-1].color:outerColors[0]?outerColors[0]:colorStops[0].color;var minCoord=colorStopsInRange[0].coord-10,maxCoord=colorStopsInRange[inRangeStopLen-1].coord+10,coordSpan=maxCoord-minCoord;if(coordSpan<.001)return"transparent";each$d(colorStopsInRange,(function(stop2){stop2.offset=(stop2.coord-minCoord)/coordSpan})),colorStopsInRange.push({offset:inRangeStopLen?colorStopsInRange[inRangeStopLen-1].offset:.5,color:outerColors[1]||"transparent"}),colorStopsInRange.unshift({offset:inRangeStopLen?colorStopsInRange[0].offset:.5,color:outerColors[0]||"transparent"});var gradient=new LinearGradient(0,0,0,0,colorStopsInRange,!0);return gradient[coordDim]=minCoord,gradient[coordDim+"2"]=maxCoord,gradient}}}function getIsIgnoreFunc(seriesModel,data,coordSys){var showAllSymbol=seriesModel.get("showAllSymbol"),isAuto="auto"===showAllSymbol;if(!showAllSymbol||isAuto){var categoryAxis2=coordSys.getAxesByScale("ordinal")[0];if(categoryAxis2&&(!isAuto||!function(categoryAxis2,data){var axisExtent=categoryAxis2.getExtent(),availSize=Math.abs(axisExtent[1]-axisExtent[0])/categoryAxis2.scale.count();isNaN(availSize)&&(availSize=0);for(var dataLen=data.count(),step=Math.max(1,Math.round(dataLen/5)),dataIndex=0;dataIndex<dataLen;dataIndex+=step)if(1.5*Symbol$1.getSymbolSize(data,dataIndex)[categoryAxis2.isHorizontal()?1:0]>availSize)return!1;return!0}(categoryAxis2,data))){var categoryDataDim=data.mapDimension(categoryAxis2.dim),labelMap={};return each$d(categoryAxis2.getViewLabels(),(function(labelItem){var ordinalNumber=categoryAxis2.scale.getRawOrdinalNumber(labelItem.tickValue);labelMap[ordinalNumber]=1})),function(dataIndex){return!labelMap.hasOwnProperty(data.get(categoryDataDim,dataIndex))}}}}function getPointAtIndex(points2,idx){return[points2[2*idx],points2[2*idx+1]]}function anyStateShowEndLabel(seriesModel){if(seriesModel.get(["endLabel","show"]))return!0;for(var i=0;i<SPECIAL_STATES.length;i++)if(seriesModel.get([SPECIAL_STATES[i],"endLabel","show"]))return!0;return!1}function createLineClipPath(lineView,coordSys,hasAnimation,seriesModel){if(isCoordinateSystemType(coordSys,"cartesian2d")){var endLabelModel_1=seriesModel.getModel("endLabel"),valueAnimation_1=endLabelModel_1.get("valueAnimation"),data_1=seriesModel.getData(),labelAnimationRecord_1={lastFrameIndex:0},during=anyStateShowEndLabel(seriesModel)?function(percent,clipRect){lineView._endLabelOnDuring(percent,clipRect,data_1,labelAnimationRecord_1,valueAnimation_1,endLabelModel_1,coordSys)}:null,isHorizontal=coordSys.getBaseAxis().isHorizontal(),clipPath=createGridClipPath(coordSys,hasAnimation,seriesModel,(function(){var endLabel=lineView._endLabel;endLabel&&hasAnimation&&null!=labelAnimationRecord_1.originalX&&endLabel.attr({x:labelAnimationRecord_1.originalX,y:labelAnimationRecord_1.originalY})}),during);if(!seriesModel.get("clip",!0)){var rectShape=clipPath.shape,expandSize=Math.max(rectShape.width,rectShape.height);isHorizontal?(rectShape.y-=expandSize,rectShape.height+=2*expandSize):(rectShape.x-=expandSize,rectShape.width+=2*expandSize)}return during&&during(1,clipPath),clipPath}return createPolarClipPath(coordSys,hasAnimation,seriesModel)}var LineView=function(_super){function LineView2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(LineView2,_super),LineView2.prototype.init=function(){var lineGroup=new Group$2,symbolDraw=new SymbolDraw;this.group.add(symbolDraw.group),this._symbolDraw=symbolDraw,this._lineGroup=lineGroup,this._changePolyState=bind$1(this._changePolyState,this)},LineView2.prototype.render=function(seriesModel,ecModel,api){var coordSys=seriesModel.coordinateSystem,group=this.group,data=seriesModel.getData(),lineStyleModel=seriesModel.getModel("lineStyle"),areaStyleModel=seriesModel.getModel("areaStyle"),points2=data.getLayout("points")||[],isCoordSysPolar="polar"===coordSys.type,prevCoordSys=this._coordSys,symbolDraw=this._symbolDraw,polyline=this._polyline,polygon=this._polygon,lineGroup=this._lineGroup,hasAnimation=!ecModel.ssr&&seriesModel.get("animation"),isAreaChart=!areaStyleModel.isEmpty(),valueOrigin=areaStyleModel.get("origin"),dataCoordInfo=prepareDataCoordInfo(coordSys,data,valueOrigin),stackedOnPoints=isAreaChart&&function(coordSys,data,dataCoordInfo){if(!dataCoordInfo.valueDim)return[];for(var len2=data.count(),points2=createFloat32Array(2*len2),idx=0;idx<len2;idx++){var pt=getStackedOnPoint(dataCoordInfo,coordSys,data,idx);points2[2*idx]=pt[0],points2[2*idx+1]=pt[1]}return points2}(coordSys,data,dataCoordInfo),showSymbol=seriesModel.get("showSymbol"),connectNulls=seriesModel.get("connectNulls"),isIgnoreFunc=showSymbol&&!isCoordSysPolar&&getIsIgnoreFunc(seriesModel,data,coordSys),oldData=this._data;oldData&&oldData.eachItemGraphicEl((function(el,idx){el.__temp&&(group.remove(el),oldData.setItemGraphicEl(idx,null))})),showSymbol||symbolDraw.remove(),group.add(lineGroup);var clipShapeForSymbol,step=!isCoordSysPolar&&seriesModel.get("step");coordSys&&coordSys.getArea&&seriesModel.get("clip",!0)&&(null!=(clipShapeForSymbol=coordSys.getArea()).width?(clipShapeForSymbol.x-=.1,clipShapeForSymbol.y-=.1,clipShapeForSymbol.width+=.2,clipShapeForSymbol.height+=.2):clipShapeForSymbol.r0&&(clipShapeForSymbol.r0-=.5,clipShapeForSymbol.r+=.5)),this._clipShapeForSymbol=clipShapeForSymbol;var visualColor=getVisualGradient(data,coordSys,api)||data.getVisual("style")[data.getVisual("drawType")];if(polyline&&prevCoordSys.type===coordSys.type&&step===this._step){isAreaChart&&!polygon?polygon=this._newPolygon(points2,stackedOnPoints):polygon&&!isAreaChart&&(lineGroup.remove(polygon),polygon=this._polygon=null),isCoordSysPolar||this._initOrUpdateEndLabel(seriesModel,coordSys,convertToColorString(visualColor));var oldClipPath=lineGroup.getClipPath();if(oldClipPath)initProps(oldClipPath,{shape:createLineClipPath(this,coordSys,!1,seriesModel).shape},seriesModel);else lineGroup.setClipPath(createLineClipPath(this,coordSys,!0,seriesModel));showSymbol&&symbolDraw.updateData(data,{isIgnore:isIgnoreFunc,clipShape:clipShapeForSymbol,disableAnimation:!0,getSymbolPoint:function(idx){return[points2[2*idx],points2[2*idx+1]]}}),isPointsSame(this._stackedOnPoints,stackedOnPoints)&&isPointsSame(this._points,points2)||(hasAnimation?this._doUpdateAnimation(data,stackedOnPoints,coordSys,api,step,valueOrigin,connectNulls):(step&&(stackedOnPoints&&(stackedOnPoints=turnPointsIntoStep(stackedOnPoints,points2,coordSys,step,connectNulls)),points2=turnPointsIntoStep(points2,null,coordSys,step,connectNulls)),polyline.setShape({points:points2}),polygon&&polygon.setShape({points:points2,stackedOnPoints:stackedOnPoints})))}else showSymbol&&symbolDraw.updateData(data,{isIgnore:isIgnoreFunc,clipShape:clipShapeForSymbol,disableAnimation:!0,getSymbolPoint:function(idx){return[points2[2*idx],points2[2*idx+1]]}}),hasAnimation&&this._initSymbolLabelAnimation(data,coordSys,clipShapeForSymbol),step&&(stackedOnPoints&&(stackedOnPoints=turnPointsIntoStep(stackedOnPoints,points2,coordSys,step,connectNulls)),points2=turnPointsIntoStep(points2,null,coordSys,step,connectNulls)),polyline=this._newPolyline(points2),isAreaChart?polygon=this._newPolygon(points2,stackedOnPoints):polygon&&(lineGroup.remove(polygon),polygon=this._polygon=null),isCoordSysPolar||this._initOrUpdateEndLabel(seriesModel,coordSys,convertToColorString(visualColor)),lineGroup.setClipPath(createLineClipPath(this,coordSys,!0,seriesModel));var emphasisModel=seriesModel.getModel("emphasis"),focus=emphasisModel.get("focus"),blurScope=emphasisModel.get("blurScope"),emphasisDisabled=emphasisModel.get("disabled");(polyline.useStyle(defaults(lineStyleModel.getLineStyle(),{fill:"none",stroke:visualColor,lineJoin:"bevel"})),setStatesStylesFromModel(polyline,seriesModel,"lineStyle"),polyline.style.lineWidth>0&&"bolder"===seriesModel.get(["emphasis","lineStyle","width"]))&&(polyline.getState("emphasis").style.lineWidth=+polyline.style.lineWidth+1);getECData(polyline).seriesIndex=seriesModel.seriesIndex,toggleHoverEmphasis(polyline,focus,blurScope,emphasisDisabled);var smooth=getSmooth(seriesModel.get("smooth")),smoothMonotone=seriesModel.get("smoothMonotone");if(polyline.setShape({smooth:smooth,smoothMonotone:smoothMonotone,connectNulls:connectNulls}),polygon){var stackedOnSeries=data.getCalculationInfo("stackedOnSeries"),stackedOnSmooth=0;polygon.useStyle(defaults(areaStyleModel.getAreaStyle(),{fill:visualColor,opacity:.7,lineJoin:"bevel",decal:data.getVisual("style").decal})),stackedOnSeries&&(stackedOnSmooth=getSmooth(stackedOnSeries.get("smooth"))),polygon.setShape({smooth:smooth,stackedOnSmooth:stackedOnSmooth,smoothMonotone:smoothMonotone,connectNulls:connectNulls}),setStatesStylesFromModel(polygon,seriesModel,"areaStyle"),getECData(polygon).seriesIndex=seriesModel.seriesIndex,toggleHoverEmphasis(polygon,focus,blurScope,emphasisDisabled)}var changePolyState=this._changePolyState;data.eachItemGraphicEl((function(el){el&&(el.onHoverStateChange=changePolyState)})),this._polyline.onHoverStateChange=changePolyState,this._data=data,this._coordSys=coordSys,this._stackedOnPoints=stackedOnPoints,this._points=points2,this._step=step,this._valueOrigin=valueOrigin,seriesModel.get("triggerLineEvent")&&(this.packEventData(seriesModel,polyline),polygon&&this.packEventData(seriesModel,polygon))},LineView2.prototype.packEventData=function(seriesModel,el){getECData(el).eventData={componentType:"series",componentSubType:"line",componentIndex:seriesModel.componentIndex,seriesIndex:seriesModel.seriesIndex,seriesName:seriesModel.name,seriesType:"line"}},LineView2.prototype.highlight=function(seriesModel,ecModel,api,payload){var data=seriesModel.getData(),dataIndex=queryDataIndex(data,payload);if(this._changePolyState("emphasis"),!(dataIndex instanceof Array)&&null!=dataIndex&&dataIndex>=0){var points2=data.getLayout("points"),symbol=data.getItemGraphicEl(dataIndex);if(!symbol){var x=points2[2*dataIndex],y=points2[2*dataIndex+1];if(isNaN(x)||isNaN(y))return;if(this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(x,y))return;var zlevel=seriesModel.get("zlevel")||0,z=seriesModel.get("z")||0;(symbol=new Symbol$1(data,dataIndex)).x=x,symbol.y=y,symbol.setZ(zlevel,z);var symbolLabel=symbol.getSymbolPath().getTextContent();symbolLabel&&(symbolLabel.zlevel=zlevel,symbolLabel.z=z,symbolLabel.z2=this._polyline.z2+1),symbol.__temp=!0,data.setItemGraphicEl(dataIndex,symbol),symbol.stopSymbolAnimation(!0),this.group.add(symbol)}symbol.highlight()}else ChartView.prototype.highlight.call(this,seriesModel,ecModel,api,payload)},LineView2.prototype.downplay=function(seriesModel,ecModel,api,payload){var data=seriesModel.getData(),dataIndex=queryDataIndex(data,payload);if(this._changePolyState("normal"),null!=dataIndex&&dataIndex>=0){var symbol=data.getItemGraphicEl(dataIndex);symbol&&(symbol.__temp?(data.setItemGraphicEl(dataIndex,null),this.group.remove(symbol)):symbol.downplay())}else ChartView.prototype.downplay.call(this,seriesModel,ecModel,api,payload)},LineView2.prototype._changePolyState=function(toState){var polygon=this._polygon;setStatesFlag(this._polyline,toState),polygon&&setStatesFlag(polygon,toState)},LineView2.prototype._newPolyline=function(points2){var polyline=this._polyline;return polyline&&this._lineGroup.remove(polyline),polyline=new ECPolyline({shape:{points:points2},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(polyline),this._polyline=polyline,polyline},LineView2.prototype._newPolygon=function(points2,stackedOnPoints){var polygon=this._polygon;return polygon&&this._lineGroup.remove(polygon),polygon=new ECPolygon({shape:{points:points2,stackedOnPoints:stackedOnPoints},segmentIgnoreThreshold:2}),this._lineGroup.add(polygon),this._polygon=polygon,polygon},LineView2.prototype._initSymbolLabelAnimation=function(data,coordSys,clipShape){var isHorizontalOrRadial,isCoordSysPolar,baseAxis=coordSys.getBaseAxis(),isAxisInverse=baseAxis.inverse;"cartesian2d"===coordSys.type?(isHorizontalOrRadial=baseAxis.isHorizontal(),isCoordSysPolar=!1):"polar"===coordSys.type&&(isHorizontalOrRadial="angle"===baseAxis.dim,isCoordSysPolar=!0);var seriesModel=data.hostModel,seriesDuration=seriesModel.get("animationDuration");isFunction(seriesDuration)&&(seriesDuration=seriesDuration(null));var seriesDelay=seriesModel.get("animationDelay")||0,seriesDelayValue=isFunction(seriesDelay)?seriesDelay(null):seriesDelay;data.eachItemGraphicEl((function(symbol,idx){var el=symbol;if(el){var point=[symbol.x,symbol.y],start2=void 0,end2=void 0,current=void 0;if(clipShape)if(isCoordSysPolar){var polarClip=clipShape,coord=coordSys.pointToCoord(point);isHorizontalOrRadial?(start2=polarClip.startAngle,end2=polarClip.endAngle,current=-coord[1]/180*Math.PI):(start2=polarClip.r0,end2=polarClip.r,current=coord[0])}else{var gridClip=clipShape;isHorizontalOrRadial?(start2=gridClip.x,end2=gridClip.x+gridClip.width,current=symbol.x):(start2=gridClip.y+gridClip.height,end2=gridClip.y,current=symbol.y)}var ratio=end2===start2?0:(current-start2)/(end2-start2);isAxisInverse&&(ratio=1-ratio);var delay=isFunction(seriesDelay)?seriesDelay(idx):seriesDuration*ratio+seriesDelayValue,symbolPath=el.getSymbolPath(),text=symbolPath.getTextContent();el.attr({scaleX:0,scaleY:0}),el.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:delay}),text&&text.animateFrom({style:{opacity:0}},{duration:300,delay:delay}),symbolPath.disableLabelAnimation=!0}}))},LineView2.prototype._initOrUpdateEndLabel=function(seriesModel,coordSys,inheritColor){var endLabelModel=seriesModel.getModel("endLabel");if(anyStateShowEndLabel(seriesModel)){var data_2=seriesModel.getData(),polyline=this._polyline,points2=data_2.getLayout("points");if(!points2)return polyline.removeTextContent(),void(this._endLabel=null);var endLabel=this._endLabel;endLabel||((endLabel=this._endLabel=new ZRText({z2:200})).ignoreClip=!0,polyline.setTextContent(this._endLabel),polyline.disableLabelAnimation=!0);var dataIndex=function(points2){for(var x,y,len2=points2.length/2;len2>0&&(x=points2[2*len2-2],y=points2[2*len2-1],isNaN(x)||isNaN(y));len2--);return len2-1}(points2);dataIndex>=0&&(setLabelStyle(polyline,getLabelStatesModels(seriesModel,"endLabel"),{inheritColor:inheritColor,labelFetcher:seriesModel,labelDataIndex:dataIndex,defaultText:function(dataIndex2,opt,interpolatedValue){return null!=interpolatedValue?getDefaultInterpolatedLabel(data_2,interpolatedValue):getDefaultLabel(data_2,dataIndex2)},enableTextSetter:!0},function(endLabelModel,coordSys){var baseAxis=coordSys.getBaseAxis(),isHorizontal=baseAxis.isHorizontal(),isBaseInversed=baseAxis.inverse,align=isHorizontal?isBaseInversed?"right":"left":"center",verticalAlign=isHorizontal?"middle":isBaseInversed?"top":"bottom";return{normal:{align:endLabelModel.get("align")||align,verticalAlign:endLabelModel.get("verticalAlign")||verticalAlign}}}(endLabelModel,coordSys)),polyline.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},LineView2.prototype._endLabelOnDuring=function(percent,clipRect,data,animationRecord,valueAnimation,endLabelModel,coordSys){var endLabel=this._endLabel,polyline=this._polyline;if(endLabel){percent<1&&null==animationRecord.originalX&&(animationRecord.originalX=endLabel.x,animationRecord.originalY=endLabel.y);var points2=data.getLayout("points"),seriesModel=data.hostModel,connectNulls=seriesModel.get("connectNulls"),precision=endLabelModel.get("precision"),distance2=endLabelModel.get("distance")||0,baseAxis=coordSys.getBaseAxis(),isHorizontal=baseAxis.isHorizontal(),isBaseInversed=baseAxis.inverse,clipShape=clipRect.shape,xOrY=isBaseInversed?isHorizontal?clipShape.x:clipShape.y+clipShape.height:isHorizontal?clipShape.x+clipShape.width:clipShape.y,distanceX=(isHorizontal?distance2:0)*(isBaseInversed?-1:1),distanceY=(isHorizontal?0:-distance2)*(isBaseInversed?-1:1),dim=isHorizontal?"x":"y",dataIndexRange=function(points2,xOrY,dim){for(var a,b,len2=points2.length/2,dimIdx="x"===dim?0:1,prevIndex=0,nextIndex=-1,i=0;i<len2;i++)if(b=points2[2*i+dimIdx],!isNaN(b)&&!isNaN(points2[2*i+1-dimIdx]))if(0!==i){if(a<=xOrY&&b>=xOrY||a>=xOrY&&b<=xOrY){nextIndex=i;break}prevIndex=i,a=b}else a=b;return{range:[prevIndex,nextIndex],t:(xOrY-a)/(b-a)}}(points2,xOrY,dim),indices=dataIndexRange.range,diff=indices[1]-indices[0],value=void 0;if(diff>=1){if(diff>1&&!connectNulls){var pt=getPointAtIndex(points2,indices[0]);endLabel.attr({x:pt[0]+distanceX,y:pt[1]+distanceY}),valueAnimation&&(value=seriesModel.getRawValue(indices[0]))}else{(pt=polyline.getPointOn(xOrY,dim))&&endLabel.attr({x:pt[0]+distanceX,y:pt[1]+distanceY});var startValue=seriesModel.getRawValue(indices[0]),endValue=seriesModel.getRawValue(indices[1]);valueAnimation&&(value=function(data,precision,sourceValue,targetValue,percent){var isAutoPrecision=null==precision||"auto"===precision;if(null==targetValue)return targetValue;if(isNumber(targetValue))return round$3(value=interpolateNumber(sourceValue||0,targetValue,percent),isAutoPrecision?Math.max(getPrecision(sourceValue||0),getPrecision(targetValue)):precision);if(isString(targetValue))return percent<1?sourceValue:targetValue;for(var interpolated=[],leftArr=sourceValue,rightArr=targetValue,length_1=Math.max(leftArr?leftArr.length:0,rightArr.length),i=0;i<length_1;++i){var info=data.getDimensionInfo(i);if(info&&"ordinal"===info.type)interpolated[i]=(percent<1&&leftArr?leftArr:rightArr)[i];else{var leftVal=leftArr&&leftArr[i]?leftArr[i]:0,rightVal=rightArr[i],value=interpolateNumber(leftVal,rightVal,percent);interpolated[i]=round$3(value,isAutoPrecision?Math.max(getPrecision(leftVal),getPrecision(rightVal)):precision)}}return interpolated}(data,precision,startValue,endValue,dataIndexRange.t))}animationRecord.lastFrameIndex=indices[0]}else{var idx=1===percent||animationRecord.lastFrameIndex>0?indices[0]:0;pt=getPointAtIndex(points2,idx);valueAnimation&&(value=seriesModel.getRawValue(idx)),endLabel.attr({x:pt[0]+distanceX,y:pt[1]+distanceY})}if(valueAnimation){var inner2=labelInner(endLabel);"function"==typeof inner2.setLabelText&&inner2.setLabelText(value)}}},LineView2.prototype._doUpdateAnimation=function(data,stackedOnPoints,coordSys,api,step,valueOrigin,connectNulls){var polyline=this._polyline,polygon=this._polygon,seriesModel=data.hostModel,diff=function(oldData,newData,oldStackedOnPoints,newStackedOnPoints,oldCoordSys,newCoordSys,oldValueOrigin){for(var diff=function(oldData,newData){var diffResult=[];return newData.diff(oldData).add((function(idx){diffResult.push({cmd:"+",idx:idx})})).update((function(newIdx,oldIdx){diffResult.push({cmd:"=",idx:oldIdx,idx1:newIdx})})).remove((function(idx){diffResult.push({cmd:"-",idx:idx})})).execute(),diffResult}(oldData,newData),currPoints=[],nextPoints=[],currStackedPoints=[],nextStackedPoints=[],status=[],sortedIndices=[],rawIndices=[],newDataOldCoordInfo=prepareDataCoordInfo(oldCoordSys,newData,oldValueOrigin),oldPoints=oldData.getLayout("points")||[],newPoints=newData.getLayout("points")||[],i=0;i<diff.length;i++){var diffItem=diff[i],pointAdded=!0,oldIdx2=void 0,newIdx2=void 0;switch(diffItem.cmd){case"=":oldIdx2=2*diffItem.idx,newIdx2=2*diffItem.idx1;var currentX=oldPoints[oldIdx2],currentY=oldPoints[oldIdx2+1],nextX=newPoints[newIdx2],nextY=newPoints[newIdx2+1];(isNaN(currentX)||isNaN(currentY))&&(currentX=nextX,currentY=nextY),currPoints.push(currentX,currentY),nextPoints.push(nextX,nextY),currStackedPoints.push(oldStackedOnPoints[oldIdx2],oldStackedOnPoints[oldIdx2+1]),nextStackedPoints.push(newStackedOnPoints[newIdx2],newStackedOnPoints[newIdx2+1]),rawIndices.push(newData.getRawIndex(diffItem.idx1));break;case"+":var newIdx=diffItem.idx,newDataDimsForPoint=newDataOldCoordInfo.dataDimsForPoint,oldPt=oldCoordSys.dataToPoint([newData.get(newDataDimsForPoint[0],newIdx),newData.get(newDataDimsForPoint[1],newIdx)]);newIdx2=2*newIdx,currPoints.push(oldPt[0],oldPt[1]),nextPoints.push(newPoints[newIdx2],newPoints[newIdx2+1]);var stackedOnPoint=getStackedOnPoint(newDataOldCoordInfo,oldCoordSys,newData,newIdx);currStackedPoints.push(stackedOnPoint[0],stackedOnPoint[1]),nextStackedPoints.push(newStackedOnPoints[newIdx2],newStackedOnPoints[newIdx2+1]),rawIndices.push(newData.getRawIndex(newIdx));break;case"-":pointAdded=!1}pointAdded&&(status.push(diffItem),sortedIndices.push(sortedIndices.length))}sortedIndices.sort((function(a,b){return rawIndices[a]-rawIndices[b]}));var len2=currPoints.length,sortedCurrPoints=createFloat32Array(len2),sortedNextPoints=createFloat32Array(len2),sortedCurrStackedPoints=createFloat32Array(len2),sortedNextStackedPoints=createFloat32Array(len2),sortedStatus=[];for(i=0;i<sortedIndices.length;i++){var idx=sortedIndices[i],i2=2*i,idx2=2*idx;sortedCurrPoints[i2]=currPoints[idx2],sortedCurrPoints[i2+1]=currPoints[idx2+1],sortedNextPoints[i2]=nextPoints[idx2],sortedNextPoints[i2+1]=nextPoints[idx2+1],sortedCurrStackedPoints[i2]=currStackedPoints[idx2],sortedCurrStackedPoints[i2+1]=currStackedPoints[idx2+1],sortedNextStackedPoints[i2]=nextStackedPoints[idx2],sortedNextStackedPoints[i2+1]=nextStackedPoints[idx2+1],sortedStatus[i]=status[idx]}return{current:sortedCurrPoints,next:sortedNextPoints,stackedOnCurrent:sortedCurrStackedPoints,stackedOnNext:sortedNextStackedPoints,status:sortedStatus}}(this._data,data,this._stackedOnPoints,stackedOnPoints,this._coordSys,0,this._valueOrigin),current=diff.current,stackedOnCurrent=diff.stackedOnCurrent,next=diff.next,stackedOnNext=diff.stackedOnNext;if(step&&(stackedOnCurrent=turnPointsIntoStep(diff.stackedOnCurrent,diff.current,coordSys,step,connectNulls),current=turnPointsIntoStep(diff.current,null,coordSys,step,connectNulls),stackedOnNext=turnPointsIntoStep(diff.stackedOnNext,diff.next,coordSys,step,connectNulls),next=turnPointsIntoStep(diff.next,null,coordSys,step,connectNulls)),getBoundingDiff(current,next)>3e3||polygon&&getBoundingDiff(stackedOnCurrent,stackedOnNext)>3e3)return polyline.stopAnimation(),polyline.setShape({points:next}),void(polygon&&(polygon.stopAnimation(),polygon.setShape({points:next,stackedOnPoints:stackedOnNext})));polyline.shape.__points=diff.current,polyline.shape.points=current;var target={shape:{points:next}};diff.current!==current&&(target.shape.__points=diff.next),polyline.stopAnimation(),updateProps$1(polyline,target,seriesModel),polygon&&(polygon.setShape({points:current,stackedOnPoints:stackedOnCurrent}),polygon.stopAnimation(),updateProps$1(polygon,{shape:{stackedOnPoints:stackedOnNext}},seriesModel),polyline.shape.points!==polygon.shape.points&&(polygon.shape.points=polyline.shape.points));for(var updatedDataInfo=[],diffStatus=diff.status,i=0;i<diffStatus.length;i++){if("="===diffStatus[i].cmd){var el=data.getItemGraphicEl(diffStatus[i].idx1);el&&updatedDataInfo.push({el:el,ptIdx:i})}}polyline.animators&&polyline.animators.length&&polyline.animators[0].during((function(){polygon&&polygon.dirtyShape();for(var points2=polyline.shape.__points,i2=0;i2<updatedDataInfo.length;i2++){var el2=updatedDataInfo[i2].el,offset=2*updatedDataInfo[i2].ptIdx;el2.x=points2[offset],el2.y=points2[offset+1],el2.markRedraw()}}))},LineView2.prototype.remove=function(ecModel){var group=this.group,oldData=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),oldData&&oldData.eachItemGraphicEl((function(el,idx){el.__temp&&(group.remove(el),oldData.setItemGraphicEl(idx,null))})),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},LineView2.type="line",LineView2}(ChartView);function pointsLayout(seriesType2,forceStoreInTypedArray){return{seriesType:seriesType2,plan:createRenderPlanner(),reset:function(seriesModel){var data=seriesModel.getData(),coordSys=seriesModel.coordinateSystem,pipelineContext=seriesModel.pipelineContext,useTypedArray=forceStoreInTypedArray||pipelineContext.large;if(coordSys){var dims=map$1(coordSys.dimensions,(function(dim){return data.mapDimension(dim)})).slice(0,2),dimLen=dims.length,stackResultDim=data.getCalculationInfo("stackResultDimension");isDimensionStacked(data,dims[0])&&(dims[0]=stackResultDim),isDimensionStacked(data,dims[1])&&(dims[1]=stackResultDim);var store=data.getStore(),dimIdx0=data.getDimensionIndex(dims[0]),dimIdx1=data.getDimensionIndex(dims[1]);return dimLen&&{progress:function(params,data2){for(var segCount=params.end-params.start,points2=useTypedArray&&createFloat32Array(segCount*dimLen),tmpIn=[],tmpOut=[],i=params.start,offset=0;i<params.end;i++){var point=void 0;if(1===dimLen){var x=store.get(dimIdx0,i);point=coordSys.dataToPoint(x,null,tmpOut)}else tmpIn[0]=store.get(dimIdx0,i),tmpIn[1]=store.get(dimIdx1,i),point=coordSys.dataToPoint(tmpIn,null,tmpOut);useTypedArray?(points2[offset++]=point[0],points2[offset++]=point[1]):data2.setItemLayout(i,point.slice())}useTypedArray&&data2.setLayout("points",points2)}}}}}}var samplers={average:function(frame){for(var sum=0,count2=0,i=0;i<frame.length;i++)isNaN(frame[i])||(sum+=frame[i],count2++);return 0===count2?NaN:sum/count2},sum:function(frame){for(var sum=0,i=0;i<frame.length;i++)sum+=frame[i]||0;return sum},max:function(frame){for(var max3=-Infinity,i=0;i<frame.length;i++)frame[i]>max3&&(max3=frame[i]);return isFinite(max3)?max3:NaN},min:function(frame){for(var min3=Infinity,i=0;i<frame.length;i++)frame[i]<min3&&(min3=frame[i]);return isFinite(min3)?min3:NaN},nearest:function(frame){return frame[0]}},indexSampler=function(frame){return Math.round(frame.length/2)};function dataSample(seriesType2){return{seriesType:seriesType2,reset:function(seriesModel,ecModel,api){var data=seriesModel.getData(),sampling=seriesModel.get("sampling"),coordSys=seriesModel.coordinateSystem,count2=data.count();if(count2>10&&"cartesian2d"===coordSys.type&&sampling){var baseAxis=coordSys.getBaseAxis(),valueAxis2=coordSys.getOtherAxis(baseAxis),extent3=baseAxis.getExtent(),dpr2=api.getDevicePixelRatio(),size=Math.abs(extent3[1]-extent3[0])*(dpr2||1),rate=Math.round(count2/size);if(isFinite(rate)&&rate>1){"lttb"===sampling?seriesModel.setData(data.lttbDownSample(data.mapDimension(valueAxis2.dim),1/rate)):"minmax"===sampling&&seriesModel.setData(data.minmaxDownSample(data.mapDimension(valueAxis2.dim),1/rate));var sampler=void 0;isString(sampling)?sampler=samplers[sampling]:isFunction(sampling)&&(sampler=sampling),sampler&&seriesModel.setData(data.downSample(data.mapDimension(valueAxis2.dim),1/rate,sampler,indexSampler))}}}}}var BaseBarSeriesModel=function(_super){function BaseBarSeriesModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=BaseBarSeriesModel2.type,_this}return __extends(BaseBarSeriesModel2,_super),BaseBarSeriesModel2.prototype.getInitialData=function(option,ecModel){return createSeriesData(0,this,{useEncodeDefaulter:!0})},BaseBarSeriesModel2.prototype.getMarkerPosition=function(value,dims,startingAtTick){var coordSys=this.coordinateSystem;if(coordSys&&coordSys.clampData){var clampData_1=coordSys.clampData(value),pt_1=coordSys.dataToPoint(clampData_1);if(startingAtTick)each$d(coordSys.getAxes(),(function(axis,idx){if("category"===axis.type&&null!=dims){var tickCoords=axis.getTicksCoords(),alignTicksWithLabel=axis.getTickModel().get("alignWithLabel"),targetTickId=clampData_1[idx],isEnd="x1"===dims[idx]||"y1"===dims[idx];if(isEnd&&!alignTicksWithLabel&&(targetTickId+=1),tickCoords.length<2)return;if(2===tickCoords.length)return void(pt_1[idx]=axis.toGlobalCoord(axis.getExtent()[isEnd?1:0]));for(var leftCoord=void 0,coord=void 0,stepTickValue=1,i=0;i<tickCoords.length;i++){var tickCoord=tickCoords[i].coord,tickValue=i===tickCoords.length-1?tickCoords[i-1].tickValue+stepTickValue:tickCoords[i].tickValue;if(tickValue===targetTickId){coord=tickCoord;break}if(tickValue<targetTickId)leftCoord=tickCoord;else if(null!=leftCoord&&tickValue>targetTickId){coord=(tickCoord+leftCoord)/2;break}1===i&&(stepTickValue=tickValue-tickCoords[0].tickValue)}null==coord&&(leftCoord?leftCoord&&(coord=tickCoords[tickCoords.length-1].coord):coord=tickCoords[0].coord),pt_1[idx]=axis.toGlobalCoord(coord)}}));else{var data=this.getData(),offset=data.getLayout("offset"),size=data.getLayout("size"),offsetIndex=coordSys.getBaseAxis().isHorizontal()?0:1;pt_1[offsetIndex]+=offset+size/2}return pt_1}return[NaN,NaN]},BaseBarSeriesModel2.type="series.__base_bar__",BaseBarSeriesModel2.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},BaseBarSeriesModel2}(SeriesModel);SeriesModel.registerClass(BaseBarSeriesModel);var BarSeriesModel=function(_super){function BarSeriesModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=BarSeriesModel2.type,_this}return __extends(BarSeriesModel2,_super),BarSeriesModel2.prototype.getInitialData=function(){return createSeriesData(0,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},BarSeriesModel2.prototype.getProgressive=function(){return!!this.get("large")&&this.get("progressive")},BarSeriesModel2.prototype.getProgressiveThreshold=function(){var progressiveThreshold=this.get("progressiveThreshold"),largeThreshold=this.get("largeThreshold");return largeThreshold>progressiveThreshold&&(progressiveThreshold=largeThreshold),progressiveThreshold},BarSeriesModel2.prototype.brushSelector=function(dataIndex,data,selectors){return selectors.rect(data.getItemLayout(dataIndex))},BarSeriesModel2.type="series.bar",BarSeriesModel2.dependencies=["grid","polar"],BarSeriesModel2.defaultOption=inheritDefaultOption(BaseBarSeriesModel.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),BarSeriesModel2}(BaseBarSeriesModel),SausageShape=function(){return function(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0}}(),SausagePath=function(_super){function SausagePath2(opts){var _this=_super.call(this,opts)||this;return _this.type="sausage",_this}return __extends(SausagePath2,_super),SausagePath2.prototype.getDefaultShape=function(){return new SausageShape},SausagePath2.prototype.buildPath=function(ctx,shape){var cx=shape.cx,cy=shape.cy,r0=Math.max(shape.r0||0,0),r=Math.max(shape.r,0),dr=.5*(r-r0),rCenter=r0+dr,startAngle=shape.startAngle,endAngle=shape.endAngle,clockwise=shape.clockwise,PI22=2*Math.PI,lessThanCircle=clockwise?endAngle-startAngle<PI22:startAngle-endAngle<PI22;lessThanCircle||(startAngle=endAngle-(clockwise?PI22:-PI22));var unitStartX=Math.cos(startAngle),unitStartY=Math.sin(startAngle),unitEndX=Math.cos(endAngle),unitEndY=Math.sin(endAngle);lessThanCircle?(ctx.moveTo(unitStartX*r0+cx,unitStartY*r0+cy),ctx.arc(unitStartX*rCenter+cx,unitStartY*rCenter+cy,dr,-Math.PI+startAngle,startAngle,!clockwise)):ctx.moveTo(unitStartX*r+cx,unitStartY*r+cy),ctx.arc(cx,cy,r,startAngle,endAngle,!clockwise),ctx.arc(unitEndX*rCenter+cx,unitEndY*rCenter+cy,dr,endAngle-2*Math.PI,endAngle-Math.PI,!clockwise),0!==r0&&ctx.arc(cx,cy,r0,endAngle,startAngle,clockwise)},SausagePath2}(Path);function adjustAngleDistanceX(angle,distance2,isEnd){return distance2*Math.sin(angle)*(isEnd?-1:1)}function adjustAngleDistanceY(angle,distance2,isEnd){return distance2*Math.cos(angle)*(isEnd?1:-1)}function getSectorCornerRadius(model,shape,zeroIfNull){var cornerRadius=model.get("borderRadius");if(null==cornerRadius)return zeroIfNull?{cornerRadius:0}:null;isArray$1(cornerRadius)||(cornerRadius=[cornerRadius,cornerRadius,cornerRadius,cornerRadius]);var dr=Math.abs(shape.r||0-shape.r0||0);return{cornerRadius:map$1(cornerRadius,(function(cr){return parsePercent$1(cr,dr)}))}}var mathMax$3=Math.max,mathMin$3=Math.min;var BarView=function(_super){function BarView2(){var _this=_super.call(this)||this;return _this.type=BarView2.type,_this._isFirstFrame=!0,_this}return __extends(BarView2,_super),BarView2.prototype.render=function(seriesModel,ecModel,api,payload){this._model=seriesModel,this._removeOnRenderedListener(api),this._updateDrawMode(seriesModel);var coordinateSystemType=seriesModel.get("coordinateSystem");"cartesian2d"!==coordinateSystemType&&"polar"!==coordinateSystemType||(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(seriesModel,ecModel,api):this._renderNormal(seriesModel,ecModel,api,payload))},BarView2.prototype.incrementalPrepareRender=function(seriesModel){this._clear(),this._updateDrawMode(seriesModel),this._updateLargeClip(seriesModel)},BarView2.prototype.incrementalRender=function(params,seriesModel){this._progressiveEls=[],this._incrementalRenderLarge(params,seriesModel)},BarView2.prototype.eachRendered=function(cb){traverseElements(this._progressiveEls||this.group,cb)},BarView2.prototype._updateDrawMode=function(seriesModel){var isLargeDraw=seriesModel.pipelineContext.large;null!=this._isLargeDraw&&isLargeDraw===this._isLargeDraw||(this._isLargeDraw=isLargeDraw,this._clear())},BarView2.prototype._renderNormal=function(seriesModel,ecModel,api,payload){var isHorizontalOrRadial,group=this.group,data=seriesModel.getData(),oldData=this._data,coord=seriesModel.coordinateSystem,baseAxis=coord.getBaseAxis();"cartesian2d"===coord.type?isHorizontalOrRadial=baseAxis.isHorizontal():"polar"===coord.type&&(isHorizontalOrRadial="angle"===baseAxis.dim);var animationModel=seriesModel.isAnimationEnabled()?seriesModel:null,realtimeSortCfg=function(seriesModel,coordSys){var realtimeSortOption=seriesModel.get("realtimeSort",!0),baseAxis=coordSys.getBaseAxis();if(realtimeSortOption&&"category"===baseAxis.type&&"cartesian2d"===coordSys.type)return{baseAxis:baseAxis,otherAxis:coordSys.getOtherAxis(baseAxis)}}(seriesModel,coord);realtimeSortCfg&&this._enableRealtimeSort(realtimeSortCfg,data,api);var needsClip=seriesModel.get("clip",!0)||realtimeSortCfg,coordSysClipArea=function(coord,data){var coordSysClipArea=coord.getArea&&coord.getArea();if(isCoordinateSystemType(coord,"cartesian2d")){var baseAxis=coord.getBaseAxis();if("category"!==baseAxis.type||!baseAxis.onBand){var expandWidth=data.getLayout("bandWidth");baseAxis.isHorizontal()?(coordSysClipArea.x-=expandWidth,coordSysClipArea.width+=2*expandWidth):(coordSysClipArea.y-=expandWidth,coordSysClipArea.height+=2*expandWidth)}}return coordSysClipArea}(coord,data);group.removeClipPath();var roundCap=seriesModel.get("roundCap",!0),drawBackground=seriesModel.get("showBackground",!0),backgroundModel=seriesModel.getModel("backgroundStyle"),barBorderRadius=backgroundModel.get("borderRadius")||0,bgEls=[],oldBgEls=this._backgroundEls,isInitSort=payload&&payload.isInitSort,isChangeOrder=payload&&"changeAxisOrder"===payload.type;function createBackground(dataIndex){var bgLayout=getLayout[coord.type](data,dataIndex),bgEl=function(coord,isHorizontalOrRadial,layout2){var ElementClz="polar"===coord.type?Sector:Rect$1;return new ElementClz({shape:createBackgroundShape(isHorizontalOrRadial,layout2,coord),silent:!0,z2:0})}(coord,isHorizontalOrRadial,bgLayout);return bgEl.useStyle(backgroundModel.getItemStyle()),"cartesian2d"===coord.type?bgEl.setShape("r",barBorderRadius):bgEl.setShape("cornerRadius",barBorderRadius),bgEls[dataIndex]=bgEl,bgEl}data.diff(oldData).add((function(dataIndex){var itemModel=data.getItemModel(dataIndex),layout2=getLayout[coord.type](data,dataIndex,itemModel);if(drawBackground&&createBackground(dataIndex),data.hasValue(dataIndex)&&isValidLayout[coord.type](layout2)){var isClipped=!1;needsClip&&(isClipped=clip[coord.type](coordSysClipArea,layout2));var el=elementCreator[coord.type](seriesModel,data,dataIndex,layout2,isHorizontalOrRadial,animationModel,baseAxis.model,!1,roundCap);realtimeSortCfg&&(el.forceLabelAnimation=!0),updateStyle(el,data,dataIndex,itemModel,layout2,seriesModel,isHorizontalOrRadial,"polar"===coord.type),isInitSort?el.attr({shape:layout2}):realtimeSortCfg?updateRealtimeAnimation(realtimeSortCfg,animationModel,el,layout2,dataIndex,isHorizontalOrRadial,!1,!1):initProps(el,{shape:layout2},seriesModel,dataIndex),data.setItemGraphicEl(dataIndex,el),group.add(el),el.ignore=isClipped}})).update((function(newIndex,oldIndex){var itemModel=data.getItemModel(newIndex),layout2=getLayout[coord.type](data,newIndex,itemModel);if(drawBackground){var bgEl=void 0;0===oldBgEls.length?bgEl=createBackground(oldIndex):((bgEl=oldBgEls[oldIndex]).useStyle(backgroundModel.getItemStyle()),"cartesian2d"===coord.type?bgEl.setShape("r",barBorderRadius):bgEl.setShape("cornerRadius",barBorderRadius),bgEls[newIndex]=bgEl);var bgLayout=getLayout[coord.type](data,newIndex);updateProps$1(bgEl,{shape:createBackgroundShape(isHorizontalOrRadial,bgLayout,coord)},animationModel,newIndex)}var el=oldData.getItemGraphicEl(oldIndex);if(data.hasValue(newIndex)&&isValidLayout[coord.type](layout2)){var isClipped=!1;if(needsClip&&(isClipped=clip[coord.type](coordSysClipArea,layout2))&&group.remove(el),el?saveOldStyle(el):el=elementCreator[coord.type](seriesModel,data,newIndex,layout2,isHorizontalOrRadial,animationModel,baseAxis.model,!!el,roundCap),realtimeSortCfg&&(el.forceLabelAnimation=!0),isChangeOrder){var textEl=el.getTextContent();if(textEl){var labelInnerStore=labelInner(textEl);null!=labelInnerStore.prevValue&&(labelInnerStore.prevValue=labelInnerStore.value)}}else updateStyle(el,data,newIndex,itemModel,layout2,seriesModel,isHorizontalOrRadial,"polar"===coord.type);isInitSort?el.attr({shape:layout2}):realtimeSortCfg?updateRealtimeAnimation(realtimeSortCfg,animationModel,el,layout2,newIndex,isHorizontalOrRadial,!0,isChangeOrder):updateProps$1(el,{shape:layout2},seriesModel,newIndex,null),data.setItemGraphicEl(newIndex,el),el.ignore=isClipped,group.add(el)}else group.remove(el)})).remove((function(dataIndex){var el=oldData.getItemGraphicEl(dataIndex);el&&removeElementWithFadeOut(el,seriesModel,dataIndex)})).execute();var bgGroup=this._backgroundGroup||(this._backgroundGroup=new Group$2);bgGroup.removeAll();for(var i=0;i<bgEls.length;++i)bgGroup.add(bgEls[i]);group.add(bgGroup),this._backgroundEls=bgEls,this._data=data},BarView2.prototype._renderLarge=function(seriesModel,ecModel,api){this._clear(),createLarge(seriesModel,this.group),this._updateLargeClip(seriesModel)},BarView2.prototype._incrementalRenderLarge=function(params,seriesModel){this._removeBackground(),createLarge(seriesModel,this.group,this._progressiveEls,!0)},BarView2.prototype._updateLargeClip=function(seriesModel){var clipPath=seriesModel.get("clip",!0)&&createClipPath(seriesModel.coordinateSystem,!1,seriesModel),group=this.group;clipPath?group.setClipPath(clipPath):group.removeClipPath()},BarView2.prototype._enableRealtimeSort=function(realtimeSortCfg,data,api){var _this=this;if(data.count()){var baseAxis=realtimeSortCfg.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(data,realtimeSortCfg,api),this._isFirstFrame=!1;else{var orderMapping_1=function(idx){var el=data.getItemGraphicEl(idx),shape=el&&el.shape;return shape&&Math.abs(baseAxis.isHorizontal()?shape.height:shape.width)||0};this._onRendered=function(){_this._updateSortWithinSameData(data,orderMapping_1,baseAxis,api)},api.getZr().on("rendered",this._onRendered)}}},BarView2.prototype._dataSort=function(data,baseAxis,orderMapping){var info=[];return data.each(data.mapDimension(baseAxis.dim),(function(ordinalNumber,dataIdx){var mappedValue=orderMapping(dataIdx);mappedValue=null==mappedValue?NaN:mappedValue,info.push({dataIndex:dataIdx,mappedValue:mappedValue,ordinalNumber:ordinalNumber})})),info.sort((function(a,b){return b.mappedValue-a.mappedValue})),{ordinalNumbers:map$1(info,(function(item){return item.ordinalNumber}))}},BarView2.prototype._isOrderChangedWithinSameData=function(data,orderMapping,baseAxis){for(var scale2=baseAxis.scale,ordinalDataDim=data.mapDimension(baseAxis.dim),lastValue=Number.MAX_VALUE,tickNum=0,len2=scale2.getOrdinalMeta().categories.length;tickNum<len2;++tickNum){var rawIdx=data.rawIndexOf(ordinalDataDim,scale2.getRawOrdinalNumber(tickNum)),value=rawIdx<0?Number.MIN_VALUE:orderMapping(data.indexOfRawIndex(rawIdx));if(value>lastValue)return!0;lastValue=value}return!1},BarView2.prototype._isOrderDifferentInView=function(orderInfo,baseAxis){for(var scale2=baseAxis.scale,extent3=scale2.getExtent(),tickNum=Math.max(0,extent3[0]),tickMax=Math.min(extent3[1],scale2.getOrdinalMeta().categories.length-1);tickNum<=tickMax;++tickNum)if(orderInfo.ordinalNumbers[tickNum]!==scale2.getRawOrdinalNumber(tickNum))return!0},BarView2.prototype._updateSortWithinSameData=function(data,orderMapping,baseAxis,api){if(this._isOrderChangedWithinSameData(data,orderMapping,baseAxis)){var sortInfo=this._dataSort(data,baseAxis,orderMapping);this._isOrderDifferentInView(sortInfo,baseAxis)&&(this._removeOnRenderedListener(api),api.dispatchAction({type:"changeAxisOrder",componentType:baseAxis.dim+"Axis",axisId:baseAxis.index,sortInfo:sortInfo}))}},BarView2.prototype._dispatchInitSort=function(data,realtimeSortCfg,api){var baseAxis=realtimeSortCfg.baseAxis,sortResult=this._dataSort(data,baseAxis,(function(dataIdx){return data.get(data.mapDimension(realtimeSortCfg.otherAxis.dim),dataIdx)}));api.dispatchAction({type:"changeAxisOrder",componentType:baseAxis.dim+"Axis",isInitSort:!0,axisId:baseAxis.index,sortInfo:sortResult})},BarView2.prototype.remove=function(ecModel,api){this._clear(this._model),this._removeOnRenderedListener(api)},BarView2.prototype.dispose=function(ecModel,api){this._removeOnRenderedListener(api)},BarView2.prototype._removeOnRenderedListener=function(api){this._onRendered&&(api.getZr().off("rendered",this._onRendered),this._onRendered=null)},BarView2.prototype._clear=function(model){var group=this.group,data=this._data;model&&model.isAnimationEnabled()&&data&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],data.eachItemGraphicEl((function(el){removeElementWithFadeOut(el,model,getECData(el).dataIndex)}))):group.removeAll(),this._data=null,this._isFirstFrame=!0},BarView2.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},BarView2.type="bar",BarView2}(ChartView),clip={cartesian2d:function(coordSysBoundingRect,layout2){var signWidth=layout2.width<0?-1:1,signHeight=layout2.height<0?-1:1;signWidth<0&&(layout2.x+=layout2.width,layout2.width=-layout2.width),signHeight<0&&(layout2.y+=layout2.height,layout2.height=-layout2.height);var coordSysX2=coordSysBoundingRect.x+coordSysBoundingRect.width,coordSysY2=coordSysBoundingRect.y+coordSysBoundingRect.height,x=mathMax$3(layout2.x,coordSysBoundingRect.x),x2=mathMin$3(layout2.x+layout2.width,coordSysX2),y=mathMax$3(layout2.y,coordSysBoundingRect.y),y2=mathMin$3(layout2.y+layout2.height,coordSysY2),xClipped=x2<x,yClipped=y2<y;return layout2.x=xClipped&&x>coordSysX2?x2:x,layout2.y=yClipped&&y>coordSysY2?y2:y,layout2.width=xClipped?0:x2-x,layout2.height=yClipped?0:y2-y,signWidth<0&&(layout2.x+=layout2.width,layout2.width=-layout2.width),signHeight<0&&(layout2.y+=layout2.height,layout2.height=-layout2.height),xClipped||yClipped},polar:function(coordSysClipArea,layout2){var signR=layout2.r0<=layout2.r?1:-1;if(signR<0){var tmp=layout2.r;layout2.r=layout2.r0,layout2.r0=tmp}var r=mathMin$3(layout2.r,coordSysClipArea.r),r0=mathMax$3(layout2.r0,coordSysClipArea.r0);layout2.r=r,layout2.r0=r0;var clipped=r-r0<0;if(signR<0){tmp=layout2.r;layout2.r=layout2.r0,layout2.r0=tmp}return clipped}},elementCreator={cartesian2d:function(seriesModel,data,newIndex,layout2,isHorizontal,animationModel,axisModel,isUpdate,roundCap){var rect=new Rect$1({shape:extend({},layout2),z2:1});(rect.__dataIndex=newIndex,rect.name="item",animationModel)&&(rect.shape[isHorizontal?"height":"width"]=0);return rect},polar:function(seriesModel,data,newIndex,layout2,isRadial,animationModel,axisModel,isUpdate,roundCap){var ShapeClass=!isRadial&&roundCap?SausagePath:Sector,sector=new ShapeClass({shape:layout2,z2:1});sector.name="item";var positionMapping,isRoundCap,positionMap=createPolarPositionMapping(isRadial);if(sector.calculateTextPosition=(positionMapping=positionMap,isRoundCap=({isRoundCap:ShapeClass===SausagePath}||{}).isRoundCap,function(out2,opts2,boundingRect){var textPosition=opts2.position;if(!textPosition||textPosition instanceof Array)return calculateTextPosition(out2,opts2,boundingRect);var mappedSectorPosition=positionMapping(textPosition),distance2=null!=opts2.distance?opts2.distance:5,sector=this.shape,cx=sector.cx,cy=sector.cy,r=sector.r,r0=sector.r0,middleR=(r+r0)/2,startAngle=sector.startAngle,endAngle=sector.endAngle,middleAngle=(startAngle+endAngle)/2,extraDist=isRoundCap?Math.abs(r-r0)/2:0,mathCos2=Math.cos,mathSin2=Math.sin,x=cx+r*mathCos2(startAngle),y=cy+r*mathSin2(startAngle),textAlign="left",textVerticalAlign="top";switch(mappedSectorPosition){case"startArc":x=cx+(r0-distance2)*mathCos2(middleAngle),y=cy+(r0-distance2)*mathSin2(middleAngle),textAlign="center",textVerticalAlign="top";break;case"insideStartArc":x=cx+(r0+distance2)*mathCos2(middleAngle),y=cy+(r0+distance2)*mathSin2(middleAngle),textAlign="center",textVerticalAlign="bottom";break;case"startAngle":x=cx+middleR*mathCos2(startAngle)+adjustAngleDistanceX(startAngle,distance2+extraDist,!1),y=cy+middleR*mathSin2(startAngle)+adjustAngleDistanceY(startAngle,distance2+extraDist,!1),textAlign="right",textVerticalAlign="middle";break;case"insideStartAngle":x=cx+middleR*mathCos2(startAngle)+adjustAngleDistanceX(startAngle,-distance2+extraDist,!1),y=cy+middleR*mathSin2(startAngle)+adjustAngleDistanceY(startAngle,-distance2+extraDist,!1),textAlign="left",textVerticalAlign="middle";break;case"middle":x=cx+middleR*mathCos2(middleAngle),y=cy+middleR*mathSin2(middleAngle),textAlign="center",textVerticalAlign="middle";break;case"endArc":x=cx+(r+distance2)*mathCos2(middleAngle),y=cy+(r+distance2)*mathSin2(middleAngle),textAlign="center",textVerticalAlign="bottom";break;case"insideEndArc":x=cx+(r-distance2)*mathCos2(middleAngle),y=cy+(r-distance2)*mathSin2(middleAngle),textAlign="center",textVerticalAlign="top";break;case"endAngle":x=cx+middleR*mathCos2(endAngle)+adjustAngleDistanceX(endAngle,distance2+extraDist,!0),y=cy+middleR*mathSin2(endAngle)+adjustAngleDistanceY(endAngle,distance2+extraDist,!0),textAlign="left",textVerticalAlign="middle";break;case"insideEndAngle":x=cx+middleR*mathCos2(endAngle)+adjustAngleDistanceX(endAngle,-distance2+extraDist,!0),y=cy+middleR*mathSin2(endAngle)+adjustAngleDistanceY(endAngle,-distance2+extraDist,!0),textAlign="right",textVerticalAlign="middle";break;default:return calculateTextPosition(out2,opts2,boundingRect)}return(out2=out2||{}).x=x,out2.y=y,out2.align=textAlign,out2.verticalAlign=textVerticalAlign,out2}),animationModel){var animateProperty=isRadial?"r":"endAngle",animateTarget={};sector.shape[animateProperty]=isRadial?layout2.r0:layout2.startAngle,animateTarget[animateProperty]=layout2[animateProperty],(isUpdate?updateProps$1:initProps)(sector,{shape:animateTarget},animationModel)}return sector}};function updateRealtimeAnimation(realtimeSortCfg,seriesAnimationModel,el,layout2,newIndex,isHorizontal,isUpdate,isChangeOrder){var seriesTarget,axisTarget;isHorizontal?(axisTarget={x:layout2.x,width:layout2.width},seriesTarget={y:layout2.y,height:layout2.height}):(axisTarget={y:layout2.y,height:layout2.height},seriesTarget={x:layout2.x,width:layout2.width}),isChangeOrder||(isUpdate?updateProps$1:initProps)(el,{shape:seriesTarget},seriesAnimationModel,newIndex,null),(isUpdate?updateProps$1:initProps)(el,{shape:axisTarget},seriesAnimationModel?realtimeSortCfg.baseAxis.model:null,newIndex)}function checkPropertiesNotValid(obj,props){for(var i=0;i<props.length;i++)if(!isFinite(obj[props[i]]))return!0;return!1}var rectPropties=["x","y","width","height"],polarPropties=["cx","cy","r","startAngle","endAngle"],isValidLayout={cartesian2d:function(layout2){return!checkPropertiesNotValid(layout2,rectPropties)},polar:function(layout2){return!checkPropertiesNotValid(layout2,polarPropties)}},getLayout={cartesian2d:function(data,dataIndex,itemModel){var layout2=data.getItemLayout(dataIndex),fixedLineWidth=itemModel?function(itemModel,rawLayout){var borderColor=itemModel.get(["itemStyle","borderColor"]);if(!borderColor||"none"===borderColor)return 0;var lineWidth=itemModel.get(["itemStyle","borderWidth"])||0,width=isNaN(rawLayout.width)?Number.MAX_VALUE:Math.abs(rawLayout.width),height=isNaN(rawLayout.height)?Number.MAX_VALUE:Math.abs(rawLayout.height);return Math.min(lineWidth,width,height)}(itemModel,layout2):0,signX=layout2.width>0?1:-1,signY=layout2.height>0?1:-1;return{x:layout2.x+signX*fixedLineWidth/2,y:layout2.y+signY*fixedLineWidth/2,width:layout2.width-signX*fixedLineWidth,height:layout2.height-signY*fixedLineWidth}},polar:function(data,dataIndex,itemModel){var layout2=data.getItemLayout(dataIndex);return{cx:layout2.cx,cy:layout2.cy,r0:layout2.r0,r:layout2.r,startAngle:layout2.startAngle,endAngle:layout2.endAngle,clockwise:layout2.clockwise}}};function createPolarPositionMapping(isRadial){return function(isRadial2){var arcOrAngle=isRadial2?"Arc":"Angle";return function(position){switch(position){case"start":case"insideStart":case"end":case"insideEnd":return position+arcOrAngle;default:return position}}}(isRadial)}function updateStyle(el,data,dataIndex,itemModel,layout2,seriesModel,isHorizontalOrRadial,isPolar){var style=data.getItemVisual(dataIndex,"style");if(isPolar){if(!seriesModel.get("roundCap")){var sectorShape=el.shape;extend(sectorShape,getSectorCornerRadius(itemModel.getModel("itemStyle"),sectorShape,!0)),el.setShape(sectorShape)}}else{var borderRadius=itemModel.get(["itemStyle","borderRadius"])||0;el.setShape("r",borderRadius)}el.useStyle(style);var cursorStyle=itemModel.getShallow("cursor");cursorStyle&&el.attr("cursor",cursorStyle);var labelPositionOutside=isPolar?isHorizontalOrRadial?layout2.r>=layout2.r0?"endArc":"startArc":layout2.endAngle>=layout2.startAngle?"endAngle":"startAngle":isHorizontalOrRadial?layout2.height>=0?"bottom":"top":layout2.width>=0?"right":"left",labelStatesModels=getLabelStatesModels(itemModel);setLabelStyle(el,labelStatesModels,{labelFetcher:seriesModel,labelDataIndex:dataIndex,defaultText:getDefaultLabel(seriesModel.getData(),dataIndex),inheritColor:style.fill,defaultOpacity:style.opacity,defaultOutsidePosition:labelPositionOutside});var label=el.getTextContent();if(isPolar&&label){var position=itemModel.get(["label","position"]);el.textConfig.inside="middle"===position||null,function(sector,textPosition,positionMapping,rotateType){if(isNumber(rotateType))sector.setTextConfig({rotation:rotateType});else if(isArray$1(textPosition))sector.setTextConfig({rotation:0});else{var anchorAngle,shape=sector.shape,startAngle=shape.clockwise?shape.startAngle:shape.endAngle,endAngle=shape.clockwise?shape.endAngle:shape.startAngle,middleAngle=(startAngle+endAngle)/2,mappedSectorPosition=positionMapping(textPosition);switch(mappedSectorPosition){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":anchorAngle=middleAngle;break;case"startAngle":case"insideStartAngle":anchorAngle=startAngle;break;case"endAngle":case"insideEndAngle":anchorAngle=endAngle;break;default:return void sector.setTextConfig({rotation:0})}var rotate2=1.5*Math.PI-anchorAngle;"middle"===mappedSectorPosition&&rotate2>Math.PI/2&&rotate2<1.5*Math.PI&&(rotate2-=Math.PI),sector.setTextConfig({rotation:rotate2})}}(el,"outside"===position?labelPositionOutside:position,createPolarPositionMapping(isHorizontalOrRadial),itemModel.get(["label","rotate"]))}!function(label,labelStatesModels,value,getDefaultText){if(label){var obj=labelInner(label);obj.prevValue=obj.value,obj.value=value;var normalLabelModel=labelStatesModels.normal;obj.valueAnimation=normalLabelModel.get("valueAnimation"),obj.valueAnimation&&(obj.precision=normalLabelModel.get("precision"),obj.defaultInterpolatedText=getDefaultText,obj.statesModels=labelStatesModels)}}(label,labelStatesModels,seriesModel.getRawValue(dataIndex),(function(value){return getDefaultInterpolatedLabel(data,value)}));var emphasisModel=itemModel.getModel(["emphasis"]);toggleHoverEmphasis(el,emphasisModel.get("focus"),emphasisModel.get("blurScope"),emphasisModel.get("disabled")),setStatesStylesFromModel(el,itemModel),function(layout2){return null!=layout2.startAngle&&null!=layout2.endAngle&&layout2.startAngle===layout2.endAngle}(layout2)&&(el.style.fill="none",el.style.stroke="none",each$d(el.states,(function(state){state.style&&(state.style.fill=state.style.stroke="none")})))}var LagePathShape=function(){return function(){}}(),LargePath=function(_super){function LargePath2(opts){var _this=_super.call(this,opts)||this;return _this.type="largeBar",_this}return __extends(LargePath2,_super),LargePath2.prototype.getDefaultShape=function(){return new LagePathShape},LargePath2.prototype.buildPath=function(ctx,shape){for(var points2=shape.points,baseDimIdx=this.baseDimIdx,valueDimIdx=1-this.baseDimIdx,startPoint=[],size=[],barWidth=this.barWidth,i=0;i<points2.length;i+=3)size[baseDimIdx]=barWidth,size[valueDimIdx]=points2[i+2],startPoint[baseDimIdx]=points2[i+baseDimIdx],startPoint[valueDimIdx]=points2[i+valueDimIdx],ctx.rect(startPoint[0],startPoint[1],size[0],size[1])},LargePath2}(Path);function createLarge(seriesModel,group,progressiveEls,incremental){var data=seriesModel.getData(),baseDimIdx=data.getLayout("valueAxisHorizontal")?1:0,largeDataIndices=data.getLayout("largeDataIndices"),barWidth=data.getLayout("size"),backgroundModel=seriesModel.getModel("backgroundStyle"),bgPoints=data.getLayout("largeBackgroundPoints");if(bgPoints){var bgEl=new LargePath({shape:{points:bgPoints},incremental:!!incremental,silent:!0,z2:0});bgEl.baseDimIdx=baseDimIdx,bgEl.largeDataIndices=largeDataIndices,bgEl.barWidth=barWidth,bgEl.useStyle(backgroundModel.getItemStyle()),group.add(bgEl),progressiveEls&&progressiveEls.push(bgEl)}var el=new LargePath({shape:{points:data.getLayout("largePoints")},incremental:!!incremental,ignoreCoarsePointer:!0,z2:1});el.baseDimIdx=baseDimIdx,el.largeDataIndices=largeDataIndices,el.barWidth=barWidth,group.add(el),el.useStyle(data.getVisual("style")),el.style.stroke=null,getECData(el).seriesIndex=seriesModel.seriesIndex,seriesModel.get("silent")||(el.on("mousedown",largePathUpdateDataIndex),el.on("mousemove",largePathUpdateDataIndex)),progressiveEls&&progressiveEls.push(el)}var largePathUpdateDataIndex=throttle((function(event){var dataIndex=function(largePath,x,y){for(var baseDimIdx=largePath.baseDimIdx,valueDimIdx=1-baseDimIdx,points2=largePath.shape.points,largeDataIndices=largePath.largeDataIndices,startPoint=[],size=[],barWidth=largePath.barWidth,i=0,len2=points2.length/3;i<len2;i++){var ii=3*i;if(size[baseDimIdx]=barWidth,size[valueDimIdx]=points2[ii+2],startPoint[baseDimIdx]=points2[ii+baseDimIdx],startPoint[valueDimIdx]=points2[ii+valueDimIdx],size[valueDimIdx]<0&&(startPoint[valueDimIdx]+=size[valueDimIdx],size[valueDimIdx]=-size[valueDimIdx]),x>=startPoint[0]&&x<=startPoint[0]+size[0]&&y>=startPoint[1]&&y<=startPoint[1]+size[1])return largeDataIndices[i]}return-1}(this,event.offsetX,event.offsetY);getECData(this).dataIndex=dataIndex>=0?dataIndex:null}),30,!1);function createBackgroundShape(isHorizontalOrRadial,layout2,coord){if(isCoordinateSystemType(coord,"cartesian2d")){var rectShape=layout2,coordLayout=coord.getArea();return{x:isHorizontalOrRadial?rectShape.x:coordLayout.x,y:isHorizontalOrRadial?coordLayout.y:rectShape.y,width:isHorizontalOrRadial?rectShape.width:coordLayout.width,height:isHorizontalOrRadial?coordLayout.height:rectShape.height}}var sectorShape=layout2;return{cx:(coordLayout=coord.getArea()).cx,cy:coordLayout.cy,r0:isHorizontalOrRadial?coordLayout.r0:sectorShape.r0,r:isHorizontalOrRadial?coordLayout.r:sectorShape.r,startAngle:isHorizontalOrRadial?sectorShape.startAngle:0,endAngle:isHorizontalOrRadial?sectorShape.endAngle:2*Math.PI}}var PI2$1=2*Math.PI,RADIAN$1=Math.PI/180;function getViewRect$1(seriesModel,api){return getLayoutRect(seriesModel.getBoxLayoutParams(),{width:api.getWidth(),height:api.getHeight()})}function getBasicPieLayout(seriesModel,api){var viewRect2=getViewRect$1(seriesModel,api),center2=seriesModel.get("center"),radius=seriesModel.get("radius");isArray$1(radius)||(radius=[0,radius]);var cx,cy,width=parsePercent(viewRect2.width,api.getWidth()),height=parsePercent(viewRect2.height,api.getHeight()),size=Math.min(width,height),r0=parsePercent(radius[0],size/2),r=parsePercent(radius[1],size/2),coordSys=seriesModel.coordinateSystem;if(coordSys){var point=coordSys.dataToPoint(center2);cx=point[0]||0,cy=point[1]||0}else isArray$1(center2)||(center2=[center2,center2]),cx=parsePercent(center2[0],width)+viewRect2.x,cy=parsePercent(center2[1],height)+viewRect2.y;return{cx:cx,cy:cy,r0:r0,r:r}}function pieLayout(seriesType2,ecModel,api){ecModel.eachSeriesByType(seriesType2,(function(seriesModel){var data=seriesModel.getData(),valueDim=data.mapDimension("value"),viewRect2=getViewRect$1(seriesModel,api),_a2=getBasicPieLayout(seriesModel,api),cx=_a2.cx,cy=_a2.cy,r=_a2.r,r0=_a2.r0,startAngle=-seriesModel.get("startAngle")*RADIAN$1,endAngle=seriesModel.get("endAngle"),padAngle=seriesModel.get("padAngle")*RADIAN$1;endAngle="auto"===endAngle?startAngle-PI2$1:-endAngle*RADIAN$1;var minAndPadAngle=seriesModel.get("minAngle")*RADIAN$1+padAngle,validDataCount=0;data.each(valueDim,(function(value){!isNaN(value)&&validDataCount++}));var sum=data.getSum(valueDim),unitRadian=Math.PI/(sum||validDataCount)*2,clockwise=seriesModel.get("clockwise"),roseType=seriesModel.get("roseType"),stillShowZeroSum=seriesModel.get("stillShowZeroSum"),extent3=data.getDataExtent(valueDim);extent3[0]=0;var dir3=clockwise?1:-1,angles=[startAngle,endAngle],halfPadAngle=dir3*padAngle/2;normalizeArcAngles(angles,!clockwise),startAngle=angles[0],endAngle=angles[1];var layoutData=getSeriesLayoutData(seriesModel);layoutData.startAngle=startAngle,layoutData.endAngle=endAngle,layoutData.clockwise=clockwise;var angleRange=Math.abs(endAngle-startAngle),restAngle=angleRange,valueSumLargerThanMinAngle=0,currentAngle=startAngle;if(data.setLayout({viewRect:viewRect2,r:r}),data.each(valueDim,(function(value,idx){var angle;if(isNaN(value))data.setItemLayout(idx,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:clockwise,cx:cx,cy:cy,r0:r0,r:roseType?NaN:r});else{(angle="area"!==roseType?0===sum&&stillShowZeroSum?unitRadian:value*unitRadian:angleRange/validDataCount)<minAndPadAngle?(angle=minAndPadAngle,restAngle-=minAndPadAngle):valueSumLargerThanMinAngle+=value;var endAngle2=currentAngle+dir3*angle,actualStartAngle=0,actualEndAngle=0;padAngle>angle?actualEndAngle=actualStartAngle=currentAngle+dir3*angle/2:(actualStartAngle=currentAngle+halfPadAngle,actualEndAngle=endAngle2-halfPadAngle),data.setItemLayout(idx,{angle:angle,startAngle:actualStartAngle,endAngle:actualEndAngle,clockwise:clockwise,cx:cx,cy:cy,r0:r0,r:roseType?linearMap$2(value,extent3,[r0,r]):r}),currentAngle=endAngle2}})),restAngle<PI2$1&&validDataCount)if(restAngle<=.001){var angle_1=angleRange/validDataCount;data.each(valueDim,(function(value,idx){if(!isNaN(value)){var layout_1=data.getItemLayout(idx);layout_1.angle=angle_1;var actualStartAngle=0,actualEndAngle=0;angle_1<padAngle?actualEndAngle=actualStartAngle=startAngle+dir3*(idx+.5)*angle_1:(actualStartAngle=startAngle+dir3*idx*angle_1+halfPadAngle,actualEndAngle=startAngle+dir3*(idx+1)*angle_1-halfPadAngle),layout_1.startAngle=actualStartAngle,layout_1.endAngle=actualEndAngle}}))}else unitRadian=restAngle/valueSumLargerThanMinAngle,currentAngle=startAngle,data.each(valueDim,(function(value,idx){if(!isNaN(value)){var layout_2=data.getItemLayout(idx),angle=layout_2.angle===minAndPadAngle?minAndPadAngle:value*unitRadian,actualStartAngle=0,actualEndAngle=0;angle<padAngle?actualEndAngle=actualStartAngle=currentAngle+dir3*angle/2:(actualStartAngle=currentAngle+halfPadAngle,actualEndAngle=currentAngle+dir3*angle-halfPadAngle),layout_2.startAngle=actualStartAngle,layout_2.endAngle=actualEndAngle,currentAngle+=dir3*angle}}))}))}var getSeriesLayoutData=makeInner();function dataFilter(seriesType2){return{seriesType:seriesType2,reset:function(seriesModel,ecModel){var legendModels=ecModel.findComponents({mainType:"legend"});if(legendModels&&legendModels.length){var data=seriesModel.getData();data.filterSelf((function(idx){for(var name=data.getName(idx),i=0;i<legendModels.length;i++)if(!legendModels[i].isSelected(name))return!1;return!0}))}}}}var RADIAN=Math.PI/180;function adjustSingleSide(list,cx,cy,r,dir3,viewWidth,viewHeight,viewLeft,viewTop,farthestX){if(!(list.length<2)){for(var len2=list.length,i=0;i<len2;i++)if("outer"===list[i].position&&"labelLine"===list[i].labelAlignTo){var dx=list[i].label.x-farthestX;list[i].linePoints[1][0]+=dx,list[i].label.x=farthestX}shiftLayoutOnY(list,viewTop,viewTop+viewHeight)&&function(items){for(var topSemi={list:[],maxY:0},bottomSemi={list:[],maxY:0},i2=0;i2<items.length;i2++)if("none"===items[i2].labelAlignTo){var item=items[i2],semi=item.label.y>cy?bottomSemi:topSemi,dy=Math.abs(item.label.y-cy);if(dy>=semi.maxY){var dx2=item.label.x-cx-item.len2*dir3,rA=r+item.len,rB=Math.abs(dx2)<rA?Math.sqrt(dy*dy/(1-dx2*dx2/rA/rA)):rA;semi.rB=rB,semi.maxY=dy}semi.list.push(item)}recalculateXOnSemiToAlignOnEllipseCurve(topSemi),recalculateXOnSemiToAlignOnEllipseCurve(bottomSemi)}(list)}function recalculateXOnSemiToAlignOnEllipseCurve(semi){for(var rB=semi.rB,rB2=rB*rB,i2=0;i2<semi.list.length;i2++){var item=semi.list[i2],dy=Math.abs(item.label.y-cy),rA=r+item.len,rA2=rA*rA,dx2=Math.sqrt(Math.abs((1-dy*dy/rB2)*rA2)),newX=cx+(dx2+item.len2)*dir3,deltaX=newX-item.label.x;constrainTextWidth(item,item.targetTextWidth-deltaX*dir3,!0),item.label.x=newX}}}function constrainTextWidth(layout2,availableWidth,forceRecalculate){if(void 0===forceRecalculate&&(forceRecalculate=!1),null==layout2.labelStyleWidth){var label=layout2.label,style=label.style,textRect=layout2.rect,bgColor=style.backgroundColor,padding=style.padding,paddingH=padding?padding[1]+padding[3]:0,overflow=style.overflow,oldOuterWidth=textRect.width+(bgColor?0:paddingH);if(availableWidth<oldOuterWidth||forceRecalculate){var oldHeight=textRect.height;if(overflow&&overflow.match("break")){label.setStyle("backgroundColor",null),label.setStyle("width",availableWidth-paddingH);var innerRect=label.getBoundingRect();label.setStyle("width",Math.ceil(innerRect.width)),label.setStyle("backgroundColor",bgColor)}else{var availableInnerWidth=availableWidth-paddingH,newWidth=availableWidth<oldOuterWidth?availableInnerWidth:forceRecalculate?availableInnerWidth>layout2.unconstrainedWidth?null:availableInnerWidth:null;label.setStyle("width",newWidth)}var newRect=label.getBoundingRect();textRect.width=newRect.width;var margin=(label.style.margin||0)+2.1;textRect.height=newRect.height+margin,textRect.y-=(textRect.height-oldHeight)/2}}}function isPositionCenter(sectorShape){return"center"===sectorShape.position}function pieLabelLayout(seriesModel){var cx,cy,data=seriesModel.getData(),labelLayoutList=[],hasLabelRotate=!1,minShowLabelRadian=(seriesModel.get("minShowLabelAngle")||0)*RADIAN,viewRect2=data.getLayout("viewRect"),r=data.getLayout("r"),viewWidth=viewRect2.width,viewLeft=viewRect2.x,viewTop=viewRect2.y,viewHeight=viewRect2.height;function setNotShow(el){el.ignore=!0}data.each((function(idx){var sector=data.getItemGraphicEl(idx),sectorShape=sector.shape,label2=sector.getTextContent(),labelLine2=sector.getTextGuideLine(),itemModel=data.getItemModel(idx),labelModel=itemModel.getModel("label"),labelPosition=labelModel.get("position")||itemModel.get(["emphasis","label","position"]),labelDistance=labelModel.get("distanceToLabelLine"),labelAlignTo=labelModel.get("alignTo"),edgeDistance=parsePercent(labelModel.get("edgeDistance"),viewWidth),bleedMargin=labelModel.get("bleedMargin"),labelLineModel=itemModel.getModel("labelLine"),labelLineLen=labelLineModel.get("length");labelLineLen=parsePercent(labelLineLen,viewWidth);var labelLineLen2=labelLineModel.get("length2");if(labelLineLen2=parsePercent(labelLineLen2,viewWidth),Math.abs(sectorShape.endAngle-sectorShape.startAngle)<minShowLabelRadian)return each$d(label2.states,setNotShow),label2.ignore=!0,void(labelLine2&&(each$d(labelLine2.states,setNotShow),labelLine2.ignore=!0));if(function(label2){if(!label2.ignore)return!0;for(var key in label2.states)if(!1===label2.states[key].ignore)return!0;return!1}(label2)){var textX,textY,linePoints2,textAlign,midAngle=(sectorShape.startAngle+sectorShape.endAngle)/2,nx=Math.cos(midAngle),ny=Math.sin(midAngle);cx=sectorShape.cx,cy=sectorShape.cy;var isLabelInside="inside"===labelPosition||"inner"===labelPosition;if("center"===labelPosition)textX=sectorShape.cx,textY=sectorShape.cy,textAlign="center";else{var x1=(isLabelInside?(sectorShape.r+sectorShape.r0)/2*nx:sectorShape.r*nx)+cx,y1=(isLabelInside?(sectorShape.r+sectorShape.r0)/2*ny:sectorShape.r*ny)+cy;if(textX=x1+3*nx,textY=y1+3*ny,!isLabelInside){var x2=x1+nx*(labelLineLen+r-sectorShape.r),y2=y1+ny*(labelLineLen+r-sectorShape.r),x3=x2+(nx<0?-1:1)*labelLineLen2;textX="edge"===labelAlignTo?nx<0?viewLeft+edgeDistance:viewLeft+viewWidth-edgeDistance:x3+(nx<0?-labelDistance:labelDistance),textY=y2,linePoints2=[[x1,y1],[x2,y2],[x3,y2]]}textAlign=isLabelInside?"center":"edge"===labelAlignTo?nx>0?"right":"left":nx>0?"left":"right"}var PI3=Math.PI,labelRotate=0,rotate2=labelModel.get("rotate");if(isNumber(rotate2))labelRotate=rotate2*(PI3/180);else if("center"===labelPosition)labelRotate=0;else if("radial"===rotate2||!0===rotate2){labelRotate=nx<0?-midAngle+PI3:-midAngle}else if("tangential"===rotate2&&"outside"!==labelPosition&&"outer"!==labelPosition){var rad=Math.atan2(nx,ny);rad<0&&(rad=2*PI3+rad),ny>0&&(rad=PI3+rad),labelRotate=rad-PI3}if(hasLabelRotate=!!labelRotate,label2.x=textX,label2.y=textY,label2.rotation=labelRotate,label2.setStyle({verticalAlign:"middle"}),isLabelInside){label2.setStyle({align:textAlign});var selectState2=label2.states.select;selectState2&&(selectState2.x+=label2.x,selectState2.y+=label2.y)}else{var textRect=label2.getBoundingRect().clone();textRect.applyTransform(label2.getComputedTransform());var margin=(label2.style.margin||0)+2.1;textRect.y-=margin/2,textRect.height+=margin,labelLayoutList.push({label:label2,labelLine:labelLine2,position:labelPosition,len:labelLineLen,len2:labelLineLen2,minTurnAngle:labelLineModel.get("minTurnAngle"),maxSurfaceAngle:labelLineModel.get("maxSurfaceAngle"),surfaceNormal:new Point(nx,ny),linePoints:linePoints2,textAlign:textAlign,labelDistance:labelDistance,labelAlignTo:labelAlignTo,edgeDistance:edgeDistance,bleedMargin:bleedMargin,rect:textRect,unconstrainedWidth:textRect.width,labelStyleWidth:label2.style.width})}sector.setTextConfig({inside:isLabelInside})}})),!hasLabelRotate&&seriesModel.get("avoidLabelOverlap")&&function(labelLayoutList,cx,cy,r,viewWidth,viewHeight,viewLeft,viewTop){for(var leftList=[],rightList=[],leftmostX=Number.MAX_VALUE,rightmostX=-Number.MAX_VALUE,i=0;i<labelLayoutList.length;i++){var label=labelLayoutList[i].label;isPositionCenter(labelLayoutList[i])||(label.x<cx?(leftmostX=Math.min(leftmostX,label.x),leftList.push(labelLayoutList[i])):(rightmostX=Math.max(rightmostX,label.x),rightList.push(labelLayoutList[i])))}for(i=0;i<labelLayoutList.length;i++)if(!isPositionCenter(layout2=labelLayoutList[i])&&layout2.linePoints){if(null!=layout2.labelStyleWidth)continue;label=layout2.label;var linePoints=layout2.linePoints,targetTextWidth=void 0;targetTextWidth="edge"===layout2.labelAlignTo?label.x<cx?linePoints[2][0]-layout2.labelDistance-viewLeft-layout2.edgeDistance:viewLeft+viewWidth-layout2.edgeDistance-linePoints[2][0]-layout2.labelDistance:"labelLine"===layout2.labelAlignTo?label.x<cx?leftmostX-viewLeft-layout2.bleedMargin:viewLeft+viewWidth-rightmostX-layout2.bleedMargin:label.x<cx?label.x-viewLeft-layout2.bleedMargin:viewLeft+viewWidth-label.x-layout2.bleedMargin,layout2.targetTextWidth=targetTextWidth,constrainTextWidth(layout2,targetTextWidth)}for(adjustSingleSide(rightList,cx,cy,r,1,0,viewHeight,0,viewTop,rightmostX),adjustSingleSide(leftList,cx,cy,r,-1,0,viewHeight,0,viewTop,leftmostX),i=0;i<labelLayoutList.length;i++){var layout2;if(!isPositionCenter(layout2=labelLayoutList[i])&&layout2.linePoints){label=layout2.label,linePoints=layout2.linePoints;var isAlignToEdge="edge"===layout2.labelAlignTo,padding=label.style.padding,paddingH=padding?padding[1]+padding[3]:0,extraPaddingH=label.style.backgroundColor?0:paddingH,realTextWidth=layout2.rect.width+extraPaddingH,dist2=linePoints[1][0]-linePoints[2][0];isAlignToEdge?label.x<cx?linePoints[2][0]=viewLeft+layout2.edgeDistance+realTextWidth+layout2.labelDistance:linePoints[2][0]=viewLeft+viewWidth-layout2.edgeDistance-realTextWidth-layout2.labelDistance:(label.x<cx?linePoints[2][0]=label.x+layout2.labelDistance:linePoints[2][0]=label.x-layout2.labelDistance,linePoints[1][0]=linePoints[2][0]+dist2),linePoints[1][1]=linePoints[2][1]=label.y}}}(labelLayoutList,cx,cy,r,viewWidth,viewHeight,viewLeft,viewTop);for(var i=0;i<labelLayoutList.length;i++){var layout2=labelLayoutList[i],label=layout2.label,labelLine=layout2.labelLine,notShowLabel=isNaN(label.x)||isNaN(label.y);if(label){label.setStyle({align:layout2.textAlign}),notShowLabel&&(each$d(label.states,setNotShow),label.ignore=!0);var selectState=label.states.select;selectState&&(selectState.x+=label.x,selectState.y+=label.y)}if(labelLine){var linePoints=layout2.linePoints;notShowLabel||!linePoints?(each$d(labelLine.states,setNotShow),labelLine.ignore=!0):(limitTurnAngle(linePoints,layout2.minTurnAngle),limitSurfaceAngle(linePoints,layout2.surfaceNormal,layout2.maxSurfaceAngle),labelLine.setShape({points:linePoints}),label.__hostTarget.textGuideLineConfig={anchor:new Point(linePoints[0][0],linePoints[0][1])})}}}var PiePiece=function(_super){function PiePiece2(data,idx,startAngle){var _this=_super.call(this)||this;_this.z2=2;var text=new ZRText;return _this.setTextContent(text),_this.updateData(data,idx,startAngle,!0),_this}return __extends(PiePiece2,_super),PiePiece2.prototype.updateData=function(data,idx,startAngle,firstCreate){var seriesModel=data.hostModel,itemModel=data.getItemModel(idx),emphasisModel=itemModel.getModel("emphasis"),layout2=data.getItemLayout(idx),sectorShape=extend(getSectorCornerRadius(itemModel.getModel("itemStyle"),layout2,!0),layout2);if(isNaN(sectorShape.startAngle))this.setShape(sectorShape);else{if(firstCreate){this.setShape(sectorShape);var animationType=seriesModel.getShallow("animationType");seriesModel.ecModel.ssr?(initProps(this,{scaleX:0,scaleY:0},seriesModel,{dataIndex:idx,isFrom:!0}),this.originX=sectorShape.cx,this.originY=sectorShape.cy):"scale"===animationType?(this.shape.r=layout2.r0,initProps(this,{shape:{r:layout2.r}},seriesModel,idx)):null!=startAngle?(this.setShape({startAngle:startAngle,endAngle:startAngle}),initProps(this,{shape:{startAngle:layout2.startAngle,endAngle:layout2.endAngle}},seriesModel,idx)):(this.shape.endAngle=layout2.startAngle,updateProps$1(this,{shape:{endAngle:layout2.endAngle}},seriesModel,idx))}else saveOldStyle(this),updateProps$1(this,{shape:sectorShape},seriesModel,idx);this.useStyle(data.getItemVisual(idx,"style")),setStatesStylesFromModel(this,itemModel);var midAngle=(layout2.startAngle+layout2.endAngle)/2,offset=seriesModel.get("selectedOffset"),dx=Math.cos(midAngle)*offset,dy=Math.sin(midAngle)*offset,cursorStyle=itemModel.getShallow("cursor");cursorStyle&&this.attr("cursor",cursorStyle),this._updateLabel(seriesModel,data,idx),this.ensureState("emphasis").shape=extend({r:layout2.r+(emphasisModel.get("scale")&&emphasisModel.get("scaleSize")||0)},getSectorCornerRadius(emphasisModel.getModel("itemStyle"),layout2)),extend(this.ensureState("select"),{x:dx,y:dy,shape:getSectorCornerRadius(itemModel.getModel(["select","itemStyle"]),layout2)}),extend(this.ensureState("blur"),{shape:getSectorCornerRadius(itemModel.getModel(["blur","itemStyle"]),layout2)});var labelLine=this.getTextGuideLine(),labelText=this.getTextContent();labelLine&&extend(labelLine.ensureState("select"),{x:dx,y:dy}),extend(labelText.ensureState("select"),{x:dx,y:dy}),toggleHoverEmphasis(this,emphasisModel.get("focus"),emphasisModel.get("blurScope"),emphasisModel.get("disabled"))}},PiePiece2.prototype._updateLabel=function(seriesModel,data,idx){var itemModel=data.getItemModel(idx),labelLineModel=itemModel.getModel("labelLine"),style=data.getItemVisual(idx,"style"),visualColor=style&&style.fill,visualOpacity=style&&style.opacity;setLabelStyle(this,getLabelStatesModels(itemModel),{labelFetcher:data.hostModel,labelDataIndex:idx,inheritColor:visualColor,defaultOpacity:visualOpacity,defaultText:seriesModel.getFormattedLabel(idx,"normal")||data.getName(idx)});var labelText=this.getTextContent();this.setTextConfig({position:null,rotation:null}),labelText.attr({z2:10});var labelPosition=seriesModel.get(["label","position"]);if("outside"!==labelPosition&&"outer"!==labelPosition)this.removeTextGuideLine();else{var polyline=this.getTextGuideLine();polyline||(polyline=new Polyline,this.setTextGuideLine(polyline)),function(targetEl,statesModels,defaultStyle){var labelLine=targetEl.getTextGuideLine(),label=targetEl.getTextContent();if(label){for(var normalModel=statesModels.normal,showNormal=normalModel.get("show"),labelIgnoreNormal=label.ignore,i=0;i<DISPLAY_STATES.length;i++){var stateName=DISPLAY_STATES[i],stateModel=statesModels[stateName],isNormal="normal"===stateName;if(stateModel){var stateShow=stateModel.get("show");if((isNormal?labelIgnoreNormal:retrieve2(label.states[stateName]&&label.states[stateName].ignore,labelIgnoreNormal))||!retrieve2(stateShow,showNormal)){var stateObj=isNormal?labelLine:labelLine&&labelLine.states[stateName];stateObj&&(stateObj.ignore=!0),labelLine&&setLabelLineState(labelLine,!0,stateName,stateModel);continue}labelLine||(labelLine=new Polyline,targetEl.setTextGuideLine(labelLine),isNormal||!labelIgnoreNormal&&showNormal||setLabelLineState(labelLine,!0,"normal",statesModels.normal),targetEl.stateProxy&&(labelLine.stateProxy=targetEl.stateProxy)),setLabelLineState(labelLine,!1,stateName,stateModel)}}if(labelLine){defaults(labelLine.style,defaultStyle),labelLine.style.fill=null;var showAbove=normalModel.get("showAbove");(targetEl.textGuideLineConfig=targetEl.textGuideLineConfig||{}).showAbove=showAbove||!1,labelLine.buildPath=buildLabelLinePath}}else labelLine&&targetEl.removeTextGuideLine()}(this,function(itemModel,labelLineName){labelLineName=labelLineName||"labelLine";for(var statesModels={normal:itemModel.getModel(labelLineName)},i=0;i<SPECIAL_STATES.length;i++){var stateName=SPECIAL_STATES[i];statesModels[stateName]=itemModel.getModel([stateName,labelLineName])}return statesModels}(itemModel),{stroke:visualColor,opacity:retrieve3(labelLineModel.get(["lineStyle","opacity"]),visualOpacity,1)})}},PiePiece2}(Sector),PieView=function(_super){function PieView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.ignoreLabelLineUpdate=!0,_this}return __extends(PieView2,_super),PieView2.prototype.render=function(seriesModel,ecModel,api,payload){var startAngle,data=seriesModel.getData(),oldData=this._data,group=this.group;if(!oldData&&data.count()>0){for(var shape=data.getItemLayout(0),s=1;isNaN(shape&&shape.startAngle)&&s<data.count();++s)shape=data.getItemLayout(s);shape&&(startAngle=shape.startAngle)}if(this._emptyCircleSector&&group.remove(this._emptyCircleSector),0===data.count()&&seriesModel.get("showEmptyCircle")){var layoutData=getSeriesLayoutData(seriesModel),sector=new Sector({shape:extend(getBasicPieLayout(seriesModel,api),layoutData)});sector.useStyle(seriesModel.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=sector,group.add(sector)}data.diff(oldData).add((function(idx){var piePiece=new PiePiece(data,idx,startAngle);data.setItemGraphicEl(idx,piePiece),group.add(piePiece)})).update((function(newIdx,oldIdx){var piePiece=oldData.getItemGraphicEl(oldIdx);piePiece.updateData(data,newIdx,startAngle),piePiece.off("click"),group.add(piePiece),data.setItemGraphicEl(newIdx,piePiece)})).remove((function(idx){removeElementWithFadeOut(oldData.getItemGraphicEl(idx),seriesModel,idx)})).execute(),pieLabelLayout(seriesModel),"expansion"!==seriesModel.get("animationTypeUpdate")&&(this._data=data)},PieView2.prototype.dispose=function(){},PieView2.prototype.containPoint=function(point,seriesModel){var itemLayout=seriesModel.getData().getItemLayout(0);if(itemLayout){var dx=point[0]-itemLayout.cx,dy=point[1]-itemLayout.cy,radius=Math.sqrt(dx*dx+dy*dy);return radius<=itemLayout.r&&radius>=itemLayout.r0}},PieView2.type="pie",PieView2}(ChartView);function createSeriesDataSimply(seriesModel,opt,nameList){opt=isArray$1(opt)&&{coordDimensions:opt}||extend({encodeDefine:seriesModel.getEncode()},opt);var source=seriesModel.getSource(),dimensions=prepareSeriesDataSchema(source,opt).dimensions,list=new SeriesData(dimensions,seriesModel);return list.initData(source,nameList),list}var LegendVisualProvider=function(){function LegendVisualProvider2(getDataWithEncodedVisual,getRawData2){this._getDataWithEncodedVisual=getDataWithEncodedVisual,this._getRawData=getRawData2}return LegendVisualProvider2.prototype.getAllNames=function(){var rawData=this._getRawData();return rawData.mapArray(rawData.getName)},LegendVisualProvider2.prototype.containName=function(name){return this._getRawData().indexOfName(name)>=0},LegendVisualProvider2.prototype.indexOfName=function(name){return this._getDataWithEncodedVisual().indexOfName(name)},LegendVisualProvider2.prototype.getItemVisual=function(dataIndex,key){return this._getDataWithEncodedVisual().getItemVisual(dataIndex,key)},LegendVisualProvider2}(),innerData=makeInner(),PieSeriesModel=function(_super){function PieSeriesModel2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(PieSeriesModel2,_super),PieSeriesModel2.prototype.init=function(option){_super.prototype.init.apply(this,arguments),this.legendVisualProvider=new LegendVisualProvider(bind$1(this.getData,this),bind$1(this.getRawData,this)),this._defaultLabelLine(option)},PieSeriesModel2.prototype.mergeOption=function(){_super.prototype.mergeOption.apply(this,arguments)},PieSeriesModel2.prototype.getInitialData=function(){return createSeriesDataSimply(this,{coordDimensions:["value"],encodeDefaulter:curry$1(makeSeriesEncodeForNameBased,this)})},PieSeriesModel2.prototype.getDataParams=function(dataIndex){var data=this.getData(),dataInner=innerData(data),seats=dataInner.seats;if(!seats){var valueList_1=[];data.each(data.mapDimension("value"),(function(value){valueList_1.push(value)})),seats=dataInner.seats=getPercentSeats(valueList_1,data.hostModel.get("percentPrecision"))}var params=_super.prototype.getDataParams.call(this,dataIndex);return params.percent=seats[dataIndex]||0,params.$vars.push("percent"),params},PieSeriesModel2.prototype._defaultLabelLine=function(option){defaultEmphasis(option,"labelLine",["show"]);var labelLineNormalOpt=option.labelLine,labelLineEmphasisOpt=option.emphasis.labelLine;labelLineNormalOpt.show=labelLineNormalOpt.show&&option.label.show,labelLineEmphasisOpt.show=labelLineEmphasisOpt.show&&option.emphasis.label.show},PieSeriesModel2.type="series.pie",PieSeriesModel2.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},PieSeriesModel2}(SeriesModel);var ScatterSeriesModel=function(_super){function ScatterSeriesModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=ScatterSeriesModel2.type,_this.hasSymbolVisual=!0,_this}return __extends(ScatterSeriesModel2,_super),ScatterSeriesModel2.prototype.getInitialData=function(option,ecModel){return createSeriesData(0,this,{useEncodeDefaulter:!0})},ScatterSeriesModel2.prototype.getProgressive=function(){var progressive=this.option.progressive;return null==progressive?this.option.large?5e3:this.get("progressive"):progressive},ScatterSeriesModel2.prototype.getProgressiveThreshold=function(){var progressiveThreshold=this.option.progressiveThreshold;return null==progressiveThreshold?this.option.large?1e4:this.get("progressiveThreshold"):progressiveThreshold},ScatterSeriesModel2.prototype.brushSelector=function(dataIndex,data,selectors){return selectors.point(data.getItemLayout(dataIndex))},ScatterSeriesModel2.prototype.getZLevelKey=function(){return this.getData().count()>this.getProgressiveThreshold()?this.id:""},ScatterSeriesModel2.type="series.scatter",ScatterSeriesModel2.dependencies=["grid","polar","geo","singleAxis","calendar"],ScatterSeriesModel2.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},emphasis:{scale:!0},clip:!0,select:{itemStyle:{borderColor:"#212121"}},universalTransition:{divideShape:"clone"}},ScatterSeriesModel2}(SeriesModel),LargeSymbolPathShape=function(){return function(){}}(),LargeSymbolPath=function(_super){function LargeSymbolPath2(opts){var _this=_super.call(this,opts)||this;return _this._off=0,_this.hoverDataIdx=-1,_this}return __extends(LargeSymbolPath2,_super),LargeSymbolPath2.prototype.getDefaultShape=function(){return new LargeSymbolPathShape},LargeSymbolPath2.prototype.reset=function(){this.notClear=!1,this._off=0},LargeSymbolPath2.prototype.buildPath=function(path,shape){var i,points2=shape.points,size=shape.size,symbolProxy=this.symbolProxy,symbolProxyShape=symbolProxy.shape,ctx=path.getContext?path.getContext():path,canBoost=ctx&&size[0]<4,softClipShape=this.softClipShape;if(canBoost)this._ctx=ctx;else{for(this._ctx=null,i=this._off;i<points2.length;){var x=points2[i++],y=points2[i++];isNaN(x)||isNaN(y)||(softClipShape&&!softClipShape.contain(x,y)||(symbolProxyShape.x=x-size[0]/2,symbolProxyShape.y=y-size[1]/2,symbolProxyShape.width=size[0],symbolProxyShape.height=size[1],symbolProxy.buildPath(path,symbolProxyShape,!0)))}this.incremental&&(this._off=i,this.notClear=!0)}},LargeSymbolPath2.prototype.afterBrush=function(){var i,shape=this.shape,points2=shape.points,size=shape.size,ctx=this._ctx,softClipShape=this.softClipShape;if(ctx){for(i=this._off;i<points2.length;){var x=points2[i++],y=points2[i++];isNaN(x)||isNaN(y)||(softClipShape&&!softClipShape.contain(x,y)||ctx.fillRect(x-size[0]/2,y-size[1]/2,size[0],size[1]))}this.incremental&&(this._off=i,this.notClear=!0)}},LargeSymbolPath2.prototype.findDataIndex=function(x,y){for(var shape=this.shape,points2=shape.points,size=shape.size,w=Math.max(size[0],4),h=Math.max(size[1],4),idx=points2.length/2-1;idx>=0;idx--){var i=2*idx,x0=points2[i]-w/2,y0=points2[i+1]-h/2;if(x>=x0&&y>=y0&&x<=x0+w&&y<=y0+h)return idx}return-1},LargeSymbolPath2.prototype.contain=function(x,y){var localPos=this.transformCoordToLocal(x,y),rect=this.getBoundingRect();return x=localPos[0],y=localPos[1],rect.contain(x,y)?(this.hoverDataIdx=this.findDataIndex(x,y))>=0:(this.hoverDataIdx=-1,!1)},LargeSymbolPath2.prototype.getBoundingRect=function(){var rect=this._rect;if(!rect){for(var shape=this.shape,points2=shape.points,size=shape.size,w=size[0],h=size[1],minX=Infinity,minY=Infinity,maxX=-Infinity,maxY=-Infinity,i=0;i<points2.length;){var x=points2[i++],y=points2[i++];minX=Math.min(x,minX),maxX=Math.max(x,maxX),minY=Math.min(y,minY),maxY=Math.max(y,maxY)}rect=this._rect=new BoundingRect(minX-w/2,minY-h/2,maxX-minX+w,maxY-minY+h)}return rect},LargeSymbolPath2}(Path),LargeSymbolDraw=function(){function LargeSymbolDraw2(){this.group=new Group$2}return LargeSymbolDraw2.prototype.updateData=function(data,opt){this._clear();var symbolEl=this._create();symbolEl.setShape({points:data.getLayout("points")}),this._setCommon(symbolEl,data,opt)},LargeSymbolDraw2.prototype.updateLayout=function(data){var points2=data.getLayout("points");this.group.eachChild((function(child){if(null!=child.startIndex){var len2=2*(child.endIndex-child.startIndex),byteOffset=4*child.startIndex*2;points2=new Float32Array(points2.buffer,byteOffset,len2)}child.setShape("points",points2),child.reset()}))},LargeSymbolDraw2.prototype.incrementalPrepareUpdate=function(data){this._clear()},LargeSymbolDraw2.prototype.incrementalUpdate=function(taskParams,data,opt){var lastAdded=this._newAdded[0],points2=data.getLayout("points"),oldPoints=lastAdded&&lastAdded.shape.points;if(oldPoints&&oldPoints.length<2e4){var oldLen=oldPoints.length,newPoints=new Float32Array(oldLen+points2.length);newPoints.set(oldPoints),newPoints.set(points2,oldLen),lastAdded.endIndex=taskParams.end,lastAdded.setShape({points:newPoints})}else{this._newAdded=[];var symbolEl=this._create();symbolEl.startIndex=taskParams.start,symbolEl.endIndex=taskParams.end,symbolEl.incremental=!0,symbolEl.setShape({points:points2}),this._setCommon(symbolEl,data,opt)}},LargeSymbolDraw2.prototype.eachRendered=function(cb){this._newAdded[0]&&cb(this._newAdded[0])},LargeSymbolDraw2.prototype._create=function(){var symbolEl=new LargeSymbolPath({cursor:"default"});return symbolEl.ignoreCoarsePointer=!0,this.group.add(symbolEl),this._newAdded.push(symbolEl),symbolEl},LargeSymbolDraw2.prototype._setCommon=function(symbolEl,data,opt){var hostModel=data.hostModel;opt=opt||{};var size=data.getVisual("symbolSize");symbolEl.setShape("size",size instanceof Array?size:[size,size]),symbolEl.softClipShape=opt.clipShape||null,symbolEl.symbolProxy=createSymbol(data.getVisual("symbol"),0,0,0,0),symbolEl.setColor=symbolEl.symbolProxy.setColor;var extrudeShadow=symbolEl.shape.size[0]<4;symbolEl.useStyle(hostModel.getModel("itemStyle").getItemStyle(extrudeShadow?["color","shadowBlur","shadowColor"]:["color"]));var globalStyle=data.getVisual("style"),visualColor=globalStyle&&globalStyle.fill;visualColor&&symbolEl.setColor(visualColor);var ecData=getECData(symbolEl);ecData.seriesIndex=hostModel.seriesIndex,symbolEl.on("mousemove",(function(e2){ecData.dataIndex=null;var dataIndex=symbolEl.hoverDataIdx;dataIndex>=0&&(ecData.dataIndex=dataIndex+(symbolEl.startIndex||0))}))},LargeSymbolDraw2.prototype.remove=function(){this._clear()},LargeSymbolDraw2.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},LargeSymbolDraw2}(),ScatterView=function(_super){function ScatterView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=ScatterView2.type,_this}return __extends(ScatterView2,_super),ScatterView2.prototype.render=function(seriesModel,ecModel,api){var data=seriesModel.getData();this._updateSymbolDraw(data,seriesModel).updateData(data,{clipShape:this._getClipShape(seriesModel)}),this._finished=!0},ScatterView2.prototype.incrementalPrepareRender=function(seriesModel,ecModel,api){var data=seriesModel.getData();this._updateSymbolDraw(data,seriesModel).incrementalPrepareUpdate(data),this._finished=!1},ScatterView2.prototype.incrementalRender=function(taskParams,seriesModel,ecModel){this._symbolDraw.incrementalUpdate(taskParams,seriesModel.getData(),{clipShape:this._getClipShape(seriesModel)}),this._finished=taskParams.end===seriesModel.getData().count()},ScatterView2.prototype.updateTransform=function(seriesModel,ecModel,api){var data=seriesModel.getData();if(this.group.dirty(),!this._finished||data.count()>1e4)return{update:!0};var res=pointsLayout("").reset(seriesModel,ecModel,api);res.progress&&res.progress({start:0,end:data.count(),count:data.count()},data),this._symbolDraw.updateLayout(data)},ScatterView2.prototype.eachRendered=function(cb){this._symbolDraw&&this._symbolDraw.eachRendered(cb)},ScatterView2.prototype._getClipShape=function(seriesModel){if(seriesModel.get("clip",!0)){var coordSys=seriesModel.coordinateSystem;return coordSys&&coordSys.getArea&&coordSys.getArea(.1)}},ScatterView2.prototype._updateSymbolDraw=function(data,seriesModel){var symbolDraw=this._symbolDraw,isLargeDraw=seriesModel.pipelineContext.large;return symbolDraw&&isLargeDraw===this._isLargeDraw||(symbolDraw&&symbolDraw.remove(),symbolDraw=this._symbolDraw=isLargeDraw?new LargeSymbolDraw:new SymbolDraw,this._isLargeDraw=isLargeDraw,this.group.removeAll()),this.group.add(symbolDraw.group),symbolDraw},ScatterView2.prototype.remove=function(ecModel,api){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null},ScatterView2.prototype.dispose=function(){},ScatterView2.type="scatter",ScatterView2}(ChartView),GridModel=function(_super){function GridModel2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(GridModel2,_super),GridModel2.type="grid",GridModel2.dependencies=["xAxis","yAxis"],GridModel2.layoutMode="box",GridModel2.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},GridModel2}(ComponentModel),CartesianAxisModel=function(_super){function CartesianAxisModel2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(CartesianAxisModel2,_super),CartesianAxisModel2.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",SINGLE_REFERRING).models[0]},CartesianAxisModel2.type="cartesian2dAxis",CartesianAxisModel2}(ComponentModel);mixin(CartesianAxisModel,AxisModelCommonMixin);var defaultOption$1={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,showMinLine:!0,showMaxLine:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},categoryAxis=merge({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},defaultOption$1),valueAxis=merge({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},defaultOption$1);const axisDefault={category:categoryAxis,value:valueAxis,time:merge({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},valueAxis),log:defaults({logBase:10},valueAxis)};var AXIS_TYPES={value:1,category:1,time:1,log:1};function axisModelCreator(registers,axisName,BaseAxisModelClass,extraDefaultOption){each$d(AXIS_TYPES,(function(v,axisType){var defaultOption2=merge(merge({},axisDefault[axisType],!0),extraDefaultOption,!0),AxisModel=function(_super){function AxisModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=axisName+"Axis."+axisType,_this}return __extends(AxisModel2,_super),AxisModel2.prototype.mergeDefaultAndTheme=function(option,ecModel){var layoutMode=fetchLayoutMode(this),inputPositionParams=layoutMode?getLayoutParams(option):{};merge(option,ecModel.getTheme().get(axisType+"Axis")),merge(option,this.getDefaultOption()),option.type=getAxisType(option),layoutMode&&mergeLayoutParam(option,inputPositionParams,layoutMode)},AxisModel2.prototype.optionUpdated=function(){"category"===this.option.type&&(this.__ordinalMeta=OrdinalMeta.createByAxisModel(this))},AxisModel2.prototype.getCategories=function(rawData){var option=this.option;if("category"===option.type)return rawData?option.data:this.__ordinalMeta.categories},AxisModel2.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},AxisModel2.type=axisName+"Axis."+axisType,AxisModel2.defaultOption=defaultOption2,AxisModel2}(BaseAxisModelClass);registers.registerComponentModel(AxisModel)})),registers.registerSubTypeDefaulter(axisName+"Axis",getAxisType)}function getAxisType(option){return option.type||(option.data?"category":"value")}var Cartesian=function(){function Cartesian2(name){this.type="cartesian",this._dimList=[],this._axes={},this.name=name||""}return Cartesian2.prototype.getAxis=function(dim){return this._axes[dim]},Cartesian2.prototype.getAxes=function(){return map$1(this._dimList,(function(dim){return this._axes[dim]}),this)},Cartesian2.prototype.getAxesByScale=function(scaleType){return scaleType=scaleType.toLowerCase(),filter(this.getAxes(),(function(axis){return axis.scale.type===scaleType}))},Cartesian2.prototype.addAxis=function(axis){var dim=axis.dim;this._axes[dim]=axis,this._dimList.push(dim)},Cartesian2}(),cartesian2DDimensions=["x","y"];function canCalculateAffineTransform(scale2){return"interval"===scale2.type||"time"===scale2.type}var Cartesian2D=function(_super){function Cartesian2D2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type="cartesian2d",_this.dimensions=cartesian2DDimensions,_this}return __extends(Cartesian2D2,_super),Cartesian2D2.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var xAxisScale=this.getAxis("x").scale,yAxisScale=this.getAxis("y").scale;if(canCalculateAffineTransform(xAxisScale)&&canCalculateAffineTransform(yAxisScale)){var xScaleExtent=xAxisScale.getExtent(),yScaleExtent=yAxisScale.getExtent(),start2=this.dataToPoint([xScaleExtent[0],yScaleExtent[0]]),end2=this.dataToPoint([xScaleExtent[1],yScaleExtent[1]]),xScaleSpan=xScaleExtent[1]-xScaleExtent[0],yScaleSpan=yScaleExtent[1]-yScaleExtent[0];if(xScaleSpan&&yScaleSpan){var scaleX=(end2[0]-start2[0])/xScaleSpan,scaleY=(end2[1]-start2[1])/yScaleSpan,translateX=start2[0]-xScaleExtent[0]*scaleX,translateY=start2[1]-yScaleExtent[0]*scaleY,m2=this._transform=[scaleX,0,0,scaleY,translateX,translateY];this._invTransform=invert([],m2)}}},Cartesian2D2.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},Cartesian2D2.prototype.containPoint=function(point){var axisX=this.getAxis("x"),axisY=this.getAxis("y");return axisX.contain(axisX.toLocalCoord(point[0]))&&axisY.contain(axisY.toLocalCoord(point[1]))},Cartesian2D2.prototype.containData=function(data){return this.getAxis("x").containData(data[0])&&this.getAxis("y").containData(data[1])},Cartesian2D2.prototype.containZone=function(data1,data2){var zoneDiag1=this.dataToPoint(data1),zoneDiag2=this.dataToPoint(data2),area=this.getArea(),zone=new BoundingRect(zoneDiag1[0],zoneDiag1[1],zoneDiag2[0]-zoneDiag1[0],zoneDiag2[1]-zoneDiag1[1]);return area.intersect(zone)},Cartesian2D2.prototype.dataToPoint=function(data,clamp2,out2){out2=out2||[];var xVal=data[0],yVal=data[1];if(this._transform&&null!=xVal&&isFinite(xVal)&&null!=yVal&&isFinite(yVal))return applyTransform$1(out2,data,this._transform);var xAxis=this.getAxis("x"),yAxis=this.getAxis("y");return out2[0]=xAxis.toGlobalCoord(xAxis.dataToCoord(xVal,clamp2)),out2[1]=yAxis.toGlobalCoord(yAxis.dataToCoord(yVal,clamp2)),out2},Cartesian2D2.prototype.clampData=function(data,out2){var xScale=this.getAxis("x").scale,yScale=this.getAxis("y").scale,xAxisExtent=xScale.getExtent(),yAxisExtent=yScale.getExtent(),x=xScale.parse(data[0]),y=yScale.parse(data[1]);return(out2=out2||[])[0]=Math.min(Math.max(Math.min(xAxisExtent[0],xAxisExtent[1]),x),Math.max(xAxisExtent[0],xAxisExtent[1])),out2[1]=Math.min(Math.max(Math.min(yAxisExtent[0],yAxisExtent[1]),y),Math.max(yAxisExtent[0],yAxisExtent[1])),out2},Cartesian2D2.prototype.pointToData=function(point,clamp2){var out2=[];if(this._invTransform)return applyTransform$1(out2,point,this._invTransform);var xAxis=this.getAxis("x"),yAxis=this.getAxis("y");return out2[0]=xAxis.coordToData(xAxis.toLocalCoord(point[0]),clamp2),out2[1]=yAxis.coordToData(yAxis.toLocalCoord(point[1]),clamp2),out2},Cartesian2D2.prototype.getOtherAxis=function(axis){return this.getAxis("x"===axis.dim?"y":"x")},Cartesian2D2.prototype.getArea=function(tolerance){tolerance=tolerance||0;var xExtent=this.getAxis("x").getGlobalExtent(),yExtent=this.getAxis("y").getGlobalExtent(),x=Math.min(xExtent[0],xExtent[1])-tolerance,y=Math.min(yExtent[0],yExtent[1])-tolerance,width=Math.max(xExtent[0],xExtent[1])-x+tolerance,height=Math.max(yExtent[0],yExtent[1])-y+tolerance;return new BoundingRect(x,y,width,height)},Cartesian2D2}(Cartesian),Axis2D=function(_super){function Axis2D2(dim,scale2,coordExtent,axisType,position){var _this=_super.call(this,dim,scale2,coordExtent)||this;return _this.index=0,_this.type=axisType||"value",_this.position=position||"bottom",_this}return __extends(Axis2D2,_super),Axis2D2.prototype.isHorizontal=function(){var position=this.position;return"top"===position||"bottom"===position},Axis2D2.prototype.getGlobalExtent=function(asc2){var ret=this.getExtent();return ret[0]=this.toGlobalCoord(ret[0]),ret[1]=this.toGlobalCoord(ret[1]),asc2&&ret[0]>ret[1]&&ret.reverse(),ret},Axis2D2.prototype.pointToData=function(point,clamp2){return this.coordToData(this.toLocalCoord(point["x"===this.dim?0:1]),clamp2)},Axis2D2.prototype.setCategorySortInfo=function(info){if("category"!==this.type)return!1;this.model.option.categorySortInfo=info,this.scale.setSortInfo(info)},Axis2D2}(Axis);function layout$1(gridModel,axisModel,opt){opt=opt||{};var grid=gridModel.coordinateSystem,axis=axisModel.axis,layout2={},otherAxisOnZeroOf=axis.getAxesOnZeroOf()[0],rawAxisPosition=axis.position,axisPosition=otherAxisOnZeroOf?"onZero":rawAxisPosition,axisDim=axis.dim,rect=grid.getRect(),rectBound=[rect.x,rect.x+rect.width,rect.y,rect.y+rect.height],idx={left:0,right:1,top:0,bottom:1,onZero:2},axisOffset=axisModel.get("offset")||0,posBound="x"===axisDim?[rectBound[2]-axisOffset,rectBound[3]+axisOffset]:[rectBound[0]-axisOffset,rectBound[1]+axisOffset];if(otherAxisOnZeroOf){var onZeroCoord=otherAxisOnZeroOf.toGlobalCoord(otherAxisOnZeroOf.dataToCoord(0));posBound[idx.onZero]=Math.max(Math.min(onZeroCoord,posBound[1]),posBound[0])}layout2.position=["y"===axisDim?posBound[idx[axisPosition]]:rectBound[0],"x"===axisDim?posBound[idx[axisPosition]]:rectBound[3]],layout2.rotation=Math.PI/2*("x"===axisDim?0:1);layout2.labelDirection=layout2.tickDirection=layout2.nameDirection={top:-1,bottom:1,left:-1,right:1}[rawAxisPosition],layout2.labelOffset=otherAxisOnZeroOf?posBound[idx[rawAxisPosition]]-posBound[idx.onZero]:0,axisModel.get(["axisTick","inside"])&&(layout2.tickDirection=-layout2.tickDirection),retrieve(opt.labelInside,axisModel.get(["axisLabel","inside"]))&&(layout2.labelDirection=-layout2.labelDirection);var labelRotate=axisModel.get(["axisLabel","rotate"]);return layout2.labelRotate="top"===axisPosition?-labelRotate:labelRotate,layout2.z2=1,layout2}function isCartesian2DSeries(seriesModel){return"cartesian2d"===seriesModel.get("coordinateSystem")}function findAxisModels(seriesModel){var axisModelMap={xAxisModel:null,yAxisModel:null};return each$d(axisModelMap,(function(v,key){var axisType=key.replace(/Model$/,""),axisModel=seriesModel.getReferringComponents(axisType,SINGLE_REFERRING).models[0];axisModelMap[key]=axisModel})),axisModelMap}var mathLog=Math.log;function alignScaleTicks(scale2,axisModel,alignToScale){var intervalScaleProto2=IntervalScale.prototype,alignToTicks=intervalScaleProto2.getTicks.call(alignToScale),alignToNicedTicks=intervalScaleProto2.getTicks.call(alignToScale,!0),alignToSplitNumber=alignToTicks.length-1,alignToInterval=intervalScaleProto2.getInterval.call(alignToScale),scaleExtent=getScaleExtent(scale2,axisModel),rawExtent=scaleExtent.extent,isMinFixed=scaleExtent.fixMin,isMaxFixed=scaleExtent.fixMax;if("log"===scale2.type){var logBase=mathLog(scale2.base);rawExtent=[mathLog(rawExtent[0])/logBase,mathLog(rawExtent[1])/logBase]}scale2.setExtent(rawExtent[0],rawExtent[1]),scale2.calcNiceExtent({splitNumber:alignToSplitNumber,fixMin:isMinFixed,fixMax:isMaxFixed});var extent3=intervalScaleProto2.getExtent.call(scale2);isMinFixed&&(rawExtent[0]=extent3[0]),isMaxFixed&&(rawExtent[1]=extent3[1]);var interval=intervalScaleProto2.getInterval.call(scale2),min3=rawExtent[0],max3=rawExtent[1];if(isMinFixed&&isMaxFixed)interval=(max3-min3)/alignToSplitNumber;else if(isMinFixed)for(max3=rawExtent[0]+interval*alignToSplitNumber;max3<rawExtent[1]&&isFinite(max3)&&isFinite(rawExtent[1]);)interval=increaseInterval(interval),max3=rawExtent[0]+interval*alignToSplitNumber;else if(isMaxFixed)for(min3=rawExtent[1]-interval*alignToSplitNumber;min3>rawExtent[0]&&isFinite(min3)&&isFinite(rawExtent[0]);)interval=increaseInterval(interval),min3=rawExtent[1]-interval*alignToSplitNumber;else{scale2.getTicks().length-1>alignToSplitNumber&&(interval=increaseInterval(interval));var range=interval*alignToSplitNumber;(min3=round$3((max3=Math.ceil(rawExtent[1]/interval)*interval)-range))<0&&rawExtent[0]>=0?(min3=0,max3=round$3(range)):max3>0&&rawExtent[1]<=0&&(max3=0,min3=-round$3(range))}var t0=(alignToTicks[0].value-alignToNicedTicks[0].value)/alignToInterval,t1=(alignToTicks[alignToSplitNumber].value-alignToNicedTicks[alignToSplitNumber].value)/alignToInterval;intervalScaleProto2.setExtent.call(scale2,min3+interval*t0,max3+interval*t1),intervalScaleProto2.setInterval.call(scale2,interval),(t0||t1)&&intervalScaleProto2.setNiceExtent.call(scale2,min3+interval,max3-interval)}var Grid=function(){function Grid2(gridModel,ecModel,api){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=cartesian2DDimensions,this._initCartesian(gridModel,ecModel,api),this.model=gridModel}return Grid2.prototype.getRect=function(){return this._rect},Grid2.prototype.update=function(ecModel,api){var axesMap=this._axesMap;function updateAxisTicks(axes){var alignTo,axesIndices=keys(axes),len2=axesIndices.length;if(len2){for(var axisNeedsAlign=[],i=len2-1;i>=0;i--){var axis=axes[+axesIndices[i]],model=axis.model,scale2=axis.scale;isIntervalOrLogScale(scale2)&&model.get("alignTicks")&&null==model.get("interval")?axisNeedsAlign.push(axis):(niceScaleExtent(scale2,model),isIntervalOrLogScale(scale2)&&(alignTo=axis))}axisNeedsAlign.length&&(alignTo||niceScaleExtent((alignTo=axisNeedsAlign.pop()).scale,alignTo.model),each$d(axisNeedsAlign,(function(axis2){alignScaleTicks(axis2.scale,axis2.model,alignTo.scale)})))}}this._updateScale(ecModel,this.model),updateAxisTicks(axesMap.x),updateAxisTicks(axesMap.y);var onZeroRecords={};each$d(axesMap.x,(function(xAxis){fixAxisOnZero(axesMap,"y",xAxis,onZeroRecords)})),each$d(axesMap.y,(function(yAxis){fixAxisOnZero(axesMap,"x",yAxis,onZeroRecords)})),this.resize(this.model,api)},Grid2.prototype.resize=function(gridModel,api,ignoreContainLabel){var boxLayoutParams=gridModel.getBoxLayoutParams(),isContainLabel=!ignoreContainLabel&&gridModel.get("containLabel"),gridRect=getLayoutRect(boxLayoutParams,{width:api.getWidth(),height:api.getHeight()});this._rect=gridRect;var axesList=this._axesList;function adjustAxes(){each$d(axesList,(function(axis){var isHorizontal=axis.isHorizontal(),extent3=isHorizontal?[0,gridRect.width]:[0,gridRect.height],idx=axis.inverse?1:0;axis.setExtent(extent3[idx],extent3[1-idx]),function(axis,coordBase){var axisExtent=axis.getExtent(),axisExtentSum=axisExtent[0]+axisExtent[1];axis.toGlobalCoord="x"===axis.dim?function(coord){return coord+coordBase}:function(coord){return axisExtentSum-coord+coordBase},axis.toLocalCoord="x"===axis.dim?function(coord){return coord-coordBase}:function(coord){return axisExtentSum-coord+coordBase}}(axis,isHorizontal?gridRect.x:gridRect.y)}))}adjustAxes(),isContainLabel&&(each$d(axesList,(function(axis){if(!axis.model.get(["axisLabel","inside"])){var labelUnionRect=function(axis){var axisModel=axis.model,scale2=axis.scale;if(axisModel.get(["axisLabel","show"])&&!scale2.isBlank()){var realNumberScaleTicks,tickCount,categoryScaleExtent=scale2.getExtent();tickCount=scale2 instanceof OrdinalScale?scale2.count():(realNumberScaleTicks=scale2.getTicks()).length;var rect,textRect,rotateRadians,beforeWidth,beforeHeight,afterWidth,afterHeight,axisLabelModel=axis.getLabelModel(),labelFormatter=makeLabelFormatter(axis),step=1;tickCount>40&&(step=Math.ceil(tickCount/40));for(var i=0;i<tickCount;i+=step){var label=labelFormatter(realNumberScaleTicks?realNumberScaleTicks[i]:{value:categoryScaleExtent[0]+i},i),singleRect=(textRect=axisLabelModel.getTextRect(label),rotateRadians=void 0,beforeWidth=void 0,beforeHeight=void 0,afterWidth=void 0,afterHeight=void 0,rotateRadians=(axisLabelModel.get("rotate")||0)*Math.PI/180,beforeWidth=textRect.width,beforeHeight=textRect.height,afterWidth=beforeWidth*Math.abs(Math.cos(rotateRadians))+Math.abs(beforeHeight*Math.sin(rotateRadians)),afterHeight=beforeWidth*Math.abs(Math.sin(rotateRadians))+Math.abs(beforeHeight*Math.cos(rotateRadians)),new BoundingRect(textRect.x,textRect.y,afterWidth,afterHeight));rect?rect.union(singleRect):rect=singleRect}return rect}}(axis);if(labelUnionRect){var dim=axis.isHorizontal()?"height":"width",margin=axis.model.get(["axisLabel","margin"]);gridRect[dim]-=labelUnionRect[dim]+margin,"top"===axis.position?gridRect.y+=labelUnionRect.height+margin:"left"===axis.position&&(gridRect.x+=labelUnionRect.width+margin)}}})),adjustAxes()),each$d(this._coordsList,(function(coord){coord.calcAffineTransform()}))},Grid2.prototype.getAxis=function(dim,axisIndex){var axesMapOnDim=this._axesMap[dim];if(null!=axesMapOnDim)return axesMapOnDim[axisIndex||0]},Grid2.prototype.getAxes=function(){return this._axesList.slice()},Grid2.prototype.getCartesian=function(xAxisIndex,yAxisIndex){if(null!=xAxisIndex&&null!=yAxisIndex){var key="x"+xAxisIndex+"y"+yAxisIndex;return this._coordsMap[key]}isObject$3(xAxisIndex)&&(yAxisIndex=xAxisIndex.yAxisIndex,xAxisIndex=xAxisIndex.xAxisIndex);for(var i=0,coordList=this._coordsList;i<coordList.length;i++)if(coordList[i].getAxis("x").index===xAxisIndex||coordList[i].getAxis("y").index===yAxisIndex)return coordList[i]},Grid2.prototype.getCartesians=function(){return this._coordsList.slice()},Grid2.prototype.convertToPixel=function(ecModel,finder,value){var target=this._findConvertTarget(finder);return target.cartesian?target.cartesian.dataToPoint(value):target.axis?target.axis.toGlobalCoord(target.axis.dataToCoord(value)):null},Grid2.prototype.convertFromPixel=function(ecModel,finder,value){var target=this._findConvertTarget(finder);return target.cartesian?target.cartesian.pointToData(value):target.axis?target.axis.coordToData(target.axis.toLocalCoord(value)):null},Grid2.prototype._findConvertTarget=function(finder){var cartesian,axis,seriesModel=finder.seriesModel,xAxisModel=finder.xAxisModel||seriesModel&&seriesModel.getReferringComponents("xAxis",SINGLE_REFERRING).models[0],yAxisModel=finder.yAxisModel||seriesModel&&seriesModel.getReferringComponents("yAxis",SINGLE_REFERRING).models[0],gridModel=finder.gridModel,coordsList=this._coordsList;if(seriesModel)indexOf(coordsList,cartesian=seriesModel.coordinateSystem)<0&&(cartesian=null);else if(xAxisModel&&yAxisModel)cartesian=this.getCartesian(xAxisModel.componentIndex,yAxisModel.componentIndex);else if(xAxisModel)axis=this.getAxis("x",xAxisModel.componentIndex);else if(yAxisModel)axis=this.getAxis("y",yAxisModel.componentIndex);else if(gridModel){gridModel.coordinateSystem===this&&(cartesian=this._coordsList[0])}return{cartesian:cartesian,axis:axis}},Grid2.prototype.containPoint=function(point){var coord=this._coordsList[0];if(coord)return coord.containPoint(point)},Grid2.prototype._initCartesian=function(gridModel,ecModel,api){var _this=this,grid=this,axisPositionUsed={left:!1,right:!1,top:!1,bottom:!1},axesMap={x:{},y:{}},axesCount={x:0,y:0};if(ecModel.eachComponent("xAxis",createAxisCreator("x"),this),ecModel.eachComponent("yAxis",createAxisCreator("y"),this),!axesCount.x||!axesCount.y)return this._axesMap={},void(this._axesList=[]);function createAxisCreator(dimName){return function(axisModel,idx){if(isAxisUsedInTheGrid(axisModel,gridModel)){var axisPosition=axisModel.get("position");"x"===dimName?"top"!==axisPosition&&"bottom"!==axisPosition&&(axisPosition=axisPositionUsed.bottom?"top":"bottom"):"left"!==axisPosition&&"right"!==axisPosition&&(axisPosition=axisPositionUsed.left?"right":"left"),axisPositionUsed[axisPosition]=!0;var axis=new Axis2D(dimName,createScaleByModel$1(axisModel),[0,0],axisModel.get("type"),axisPosition),isCategory2="category"===axis.type;axis.onBand=isCategory2&&axisModel.get("boundaryGap"),axis.inverse=axisModel.get("inverse"),axisModel.axis=axis,axis.model=axisModel,axis.grid=grid,axis.index=idx,grid._axesList.push(axis),axesMap[dimName][idx]=axis,axesCount[dimName]++}}}this._axesMap=axesMap,each$d(axesMap.x,(function(xAxis,xAxisIndex){each$d(axesMap.y,(function(yAxis,yAxisIndex){var key="x"+xAxisIndex+"y"+yAxisIndex,cartesian=new Cartesian2D(key);cartesian.master=_this,cartesian.model=gridModel,_this._coordsMap[key]=cartesian,_this._coordsList.push(cartesian),cartesian.addAxis(xAxis),cartesian.addAxis(yAxis)}))}))},Grid2.prototype._updateScale=function(ecModel,gridModel){function unionExtent(data,axis){each$d(getDataDimensionsOnAxis(data,axis.dim),(function(dim){axis.scale.unionExtentFromData(data,dim)}))}each$d(this._axesList,(function(axis){if(axis.scale.setExtent(Infinity,-Infinity),"category"===axis.type){var categorySortInfo=axis.model.get("categorySortInfo");axis.scale.setSortInfo(categorySortInfo)}})),ecModel.eachSeries((function(seriesModel){if(isCartesian2DSeries(seriesModel)){var axesModelMap=findAxisModels(seriesModel),xAxisModel=axesModelMap.xAxisModel,yAxisModel=axesModelMap.yAxisModel;if(!isAxisUsedInTheGrid(xAxisModel,gridModel)||!isAxisUsedInTheGrid(yAxisModel,gridModel))return;var cartesian=this.getCartesian(xAxisModel.componentIndex,yAxisModel.componentIndex),data=seriesModel.getData(),xAxis=cartesian.getAxis("x"),yAxis=cartesian.getAxis("y");unionExtent(data,xAxis),unionExtent(data,yAxis)}}),this)},Grid2.prototype.getTooltipAxes=function(dim){var baseAxes=[],otherAxes=[];return each$d(this.getCartesians(),(function(cartesian){var baseAxis=null!=dim&&"auto"!==dim?cartesian.getAxis(dim):cartesian.getBaseAxis(),otherAxis=cartesian.getOtherAxis(baseAxis);indexOf(baseAxes,baseAxis)<0&&baseAxes.push(baseAxis),indexOf(otherAxes,otherAxis)<0&&otherAxes.push(otherAxis)})),{baseAxes:baseAxes,otherAxes:otherAxes}},Grid2.create=function(ecModel,api){var grids=[];return ecModel.eachComponent("grid",(function(gridModel,idx){var grid=new Grid2(gridModel,ecModel,api);grid.name="grid_"+idx,grid.resize(gridModel,api,!0),gridModel.coordinateSystem=grid,grids.push(grid)})),ecModel.eachSeries((function(seriesModel){if(isCartesian2DSeries(seriesModel)){var axesModelMap=findAxisModels(seriesModel),xAxisModel=axesModelMap.xAxisModel,yAxisModel=axesModelMap.yAxisModel,grid=xAxisModel.getCoordSysModel().coordinateSystem;seriesModel.coordinateSystem=grid.getCartesian(xAxisModel.componentIndex,yAxisModel.componentIndex)}})),grids},Grid2.dimensions=cartesian2DDimensions,Grid2}();function isAxisUsedInTheGrid(axisModel,gridModel){return axisModel.getCoordSysModel()===gridModel}function fixAxisOnZero(axesMap,otherAxisDim,axis,onZeroRecords){axis.getAxesOnZeroOf=function(){return otherAxisOnZeroOf?[otherAxisOnZeroOf]:[]};var otherAxisOnZeroOf,otherAxes=axesMap[otherAxisDim],axisModel=axis.model,onZero=axisModel.get(["axisLine","onZero"]),onZeroAxisIndex=axisModel.get(["axisLine","onZeroAxisIndex"]);if(onZero){if(null!=onZeroAxisIndex)canOnZeroToAxis(otherAxes[onZeroAxisIndex])&&(otherAxisOnZeroOf=otherAxes[onZeroAxisIndex]);else for(var idx in otherAxes)if(otherAxes.hasOwnProperty(idx)&&canOnZeroToAxis(otherAxes[idx])&&!onZeroRecords[getOnZeroRecordKey(otherAxes[idx])]){otherAxisOnZeroOf=otherAxes[idx];break}otherAxisOnZeroOf&&(onZeroRecords[getOnZeroRecordKey(otherAxisOnZeroOf)]=!0)}function getOnZeroRecordKey(axis2){return axis2.dim+"_"+axis2.index}}function canOnZeroToAxis(axis){return axis&&"category"!==axis.type&&"time"!==axis.type&&function(axis){var dataExtent=axis.scale.getExtent(),min3=dataExtent[0],max3=dataExtent[1];return!(min3>0&&max3>0||min3<0&&max3<0)}(axis)}var PI$3=Math.PI,AxisBuilder=function(){function AxisBuilder2(axisModel,opt){this.group=new Group$2,this.opt=opt,this.axisModel=axisModel,defaults(opt,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var transformGroup=new Group$2({x:opt.position[0],y:opt.position[1],rotation:opt.rotation});transformGroup.updateTransform(),this._transformGroup=transformGroup}return AxisBuilder2.prototype.hasBuilder=function(name){return!!builders[name]},AxisBuilder2.prototype.add=function(name){builders[name](this.opt,this.axisModel,this.group,this._transformGroup)},AxisBuilder2.prototype.getGroup=function(){return this.group},AxisBuilder2.innerTextLayout=function(axisRotation,textRotation,direction){var textAlign,textVerticalAlign,rotationDiff=remRadian(textRotation-axisRotation);return isRadianAroundZero(rotationDiff)?(textVerticalAlign=direction>0?"top":"bottom",textAlign="center"):isRadianAroundZero(rotationDiff-PI$3)?(textVerticalAlign=direction>0?"bottom":"top",textAlign="center"):(textVerticalAlign="middle",textAlign=rotationDiff>0&&rotationDiff<PI$3?direction>0?"right":"left":direction>0?"left":"right"),{rotation:rotationDiff,textAlign:textAlign,textVerticalAlign:textVerticalAlign}},AxisBuilder2.makeAxisEventDataBase=function(axisModel){var eventData={componentType:axisModel.mainType,componentIndex:axisModel.componentIndex};return eventData[axisModel.mainType+"Index"]=axisModel.componentIndex,eventData},AxisBuilder2.isLabelSilent=function(axisModel){var tooltipOpt=axisModel.get("tooltip");return axisModel.get("silent")||!(axisModel.get("triggerEvent")||tooltipOpt&&tooltipOpt.show)},AxisBuilder2}(),builders={axisLine:function(opt,axisModel,group,transformGroup){var shown=axisModel.get(["axisLine","show"]);if("auto"===shown&&opt.handleAutoShown&&(shown=opt.handleAutoShown("axisLine")),shown){var extent3=axisModel.axis.getExtent(),matrix2=transformGroup.transform,pt12=[extent3[0],0],pt22=[extent3[1],0],inverse=pt12[0]>pt22[0];matrix2&&(applyTransform$1(pt12,pt12,matrix2),applyTransform$1(pt22,pt22,matrix2));var lineStyle=extend({lineCap:"round"},axisModel.getModel(["axisLine","lineStyle"]).getLineStyle()),line=new Line({shape:{x1:pt12[0],y1:pt12[1],x2:pt22[0],y2:pt22[1]},style:lineStyle,strokeContainThreshold:opt.strokeContainThreshold||5,silent:!0,z2:1});subPixelOptimizeLine(line.shape,line.style.lineWidth),line.anid="line",group.add(line);var arrows=axisModel.get(["axisLine","symbol"]);if(null!=arrows){var arrowSize=axisModel.get(["axisLine","symbolSize"]);isString(arrows)&&(arrows=[arrows,arrows]),(isString(arrowSize)||isNumber(arrowSize))&&(arrowSize=[arrowSize,arrowSize]);var arrowOffset=normalizeSymbolOffset(axisModel.get(["axisLine","symbolOffset"])||0,arrowSize),symbolWidth_1=arrowSize[0],symbolHeight_1=arrowSize[1];each$d([{rotate:opt.rotation+Math.PI/2,offset:arrowOffset[0],r:0},{rotate:opt.rotation-Math.PI/2,offset:arrowOffset[1],r:Math.sqrt((pt12[0]-pt22[0])*(pt12[0]-pt22[0])+(pt12[1]-pt22[1])*(pt12[1]-pt22[1]))}],(function(point,index){if("none"!==arrows[index]&&null!=arrows[index]){var symbol=createSymbol(arrows[index],-symbolWidth_1/2,-symbolHeight_1/2,symbolWidth_1,symbolHeight_1,lineStyle.stroke,!0),r=point.r+point.offset,pt=inverse?pt22:pt12;symbol.attr({rotation:point.rotate,x:pt[0]+r*Math.cos(opt.rotation),y:pt[1]-r*Math.sin(opt.rotation),silent:!0,z2:11}),group.add(symbol)}}))}}},axisTickLabel:function(opt,axisModel,group,transformGroup){var ticksEls=function(group,transformGroup,axisModel,opt){var axis=axisModel.axis,tickModel=axisModel.getModel("axisTick"),shown=tickModel.get("show");"auto"===shown&&opt.handleAutoShown&&(shown=opt.handleAutoShown("axisTick"));if(!shown||axis.scale.isBlank())return;for(var lineStyleModel=tickModel.getModel("lineStyle"),tickEndCoord=opt.tickDirection*tickModel.get("length"),ticksEls=createTicks(axis.getTicksCoords(),transformGroup.transform,tickEndCoord,defaults(lineStyleModel.getLineStyle(),{stroke:axisModel.get(["axisLine","lineStyle","color"])}),"ticks"),i=0;i<ticksEls.length;i++)group.add(ticksEls[i]);return ticksEls}(group,transformGroup,axisModel,opt),labelEls=function(group,transformGroup,axisModel,opt){var axis=axisModel.axis,show=retrieve(opt.axisLabelShow,axisModel.get(["axisLabel","show"]));if(!show||axis.scale.isBlank())return;var labelModel=axisModel.getModel("axisLabel"),labelMargin=labelModel.get("margin"),labels=axis.getViewLabels(),labelRotation=(retrieve(opt.labelRotate,labelModel.get("rotate"))||0)*PI$3/180,labelLayout=AxisBuilder.innerTextLayout(opt.rotation,labelRotation,opt.labelDirection),rawCategoryData=axisModel.getCategories&&axisModel.getCategories(!0),labelEls=[],silent=AxisBuilder.isLabelSilent(axisModel),triggerEvent=axisModel.get("triggerEvent");return each$d(labels,(function(labelItem,index){var tickValue="ordinal"===axis.scale.type?axis.scale.getRawOrdinalNumber(labelItem.tickValue):labelItem.tickValue,formattedLabel=labelItem.formattedLabel,rawLabel=labelItem.rawLabel,itemLabelModel=labelModel;if(rawCategoryData&&rawCategoryData[tickValue]){var rawCategoryItem=rawCategoryData[tickValue];isObject$3(rawCategoryItem)&&rawCategoryItem.textStyle&&(itemLabelModel=new Model(rawCategoryItem.textStyle,labelModel,axisModel.ecModel))}var textColor=itemLabelModel.getTextColor()||axisModel.get(["axisLine","lineStyle","color"]),tickCoord=axis.dataToCoord(tickValue),align=itemLabelModel.getShallow("align",!0)||labelLayout.textAlign,alignMin=retrieve2(itemLabelModel.getShallow("alignMinLabel",!0),align),alignMax=retrieve2(itemLabelModel.getShallow("alignMaxLabel",!0),align),verticalAlign=itemLabelModel.getShallow("verticalAlign",!0)||itemLabelModel.getShallow("baseline",!0)||labelLayout.textVerticalAlign,verticalAlignMin=retrieve2(itemLabelModel.getShallow("verticalAlignMinLabel",!0),verticalAlign),verticalAlignMax=retrieve2(itemLabelModel.getShallow("verticalAlignMaxLabel",!0),verticalAlign),textEl=new ZRText({x:tickCoord,y:opt.labelOffset+opt.labelDirection*labelMargin,rotation:labelLayout.rotation,silent:silent,z2:10+(labelItem.level||0),style:createTextStyle$1(itemLabelModel,{text:formattedLabel,align:0===index?alignMin:index===labels.length-1?alignMax:align,verticalAlign:0===index?verticalAlignMin:index===labels.length-1?verticalAlignMax:verticalAlign,fill:isFunction(textColor)?textColor("category"===axis.type?rawLabel:"value"===axis.type?tickValue+"":tickValue,index):textColor})});if(textEl.anid="label_"+tickValue,setTooltipConfig({el:textEl,componentModel:axisModel,itemName:formattedLabel,formatterParamsExtra:{isTruncated:function(){return textEl.isTruncated},value:rawLabel,tickIndex:index}}),triggerEvent){var eventData=AxisBuilder.makeAxisEventDataBase(axisModel);eventData.targetType="axisLabel",eventData.value=rawLabel,eventData.tickIndex=index,"category"===axis.type&&(eventData.dataIndex=tickValue),getECData(textEl).eventData=eventData}transformGroup.add(textEl),textEl.updateTransform(),labelEls.push(textEl),group.add(textEl),textEl.decomposeTransform()})),labelEls}(group,transformGroup,axisModel,opt);if(function(axisModel,labelEls,tickEls){if(shouldShowAllLabels(axisModel.axis))return;var showMinLabel=axisModel.get(["axisLabel","showMinLabel"]),showMaxLabel=axisModel.get(["axisLabel","showMaxLabel"]);labelEls=labelEls||[],tickEls=tickEls||[];var firstLabel=labelEls[0],nextLabel=labelEls[1],lastLabel=labelEls[labelEls.length-1],prevLabel=labelEls[labelEls.length-2],firstTick=tickEls[0],nextTick2=tickEls[1],lastTick=tickEls[tickEls.length-1],prevTick=tickEls[tickEls.length-2];!1===showMinLabel?(ignoreEl(firstLabel),ignoreEl(firstTick)):isTwoLabelOverlapped(firstLabel,nextLabel)&&(showMinLabel?(ignoreEl(nextLabel),ignoreEl(nextTick2)):(ignoreEl(firstLabel),ignoreEl(firstTick)));!1===showMaxLabel?(ignoreEl(lastLabel),ignoreEl(lastTick)):isTwoLabelOverlapped(prevLabel,lastLabel)&&(showMaxLabel?(ignoreEl(prevLabel),ignoreEl(prevTick)):(ignoreEl(lastLabel),ignoreEl(lastTick)))}(axisModel,labelEls,ticksEls),function(group,transformGroup,axisModel,tickDirection){var axis=axisModel.axis,minorTickModel=axisModel.getModel("minorTick");if(!minorTickModel.get("show")||axis.scale.isBlank())return;var minorTicksCoords=axis.getMinorTicksCoords();if(!minorTicksCoords.length)return;for(var lineStyleModel=minorTickModel.getModel("lineStyle"),tickEndCoord=tickDirection*minorTickModel.get("length"),minorTickLineStyle=defaults(lineStyleModel.getLineStyle(),defaults(axisModel.getModel("axisTick").getLineStyle(),{stroke:axisModel.get(["axisLine","lineStyle","color"])})),i=0;i<minorTicksCoords.length;i++)for(var minorTicksEls=createTicks(minorTicksCoords[i],transformGroup.transform,tickEndCoord,minorTickLineStyle,"minorticks_"+i),k=0;k<minorTicksEls.length;k++)group.add(minorTicksEls[k])}(group,transformGroup,axisModel,opt.tickDirection),axisModel.get(["axisLabel","hideOverlap"])){var labelList=function(input){for(var list=[],i=0;i<input.length;i++){var rawItem=input[i];if(!rawItem.defaultAttr.ignore){var label=rawItem.label,transform=label.getComputedTransform(),localRect=label.getBoundingRect(),isAxisAligned=!transform||transform[1]<1e-5&&transform[2]<1e-5,minMargin=label.style.margin||0,globalRect=localRect.clone();globalRect.applyTransform(transform),globalRect.x-=minMargin/2,globalRect.y-=minMargin/2,globalRect.width+=minMargin,globalRect.height+=minMargin;var obb=isAxisAligned?new OrientedBoundingRect(localRect,transform):null;list.push({label:label,labelLine:rawItem.labelLine,rect:globalRect,localRect:localRect,obb:obb,priority:rawItem.priority,defaultAttr:rawItem.defaultAttr,layoutOption:rawItem.computedLayoutOption,axisAligned:isAxisAligned,transform:transform})}}return list}(map$1(labelEls,(function(label){return{label:label,priority:label.z2,defaultAttr:{ignore:label.ignore}}})));!function(labelList){var displayedLabels=[];labelList.sort((function(a,b){return b.priority-a.priority}));var globalRect=new BoundingRect(0,0,0,0);function hideEl(el){if(!el.ignore){var emphasisState=el.ensureState("emphasis");null==emphasisState.ignore&&(emphasisState.ignore=!1)}el.ignore=!0}for(var i=0;i<labelList.length;i++){var labelItem=labelList[i],isAxisAligned=labelItem.axisAligned,localRect=labelItem.localRect,transform=labelItem.transform,label=labelItem.label,labelLine=labelItem.labelLine;globalRect.copy(labelItem.rect),globalRect.width-=.1,globalRect.height-=.1,globalRect.x+=.05,globalRect.y+=.05;for(var obb=labelItem.obb,overlapped=!1,j=0;j<displayedLabels.length;j++){var existsTextCfg=displayedLabels[j];if(globalRect.intersect(existsTextCfg.rect)){if(isAxisAligned&&existsTextCfg.axisAligned){overlapped=!0;break}if(existsTextCfg.obb||(existsTextCfg.obb=new OrientedBoundingRect(existsTextCfg.localRect,existsTextCfg.transform)),obb||(obb=new OrientedBoundingRect(localRect,transform)),obb.intersect(existsTextCfg.obb)){overlapped=!0;break}}}overlapped?(hideEl(label),labelLine&&hideEl(labelLine)):(label.attr("ignore",labelItem.defaultAttr.ignore),labelLine&&labelLine.attr("ignore",labelItem.defaultAttr.labelGuideIgnore),displayedLabels.push(labelItem))}}(labelList)}},axisName:function(opt,axisModel,group,transformGroup){var name=retrieve(opt.axisName,axisModel.get("name"));if(name){var labelLayout,axisNameAvailableWidth,nameLocation=axisModel.get("nameLocation"),nameDirection=opt.nameDirection,textStyleModel=axisModel.getModel("nameTextStyle"),gap=axisModel.get("nameGap")||0,extent3=axisModel.axis.getExtent(),gapSignal=extent3[0]>extent3[1]?-1:1,pos=["start"===nameLocation?extent3[0]-gapSignal*gap:"end"===nameLocation?extent3[1]+gapSignal*gap:(extent3[0]+extent3[1])/2,isNameLocationCenter(nameLocation)?opt.labelOffset+nameDirection*gap:0],nameRotation=axisModel.get("nameRotate");null!=nameRotation&&(nameRotation=nameRotation*PI$3/180),isNameLocationCenter(nameLocation)?labelLayout=AxisBuilder.innerTextLayout(opt.rotation,null!=nameRotation?nameRotation:opt.rotation,nameDirection):(labelLayout=function(rotation,textPosition,textRotate,extent3){var textAlign,textVerticalAlign,rotationDiff=remRadian(textRotate-rotation),inverse=extent3[0]>extent3[1],onLeft="start"===textPosition&&!inverse||"start"!==textPosition&&inverse;isRadianAroundZero(rotationDiff-PI$3/2)?(textVerticalAlign=onLeft?"bottom":"top",textAlign="center"):isRadianAroundZero(rotationDiff-1.5*PI$3)?(textVerticalAlign=onLeft?"top":"bottom",textAlign="center"):(textVerticalAlign="middle",textAlign=rotationDiff<1.5*PI$3&&rotationDiff>PI$3/2?onLeft?"left":"right":onLeft?"right":"left");return{rotation:rotationDiff,textAlign:textAlign,textVerticalAlign:textVerticalAlign}}(opt.rotation,nameLocation,nameRotation||0,extent3),null!=(axisNameAvailableWidth=opt.axisNameAvailableWidth)&&(axisNameAvailableWidth=Math.abs(axisNameAvailableWidth/Math.sin(labelLayout.rotation)),!isFinite(axisNameAvailableWidth)&&(axisNameAvailableWidth=null)));var textFont=textStyleModel.getFont(),truncateOpt=axisModel.get("nameTruncate",!0)||{},ellipsis=truncateOpt.ellipsis,maxWidth=retrieve(opt.nameTruncateMaxWidth,truncateOpt.maxWidth,axisNameAvailableWidth),textEl=new ZRText({x:pos[0],y:pos[1],rotation:labelLayout.rotation,silent:AxisBuilder.isLabelSilent(axisModel),style:createTextStyle$1(textStyleModel,{text:name,font:textFont,overflow:"truncate",width:maxWidth,ellipsis:ellipsis,fill:textStyleModel.getTextColor()||axisModel.get(["axisLine","lineStyle","color"]),align:textStyleModel.get("align")||labelLayout.textAlign,verticalAlign:textStyleModel.get("verticalAlign")||labelLayout.textVerticalAlign}),z2:1});if(setTooltipConfig({el:textEl,componentModel:axisModel,itemName:name}),textEl.__fullText=name,textEl.anid="name",axisModel.get("triggerEvent")){var eventData=AxisBuilder.makeAxisEventDataBase(axisModel);eventData.targetType="axisName",eventData.name=name,getECData(textEl).eventData=eventData}transformGroup.add(textEl),textEl.updateTransform(),group.add(textEl),textEl.decomposeTransform()}}};function ignoreEl(el){el&&(el.ignore=!0)}function isTwoLabelOverlapped(current,next){var firstRect=current&&current.getBoundingRect().clone(),nextRect=next&&next.getBoundingRect().clone();if(firstRect&&nextRect){var mRotationBack=identity([]);return rotate(mRotationBack,mRotationBack,-current.rotation),firstRect.applyTransform(mul([],mRotationBack,current.getLocalTransform())),nextRect.applyTransform(mul([],mRotationBack,next.getLocalTransform())),firstRect.intersect(nextRect)}}function isNameLocationCenter(nameLocation){return"middle"===nameLocation||"center"===nameLocation}function createTicks(ticksCoords,tickTransform,tickEndCoord,tickLineStyle,anidPrefix){for(var tickEls=[],pt12=[],pt22=[],i=0;i<ticksCoords.length;i++){var tickCoord=ticksCoords[i].coord;pt12[0]=tickCoord,pt12[1]=0,pt22[0]=tickCoord,pt22[1]=tickEndCoord,tickTransform&&(applyTransform$1(pt12,pt12,tickTransform),applyTransform$1(pt22,pt22,tickTransform));var tickEl=new Line({shape:{x1:pt12[0],y1:pt12[1],x2:pt22[0],y2:pt22[1]},style:tickLineStyle,z2:2,autoBatch:!0,silent:!0});subPixelOptimizeLine(tickEl.shape,tickEl.style.lineWidth),tickEl.anid=anidPrefix+"_"+ticksCoords[i].tickValue,tickEls.push(tickEl)}return tickEls}function collect(ecModel,api){var result={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return function(result,ecModel,api){var globalTooltipModel=ecModel.getComponent("tooltip"),globalAxisPointerModel=ecModel.getComponent("axisPointer"),linksOption=globalAxisPointerModel.get("link",!0)||[],linkGroups=[];each$d(api.getCoordinateSystems(),(function(coordSys){if(coordSys.axisPointerEnabled){var coordSysKey=makeKey(coordSys.model),axesInfoInCoordSys=result.coordSysAxesInfo[coordSysKey]={};result.coordSysMap[coordSysKey]=coordSys;var baseTooltipModel=coordSys.model.getModel("tooltip",globalTooltipModel);if(each$d(coordSys.getAxes(),curry$1(saveTooltipAxisInfo,!1,null)),coordSys.getTooltipAxes&&globalTooltipModel&&baseTooltipModel.get("show")){var triggerAxis="axis"===baseTooltipModel.get("trigger"),cross="cross"===baseTooltipModel.get(["axisPointer","type"]),tooltipAxes=coordSys.getTooltipAxes(baseTooltipModel.get(["axisPointer","axis"]));(triggerAxis||cross)&&each$d(tooltipAxes.baseAxes,curry$1(saveTooltipAxisInfo,!cross||"cross",triggerAxis)),cross&&each$d(tooltipAxes.otherAxes,curry$1(saveTooltipAxisInfo,"cross",!1))}}function saveTooltipAxisInfo(fromTooltip,triggerTooltip,axis){var axisPointerModel=axis.model.getModel("axisPointer",globalAxisPointerModel),axisPointerShow=axisPointerModel.get("show");if(axisPointerShow&&("auto"!==axisPointerShow||fromTooltip||isHandleTrigger(axisPointerModel))){null==triggerTooltip&&(triggerTooltip=axisPointerModel.get("triggerTooltip")),axisPointerModel=fromTooltip?function(axis,baseTooltipModel,globalAxisPointerModel,ecModel,fromTooltip,triggerTooltip){var tooltipAxisPointerModel=baseTooltipModel.getModel("axisPointer"),volatileOption={};each$d(["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],(function(field){volatileOption[field]=clone$3(tooltipAxisPointerModel.get(field))})),volatileOption.snap="category"!==axis.type&&!!triggerTooltip,"cross"===tooltipAxisPointerModel.get("type")&&(volatileOption.type="line");var labelOption=volatileOption.label||(volatileOption.label={});if(null==labelOption.show&&(labelOption.show=!1),"cross"===fromTooltip){var tooltipAxisPointerLabelShow=tooltipAxisPointerModel.get(["label","show"]);if(labelOption.show=null==tooltipAxisPointerLabelShow||tooltipAxisPointerLabelShow,!triggerTooltip){var crossStyle=volatileOption.lineStyle=tooltipAxisPointerModel.get("crossStyle");crossStyle&&defaults(labelOption,crossStyle.textStyle)}}return axis.model.getModel("axisPointer",new Model(volatileOption,globalAxisPointerModel,ecModel))}(axis,baseTooltipModel,globalAxisPointerModel,ecModel,fromTooltip,triggerTooltip):axisPointerModel;var snap=axisPointerModel.get("snap"),triggerEmphasis=axisPointerModel.get("triggerEmphasis"),axisKey=makeKey(axis.model),involveSeries=triggerTooltip||snap||"category"===axis.type,axisInfo=result.axesInfo[axisKey]={key:axisKey,axis:axis,coordSys:coordSys,axisPointerModel:axisPointerModel,triggerTooltip:triggerTooltip,triggerEmphasis:triggerEmphasis,involveSeries:involveSeries,snap:snap,useHandle:isHandleTrigger(axisPointerModel),seriesModels:[],linkGroup:null};axesInfoInCoordSys[axisKey]=axisInfo,result.seriesInvolved=result.seriesInvolved||involveSeries;var groupIndex=function(linksOption,axis){for(var axisModel=axis.model,dim=axis.dim,i=0;i<linksOption.length;i++){var linkOption=linksOption[i]||{};if(checkPropInLink(linkOption[dim+"AxisId"],axisModel.id)||checkPropInLink(linkOption[dim+"AxisIndex"],axisModel.componentIndex)||checkPropInLink(linkOption[dim+"AxisName"],axisModel.name))return i}}(linksOption,axis);if(null!=groupIndex){var linkGroup=linkGroups[groupIndex]||(linkGroups[groupIndex]={axesInfo:{}});linkGroup.axesInfo[axisKey]=axisInfo,linkGroup.mapper=linksOption[groupIndex].mapper,axisInfo.linkGroup=linkGroup}}}}))}(result,ecModel,api),result.seriesInvolved&&function(result,ecModel){ecModel.eachSeries((function(seriesModel){var coordSys=seriesModel.coordinateSystem,seriesTooltipTrigger=seriesModel.get(["tooltip","trigger"],!0),seriesTooltipShow=seriesModel.get(["tooltip","show"],!0);coordSys&&"none"!==seriesTooltipTrigger&&!1!==seriesTooltipTrigger&&"item"!==seriesTooltipTrigger&&!1!==seriesTooltipShow&&!1!==seriesModel.get(["axisPointer","show"],!0)&&each$d(result.coordSysAxesInfo[makeKey(coordSys.model)],(function(axisInfo){var axis=axisInfo.axis;coordSys.getAxis(axis.dim)===axis&&(axisInfo.seriesModels.push(seriesModel),null==axisInfo.seriesDataCount&&(axisInfo.seriesDataCount=0),axisInfo.seriesDataCount+=seriesModel.getData().count())}))}))}(result,ecModel),result}function checkPropInLink(linkPropValue,axisPropValue){return"all"===linkPropValue||isArray$1(linkPropValue)&&indexOf(linkPropValue,axisPropValue)>=0||linkPropValue===axisPropValue}function getAxisInfo(axisModel){var coordSysAxesInfo=(axisModel.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return coordSysAxesInfo&&coordSysAxesInfo.axesInfo[makeKey(axisModel)]}function isHandleTrigger(axisPointerModel){return!!axisPointerModel.get(["handle","show"])}function makeKey(model){return model.type+"||"+model.id}var axisPointerClazz={},AxisView=function(_super){function AxisView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=AxisView2.type,_this}return __extends(AxisView2,_super),AxisView2.prototype.render=function(axisModel,ecModel,api,payload){this.axisPointerClass&&function(axisModel){var axisInfo=getAxisInfo(axisModel);if(axisInfo){var axisPointerModel=axisInfo.axisPointerModel,scale2=axisInfo.axis.scale,option=axisPointerModel.option,status=axisPointerModel.get("status"),value=axisPointerModel.get("value");null!=value&&(value=scale2.parse(value));var useHandle=isHandleTrigger(axisPointerModel);null==status&&(option.status=useHandle?"show":"hide");var extent3=scale2.getExtent().slice();extent3[0]>extent3[1]&&extent3.reverse(),(null==value||value>extent3[1])&&(value=extent3[1]),value<extent3[0]&&(value=extent3[0]),option.value=value,useHandle&&(option.status=axisInfo.axis.scale.isBlank()?"hide":"show")}}(axisModel),_super.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(axisModel,api,!0)},AxisView2.prototype.updateAxisPointer=function(axisModel,ecModel,api,payload){this._doUpdateAxisPointerClass(axisModel,api,!1)},AxisView2.prototype.remove=function(ecModel,api){var axisPointer=this._axisPointer;axisPointer&&axisPointer.remove(api)},AxisView2.prototype.dispose=function(ecModel,api){this._disposeAxisPointer(api),_super.prototype.dispose.apply(this,arguments)},AxisView2.prototype._doUpdateAxisPointerClass=function(axisModel,api,forceRender){var Clazz=AxisView2.getAxisPointerClass(this.axisPointerClass);if(Clazz){var axisPointerModel=function(axisModel){var axisInfo=getAxisInfo(axisModel);return axisInfo&&axisInfo.axisPointerModel}(axisModel);axisPointerModel?(this._axisPointer||(this._axisPointer=new Clazz)).render(axisModel,axisPointerModel,api,forceRender):this._disposeAxisPointer(api)}},AxisView2.prototype._disposeAxisPointer=function(api){this._axisPointer&&this._axisPointer.dispose(api),this._axisPointer=null},AxisView2.registerAxisPointerClass=function(type,clazz){axisPointerClazz[type]=clazz},AxisView2.getAxisPointerClass=function(type){return type&&axisPointerClazz[type]},AxisView2.type="axis",AxisView2}(ComponentView),inner$8=makeInner();var axisBuilderAttrs$2=["axisLine","axisTickLabel","axisName"],selfBuilderAttrs$1=["splitArea","splitLine","minorSplitLine"],CartesianAxisView=function(_super){function CartesianAxisView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=CartesianAxisView2.type,_this.axisPointerClass="CartesianAxisPointer",_this}return __extends(CartesianAxisView2,_super),CartesianAxisView2.prototype.render=function(axisModel,ecModel,api,payload){this.group.removeAll();var oldAxisGroup=this._axisGroup;if(this._axisGroup=new Group$2,this.group.add(this._axisGroup),axisModel.get("show")){var gridModel=axisModel.getCoordSysModel(),layout2=layout$1(gridModel,axisModel),axisBuilder=new AxisBuilder(axisModel,extend({handleAutoShown:function(elementType){for(var cartesians=gridModel.coordinateSystem.getCartesians(),i=0;i<cartesians.length;i++)if(isIntervalOrLogScale(cartesians[i].getOtherAxis(axisModel.axis).scale))return!0;return!1}},layout2));each$d(axisBuilderAttrs$2,axisBuilder.add,axisBuilder),this._axisGroup.add(axisBuilder.getGroup()),each$d(selfBuilderAttrs$1,(function(name){axisModel.get([name,"show"])&&axisElementBuilders$1[name](this,this._axisGroup,axisModel,gridModel)}),this),payload&&"changeAxisOrder"===payload.type&&payload.isInitSort||groupTransition(oldAxisGroup,this._axisGroup,axisModel),_super.prototype.render.call(this,axisModel,ecModel,api,payload)}},CartesianAxisView2.prototype.remove=function(){inner$8(this).splitAreaColors=null},CartesianAxisView2.type="cartesianAxis",CartesianAxisView2}(AxisView),axisElementBuilders$1={splitLine:function(axisView,axisGroup,axisModel,gridModel){var axis=axisModel.axis;if(!axis.scale.isBlank()){var splitLineModel=axisModel.getModel("splitLine"),lineStyleModel=splitLineModel.getModel("lineStyle"),lineColors=lineStyleModel.get("color"),showMinLine=!1!==splitLineModel.get("showMinLine"),showMaxLine=!1!==splitLineModel.get("showMaxLine");lineColors=isArray$1(lineColors)?lineColors:[lineColors];for(var gridRect=gridModel.coordinateSystem.getRect(),isHorizontal=axis.isHorizontal(),lineCount=0,ticksCoords=axis.getTicksCoords({tickModel:splitLineModel}),p1=[],p2=[],lineStyle=lineStyleModel.getLineStyle(),i=0;i<ticksCoords.length;i++){var tickCoord=axis.toGlobalCoord(ticksCoords[i].coord);if((0!==i||showMinLine)&&(i!==ticksCoords.length-1||showMaxLine)){var tickValue=ticksCoords[i].tickValue;isHorizontal?(p1[0]=tickCoord,p1[1]=gridRect.y,p2[0]=tickCoord,p2[1]=gridRect.y+gridRect.height):(p1[0]=gridRect.x,p1[1]=tickCoord,p2[0]=gridRect.x+gridRect.width,p2[1]=tickCoord);var colorIndex=lineCount++%lineColors.length,line=new Line({anid:null!=tickValue?"line_"+tickValue:null,autoBatch:!0,shape:{x1:p1[0],y1:p1[1],x2:p2[0],y2:p2[1]},style:defaults({stroke:lineColors[colorIndex]},lineStyle),silent:!0});subPixelOptimizeLine(line.shape,lineStyle.lineWidth),axisGroup.add(line)}}}},minorSplitLine:function(axisView,axisGroup,axisModel,gridModel){var axis=axisModel.axis,lineStyleModel=axisModel.getModel("minorSplitLine").getModel("lineStyle"),gridRect=gridModel.coordinateSystem.getRect(),isHorizontal=axis.isHorizontal(),minorTicksCoords=axis.getMinorTicksCoords();if(minorTicksCoords.length)for(var p1=[],p2=[],lineStyle=lineStyleModel.getLineStyle(),i=0;i<minorTicksCoords.length;i++)for(var k=0;k<minorTicksCoords[i].length;k++){var tickCoord=axis.toGlobalCoord(minorTicksCoords[i][k].coord);isHorizontal?(p1[0]=tickCoord,p1[1]=gridRect.y,p2[0]=tickCoord,p2[1]=gridRect.y+gridRect.height):(p1[0]=gridRect.x,p1[1]=tickCoord,p2[0]=gridRect.x+gridRect.width,p2[1]=tickCoord);var line=new Line({anid:"minor_line_"+minorTicksCoords[i][k].tickValue,autoBatch:!0,shape:{x1:p1[0],y1:p1[1],x2:p2[0],y2:p2[1]},style:lineStyle,silent:!0});subPixelOptimizeLine(line.shape,lineStyle.lineWidth),axisGroup.add(line)}},splitArea:function(axisView,axisGroup,axisModel,gridModel){!function(axisView,axisGroup,axisModel,gridModel){var axis=axisModel.axis;if(!axis.scale.isBlank()){var splitAreaModel=axisModel.getModel("splitArea"),areaStyleModel=splitAreaModel.getModel("areaStyle"),areaColors=areaStyleModel.get("color"),gridRect=gridModel.coordinateSystem.getRect(),ticksCoords=axis.getTicksCoords({tickModel:splitAreaModel,clamp:!0});if(ticksCoords.length){var areaColorsLen=areaColors.length,lastSplitAreaColors=inner$8(axisView).splitAreaColors,newSplitAreaColors=createHashMap(),colorIndex=0;if(lastSplitAreaColors)for(var i=0;i<ticksCoords.length;i++){var cIndex=lastSplitAreaColors.get(ticksCoords[i].tickValue);if(null!=cIndex){colorIndex=(cIndex+(areaColorsLen-1)*i)%areaColorsLen;break}}var prev=axis.toGlobalCoord(ticksCoords[0].coord),areaStyle=areaStyleModel.getAreaStyle();for(areaColors=isArray$1(areaColors)?areaColors:[areaColors],i=1;i<ticksCoords.length;i++){var tickCoord=axis.toGlobalCoord(ticksCoords[i].coord),x=void 0,y=void 0,width=void 0,height=void 0;axis.isHorizontal()?(x=prev,y=gridRect.y,width=tickCoord-x,height=gridRect.height,prev=x+width):(x=gridRect.x,y=prev,width=gridRect.width,prev=y+(height=tickCoord-y));var tickValue=ticksCoords[i-1].tickValue;null!=tickValue&&newSplitAreaColors.set(tickValue,colorIndex),axisGroup.add(new Rect$1({anid:null!=tickValue?"area_"+tickValue:null,shape:{x:x,y:y,width:width,height:height},style:defaults({fill:areaColors[colorIndex]},areaStyle),autoBatch:!0,silent:!0})),colorIndex=(colorIndex+1)%areaColorsLen}inner$8(axisView).splitAreaColors=newSplitAreaColors}}}(axisView,axisGroup,axisModel,gridModel)}},CartesianXAxisView=function(_super){function CartesianXAxisView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=CartesianXAxisView2.type,_this}return __extends(CartesianXAxisView2,_super),CartesianXAxisView2.type="xAxis",CartesianXAxisView2}(CartesianAxisView),CartesianYAxisView=function(_super){function CartesianYAxisView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=CartesianXAxisView.type,_this}return __extends(CartesianYAxisView2,_super),CartesianYAxisView2.type="yAxis",CartesianYAxisView2}(CartesianAxisView),GridView=function(_super){function GridView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type="grid",_this}return __extends(GridView2,_super),GridView2.prototype.render=function(gridModel,ecModel){this.group.removeAll(),gridModel.get("show")&&this.group.add(new Rect$1({shape:gridModel.coordinateSystem.getRect(),style:defaults({fill:gridModel.get("backgroundColor")},gridModel.getItemStyle()),silent:!0,z2:-1}))},GridView2.type="grid",GridView2}(ComponentView),extraOption={offset:0};function install$s(registers){registers.registerComponentView(GridView),registers.registerComponentModel(GridModel),registers.registerCoordinateSystem("cartesian2d",Grid),axisModelCreator(registers,"x",CartesianAxisModel,extraOption),axisModelCreator(registers,"y",CartesianAxisModel,extraOption),registers.registerComponentView(CartesianXAxisView),registers.registerComponentView(CartesianYAxisView),registers.registerPreprocessor((function(option){option.xAxis&&option.yAxis&&!option.grid&&(option.grid={})}))}function radarLayout(ecModel){ecModel.eachSeriesByType("radar",(function(seriesModel){var data=seriesModel.getData(),points2=[],coordSys=seriesModel.coordinateSystem;if(coordSys){var axes=coordSys.getIndicatorAxes();each$d(axes,(function(axis,axisIndex){data.each(data.mapDimension(axes[axisIndex].dim),(function(val,dataIndex){points2[dataIndex]=points2[dataIndex]||[];var point=coordSys.dataToPoint(val,axisIndex);points2[dataIndex][axisIndex]=isValidPoint(point)?point:getValueMissingPoint(coordSys)}))})),data.each((function(idx){var firstPoint=find(points2[idx],(function(point){return isValidPoint(point)}))||getValueMissingPoint(coordSys);points2[idx].push(firstPoint.slice()),data.setItemLayout(idx,points2[idx])}))}}))}function isValidPoint(point){return!isNaN(point[0])&&!isNaN(point[1])}function getValueMissingPoint(coordSys){return[coordSys.cx,coordSys.cy]}function radarBackwardCompat(option){var polarOptArr=option.polar;if(polarOptArr){isArray$1(polarOptArr)||(polarOptArr=[polarOptArr]);var polarNotRadar_1=[];each$d(polarOptArr,(function(polarOpt,idx){polarOpt.indicator?(polarOpt.type&&!polarOpt.shape&&(polarOpt.shape=polarOpt.type),option.radar=option.radar||[],isArray$1(option.radar)||(option.radar=[option.radar]),option.radar.push(polarOpt)):polarNotRadar_1.push(polarOpt)})),option.polar=polarNotRadar_1}each$d(option.series,(function(seriesOpt){seriesOpt&&"radar"===seriesOpt.type&&seriesOpt.polarIndex&&(seriesOpt.radarIndex=seriesOpt.polarIndex)}))}var RadarView$1=function(_super){function RadarView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=RadarView2.type,_this}return __extends(RadarView2,_super),RadarView2.prototype.render=function(seriesModel,ecModel,api){var polar=seriesModel.coordinateSystem,group=this.group,data=seriesModel.getData(),oldData=this._data;function createSymbol$1(data2,idx){var symbolType=data2.getItemVisual(idx,"symbol")||"circle";if("none"!==symbolType){var symbolSize=normalizeSymbolSize(data2.getItemVisual(idx,"symbolSize")),symbolPath=createSymbol(symbolType,-1,-1,2,2),symbolRotate=data2.getItemVisual(idx,"symbolRotate")||0;return symbolPath.attr({style:{strokeNoScale:!0},z2:100,scaleX:symbolSize[0]/2,scaleY:symbolSize[1]/2,rotation:symbolRotate*Math.PI/180||0}),symbolPath}}function updateSymbols(oldPoints,newPoints,symbolGroup,data2,idx,isInit){symbolGroup.removeAll();for(var i=0;i<newPoints.length-1;i++){var symbolPath=createSymbol$1(data2,idx);symbolPath&&(symbolPath.__dimIdx=i,oldPoints[i]?(symbolPath.setPosition(oldPoints[i]),graphic$1[isInit?"initProps":"updateProps"](symbolPath,{x:newPoints[i][0],y:newPoints[i][1]},seriesModel,idx)):symbolPath.setPosition(newPoints[i]),symbolGroup.add(symbolPath))}}function getInitialPoints(points2){return map$1(points2,(function(pt){return[polar.cx,polar.cy]}))}data.diff(oldData).add((function(idx){var points2=data.getItemLayout(idx);if(points2){var polygon=new Polygon,polyline=new Polyline,target={shape:{points:points2}};polygon.shape.points=getInitialPoints(points2),polyline.shape.points=getInitialPoints(points2),initProps(polygon,target,seriesModel,idx),initProps(polyline,target,seriesModel,idx);var itemGroup=new Group$2,symbolGroup=new Group$2;itemGroup.add(polyline),itemGroup.add(polygon),itemGroup.add(symbolGroup),updateSymbols(polyline.shape.points,points2,symbolGroup,data,idx,!0),data.setItemGraphicEl(idx,itemGroup)}})).update((function(newIdx,oldIdx){var itemGroup=oldData.getItemGraphicEl(oldIdx),polyline=itemGroup.childAt(0),polygon=itemGroup.childAt(1),symbolGroup=itemGroup.childAt(2),target={shape:{points:data.getItemLayout(newIdx)}};target.shape.points&&(updateSymbols(polyline.shape.points,target.shape.points,symbolGroup,data,newIdx,!1),saveOldStyle(polygon),saveOldStyle(polyline),updateProps$1(polyline,target,seriesModel),updateProps$1(polygon,target,seriesModel),data.setItemGraphicEl(newIdx,itemGroup))})).remove((function(idx){group.remove(oldData.getItemGraphicEl(idx))})).execute(),data.eachItemGraphicEl((function(itemGroup,idx){var itemModel=data.getItemModel(idx),polyline=itemGroup.childAt(0),polygon=itemGroup.childAt(1),symbolGroup=itemGroup.childAt(2),itemStyle=data.getItemVisual(idx,"style"),color2=itemStyle.fill;group.add(itemGroup),polyline.useStyle(defaults(itemModel.getModel("lineStyle").getLineStyle(),{fill:"none",stroke:color2})),setStatesStylesFromModel(polyline,itemModel,"lineStyle"),setStatesStylesFromModel(polygon,itemModel,"areaStyle");var areaStyleModel=itemModel.getModel("areaStyle"),polygonIgnore=areaStyleModel.isEmpty()&&areaStyleModel.parentModel.isEmpty();polygon.ignore=polygonIgnore,each$d(["emphasis","select","blur"],(function(stateName){var stateModel=itemModel.getModel([stateName,"areaStyle"]),stateIgnore=stateModel.isEmpty()&&stateModel.parentModel.isEmpty();polygon.ensureState(stateName).ignore=stateIgnore&&polygonIgnore})),polygon.useStyle(defaults(areaStyleModel.getAreaStyle(),{fill:color2,opacity:.7,decal:itemStyle.decal}));var emphasisModel=itemModel.getModel("emphasis"),itemHoverStyle=emphasisModel.getModel("itemStyle").getItemStyle();symbolGroup.eachChild((function(symbolPath){if(symbolPath instanceof ZRImage){var pathStyle=symbolPath.style;symbolPath.useStyle(extend({image:pathStyle.image,x:pathStyle.x,y:pathStyle.y,width:pathStyle.width,height:pathStyle.height},itemStyle))}else symbolPath.useStyle(itemStyle),symbolPath.setColor(color2),symbolPath.style.strokeNoScale=!0;symbolPath.ensureState("emphasis").style=clone$3(itemHoverStyle);var defaultText=data.getStore().get(data.getDimensionIndex(symbolPath.__dimIdx),idx);(null==defaultText||isNaN(defaultText))&&(defaultText=""),setLabelStyle(symbolPath,getLabelStatesModels(itemModel),{labelFetcher:data.hostModel,labelDataIndex:idx,labelDimIndex:symbolPath.__dimIdx,defaultText:defaultText,inheritColor:color2,defaultOpacity:itemStyle.opacity})})),toggleHoverEmphasis(itemGroup,emphasisModel.get("focus"),emphasisModel.get("blurScope"),emphasisModel.get("disabled"))})),this._data=data},RadarView2.prototype.remove=function(){this.group.removeAll(),this._data=null},RadarView2.type="radar",RadarView2}(ChartView),RadarSeriesModel=function(_super){function RadarSeriesModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=RadarSeriesModel2.type,_this.hasSymbolVisual=!0,_this}return __extends(RadarSeriesModel2,_super),RadarSeriesModel2.prototype.init=function(option){_super.prototype.init.apply(this,arguments),this.legendVisualProvider=new LegendVisualProvider(bind$1(this.getData,this),bind$1(this.getRawData,this))},RadarSeriesModel2.prototype.getInitialData=function(option,ecModel){return createSeriesDataSimply(this,{generateCoord:"indicator_",generateCoordCount:Infinity})},RadarSeriesModel2.prototype.formatTooltip=function(dataIndex,multipleSeries,dataType){var data=this.getData(),indicatorAxes=this.coordinateSystem.getIndicatorAxes(),name=this.getData().getName(dataIndex),nameToDisplay=""===name?this.name:name,markerColor=retrieveVisualColorForTooltipMarker(this,dataIndex);return createTooltipMarkup("section",{header:nameToDisplay,sortBlocks:!0,blocks:map$1(indicatorAxes,(function(axis){var val=data.get(data.mapDimension(axis.dim),dataIndex);return createTooltipMarkup("nameValue",{markerType:"subItem",markerColor:markerColor,name:axis.name,value:val,sortParam:val})}))})},RadarSeriesModel2.prototype.getTooltipPosition=function(dataIndex){if(null!=dataIndex)for(var data_1=this.getData(),coordSys=this.coordinateSystem,values=data_1.getValues(map$1(coordSys.dimensions,(function(dim){return data_1.mapDimension(dim)})),dataIndex),i=0,len2=values.length;i<len2;i++)if(!isNaN(values[i])){var indicatorAxes=coordSys.getIndicatorAxes();return coordSys.coordToPoint(indicatorAxes[i].dataToCoord(values[i]),i)}},RadarSeriesModel2.type="series.radar",RadarSeriesModel2.dependencies=["radar"],RadarSeriesModel2.defaultOption={z:2,colorBy:"data",coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{width:2,type:"solid",join:"round"},label:{position:"top"},symbolSize:8},RadarSeriesModel2}(SeriesModel),valueAxisDefault=axisDefault.value;function defaultsShow(opt,show){return defaults({show:show},opt)}var RadarModel=function(_super){function RadarModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=RadarModel2.type,_this}return __extends(RadarModel2,_super),RadarModel2.prototype.optionUpdated=function(){var boundaryGap=this.get("boundaryGap"),splitNumber=this.get("splitNumber"),scale2=this.get("scale"),axisLine=this.get("axisLine"),axisTick=this.get("axisTick"),axisLabel=this.get("axisLabel"),nameTextStyle=this.get("axisName"),showName=this.get(["axisName","show"]),nameFormatter=this.get(["axisName","formatter"]),nameGap=this.get("axisNameGap"),triggerEvent=this.get("triggerEvent"),indicatorModels=map$1(this.get("indicator")||[],(function(indicatorOpt){null!=indicatorOpt.max&&indicatorOpt.max>0&&!indicatorOpt.min?indicatorOpt.min=0:null!=indicatorOpt.min&&indicatorOpt.min<0&&!indicatorOpt.max&&(indicatorOpt.max=0);var iNameTextStyle=nameTextStyle;null!=indicatorOpt.color&&(iNameTextStyle=defaults({color:indicatorOpt.color},nameTextStyle));var innerIndicatorOpt=merge(clone$3(indicatorOpt),{boundaryGap:boundaryGap,splitNumber:splitNumber,scale:scale2,axisLine:axisLine,axisTick:axisTick,axisLabel:axisLabel,name:indicatorOpt.text,showName:showName,nameLocation:"end",nameGap:nameGap,nameTextStyle:iNameTextStyle,triggerEvent:triggerEvent},!1);if(isString(nameFormatter)){var indName=innerIndicatorOpt.name;innerIndicatorOpt.name=nameFormatter.replace("{value}",null!=indName?indName:"")}else isFunction(nameFormatter)&&(innerIndicatorOpt.name=nameFormatter(innerIndicatorOpt.name,innerIndicatorOpt));var model=new Model(innerIndicatorOpt,null,this.ecModel);return mixin(model,AxisModelCommonMixin.prototype),model.mainType="radar",model.componentIndex=this.componentIndex,model}),this);this._indicatorModels=indicatorModels},RadarModel2.prototype.getIndicatorModels=function(){return this._indicatorModels},RadarModel2.type="radar",RadarModel2.defaultOption={z:0,center:["50%","50%"],radius:"75%",startAngle:90,axisName:{show:!0},boundaryGap:[0,0],splitNumber:5,axisNameGap:15,scale:!1,shape:"polygon",axisLine:merge({lineStyle:{color:"#bbb"}},valueAxisDefault.axisLine),axisLabel:defaultsShow(valueAxisDefault.axisLabel,!1),axisTick:defaultsShow(valueAxisDefault.axisTick,!1),splitLine:defaultsShow(valueAxisDefault.splitLine,!0),splitArea:defaultsShow(valueAxisDefault.splitArea,!0),indicator:[]},RadarModel2}(ComponentModel),axisBuilderAttrs$1=["axisLine","axisTickLabel","axisName"],RadarView=function(_super){function RadarView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=RadarView2.type,_this}return __extends(RadarView2,_super),RadarView2.prototype.render=function(radarModel,ecModel,api){this.group.removeAll(),this._buildAxes(radarModel),this._buildSplitLineAndArea(radarModel)},RadarView2.prototype._buildAxes=function(radarModel){var radar=radarModel.coordinateSystem;each$d(map$1(radar.getIndicatorAxes(),(function(indicatorAxis){var axisName=indicatorAxis.model.get("showName")?indicatorAxis.name:"";return new AxisBuilder(indicatorAxis.model,{axisName:axisName,position:[radar.cx,radar.cy],rotation:indicatorAxis.angle,labelDirection:-1,tickDirection:-1,nameDirection:1})})),(function(axisBuilder){each$d(axisBuilderAttrs$1,axisBuilder.add,axisBuilder),this.group.add(axisBuilder.getGroup())}),this)},RadarView2.prototype._buildSplitLineAndArea=function(radarModel){var radar=radarModel.coordinateSystem,indicatorAxes=radar.getIndicatorAxes();if(indicatorAxes.length){var shape=radarModel.get("shape"),splitLineModel=radarModel.getModel("splitLine"),splitAreaModel=radarModel.getModel("splitArea"),lineStyleModel=splitLineModel.getModel("lineStyle"),areaStyleModel=splitAreaModel.getModel("areaStyle"),showSplitLine=splitLineModel.get("show"),showSplitArea=splitAreaModel.get("show"),splitLineColors=lineStyleModel.get("color"),splitAreaColors=areaStyleModel.get("color"),splitLineColorsArr=isArray$1(splitLineColors)?splitLineColors:[splitLineColors],splitAreaColorsArr=isArray$1(splitAreaColors)?splitAreaColors:[splitAreaColors],splitLines=[],splitAreas=[];if("circle"===shape)for(var ticksRadius=indicatorAxes[0].getTicksCoords(),cx=radar.cx,cy=radar.cy,i=0;i<ticksRadius.length;i++){if(showSplitLine)splitLines[getColorIndex(splitLines,splitLineColorsArr,i)].push(new Circle({shape:{cx:cx,cy:cy,r:ticksRadius[i].coord}}));if(showSplitArea&&i<ticksRadius.length-1)splitAreas[getColorIndex(splitAreas,splitAreaColorsArr,i)].push(new Ring({shape:{cx:cx,cy:cy,r0:ticksRadius[i].coord,r:ticksRadius[i+1].coord}}))}else{var realSplitNumber_1,axesTicksPoints=map$1(indicatorAxes,(function(indicatorAxis,idx){var ticksCoords=indicatorAxis.getTicksCoords();return realSplitNumber_1=null==realSplitNumber_1?ticksCoords.length-1:Math.min(ticksCoords.length-1,realSplitNumber_1),map$1(ticksCoords,(function(tickCoord){return radar.coordToPoint(tickCoord.coord,idx)}))})),prevPoints=[];for(i=0;i<=realSplitNumber_1;i++){for(var points2=[],j=0;j<indicatorAxes.length;j++)points2.push(axesTicksPoints[j][i]);if(points2[0]&&points2.push(points2[0].slice()),showSplitLine)splitLines[getColorIndex(splitLines,splitLineColorsArr,i)].push(new Polyline({shape:{points:points2}}));if(showSplitArea&&prevPoints)splitAreas[getColorIndex(splitAreas,splitAreaColorsArr,i-1)].push(new Polygon({shape:{points:points2.concat(prevPoints)}}));prevPoints=points2.slice().reverse()}}var lineStyle=lineStyleModel.getLineStyle(),areaStyle=areaStyleModel.getAreaStyle();each$d(splitAreas,(function(splitAreas2,idx){this.group.add(mergePath(splitAreas2,{style:defaults({stroke:"none",fill:splitAreaColorsArr[idx%splitAreaColorsArr.length]},areaStyle),silent:!0}))}),this),each$d(splitLines,(function(splitLines2,idx){this.group.add(mergePath(splitLines2,{style:defaults({fill:"none",stroke:splitLineColorsArr[idx%splitLineColorsArr.length]},lineStyle),silent:!0}))}),this)}function getColorIndex(areaOrLine,areaOrLineColorList,idx){var colorIndex2=idx%areaOrLineColorList.length;return areaOrLine[colorIndex2]=areaOrLine[colorIndex2]||[],colorIndex2}},RadarView2.type="radar",RadarView2}(ComponentView),IndicatorAxis=function(_super){function IndicatorAxis2(dim,scale2,radiusExtent){var _this=_super.call(this,dim,scale2,radiusExtent)||this;return _this.type="value",_this.angle=0,_this.name="",_this}return __extends(IndicatorAxis2,_super),IndicatorAxis2}(Axis),Radar=function(){function Radar2(radarModel,ecModel,api){this.dimensions=[],this._model=radarModel,this._indicatorAxes=map$1(radarModel.getIndicatorModels(),(function(indicatorModel,idx){var dim="indicator_"+idx,indicatorAxis=new IndicatorAxis(dim,new IntervalScale);return indicatorAxis.name=indicatorModel.get("name"),indicatorAxis.model=indicatorModel,indicatorModel.axis=indicatorAxis,this.dimensions.push(dim),indicatorAxis}),this),this.resize(radarModel,api)}return Radar2.prototype.getIndicatorAxes=function(){return this._indicatorAxes},Radar2.prototype.dataToPoint=function(value,indicatorIndex){var indicatorAxis=this._indicatorAxes[indicatorIndex];return this.coordToPoint(indicatorAxis.dataToCoord(value),indicatorIndex)},Radar2.prototype.coordToPoint=function(coord,indicatorIndex){var angle=this._indicatorAxes[indicatorIndex].angle;return[this.cx+coord*Math.cos(angle),this.cy-coord*Math.sin(angle)]},Radar2.prototype.pointToData=function(pt){var dx=pt[0]-this.cx,dy=pt[1]-this.cy,radius=Math.sqrt(dx*dx+dy*dy);dx/=radius,dy/=radius;for(var closestAxis,radian=Math.atan2(-dy,dx),minRadianDiff=Infinity,closestAxisIdx=-1,i=0;i<this._indicatorAxes.length;i++){var indicatorAxis=this._indicatorAxes[i],diff=Math.abs(radian-indicatorAxis.angle);diff<minRadianDiff&&(closestAxis=indicatorAxis,closestAxisIdx=i,minRadianDiff=diff)}return[closestAxisIdx,+(closestAxis&&closestAxis.coordToData(radius))]},Radar2.prototype.resize=function(radarModel,api){var center2=radarModel.get("center"),viewWidth=api.getWidth(),viewHeight=api.getHeight(),viewSize=Math.min(viewWidth,viewHeight)/2;this.cx=parsePercent(center2[0],viewWidth),this.cy=parsePercent(center2[1],viewHeight),this.startAngle=radarModel.get("startAngle")*Math.PI/180;var radius=radarModel.get("radius");(isString(radius)||isNumber(radius))&&(radius=[0,radius]),this.r0=parsePercent(radius[0],viewSize),this.r=parsePercent(radius[1],viewSize),each$d(this._indicatorAxes,(function(indicatorAxis,idx){indicatorAxis.setExtent(this.r0,this.r);var angle=this.startAngle+idx*Math.PI*2/this._indicatorAxes.length;angle=Math.atan2(Math.sin(angle),Math.cos(angle)),indicatorAxis.angle=angle}),this)},Radar2.prototype.update=function(ecModel,api){var indicatorAxes=this._indicatorAxes,radarModel=this._model;each$d(indicatorAxes,(function(indicatorAxis){indicatorAxis.scale.setExtent(Infinity,-Infinity)})),ecModel.eachSeriesByType("radar",(function(radarSeries,idx){if("radar"===radarSeries.get("coordinateSystem")&&ecModel.getComponent("radar",radarSeries.get("radarIndex"))===radarModel){var data=radarSeries.getData();each$d(indicatorAxes,(function(indicatorAxis){indicatorAxis.scale.unionExtentFromData(data,data.mapDimension(indicatorAxis.dim))}))}}),this);var splitNumber=radarModel.get("splitNumber"),dummyScale=new IntervalScale;dummyScale.setExtent(0,splitNumber),dummyScale.setInterval(1),each$d(indicatorAxes,(function(indicatorAxis,idx){alignScaleTicks(indicatorAxis.scale,indicatorAxis.model,dummyScale)}))},Radar2.prototype.convertToPixel=function(ecModel,finder,value){return console.warn("Not implemented."),null},Radar2.prototype.convertFromPixel=function(ecModel,finder,pixel){return console.warn("Not implemented."),null},Radar2.prototype.containPoint=function(point){return console.warn("Not implemented."),!1},Radar2.create=function(ecModel,api){var radarList=[];return ecModel.eachComponent("radar",(function(radarModel){var radar=new Radar2(radarModel,ecModel,api);radarList.push(radar),radarModel.coordinateSystem=radar})),ecModel.eachSeriesByType("radar",(function(radarSeries){"radar"===radarSeries.get("coordinateSystem")&&(radarSeries.coordinateSystem=radarList[radarSeries.get("radarIndex")||0])})),radarList},Radar2.dimensions=[],Radar2}();function install$q(registers){registers.registerCoordinateSystem("radar",Radar),registers.registerComponentModel(RadarModel),registers.registerComponentView(RadarView),registers.registerVisual({seriesType:"radar",reset:function(seriesModel){var data=seriesModel.getData();data.each((function(idx){data.setItemVisual(idx,"legendIcon","roundRect")})),data.setVisual("legendIcon","roundRect")}})}var ATTR="\0_ec_interaction_mutex";function isTaken(zr,resourceKey){return!!getStore(zr)[resourceKey]}function getStore(zr){return zr[ATTR]||(zr[ATTR]={})}registerAction({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},noop);var RoamController=function(_super){function RoamController2(zr){var _this=_super.call(this)||this;_this._zr=zr;var mousedownHandler=bind$1(_this._mousedownHandler,_this),mousemoveHandler=bind$1(_this._mousemoveHandler,_this),mouseupHandler=bind$1(_this._mouseupHandler,_this),mousewheelHandler=bind$1(_this._mousewheelHandler,_this),pinchHandler=bind$1(_this._pinchHandler,_this);return _this.enable=function(controlType,opt){this.disable(),this._opt=defaults(clone$3(opt)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),null==controlType&&(controlType=!0),!0!==controlType&&"move"!==controlType&&"pan"!==controlType||(zr.on("mousedown",mousedownHandler),zr.on("mousemove",mousemoveHandler),zr.on("mouseup",mouseupHandler)),!0!==controlType&&"scale"!==controlType&&"zoom"!==controlType||(zr.on("mousewheel",mousewheelHandler),zr.on("pinch",pinchHandler))},_this.disable=function(){zr.off("mousedown",mousedownHandler),zr.off("mousemove",mousemoveHandler),zr.off("mouseup",mouseupHandler),zr.off("mousewheel",mousewheelHandler),zr.off("pinch",pinchHandler)},_this}return __extends(RoamController2,_super),RoamController2.prototype.isDragging=function(){return this._dragging},RoamController2.prototype.isPinching=function(){return this._pinching},RoamController2.prototype.setPointerChecker=function(pointerChecker){this.pointerChecker=pointerChecker},RoamController2.prototype.dispose=function(){this.disable()},RoamController2.prototype._mousedownHandler=function(e2){if(!isMiddleOrRightButtonOnMouseUpDown(e2)){for(var el=e2.target;el;){if(el.draggable)return;el=el.__hostTarget||el.parent}var x=e2.offsetX,y=e2.offsetY;this.pointerChecker&&this.pointerChecker(e2,x,y)&&(this._x=x,this._y=y,this._dragging=!0)}},RoamController2.prototype._mousemoveHandler=function(e2){if(this._dragging&&isAvailableBehavior("moveOnMouseMove",e2,this._opt)&&"pinch"!==e2.gestureEvent&&!isTaken(this._zr,"globalPan")){var x=e2.offsetX,y=e2.offsetY,oldX=this._x,oldY=this._y,dx=x-oldX,dy=y-oldY;this._x=x,this._y=y,this._opt.preventDefaultMouseMove&&stop(e2.event),trigger$1(this,"pan","moveOnMouseMove",e2,{dx:dx,dy:dy,oldX:oldX,oldY:oldY,newX:x,newY:y,isAvailableBehavior:null})}},RoamController2.prototype._mouseupHandler=function(e2){isMiddleOrRightButtonOnMouseUpDown(e2)||(this._dragging=!1)},RoamController2.prototype._mousewheelHandler=function(e2){var shouldZoom=isAvailableBehavior("zoomOnMouseWheel",e2,this._opt),shouldMove=isAvailableBehavior("moveOnMouseWheel",e2,this._opt),wheelDelta=e2.wheelDelta,absWheelDeltaDelta=Math.abs(wheelDelta),originX=e2.offsetX,originY=e2.offsetY;if(0!==wheelDelta&&(shouldZoom||shouldMove)){if(shouldZoom){var factor=absWheelDeltaDelta>3?1.4:absWheelDeltaDelta>1?1.2:1.1;checkPointerAndTrigger(this,"zoom","zoomOnMouseWheel",e2,{scale:wheelDelta>0?factor:1/factor,originX:originX,originY:originY,isAvailableBehavior:null})}if(shouldMove){var absDelta=Math.abs(wheelDelta);checkPointerAndTrigger(this,"scrollMove","moveOnMouseWheel",e2,{scrollDelta:(wheelDelta>0?1:-1)*(absDelta>3?.4:absDelta>1?.15:.05),originX:originX,originY:originY,isAvailableBehavior:null})}}},RoamController2.prototype._pinchHandler=function(e2){isTaken(this._zr,"globalPan")||checkPointerAndTrigger(this,"zoom",null,e2,{scale:e2.pinchScale>1?1.1:1/1.1,originX:e2.pinchX,originY:e2.pinchY,isAvailableBehavior:null})},RoamController2}(Eventful);function checkPointerAndTrigger(controller,eventName,behaviorToCheck,e2,contollerEvent){controller.pointerChecker&&controller.pointerChecker(e2,contollerEvent.originX,contollerEvent.originY)&&(stop(e2.event),trigger$1(controller,eventName,behaviorToCheck,e2,contollerEvent))}function trigger$1(controller,eventName,behaviorToCheck,e2,contollerEvent){contollerEvent.isAvailableBehavior=bind$1(isAvailableBehavior,null,behaviorToCheck,e2),controller.trigger(eventName,contollerEvent)}function isAvailableBehavior(behaviorToCheck,e2,settings){var setting=settings[behaviorToCheck];return!behaviorToCheck||setting&&(!isString(setting)||e2.event[setting+"Key"])}var nodeParsers,IRRELEVANT_EXCLUDES={axisPointer:1,tooltip:1,brush:1};function onIrrelevantElement(e2,api,targetCoordSysModel){var model=api.getComponentByElement(e2.topTarget),coordSys=model&&model.coordinateSystem;return model&&model!==targetCoordSysModel&&!IRRELEVANT_EXCLUDES.hasOwnProperty(model.mainType)&&coordSys&&coordSys.model!==targetCoordSysModel}function parseXML(svg){isString(svg)&&(svg=(new DOMParser).parseFromString(svg,"text/xml"));var svgNode=svg;for(9===svgNode.nodeType&&(svgNode=svgNode.firstChild);"svg"!==svgNode.nodeName.toLowerCase()||1!==svgNode.nodeType;)svgNode=svgNode.nextSibling;return svgNode}var INHERITABLE_STYLE_ATTRIBUTES_MAP={fill:"fill",stroke:"stroke","stroke-width":"lineWidth",opacity:"opacity","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-miterlimit":"miterLimit","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","text-anchor":"textAlign",visibility:"visibility",display:"display"},INHERITABLE_STYLE_ATTRIBUTES_MAP_KEYS=keys(INHERITABLE_STYLE_ATTRIBUTES_MAP),SELF_STYLE_ATTRIBUTES_MAP={"alignment-baseline":"textBaseline","stop-color":"stopColor"},SELF_STYLE_ATTRIBUTES_MAP_KEYS=keys(SELF_STYLE_ATTRIBUTES_MAP),SVGParser=function(){function SVGParser2(){this._defs={},this._root=null}return SVGParser2.prototype.parse=function(xml,opt){opt=opt||{};var svg=parseXML(xml);this._defsUsePending=[];var root=new Group$2;this._root=root;var named=[],viewBox=svg.getAttribute("viewBox")||"",width=parseFloat(svg.getAttribute("width")||opt.width),height=parseFloat(svg.getAttribute("height")||opt.height);isNaN(width)&&(width=null),isNaN(height)&&(height=null),parseAttributes(svg,root,null,!0,!1);for(var viewBoxRect,viewBoxTransform,child=svg.firstChild;child;)this._parseNode(child,root,named,null,!1,!1),child=child.nextSibling;if(function(defs,defsUsePending){for(var i=0;i<defsUsePending.length;i++){var item=defsUsePending[i];item[0].style[item[1]]=defs[item[2]]}}(this._defs,this._defsUsePending),this._defsUsePending=[],viewBox){var viewBoxArr=splitNumberSequence(viewBox);viewBoxArr.length>=4&&(viewBoxRect={x:parseFloat(viewBoxArr[0]||0),y:parseFloat(viewBoxArr[1]||0),width:parseFloat(viewBoxArr[2]),height:parseFloat(viewBoxArr[3])})}if(viewBoxRect&&null!=width&&null!=height&&(viewBoxTransform=makeViewBoxTransform(viewBoxRect,{x:0,y:0,width:width,height:height}),!opt.ignoreViewBox)){var elRoot=root;(root=new Group$2).add(elRoot),elRoot.scaleX=elRoot.scaleY=viewBoxTransform.scale,elRoot.x=viewBoxTransform.x,elRoot.y=viewBoxTransform.y}return opt.ignoreRootClip||null==width||null==height||root.setClipPath(new Rect$1({shape:{x:0,y:0,width:width,height:height}})),{root:root,width:width,height:height,viewBoxRect:viewBoxRect,viewBoxTransform:viewBoxTransform,named:named}},SVGParser2.prototype._parseNode=function(xmlNode,parentGroup,named,namedFrom,isInDefs,isInText){var el,nodeName=xmlNode.nodeName.toLowerCase(),namedFromForSub=namedFrom;if("defs"===nodeName&&(isInDefs=!0),"text"===nodeName&&(isInText=!0),"defs"===nodeName||"switch"===nodeName)el=parentGroup;else{if(!isInDefs){var parser_1=nodeParsers[nodeName];if(parser_1&&hasOwn(nodeParsers,nodeName)){el=parser_1.call(this,xmlNode,parentGroup);var nameAttr=xmlNode.getAttribute("name");if(nameAttr){var newNamed={name:nameAttr,namedFrom:null,svgNodeTagLower:nodeName,el:el};named.push(newNamed),"g"===nodeName&&(namedFromForSub=newNamed)}else namedFrom&&named.push({name:namedFrom.name,namedFrom:namedFrom,svgNodeTagLower:nodeName,el:el});parentGroup.add(el)}}var parser=paintServerParsers[nodeName];if(parser&&hasOwn(paintServerParsers,nodeName)){var def=parser.call(this,xmlNode),id=xmlNode.getAttribute("id");id&&(this._defs[id]=def)}}if(el&&el.isGroup)for(var child=xmlNode.firstChild;child;)1===child.nodeType?this._parseNode(child,el,named,namedFromForSub,isInDefs,isInText):3===child.nodeType&&isInText&&this._parseText(child,el),child=child.nextSibling},SVGParser2.prototype._parseText=function(xmlNode,parentGroup){var text=new TSpan({style:{text:xmlNode.textContent},silent:!0,x:this._textX||0,y:this._textY||0});inheritStyle(parentGroup,text),parseAttributes(xmlNode,text,this._defsUsePending,!1,!1),function(text,parentGroup){var parentSelfStyle=parentGroup.__selfStyle;if(parentSelfStyle){var textBaseline=parentSelfStyle.textBaseline,zrTextBaseline=textBaseline;textBaseline&&"auto"!==textBaseline?"baseline"===textBaseline?zrTextBaseline="alphabetic":"before-edge"===textBaseline||"text-before-edge"===textBaseline?zrTextBaseline="top":"after-edge"===textBaseline||"text-after-edge"===textBaseline?zrTextBaseline="bottom":"central"!==textBaseline&&"mathematical"!==textBaseline||(zrTextBaseline="middle"):zrTextBaseline="alphabetic",text.style.textBaseline=zrTextBaseline}var parentInheritedStyle=parentGroup.__inheritedStyle;if(parentInheritedStyle){var textAlign=parentInheritedStyle.textAlign,zrTextAlign=textAlign;textAlign&&("middle"===textAlign&&(zrTextAlign="center"),text.style.textAlign=zrTextAlign)}}(text,parentGroup);var textStyle=text.style,fontSize=textStyle.fontSize;fontSize&&fontSize<9&&(textStyle.fontSize=9,text.scaleX*=fontSize/9,text.scaleY*=fontSize/9);var font=(textStyle.fontSize||textStyle.fontFamily)&&[textStyle.fontStyle,textStyle.fontWeight,(textStyle.fontSize||12)+"px",textStyle.fontFamily||"sans-serif"].join(" ");textStyle.font=font;var rect=text.getBoundingRect();return this._textX+=rect.width,parentGroup.add(text),text},SVGParser2.internalField=void(nodeParsers={g:function(xmlNode,parentGroup){var g=new Group$2;return inheritStyle(parentGroup,g),parseAttributes(xmlNode,g,this._defsUsePending,!1,!1),g},rect:function(xmlNode,parentGroup){var rect=new Rect$1;return inheritStyle(parentGroup,rect),parseAttributes(xmlNode,rect,this._defsUsePending,!1,!1),rect.setShape({x:parseFloat(xmlNode.getAttribute("x")||"0"),y:parseFloat(xmlNode.getAttribute("y")||"0"),width:parseFloat(xmlNode.getAttribute("width")||"0"),height:parseFloat(xmlNode.getAttribute("height")||"0")}),rect.silent=!0,rect},circle:function(xmlNode,parentGroup){var circle=new Circle;return inheritStyle(parentGroup,circle),parseAttributes(xmlNode,circle,this._defsUsePending,!1,!1),circle.setShape({cx:parseFloat(xmlNode.getAttribute("cx")||"0"),cy:parseFloat(xmlNode.getAttribute("cy")||"0"),r:parseFloat(xmlNode.getAttribute("r")||"0")}),circle.silent=!0,circle},line:function(xmlNode,parentGroup){var line=new Line;return inheritStyle(parentGroup,line),parseAttributes(xmlNode,line,this._defsUsePending,!1,!1),line.setShape({x1:parseFloat(xmlNode.getAttribute("x1")||"0"),y1:parseFloat(xmlNode.getAttribute("y1")||"0"),x2:parseFloat(xmlNode.getAttribute("x2")||"0"),y2:parseFloat(xmlNode.getAttribute("y2")||"0")}),line.silent=!0,line},ellipse:function(xmlNode,parentGroup){var ellipse=new Ellipse;return inheritStyle(parentGroup,ellipse),parseAttributes(xmlNode,ellipse,this._defsUsePending,!1,!1),ellipse.setShape({cx:parseFloat(xmlNode.getAttribute("cx")||"0"),cy:parseFloat(xmlNode.getAttribute("cy")||"0"),rx:parseFloat(xmlNode.getAttribute("rx")||"0"),ry:parseFloat(xmlNode.getAttribute("ry")||"0")}),ellipse.silent=!0,ellipse},polygon:function(xmlNode,parentGroup){var pointsArr,pointsStr=xmlNode.getAttribute("points");pointsStr&&(pointsArr=parsePoints(pointsStr));var polygon=new Polygon({shape:{points:pointsArr||[]},silent:!0});return inheritStyle(parentGroup,polygon),parseAttributes(xmlNode,polygon,this._defsUsePending,!1,!1),polygon},polyline:function(xmlNode,parentGroup){var pointsArr,pointsStr=xmlNode.getAttribute("points");pointsStr&&(pointsArr=parsePoints(pointsStr));var polyline=new Polyline({shape:{points:pointsArr||[]},silent:!0});return inheritStyle(parentGroup,polyline),parseAttributes(xmlNode,polyline,this._defsUsePending,!1,!1),polyline},image:function(xmlNode,parentGroup){var img=new ZRImage;return inheritStyle(parentGroup,img),parseAttributes(xmlNode,img,this._defsUsePending,!1,!1),img.setStyle({image:xmlNode.getAttribute("xlink:href")||xmlNode.getAttribute("href"),x:+xmlNode.getAttribute("x"),y:+xmlNode.getAttribute("y"),width:+xmlNode.getAttribute("width"),height:+xmlNode.getAttribute("height")}),img.silent=!0,img},text:function(xmlNode,parentGroup){var x=xmlNode.getAttribute("x")||"0",y=xmlNode.getAttribute("y")||"0",dx=xmlNode.getAttribute("dx")||"0",dy=xmlNode.getAttribute("dy")||"0";this._textX=parseFloat(x)+parseFloat(dx),this._textY=parseFloat(y)+parseFloat(dy);var g=new Group$2;return inheritStyle(parentGroup,g),parseAttributes(xmlNode,g,this._defsUsePending,!1,!0),g},tspan:function(xmlNode,parentGroup){var x=xmlNode.getAttribute("x"),y=xmlNode.getAttribute("y");null!=x&&(this._textX=parseFloat(x)),null!=y&&(this._textY=parseFloat(y));var dx=xmlNode.getAttribute("dx")||"0",dy=xmlNode.getAttribute("dy")||"0",g=new Group$2;return inheritStyle(parentGroup,g),parseAttributes(xmlNode,g,this._defsUsePending,!1,!0),this._textX+=parseFloat(dx),this._textY+=parseFloat(dy),g},path:function(xmlNode,parentGroup){var path=createFromString(xmlNode.getAttribute("d")||"");return inheritStyle(parentGroup,path),parseAttributes(xmlNode,path,this._defsUsePending,!1,!1),path.silent=!0,path}}),SVGParser2}(),paintServerParsers={lineargradient:function(xmlNode){var x1=parseInt(xmlNode.getAttribute("x1")||"0",10),y1=parseInt(xmlNode.getAttribute("y1")||"0",10),x2=parseInt(xmlNode.getAttribute("x2")||"10",10),y2=parseInt(xmlNode.getAttribute("y2")||"0",10),gradient=new LinearGradient(x1,y1,x2,y2);return parsePaintServerUnit(xmlNode,gradient),parseGradientColorStops(xmlNode,gradient),gradient},radialgradient:function(xmlNode){var cx=parseInt(xmlNode.getAttribute("cx")||"0",10),cy=parseInt(xmlNode.getAttribute("cy")||"0",10),r=parseInt(xmlNode.getAttribute("r")||"0",10),gradient=new RadialGradient(cx,cy,r);return parsePaintServerUnit(xmlNode,gradient),parseGradientColorStops(xmlNode,gradient),gradient}};function parsePaintServerUnit(xmlNode,gradient){"userSpaceOnUse"===xmlNode.getAttribute("gradientUnits")&&(gradient.global=!0)}function parseGradientColorStops(xmlNode,gradient){for(var stop2=xmlNode.firstChild;stop2;){if(1===stop2.nodeType&&"stop"===stop2.nodeName.toLocaleLowerCase()){var offsetStr=stop2.getAttribute("offset"),offset=void 0;offset=offsetStr&&offsetStr.indexOf("%")>0?parseInt(offsetStr,10)/100:offsetStr?parseFloat(offsetStr):0;var styleVals={};parseInlineStyle(stop2,styleVals,styleVals);var stopColor=styleVals.stopColor||stop2.getAttribute("stop-color")||"#000000";gradient.colorStops.push({offset:offset,color:stopColor})}stop2=stop2.nextSibling}}function inheritStyle(parent,child){parent&&parent.__inheritedStyle&&(child.__inheritedStyle||(child.__inheritedStyle={}),defaults(child.__inheritedStyle,parent.__inheritedStyle))}function parsePoints(pointsString){for(var list=splitNumberSequence(pointsString),points2=[],i=0;i<list.length;i+=2){var x=parseFloat(list[i]),y=parseFloat(list[i+1]);points2.push([x,y])}return points2}function parseAttributes(xmlNode,el,defsUsePending,onlyInlineStyle,isTextGroup){var disp=el,inheritedStyle=disp.__inheritedStyle=disp.__inheritedStyle||{},selfStyle={};1===xmlNode.nodeType&&(function(xmlNode,node){var transform=xmlNode.getAttribute("transform");if(transform){transform=transform.replace(/,/g," ");var transformOps_1=[],mt=null;transform.replace(transformRegex,(function(str,type2,value2){return transformOps_1.push(type2,value2),""}));for(var i=transformOps_1.length-1;i>0;i-=2){var value=transformOps_1[i],type=transformOps_1[i-1],valueArr=splitNumberSequence(value);switch(mt=mt||[1,0,0,1,0,0],type){case"translate":translate(mt,mt,[parseFloat(valueArr[0]),parseFloat(valueArr[1]||"0")]);break;case"scale":scale$1(mt,mt,[parseFloat(valueArr[0]),parseFloat(valueArr[1]||valueArr[0])]);break;case"rotate":rotate(mt,mt,-parseFloat(valueArr[0])*DEGREE_TO_ANGLE,[parseFloat(valueArr[1]||"0"),parseFloat(valueArr[2]||"0")]);break;case"skewX":mul(mt,[1,0,Math.tan(parseFloat(valueArr[0])*DEGREE_TO_ANGLE),1,0,0],mt);break;case"skewY":mul(mt,[1,Math.tan(parseFloat(valueArr[0])*DEGREE_TO_ANGLE),0,1,0,0],mt);break;case"matrix":mt[0]=parseFloat(valueArr[0]),mt[1]=parseFloat(valueArr[1]),mt[2]=parseFloat(valueArr[2]),mt[3]=parseFloat(valueArr[3]),mt[4]=parseFloat(valueArr[4]),mt[5]=parseFloat(valueArr[5])}}node.setLocalTransform(mt)}}(xmlNode,el),parseInlineStyle(xmlNode,inheritedStyle,selfStyle),onlyInlineStyle||function(xmlNode,inheritableStyleResult,selfStyleResult){for(var i=0;i<INHERITABLE_STYLE_ATTRIBUTES_MAP_KEYS.length;i++){var svgAttrName=INHERITABLE_STYLE_ATTRIBUTES_MAP_KEYS[i];null!=(attrValue=xmlNode.getAttribute(svgAttrName))&&(inheritableStyleResult[INHERITABLE_STYLE_ATTRIBUTES_MAP[svgAttrName]]=attrValue)}for(i=0;i<SELF_STYLE_ATTRIBUTES_MAP_KEYS.length;i++){var attrValue;svgAttrName=SELF_STYLE_ATTRIBUTES_MAP_KEYS[i];null!=(attrValue=xmlNode.getAttribute(svgAttrName))&&(selfStyleResult[SELF_STYLE_ATTRIBUTES_MAP[svgAttrName]]=attrValue)}}(xmlNode,inheritedStyle,selfStyle)),disp.style=disp.style||{},null!=inheritedStyle.fill&&(disp.style.fill=getFillStrokeStyle(disp,"fill",inheritedStyle.fill,defsUsePending)),null!=inheritedStyle.stroke&&(disp.style.stroke=getFillStrokeStyle(disp,"stroke",inheritedStyle.stroke,defsUsePending)),each$d(["lineWidth","opacity","fillOpacity","strokeOpacity","miterLimit","fontSize"],(function(propName){null!=inheritedStyle[propName]&&(disp.style[propName]=parseFloat(inheritedStyle[propName]))})),each$d(["lineDashOffset","lineCap","lineJoin","fontWeight","fontFamily","fontStyle","textAlign"],(function(propName){null!=inheritedStyle[propName]&&(disp.style[propName]=inheritedStyle[propName])})),isTextGroup&&(disp.__selfStyle=selfStyle),inheritedStyle.lineDash&&(disp.style.lineDash=map$1(splitNumberSequence(inheritedStyle.lineDash),(function(str){return parseFloat(str)}))),"hidden"!==inheritedStyle.visibility&&"collapse"!==inheritedStyle.visibility||(disp.invisible=!0),"none"===inheritedStyle.display&&(disp.ignore=!0)}var urlRegex=/^url\(\s*#(.*?)\)/;function getFillStrokeStyle(el,method,str,defsUsePending){var urlMatch=str&&str.match(urlRegex);if(!urlMatch)return"none"===str&&(str=null),str;var url=trim$1(urlMatch[1]);defsUsePending.push([el,method,url])}var numberReg=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function splitNumberSequence(rawStr){return rawStr.match(numberReg)||[]}var transformRegex=/(translate|scale|rotate|skewX|skewY|matrix)\(([\-\s0-9\.eE,]*)\)/g,DEGREE_TO_ANGLE=Math.PI/180;var styleRegex=/([^\s:;]+)\s*:\s*([^:;]+)/g;function parseInlineStyle(xmlNode,inheritableStyleResult,selfStyleResult){var styleRegResult,style=xmlNode.getAttribute("style");if(style)for(styleRegex.lastIndex=0;null!=(styleRegResult=styleRegex.exec(style));){var svgStlAttr=styleRegResult[1],zrInheritableStlAttr=hasOwn(INHERITABLE_STYLE_ATTRIBUTES_MAP,svgStlAttr)?INHERITABLE_STYLE_ATTRIBUTES_MAP[svgStlAttr]:null;zrInheritableStlAttr&&(inheritableStyleResult[zrInheritableStlAttr]=styleRegResult[2]);var zrSelfStlAttr=hasOwn(SELF_STYLE_ATTRIBUTES_MAP,svgStlAttr)?SELF_STYLE_ATTRIBUTES_MAP[svgStlAttr]:null;zrSelfStlAttr&&(selfStyleResult[zrSelfStlAttr]=styleRegResult[2])}}function makeViewBoxTransform(viewBoxRect,boundingRect){var scaleX=boundingRect.width/viewBoxRect.width,scaleY=boundingRect.height/viewBoxRect.height,scale2=Math.min(scaleX,scaleY);return{scale:scale2,x:-(viewBoxRect.x+viewBoxRect.width/2)*scale2+(boundingRect.x+boundingRect.width/2),y:-(viewBoxRect.y+viewBoxRect.height/2)*scale2+(boundingRect.y+boundingRect.height/2)}}var REGION_AVAILABLE_SVG_TAG_MAP=createHashMap(["rect","circle","line","ellipse","polygon","polyline","path","text","tspan","g"]),GeoSVGResource=function(){function GeoSVGResource2(mapName,svg){this.type="geoSVG",this._usedGraphicMap=createHashMap(),this._freedGraphics=[],this._mapName=mapName,this._parsedXML=parseXML(svg)}return GeoSVGResource2.prototype.load=function(){var firstGraphic=this._firstGraphic;if(!firstGraphic){firstGraphic=this._firstGraphic=this._buildGraphic(this._parsedXML),this._freedGraphics.push(firstGraphic),this._boundingRect=this._firstGraphic.boundingRect.clone();var _a2=function(named){var regions=[],regionsMap=createHashMap();return each$d(named,(function(namedItem){if(null==namedItem.namedFrom){var region=new GeoSVGRegion(namedItem.name,namedItem.el);regions.push(region),regionsMap.set(namedItem.name,region)}})),{regions:regions,regionsMap:regionsMap}}(firstGraphic.named),regions=_a2.regions,regionsMap=_a2.regionsMap;this._regions=regions,this._regionsMap=regionsMap}return{boundingRect:this._boundingRect,regions:this._regions,regionsMap:this._regionsMap}},GeoSVGResource2.prototype._buildGraphic=function(svgXML){var result,rootFromParse,xml,opt;try{assert(null!=(rootFromParse=(result=svgXML&&(xml=svgXML,opt={ignoreViewBox:!0,ignoreRootClip:!0},(new SVGParser).parse(xml,opt))||{}).root))}catch(e2){throw new Error("Invalid svg format\n"+e2.message)}var root=new Group$2;root.add(rootFromParse),root.isGeoSVGGraphicRoot=!0;var svgWidth=result.width,svgHeight=result.height,viewBoxRect=result.viewBoxRect,boundingRect=this._boundingRect;if(!boundingRect){var bRectX=void 0,bRectY=void 0,bRectWidth=void 0,bRectHeight=void 0;if(null!=svgWidth?(bRectX=0,bRectWidth=svgWidth):viewBoxRect&&(bRectX=viewBoxRect.x,bRectWidth=viewBoxRect.width),null!=svgHeight?(bRectY=0,bRectHeight=svgHeight):viewBoxRect&&(bRectY=viewBoxRect.y,bRectHeight=viewBoxRect.height),null==bRectX||null==bRectY){var calculatedBoundingRect=rootFromParse.getBoundingRect();null==bRectX&&(bRectX=calculatedBoundingRect.x,bRectWidth=calculatedBoundingRect.width),null==bRectY&&(bRectY=calculatedBoundingRect.y,bRectHeight=calculatedBoundingRect.height)}boundingRect=this._boundingRect=new BoundingRect(bRectX,bRectY,bRectWidth,bRectHeight)}if(viewBoxRect){var viewBoxTransform=makeViewBoxTransform(viewBoxRect,boundingRect);rootFromParse.scaleX=rootFromParse.scaleY=viewBoxTransform.scale,rootFromParse.x=viewBoxTransform.x,rootFromParse.y=viewBoxTransform.y}root.setClipPath(new Rect$1({shape:boundingRect.plain()}));var named=[];return each$d(result.named,(function(namedItem){var el;null!=REGION_AVAILABLE_SVG_TAG_MAP.get(namedItem.svgNodeTagLower)&&(named.push(namedItem),(el=namedItem.el).silent=!1,el.isGroup&&el.traverse((function(child){child.silent=!1})))})),{root:root,boundingRect:boundingRect,named:named}},GeoSVGResource2.prototype.useGraphic=function(hostKey){var usedRootMap=this._usedGraphicMap,svgGraphic=usedRootMap.get(hostKey);return svgGraphic||(svgGraphic=this._freedGraphics.pop()||this._buildGraphic(this._parsedXML),usedRootMap.set(hostKey,svgGraphic),svgGraphic)},GeoSVGResource2.prototype.freeGraphic=function(hostKey){var usedRootMap=this._usedGraphicMap,svgGraphic=usedRootMap.get(hostKey);svgGraphic&&(usedRootMap.removeKey(hostKey),this._freedGraphics.push(svgGraphic))},GeoSVGResource2}();for(var geoCoord=[126,25],points$1=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]],i=0;i<points$1.length;i++)for(var k=0;k<points$1[i].length;k++)points$1[i][k][0]/=10.5,points$1[i][k][1]/=-14,points$1[i][k][0]+=geoCoord[0],points$1[i][k][1]+=geoCoord[1];var coordsOffsetMap={"南海诸岛":[32,80],"广东":[0,-10],"香港":[10,5],"澳门":[-10,10],"天津":[5,5]};var points=[[[123.45165252685547,25.73527164402261],[123.49731445312499,25.73527164402261],[123.49731445312499,25.750734064600884],[123.45165252685547,25.750734064600884],[123.45165252685547,25.73527164402261]]];var GeoJSONResource=function(){function GeoJSONResource2(mapName,geoJSON,specialAreas){var source;this.type="geoJSON",this._parsedMap=createHashMap(),this._mapName=mapName,this._specialAreas=specialAreas,this._geoJSON=isString(source=geoJSON)?"undefined"!=typeof JSON&&JSON.parse?JSON.parse(source):new Function("return ("+source+");")():source}return GeoJSONResource2.prototype.load=function(nameMap,nameProperty){nameProperty=nameProperty||"name";var parsed=this._parsedMap.get(nameProperty);if(!parsed){var rawRegions=this._parseToRegions(nameProperty);parsed=this._parsedMap.set(nameProperty,{regions:rawRegions,boundingRect:calculateBoundingRect(rawRegions)})}var regionsMap=createHashMap(),finalRegions=[];return each$d(parsed.regions,(function(region){var regionName=region.name;nameMap&&hasOwn(nameMap,regionName)&&(region=region.cloneShallow(regionName=nameMap[regionName])),finalRegions.push(region),regionsMap.set(regionName,region)})),{regions:finalRegions,boundingRect:parsed.boundingRect||new BoundingRect(0,0,0,0),regionsMap:regionsMap}},GeoJSONResource2.prototype._parseToRegions=function(nameProperty){var rawRegions,mapName=this._mapName,geoJSON=this._geoJSON;try{rawRegions=geoJSON?parseGeoJSON(geoJSON,nameProperty):[]}catch(e2){throw new Error("Invalid geoJson format\n"+e2.message)}return function(mapType,regions){if("china"===mapType){for(var i=0;i<regions.length;i++)if("南海诸岛"===regions[i].name)return;regions.push(new GeoJSONRegion("南海诸岛",map$1(points$1,(function(exterior){return{type:"polygon",exterior:exterior}})),geoCoord))}}(mapName,rawRegions),each$d(rawRegions,(function(region){var regionName=region.name;!function(mapType,region){if("china"===mapType){var coordFix=coordsOffsetMap[region.name];if(coordFix){var cp=region.getCenter();cp[0]+=coordFix[0]/10.5,cp[1]+=-coordFix[1]/14,region.setCenter(cp)}}}(mapName,region),function(mapType,region){"china"===mapType&&"台湾"===region.name&&region.geometries.push({type:"polygon",exterior:points[0]})}(mapName,region);var specialArea=this._specialAreas&&this._specialAreas[regionName];specialArea&&region.transformTo(specialArea.left,specialArea.top,specialArea.width,specialArea.height)}),this),rawRegions},GeoJSONResource2.prototype.getMapForUser=function(){return{geoJson:this._geoJSON,geoJSON:this._geoJSON,specialAreas:this._specialAreas}},GeoJSONResource2}();function calculateBoundingRect(regions){for(var rect,i=0;i<regions.length;i++){var regionRect=regions[i].getBoundingRect();(rect=rect||regionRect.clone()).union(regionRect)}return rect}var storage=createHashMap();const geoSourceManager_registerMap=function(mapName,rawDef,rawSpecialAreas){if(rawDef.svg){var resource=new GeoSVGResource(mapName,rawDef.svg);storage.set(mapName,resource)}else{var geoJSON=rawDef.geoJson||rawDef.geoJSON;geoJSON&&!rawDef.features?rawSpecialAreas=rawDef.specialAreas:geoJSON=rawDef;resource=new GeoJSONResource(mapName,geoJSON,rawSpecialAreas);storage.set(mapName,resource)}},geoSourceManager_getGeoResource=function(mapName){return storage.get(mapName)},geoSourceManager_getMapForUser=function(mapName){var resource=storage.get(mapName);return resource&&"geoJSON"===resource.type&&resource.getMapForUser()},geoSourceManager_load=function(mapName,nameMap,nameProperty){var resource=storage.get(mapName);if(resource)return resource.load(nameMap,nameProperty)};var OPTION_STYLE_ENABLED_TAGS=["rect","circle","line","ellipse","polygon","polyline","path"],OPTION_STYLE_ENABLED_TAG_MAP=createHashMap(OPTION_STYLE_ENABLED_TAGS),STATE_TRIGGER_TAG_MAP=createHashMap(OPTION_STYLE_ENABLED_TAGS.concat(["g"])),LABEL_HOST_MAP=createHashMap(OPTION_STYLE_ENABLED_TAGS.concat(["g"])),mapLabelRaw=makeInner();function getFixedItemStyle(model){var itemStyle=model.getItemStyle(),areaColor=model.get("areaColor");return null!=areaColor&&(itemStyle.fill=areaColor),itemStyle}function fixLineStyle(styleHost){var style=styleHost.style;style&&(style.stroke=style.stroke||style.fill,style.fill=null)}var MapDraw=function(){function MapDraw2(api){var group=new Group$2;this.uid=getUID("ec_map_draw"),this._controller=new RoamController(api.getZr()),this._controllerHost={target:group},this.group=group,group.add(this._regionsGroup=new Group$2),group.add(this._svgGroup=new Group$2)}return MapDraw2.prototype.draw=function(mapOrGeoModel,ecModel,api,fromView,payload){var isGeo="geo"===mapOrGeoModel.mainType,data=mapOrGeoModel.getData&&mapOrGeoModel.getData();isGeo&&ecModel.eachComponent({mainType:"series",subType:"map"},(function(mapSeries){data||mapSeries.getHostGeoModel()!==mapOrGeoModel||(data=mapSeries.getData())}));var geo=mapOrGeoModel.coordinateSystem,regionsGroup=this._regionsGroup,group=this.group,transformInfo=geo.getTransformInfo(),transformInfoRaw=transformInfo.raw,transformInfoRoam=transformInfo.roam;!regionsGroup.childAt(0)||payload?(group.x=transformInfoRoam.x,group.y=transformInfoRoam.y,group.scaleX=transformInfoRoam.scaleX,group.scaleY=transformInfoRoam.scaleY,group.dirty()):updateProps$1(group,transformInfoRoam,mapOrGeoModel);var isVisualEncodedByVisualMap=data&&data.getVisual("visualMeta")&&data.getVisual("visualMeta").length>0,viewBuildCtx={api:api,geo:geo,mapOrGeoModel:mapOrGeoModel,data:data,isVisualEncodedByVisualMap:isVisualEncodedByVisualMap,isGeo:isGeo,transformInfoRaw:transformInfoRaw};"geoJSON"===geo.resourceType?this._buildGeoJSON(viewBuildCtx):"geoSVG"===geo.resourceType&&this._buildSVG(viewBuildCtx),this._updateController(mapOrGeoModel,ecModel,api),this._updateMapSelectHandler(mapOrGeoModel,regionsGroup,api,fromView)},MapDraw2.prototype._buildGeoJSON=function(viewBuildCtx){var regionsGroupByName=this._regionsGroupByName=createHashMap(),regionsInfoByName=createHashMap(),regionsGroup=this._regionsGroup,transformInfoRaw=viewBuildCtx.transformInfoRaw,mapOrGeoModel=viewBuildCtx.mapOrGeoModel,data=viewBuildCtx.data,projection=viewBuildCtx.geo.projection,projectionStream=projection&&projection.stream;function transformPoint(point,project){return project&&(point=project(point)),point&&[point[0]*transformInfoRaw.scaleX+transformInfoRaw.x,point[1]*transformInfoRaw.scaleY+transformInfoRaw.y]}function transformPolygonPoints(inPoints){for(var outPoints=[],project=!projectionStream&&projection&&projection.project,i=0;i<inPoints.length;++i){var newPt=transformPoint(inPoints[i],project);newPt&&outPoints.push(newPt)}return outPoints}function getPolyShape(points2){return{shape:{points:transformPolygonPoints(points2)}}}regionsGroup.removeAll(),each$d(viewBuildCtx.geo.regions,(function(region){var regionName=region.name,regionGroup=regionsGroupByName.get(regionName),_a2=regionsInfoByName.get(regionName)||{},dataIdx=_a2.dataIdx,regionModel=_a2.regionModel;if(!regionGroup){regionGroup=regionsGroupByName.set(regionName,new Group$2),regionsGroup.add(regionGroup),dataIdx=data?data.indexOfName(regionName):null;var silent=(regionModel=viewBuildCtx.isGeo?mapOrGeoModel.getRegionModel(regionName):data?data.getItemModel(dataIdx):null).get("silent",!0);null!=silent&&(regionGroup.silent=silent),regionsInfoByName.set(regionName,{dataIdx:dataIdx,regionModel:regionModel})}var polygonSubpaths=[],polylineSubpaths=[];each$d(region.geometries,(function(geometry){if("polygon"===geometry.type){var polys=[geometry.exterior].concat(geometry.interiors||[]);projectionStream&&(polys=projectPolys(polys,projectionStream)),each$d(polys,(function(poly){polygonSubpaths.push(new Polygon(getPolyShape(poly)))}))}else{var points2=geometry.points;projectionStream&&(points2=projectPolys(points2,projectionStream,!0)),each$d(points2,(function(points3){polylineSubpaths.push(new Polyline(getPolyShape(points3)))}))}}));var centerPt=transformPoint(region.getCenter(),projection&&projection.project);function createCompoundPath(subpaths,isLine){if(subpaths.length){var compoundPath=new CompoundPath({culling:!0,segmentIgnoreThreshold:1,shape:{paths:subpaths}});regionGroup.add(compoundPath),applyOptionStyleForRegion(viewBuildCtx,compoundPath,dataIdx,regionModel),resetLabelForRegion(viewBuildCtx,compoundPath,regionName,regionModel,mapOrGeoModel,dataIdx,centerPt),isLine&&(fixLineStyle(compoundPath),each$d(compoundPath.states,fixLineStyle))}}createCompoundPath(polygonSubpaths),createCompoundPath(polylineSubpaths,!0)})),regionsGroupByName.each((function(regionGroup,regionName){var _a2=regionsInfoByName.get(regionName),dataIdx=_a2.dataIdx,regionModel=_a2.regionModel;resetEventTriggerForRegion(viewBuildCtx,regionGroup,regionName,regionModel,mapOrGeoModel,dataIdx),resetTooltipForRegion(viewBuildCtx,regionGroup,regionName,regionModel,mapOrGeoModel),resetStateTriggerForRegion(viewBuildCtx,regionGroup,regionName,regionModel,mapOrGeoModel)}),this)},MapDraw2.prototype._buildSVG=function(viewBuildCtx){var mapName=viewBuildCtx.geo.map,transformInfoRaw=viewBuildCtx.transformInfoRaw;this._svgGroup.x=transformInfoRaw.x,this._svgGroup.y=transformInfoRaw.y,this._svgGroup.scaleX=transformInfoRaw.scaleX,this._svgGroup.scaleY=transformInfoRaw.scaleY,this._svgResourceChanged(mapName)&&(this._freeSVG(),this._useSVG(mapName));var svgDispatcherMap=this._svgDispatcherMap=createHashMap(),focusSelf=!1;each$d(this._svgGraphicRecord.named,(function(namedItem){var regionName=namedItem.name,mapOrGeoModel=viewBuildCtx.mapOrGeoModel,data=viewBuildCtx.data,svgNodeTagLower=namedItem.svgNodeTagLower,el=namedItem.el,dataIdx=data?data.indexOfName(regionName):null,regionModel=mapOrGeoModel.getRegionModel(regionName);null!=OPTION_STYLE_ENABLED_TAG_MAP.get(svgNodeTagLower)&&el instanceof Displayable&&applyOptionStyleForRegion(viewBuildCtx,el,dataIdx,regionModel),el instanceof Displayable&&(el.culling=!0);var silent=regionModel.get("silent",!0);(null!=silent&&(el.silent=silent),el.z2EmphasisLift=0,namedItem.namedFrom)||(null!=LABEL_HOST_MAP.get(svgNodeTagLower)&&resetLabelForRegion(viewBuildCtx,el,regionName,regionModel,mapOrGeoModel,dataIdx,null),resetEventTriggerForRegion(viewBuildCtx,el,regionName,regionModel,mapOrGeoModel,dataIdx),resetTooltipForRegion(viewBuildCtx,el,regionName,regionModel,mapOrGeoModel),null!=STATE_TRIGGER_TAG_MAP.get(svgNodeTagLower)&&("self"===resetStateTriggerForRegion(viewBuildCtx,el,regionName,regionModel,mapOrGeoModel)&&(focusSelf=!0),(svgDispatcherMap.get(regionName)||svgDispatcherMap.set(regionName,[])).push(el)))}),this),this._enableBlurEntireSVG(focusSelf,viewBuildCtx)},MapDraw2.prototype._enableBlurEntireSVG=function(focusSelf,viewBuildCtx){if(focusSelf&&viewBuildCtx.isGeo){var opacity_1=viewBuildCtx.mapOrGeoModel.getModel(["blur","itemStyle"]).getItemStyle().opacity;this._svgGraphicRecord.root.traverse((function(el){if(!el.isGroup){setDefaultStateProxy(el);var style=el.ensureState("blur").style||{};null==style.opacity&&null!=opacity_1&&(style.opacity=opacity_1),el.ensureState("emphasis")}}))}},MapDraw2.prototype.remove=function(){this._regionsGroup.removeAll(),this._regionsGroupByName=null,this._svgGroup.removeAll(),this._freeSVG(),this._controller.dispose(),this._controllerHost=null},MapDraw2.prototype.findHighDownDispatchers=function(name,geoModel){if(null==name)return[];var geo=geoModel.coordinateSystem;if("geoJSON"===geo.resourceType){var regionsGroupByName=this._regionsGroupByName;if(regionsGroupByName){var regionGroup=regionsGroupByName.get(name);return regionGroup?[regionGroup]:[]}}else if("geoSVG"===geo.resourceType)return this._svgDispatcherMap&&this._svgDispatcherMap.get(name)||[]},MapDraw2.prototype._svgResourceChanged=function(mapName){return this._svgMapName!==mapName},MapDraw2.prototype._useSVG=function(mapName){var resource=geoSourceManager_getGeoResource(mapName);if(resource&&"geoSVG"===resource.type){var svgGraphic=resource.useGraphic(this.uid);this._svgGroup.add(svgGraphic.root),this._svgGraphicRecord=svgGraphic,this._svgMapName=mapName}},MapDraw2.prototype._freeSVG=function(){var mapName=this._svgMapName;if(null!=mapName){var resource=geoSourceManager_getGeoResource(mapName);resource&&"geoSVG"===resource.type&&resource.freeGraphic(this.uid),this._svgGraphicRecord=null,this._svgDispatcherMap=null,this._svgGroup.removeAll(),this._svgMapName=null}},MapDraw2.prototype._updateController=function(mapOrGeoModel,ecModel,api){var geo=mapOrGeoModel.coordinateSystem,controller=this._controller,controllerHost=this._controllerHost;controllerHost.zoomLimit=mapOrGeoModel.get("scaleLimit"),controllerHost.zoom=geo.getZoom(),controller.enable(mapOrGeoModel.get("roam")||!1);var mainType=mapOrGeoModel.mainType;function makeActionBase(){var action={type:"geoRoam",componentType:mainType};return action[mainType+"Id"]=mapOrGeoModel.id,action}controller.off("pan").on("pan",(function(e2){this._mouseDownFlag=!1,function(controllerHost,dx,dy){var target=controllerHost.target;target.x+=dx,target.y+=dy,target.dirty()}(controllerHost,e2.dx,e2.dy),api.dispatchAction(extend(makeActionBase(),{dx:e2.dx,dy:e2.dy,animation:{duration:0}}))}),this),controller.off("zoom").on("zoom",(function(e2){this._mouseDownFlag=!1,function(controllerHost,zoomDelta,zoomX,zoomY){var target=controllerHost.target,zoomLimit=controllerHost.zoomLimit,newZoom=controllerHost.zoom=controllerHost.zoom||1;if(newZoom*=zoomDelta,zoomLimit){var zoomMin=zoomLimit.min||0,zoomMax=zoomLimit.max||Infinity;newZoom=Math.max(Math.min(zoomMax,newZoom),zoomMin)}var zoomScale=newZoom/controllerHost.zoom;controllerHost.zoom=newZoom,target.x-=(zoomX-target.x)*(zoomScale-1),target.y-=(zoomY-target.y)*(zoomScale-1),target.scaleX*=zoomScale,target.scaleY*=zoomScale,target.dirty()}(controllerHost,e2.scale,e2.originX,e2.originY),api.dispatchAction(extend(makeActionBase(),{totalZoom:controllerHost.zoom,zoom:e2.scale,originX:e2.originX,originY:e2.originY,animation:{duration:0}}))}),this),controller.setPointerChecker((function(e2,x,y){return geo.containPoint([x,y])&&!onIrrelevantElement(e2,api,mapOrGeoModel)}))},MapDraw2.prototype.resetForLabelLayout=function(){this.group.traverse((function(el){var label=el.getTextContent();label&&(label.ignore=mapLabelRaw(label).ignore)}))},MapDraw2.prototype._updateMapSelectHandler=function(mapOrGeoModel,regionsGroup,api,fromView){var mapDraw=this;regionsGroup.off("mousedown"),regionsGroup.off("click"),mapOrGeoModel.get("selectedMode")&&(regionsGroup.on("mousedown",(function(){mapDraw._mouseDownFlag=!0})),regionsGroup.on("click",(function(e2){mapDraw._mouseDownFlag&&(mapDraw._mouseDownFlag=!1)})))},MapDraw2}();function applyOptionStyleForRegion(viewBuildCtx,el,dataIndex,regionModel){var normalStyleModel=regionModel.getModel("itemStyle"),emphasisStyleModel=regionModel.getModel(["emphasis","itemStyle"]),blurStyleModel=regionModel.getModel(["blur","itemStyle"]),selectStyleModel=regionModel.getModel(["select","itemStyle"]),normalStyle=getFixedItemStyle(normalStyleModel),emphasisStyle=getFixedItemStyle(emphasisStyleModel),selectStyle=getFixedItemStyle(selectStyleModel),blurStyle=getFixedItemStyle(blurStyleModel),data=viewBuildCtx.data;if(data){var style=data.getItemVisual(dataIndex,"style"),decal=data.getItemVisual(dataIndex,"decal");viewBuildCtx.isVisualEncodedByVisualMap&&style.fill&&(normalStyle.fill=style.fill),decal&&(normalStyle.decal=createOrUpdatePatternFromDecal(decal,viewBuildCtx.api))}el.setStyle(normalStyle),el.style.strokeNoScale=!0,el.ensureState("emphasis").style=emphasisStyle,el.ensureState("select").style=selectStyle,el.ensureState("blur").style=blurStyle,setDefaultStateProxy(el)}function resetLabelForRegion(viewBuildCtx,el,regionName,regionModel,mapOrGeoModel,dataIdx,labelXY){var data=viewBuildCtx.data,isGeo=viewBuildCtx.isGeo,isDataNaN=data&&isNaN(data.get(data.mapDimension("value"),dataIdx)),itemLayout=data&&data.getItemLayout(dataIdx);if(isGeo||isDataNaN||itemLayout&&itemLayout.showLabel){var query=isGeo?regionName:dataIdx,labelFetcher=void 0;(!data||dataIdx>=0)&&(labelFetcher=mapOrGeoModel);var specifiedTextOpt=labelXY?{normal:{align:"center",verticalAlign:"middle"}}:null;setLabelStyle(el,getLabelStatesModels(regionModel),{labelFetcher:labelFetcher,labelDataIndex:query,defaultText:regionName},specifiedTextOpt);var textEl=el.getTextContent();if(textEl&&(mapLabelRaw(textEl).ignore=textEl.ignore,el.textConfig&&labelXY)){var rect=el.getBoundingRect().clone();el.textConfig.layoutRect=rect,el.textConfig.position=[(labelXY[0]-rect.x)/rect.width*100+"%",(labelXY[1]-rect.y)/rect.height*100+"%"]}el.disableLabelAnimation=!0}else el.removeTextContent(),el.removeTextConfig(),el.disableLabelAnimation=null}function resetEventTriggerForRegion(viewBuildCtx,eventTrigger,regionName,regionModel,mapOrGeoModel,dataIdx){viewBuildCtx.data?viewBuildCtx.data.setItemGraphicEl(dataIdx,eventTrigger):getECData(eventTrigger).eventData={componentType:"geo",componentIndex:mapOrGeoModel.componentIndex,geoIndex:mapOrGeoModel.componentIndex,name:regionName,region:regionModel&&regionModel.option||{}}}function resetTooltipForRegion(viewBuildCtx,el,regionName,regionModel,mapOrGeoModel){viewBuildCtx.data||setTooltipConfig({el:el,componentModel:mapOrGeoModel,itemName:regionName,itemTooltipOption:regionModel.get("tooltip")})}function resetStateTriggerForRegion(viewBuildCtx,el,regionName,regionModel,mapOrGeoModel){el.highDownSilentOnTouch=!!mapOrGeoModel.get("selectedMode");var emphasisModel=regionModel.getModel("emphasis"),focus=emphasisModel.get("focus");return toggleHoverEmphasis(el,focus,emphasisModel.get("blurScope"),emphasisModel.get("disabled")),viewBuildCtx.isGeo&&function(el,componentModel,componentHighDownName){var ecData=getECData(el);ecData.componentMainType=componentModel.mainType,ecData.componentIndex=componentModel.componentIndex,ecData.componentHighDownName=componentHighDownName}(el,mapOrGeoModel,regionName),focus}function projectPolys(rings,createStream,isLine){var curPoly,polygons=[];function startPolygon(){curPoly=[]}function endPolygon(){curPoly.length&&(polygons.push(curPoly),curPoly=[])}var stream=createStream({polygonStart:startPolygon,polygonEnd:endPolygon,lineStart:startPolygon,lineEnd:endPolygon,point:function(x,y){isFinite(x)&&isFinite(y)&&curPoly.push([x,y])},sphere:function(){}});return!isLine&&stream.polygonStart(),each$d(rings,(function(ring){stream.lineStart();for(var i=0;i<ring.length;i++)stream.point(ring[i][0],ring[i][1]);stream.lineEnd()})),!isLine&&stream.polygonEnd(),polygons}var MapView=function(_super){function MapView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=MapView2.type,_this}return __extends(MapView2,_super),MapView2.prototype.render=function(mapModel,ecModel,api,payload){if(!payload||"mapToggleSelect"!==payload.type||payload.from!==this.uid){var group=this.group;if(group.removeAll(),!mapModel.getHostGeoModel()){if(this._mapDraw&&payload&&"geoRoam"===payload.type&&this._mapDraw.resetForLabelLayout(),payload&&"geoRoam"===payload.type&&"series"===payload.componentType&&payload.seriesId===mapModel.id)(mapDraw=this._mapDraw)&&group.add(mapDraw.group);else if(mapModel.needsDrawMap){var mapDraw=this._mapDraw||new MapDraw(api);group.add(mapDraw.group),mapDraw.draw(mapModel,ecModel,api,this,payload),this._mapDraw=mapDraw}else this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;mapModel.get("showLegendSymbol")&&ecModel.getComponent("legend")&&this._renderSymbols(mapModel,ecModel,api)}}},MapView2.prototype.remove=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll()},MapView2.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null},MapView2.prototype._renderSymbols=function(mapModel,ecModel,api){var originalData=mapModel.originalData,group=this.group;originalData.each(originalData.mapDimension("value"),(function(value,originalDataIndex){if(!isNaN(value)){var layout2=originalData.getItemLayout(originalDataIndex);if(layout2&&layout2.point){var point=layout2.point,offset=layout2.offset,circle=new Circle({style:{fill:mapModel.getData().getVisual("style").fill},shape:{cx:point[0]+9*offset,cy:point[1],r:3},silent:!0,z2:8+(offset?0:11)});if(!offset){var fullData=mapModel.mainSeries.getData(),name_1=originalData.getName(originalDataIndex),fullIndex_1=fullData.indexOfName(name_1),itemModel=originalData.getItemModel(originalDataIndex),labelModel=itemModel.getModel("label"),regionGroup=fullData.getItemGraphicEl(fullIndex_1);setLabelStyle(circle,getLabelStatesModels(itemModel),{labelFetcher:{getFormattedLabel:function(idx,state){return mapModel.getFormattedLabel(fullIndex_1,state)}},defaultText:name_1}),circle.disableLabelAnimation=!0,labelModel.get("position")||circle.setTextConfig({position:"bottom"}),regionGroup.onHoverStateChange=function(toState){setStatesFlag(circle,toState)}}group.add(circle)}}}))},MapView2.type="map",MapView2}(ChartView),MapSeries=function(_super){function MapSeries2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=MapSeries2.type,_this.needsDrawMap=!1,_this.seriesGroup=[],_this.getTooltipPosition=function(dataIndex){if(null!=dataIndex){var name_1=this.getData().getName(dataIndex),geo=this.coordinateSystem,region=geo.getRegion(name_1);return region&&geo.dataToPoint(region.getCenter())}},_this}return __extends(MapSeries2,_super),MapSeries2.prototype.getInitialData=function(option){for(var data=createSeriesDataSimply(this,{coordDimensions:["value"],encodeDefaulter:curry$1(makeSeriesEncodeForNameBased,this)}),dataNameIndexMap=createHashMap(),toAppendItems=[],i=0,len2=data.count();i<len2;i++){var name_2=data.getName(i);dataNameIndexMap.set(name_2,i)}return each$d(geoSourceManager_load(this.getMapType(),this.option.nameMap,this.option.nameProperty).regions,(function(region){var dataItem,name=region.name,dataNameIdx=dataNameIndexMap.get(name),specifiedGeoJSONRegionStyle=region.properties&&region.properties.echartsStyle;null==dataNameIdx?(dataItem={name:name},toAppendItems.push(dataItem)):dataItem=data.getRawDataItem(dataNameIdx),specifiedGeoJSONRegionStyle&&merge(dataItem,specifiedGeoJSONRegionStyle)})),data.appendData(toAppendItems),data},MapSeries2.prototype.getHostGeoModel=function(){var geoIndex=this.option.geoIndex;return null!=geoIndex?this.ecModel.getComponent("geo",geoIndex):null},MapSeries2.prototype.getMapType=function(){return(this.getHostGeoModel()||this).option.map},MapSeries2.prototype.getRawValue=function(dataIndex){var data=this.getData();return data.get(data.mapDimension("value"),dataIndex)},MapSeries2.prototype.getRegionModel=function(regionName){var data=this.getData();return data.getItemModel(data.indexOfName(regionName))},MapSeries2.prototype.formatTooltip=function(dataIndex,multipleSeries,dataType){for(var data=this.getData(),value=this.getRawValue(dataIndex),name=data.getName(dataIndex),seriesGroup=this.seriesGroup,seriesNames=[],i=0;i<seriesGroup.length;i++){var otherIndex=seriesGroup[i].originalData.indexOfName(name),valueDim=data.mapDimension("value");isNaN(seriesGroup[i].originalData.get(valueDim,otherIndex))||seriesNames.push(seriesGroup[i].name)}return createTooltipMarkup("section",{header:seriesNames.join(", "),noHeader:!seriesNames.length,blocks:[createTooltipMarkup("nameValue",{name:name,value:value})]})},MapSeries2.prototype.setZoom=function(zoom){this.option.zoom=zoom},MapSeries2.prototype.setCenter=function(center2){this.option.center=center2},MapSeries2.prototype.getLegendIcon=function(opt){var iconType=opt.icon||"roundRect",icon=createSymbol(iconType,0,0,opt.itemWidth,opt.itemHeight,opt.itemStyle.fill);return icon.setStyle(opt.itemStyle),icon.style.stroke="none",iconType.indexOf("empty")>-1&&(icon.style.stroke=icon.style.fill,icon.style.fill="#fff",icon.style.lineWidth=2),icon},MapSeries2.type="series.map",MapSeries2.dependencies=["geo"],MapSeries2.layoutMode="box",MapSeries2.defaultOption={z:2,coordinateSystem:"geo",map:"",left:"center",top:"center",aspectScale:null,showLegendSymbol:!0,boundingCoords:null,center:null,zoom:1,scaleLimit:null,selectedMode:!0,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",areaColor:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{areaColor:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},nameProperty:"name"},MapSeries2}(SeriesModel);function mapDataStatistic(ecModel){var seriesGroups={};ecModel.eachSeriesByType("map",(function(seriesModel){var hostGeoModel=seriesModel.getHostGeoModel(),key=hostGeoModel?"o"+hostGeoModel.id:"i"+seriesModel.getMapType();(seriesGroups[key]=seriesGroups[key]||[]).push(seriesModel)})),each$d(seriesGroups,(function(seriesList,key){for(var datas,statisticType,dataNameMap,data=(datas=map$1(seriesList,(function(seriesModel){return seriesModel.getData()})),statisticType=seriesList[0].get("mapValueCalculation"),dataNameMap={},each$d(datas,(function(data){data.each(data.mapDimension("value"),(function(value,idx){var mapKey="ec-"+data.getName(idx);dataNameMap[mapKey]=dataNameMap[mapKey]||[],isNaN(value)||dataNameMap[mapKey].push(value)}))})),datas[0].map(datas[0].mapDimension("value"),(function(value,idx){for(var mapKey="ec-"+datas[0].getName(idx),sum=0,min3=Infinity,max3=-Infinity,len2=dataNameMap[mapKey].length,i=0;i<len2;i++)min3=Math.min(min3,dataNameMap[mapKey][i]),max3=Math.max(max3,dataNameMap[mapKey][i]),sum+=dataNameMap[mapKey][i];return 0===len2?NaN:"min"===statisticType?min3:"max"===statisticType?max3:"average"===statisticType?sum/len2:sum}))),i=0;i<seriesList.length;i++)seriesList[i].originalData=seriesList[i].getData();for(i=0;i<seriesList.length;i++)seriesList[i].seriesGroup=seriesList,seriesList[i].needsDrawMap=0===i&&!seriesList[i].getHostGeoModel(),seriesList[i].setData(data.cloneShallow()),seriesList[i].mainSeries=seriesList[0]}))}function mapSymbolLayout(ecModel){var processedMapType={};ecModel.eachSeriesByType("map",(function(mapSeries){var mapType=mapSeries.getMapType();if(!mapSeries.getHostGeoModel()&&!processedMapType[mapType]){var mapSymbolOffsets={};each$d(mapSeries.seriesGroup,(function(subMapSeries){var geo=subMapSeries.coordinateSystem,data2=subMapSeries.originalData;subMapSeries.get("showLegendSymbol")&&ecModel.getComponent("legend")&&data2.each(data2.mapDimension("value"),(function(value,idx){var name=data2.getName(idx),region=geo.getRegion(name);if(region&&!isNaN(value)){var offset=mapSymbolOffsets[name]||0,point=geo.dataToPoint(region.getCenter());mapSymbolOffsets[name]=offset+1,data2.setItemLayout(idx,{point:point,offset:offset})}}))}));var data=mapSeries.getData();data.each((function(idx){var name=data.getName(idx),layout2=data.getItemLayout(idx)||{};layout2.showLabel=!mapSymbolOffsets[name],data.setItemLayout(idx,layout2)})),processedMapType[mapType]=!0}}))}var v2ApplyTransform=applyTransform$1,View=function(_super){function View2(name){var _this=_super.call(this)||this;return _this.type="view",_this.dimensions=["x","y"],_this._roamTransformable=new Transformable,_this._rawTransformable=new Transformable,_this.name=name,_this}return __extends(View2,_super),View2.prototype.setBoundingRect=function(x,y,width,height){return this._rect=new BoundingRect(x,y,width,height),this._rect},View2.prototype.getBoundingRect=function(){return this._rect},View2.prototype.setViewRect=function(x,y,width,height){this._transformTo(x,y,width,height),this._viewRect=new BoundingRect(x,y,width,height)},View2.prototype._transformTo=function(x,y,width,height){var rect=this.getBoundingRect(),rawTransform=this._rawTransformable;rawTransform.transform=rect.calculateTransform(new BoundingRect(x,y,width,height));var rawParent=rawTransform.parent;rawTransform.parent=null,rawTransform.decomposeTransform(),rawTransform.parent=rawParent,this._updateTransform()},View2.prototype.setCenter=function(centerCoord,api){centerCoord&&(this._center=[parsePercent(centerCoord[0],api.getWidth()),parsePercent(centerCoord[1],api.getHeight())],this._updateCenterAndZoom())},View2.prototype.setZoom=function(zoom){zoom=zoom||1;var zoomLimit=this.zoomLimit;zoomLimit&&(null!=zoomLimit.max&&(zoom=Math.min(zoomLimit.max,zoom)),null!=zoomLimit.min&&(zoom=Math.max(zoomLimit.min,zoom))),this._zoom=zoom,this._updateCenterAndZoom()},View2.prototype.getDefaultCenter=function(){var rawRect=this.getBoundingRect();return[rawRect.x+rawRect.width/2,rawRect.y+rawRect.height/2]},View2.prototype.getCenter=function(){return this._center||this.getDefaultCenter()},View2.prototype.getZoom=function(){return this._zoom||1},View2.prototype.getRoamTransform=function(){return this._roamTransformable.getLocalTransform()},View2.prototype._updateCenterAndZoom=function(){var rawTransformMatrix=this._rawTransformable.getLocalTransform(),roamTransform=this._roamTransformable,defaultCenter=this.getDefaultCenter(),center2=this.getCenter(),zoom=this.getZoom();center2=applyTransform$1([],center2,rawTransformMatrix),defaultCenter=applyTransform$1([],defaultCenter,rawTransformMatrix),roamTransform.originX=center2[0],roamTransform.originY=center2[1],roamTransform.x=defaultCenter[0]-center2[0],roamTransform.y=defaultCenter[1]-center2[1],roamTransform.scaleX=roamTransform.scaleY=zoom,this._updateTransform()},View2.prototype._updateTransform=function(){var roamTransformable=this._roamTransformable,rawTransformable=this._rawTransformable;rawTransformable.parent=roamTransformable,roamTransformable.updateTransform(),rawTransformable.updateTransform(),copy(this.transform||(this.transform=[]),rawTransformable.transform||[1,0,0,1,0,0]),this._rawTransform=rawTransformable.getLocalTransform(),this.invTransform=this.invTransform||[],invert(this.invTransform,this.transform),this.decomposeTransform()},View2.prototype.getTransformInfo=function(){var rawTransformable=this._rawTransformable,roamTransformable=this._roamTransformable,dummyTransformable=new Transformable;return dummyTransformable.transform=roamTransformable.transform,dummyTransformable.decomposeTransform(),{roam:{x:dummyTransformable.x,y:dummyTransformable.y,scaleX:dummyTransformable.scaleX,scaleY:dummyTransformable.scaleY},raw:{x:rawTransformable.x,y:rawTransformable.y,scaleX:rawTransformable.scaleX,scaleY:rawTransformable.scaleY}}},View2.prototype.getViewRect=function(){return this._viewRect},View2.prototype.getViewRectAfterRoam=function(){var rect=this.getBoundingRect().clone();return rect.applyTransform(this.transform),rect},View2.prototype.dataToPoint=function(data,noRoam,out2){var transform=noRoam?this._rawTransform:this.transform;return out2=out2||[],transform?v2ApplyTransform(out2,data,transform):copy$1(out2,data)},View2.prototype.pointToData=function(point){var invTransform=this.invTransform;return invTransform?v2ApplyTransform([],point,invTransform):[point[0],point[1]]},View2.prototype.convertToPixel=function(ecModel,finder,value){var coordSys=getCoordSys$3(finder);return coordSys===this?coordSys.dataToPoint(value):null},View2.prototype.convertFromPixel=function(ecModel,finder,pixel){var coordSys=getCoordSys$3(finder);return coordSys===this?coordSys.pointToData(pixel):null},View2.prototype.containPoint=function(point){return this.getViewRectAfterRoam().contain(point[0],point[1])},View2.dimensions=["x","y"],View2}(Transformable);function getCoordSys$3(finder){var seriesModel=finder.seriesModel;return seriesModel?seriesModel.coordinateSystem:null}var GEO_DEFAULT_PARAMS={geoJSON:{aspectScale:.75,invertLongitute:!0},geoSVG:{aspectScale:1,invertLongitute:!1}},geo2DDimensions=["lng","lat"],Geo=function(_super){function Geo2(name,map2,opt){var _this=_super.call(this,name)||this;_this.dimensions=geo2DDimensions,_this.type="geo",_this._nameCoordMap=createHashMap(),_this.map=map2;var projection=opt.projection,source=geoSourceManager_load(map2,opt.nameMap,opt.nameProperty),resource=geoSourceManager_getGeoResource(map2);_this.resourceType=resource?resource.type:null;var boundingRect,regions=_this.regions=source.regions,defaultParams=GEO_DEFAULT_PARAMS[resource.type];if(_this._regionsMap=source.regionsMap,_this.regions=source.regions,_this.projection=projection,projection)for(var i=0;i<regions.length;i++){var regionRect=regions[i].getBoundingRect(projection);(boundingRect=boundingRect||regionRect.clone()).union(regionRect)}else boundingRect=source.boundingRect;return _this.setBoundingRect(boundingRect.x,boundingRect.y,boundingRect.width,boundingRect.height),_this.aspectScale=projection?1:retrieve2(opt.aspectScale,defaultParams.aspectScale),_this._invertLongitute=!projection&&defaultParams.invertLongitute,_this}return __extends(Geo2,_super),Geo2.prototype._transformTo=function(x,y,width,height){var rect=this.getBoundingRect(),invertLongitute=this._invertLongitute;rect=rect.clone(),invertLongitute&&(rect.y=-rect.y-rect.height);var rawTransformable=this._rawTransformable;rawTransformable.transform=rect.calculateTransform(new BoundingRect(x,y,width,height));var rawParent=rawTransformable.parent;rawTransformable.parent=null,rawTransformable.decomposeTransform(),rawTransformable.parent=rawParent,invertLongitute&&(rawTransformable.scaleY=-rawTransformable.scaleY),this._updateTransform()},Geo2.prototype.getRegion=function(name){return this._regionsMap.get(name)},Geo2.prototype.getRegionByCoord=function(coord){for(var regions=this.regions,i=0;i<regions.length;i++){var region=regions[i];if("geoJSON"===region.type&&region.contain(coord))return regions[i]}},Geo2.prototype.addGeoCoord=function(name,geoCoord2){this._nameCoordMap.set(name,geoCoord2)},Geo2.prototype.getGeoCoord=function(name){var region=this._regionsMap.get(name);return this._nameCoordMap.get(name)||region&&region.getCenter()},Geo2.prototype.dataToPoint=function(data,noRoam,out2){if(isString(data)&&(data=this.getGeoCoord(data)),data){var projection=this.projection;return projection&&(data=projection.project(data)),data&&this.projectedToPoint(data,noRoam,out2)}},Geo2.prototype.pointToData=function(point){var projection=this.projection;return projection&&(point=projection.unproject(point)),point&&this.pointToProjected(point)},Geo2.prototype.pointToProjected=function(point){return _super.prototype.pointToData.call(this,point)},Geo2.prototype.projectedToPoint=function(projected,noRoam,out2){return _super.prototype.dataToPoint.call(this,projected,noRoam,out2)},Geo2.prototype.convertToPixel=function(ecModel,finder,value){var coordSys=getCoordSys$2(finder);return coordSys===this?coordSys.dataToPoint(value):null},Geo2.prototype.convertFromPixel=function(ecModel,finder,pixel){var coordSys=getCoordSys$2(finder);return coordSys===this?coordSys.pointToData(pixel):null},Geo2}(View);function getCoordSys$2(finder){var geoModel=finder.geoModel,seriesModel=finder.seriesModel;return geoModel?geoModel.coordinateSystem:seriesModel?seriesModel.coordinateSystem||(seriesModel.getReferringComponents("geo",SINGLE_REFERRING).models[0]||{}).coordinateSystem:null}function resizeGeo(geoModel,api){var boundingCoords=geoModel.get("boundingCoords");if(null!=boundingCoords){var leftTop_1=boundingCoords[0],rightBottom_1=boundingCoords[1];if(isFinite(leftTop_1[0])&&isFinite(leftTop_1[1])&&isFinite(rightBottom_1[0])&&isFinite(rightBottom_1[1])){var projection_1=this.projection;if(projection_1){var xMin=leftTop_1[0],yMin=leftTop_1[1],xMax=rightBottom_1[0],yMax=rightBottom_1[1];leftTop_1=[Infinity,Infinity],rightBottom_1=[-Infinity,-Infinity];var sampleLine=function(x0,y0,x1,y1){for(var dx=x1-x0,dy=y1-y0,i=0;i<=100;i++){var p=i/100,pt=projection_1.project([x0+dx*p,y0+dy*p]);min$1(leftTop_1,leftTop_1,pt),max$1(rightBottom_1,rightBottom_1,pt)}};sampleLine(xMin,yMin,xMax,yMin),sampleLine(xMax,yMin,xMax,yMax),sampleLine(xMax,yMax,xMin,yMax),sampleLine(xMin,yMax,xMax,yMin)}this.setBoundingRect(leftTop_1[0],leftTop_1[1],rightBottom_1[0]-leftTop_1[0],rightBottom_1[1]-leftTop_1[1])}else;}var center2,size,viewRect2,rect=this.getBoundingRect(),centerOption=geoModel.get("layoutCenter"),sizeOption=geoModel.get("layoutSize"),viewWidth=api.getWidth(),viewHeight=api.getHeight(),aspect=rect.width/rect.height*this.aspectScale,useCenterAndSize=!1;if(centerOption&&sizeOption&&(center2=[parsePercent(centerOption[0],viewWidth),parsePercent(centerOption[1],viewHeight)],size=parsePercent(sizeOption,Math.min(viewWidth,viewHeight)),isNaN(center2[0])||isNaN(center2[1])||isNaN(size)||(useCenterAndSize=!0)),useCenterAndSize)viewRect2={},aspect>1?(viewRect2.width=size,viewRect2.height=size/aspect):(viewRect2.height=size,viewRect2.width=size*aspect),viewRect2.y=center2[1]-viewRect2.height/2,viewRect2.x=center2[0]-viewRect2.width/2;else{var boxLayoutOption=geoModel.getBoxLayoutParams();boxLayoutOption.aspect=aspect,viewRect2=getLayoutRect(boxLayoutOption,{width:viewWidth,height:viewHeight})}this.setViewRect(viewRect2.x,viewRect2.y,viewRect2.width,viewRect2.height),this.setCenter(geoModel.get("center"),api),this.setZoom(geoModel.get("zoom"))}mixin(Geo,View);var GeoCreator=function(){function GeoCreator2(){this.dimensions=geo2DDimensions}return GeoCreator2.prototype.create=function(ecModel,api){var geoList=[];function getCommonGeoProperties(model){return{nameProperty:model.get("nameProperty"),aspectScale:model.get("aspectScale"),projection:model.get("projection")}}ecModel.eachComponent("geo",(function(geoModel,idx){var mapName=geoModel.get("map"),geo=new Geo(mapName+idx,mapName,extend({nameMap:geoModel.get("nameMap")},getCommonGeoProperties(geoModel)));geo.zoomLimit=geoModel.get("scaleLimit"),geoList.push(geo),geoModel.coordinateSystem=geo,geo.model=geoModel,geo.resize=resizeGeo,geo.resize(geoModel,api)})),ecModel.eachSeries((function(seriesModel){if("geo"===seriesModel.get("coordinateSystem")){var geoIndex=seriesModel.get("geoIndex")||0;seriesModel.coordinateSystem=geoList[geoIndex]}}));var mapModelGroupBySeries={};return ecModel.eachSeriesByType("map",(function(seriesModel){if(!seriesModel.getHostGeoModel()){var mapType=seriesModel.getMapType();mapModelGroupBySeries[mapType]=mapModelGroupBySeries[mapType]||[],mapModelGroupBySeries[mapType].push(seriesModel)}})),each$d(mapModelGroupBySeries,(function(mapSeries,mapType){var nameMapList=map$1(mapSeries,(function(singleMapSeries){return singleMapSeries.get("nameMap")})),geo=new Geo(mapType,mapType,extend({nameMap:mergeAll(nameMapList)},getCommonGeoProperties(mapSeries[0])));geo.zoomLimit=retrieve.apply(null,map$1(mapSeries,(function(singleMapSeries){return singleMapSeries.get("scaleLimit")}))),geoList.push(geo),geo.resize=resizeGeo,geo.resize(mapSeries[0],api),each$d(mapSeries,(function(singleMapSeries){singleMapSeries.coordinateSystem=geo,function(geo,model){each$d(model.get("geoCoord"),(function(geoCoord2,name){geo.addGeoCoord(name,geoCoord2)}))}(geo,singleMapSeries)}))})),geoList},GeoCreator2.prototype.getFilledRegions=function(originRegionArr,mapName,nameMap,nameProperty){for(var regionsArr=(originRegionArr||[]).slice(),dataNameMap=createHashMap(),i=0;i<regionsArr.length;i++)dataNameMap.set(regionsArr[i].name,regionsArr[i]);return each$d(geoSourceManager_load(mapName,nameMap,nameProperty).regions,(function(region){var name=region.name,regionOption=dataNameMap.get(name),specifiedGeoJSONRegionStyle=region.properties&&region.properties.echartsStyle;regionOption||(regionOption={name:name},regionsArr.push(regionOption)),specifiedGeoJSONRegionStyle&&merge(regionOption,specifiedGeoJSONRegionStyle)})),regionsArr},GeoCreator2}(),geoCreator=new GeoCreator,GeoModel=function(_super){function GeoModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=GeoModel2.type,_this}return __extends(GeoModel2,_super),GeoModel2.prototype.init=function(option,parentModel,ecModel){var source=geoSourceManager_getGeoResource(option.map);if(source&&"geoJSON"===source.type){var itemStyle=option.itemStyle=option.itemStyle||{};"color"in itemStyle||(itemStyle.color="#eee")}this.mergeDefaultAndTheme(option,ecModel),defaultEmphasis(option,"label",["show"])},GeoModel2.prototype.optionUpdated=function(){var _this=this,option=this.option;option.regions=geoCreator.getFilledRegions(option.regions,option.map,option.nameMap,option.nameProperty);var selectedMap={};this._optionModelMap=reduce(option.regions||[],(function(optionModelMap,regionOpt){var regionName=regionOpt.name;return regionName&&(optionModelMap.set(regionName,new Model(regionOpt,_this,_this.ecModel)),regionOpt.selected&&(selectedMap[regionName]=!0)),optionModelMap}),createHashMap()),option.selectedMap||(option.selectedMap=selectedMap)},GeoModel2.prototype.getRegionModel=function(name){return this._optionModelMap.get(name)||new Model(null,this,this.ecModel)},GeoModel2.prototype.getFormattedLabel=function(name,status){var regionModel=this.getRegionModel(name),formatter="normal"===status?regionModel.get(["label","formatter"]):regionModel.get(["emphasis","label","formatter"]),params={name:name};return isFunction(formatter)?(params.status=status,formatter(params)):isString(formatter)?formatter.replace("{a}",null!=name?name:""):void 0},GeoModel2.prototype.setZoom=function(zoom){this.option.zoom=zoom},GeoModel2.prototype.setCenter=function(center2){this.option.center=center2},GeoModel2.prototype.select=function(name){var option=this.option,selectedMode=option.selectedMode;selectedMode&&("multiple"!==selectedMode&&(option.selectedMap=null),(option.selectedMap||(option.selectedMap={}))[name]=!0)},GeoModel2.prototype.unSelect=function(name){var selectedMap=this.option.selectedMap;selectedMap&&(selectedMap[name]=!1)},GeoModel2.prototype.toggleSelected=function(name){this[this.isSelected(name)?"unSelect":"select"](name)},GeoModel2.prototype.isSelected=function(name){var selectedMap=this.option.selectedMap;return!(!selectedMap||!selectedMap[name])},GeoModel2.type="geo",GeoModel2.layoutMode="box",GeoModel2.defaultOption={z:0,show:!0,left:"center",top:"center",aspectScale:null,silent:!1,map:"",boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},regions:[]},GeoModel2}(ComponentModel);function getCenterCoord(view,point){return view.pointToProjected?view.pointToProjected(point):view.pointToData(point)}var GeoView=function(_super){function GeoView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=GeoView2.type,_this.focusBlurEnabled=!0,_this}return __extends(GeoView2,_super),GeoView2.prototype.init=function(ecModel,api){this._api=api},GeoView2.prototype.render=function(geoModel,ecModel,api,payload){if(this._model=geoModel,!geoModel.get("show"))return this._mapDraw&&this._mapDraw.remove(),void(this._mapDraw=null);this._mapDraw||(this._mapDraw=new MapDraw(api));var mapDraw=this._mapDraw;mapDraw.draw(geoModel,ecModel,api,this,payload),mapDraw.group.on("click",this._handleRegionClick,this),mapDraw.group.silent=geoModel.get("silent"),this.group.add(mapDraw.group),this.updateSelectStatus(geoModel,ecModel,api)},GeoView2.prototype._handleRegionClick=function(e2){var eventData;findEventDispatcher(e2.target,(function(current){return null!=(eventData=getECData(current).eventData)}),!0),eventData&&this._api.dispatchAction({type:"geoToggleSelect",geoId:this._model.id,name:eventData.name})},GeoView2.prototype.updateSelectStatus=function(model,ecModel,api){var _this=this;this._mapDraw.group.traverse((function(node){var eventData=getECData(node).eventData;if(eventData)return _this._model.isSelected(eventData.name)?api.enterSelect(node):api.leaveSelect(node),!0}))},GeoView2.prototype.findHighDownDispatchers=function(name){return this._mapDraw&&this._mapDraw.findHighDownDispatchers(name,this._model)},GeoView2.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove()},GeoView2.type="geo",GeoView2}(ComponentView);function registerMap(mapName,geoJson,specialAreas){geoSourceManager_registerMap(mapName,geoJson,specialAreas)}function install$o(registers){function makeAction(method,actionInfo2){actionInfo2.update="geo:updateSelectStatus",registers.registerAction(actionInfo2,(function(payload,ecModel){var selected={},allSelected=[];return ecModel.eachComponent({mainType:"geo",query:payload},(function(geoModel){geoModel[method](payload.name),each$d(geoModel.coordinateSystem.regions,(function(region){selected[region.name]=geoModel.isSelected(region.name)||!1}));var names=[];each$d(selected,(function(v,name){selected[name]&&names.push(name)})),allSelected.push({geoIndex:geoModel.componentIndex,name:names})})),{selected:selected,allSelected:allSelected,name:payload.name}}))}registers.registerCoordinateSystem("geo",geoCreator),registers.registerComponentModel(GeoModel),registers.registerComponentView(GeoView),registers.registerImpl("registerMap",registerMap),registers.registerImpl("getMap",(function(mapName){return geoSourceManager_getMapForUser(mapName)})),makeAction("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),makeAction("select",{type:"geoSelect",event:"geoselected"}),makeAction("unSelect",{type:"geoUnSelect",event:"geounselected"}),registers.registerAction({type:"geoRoam",event:"geoRoam",update:"updateTransform"},(function(payload,ecModel,api){var componentType=payload.componentType||"series";ecModel.eachComponent({mainType:componentType,query:payload},(function(componentModel){var geo=componentModel.coordinateSystem;if("geo"===geo.type){var res=function(view,payload,zoomLimit,api){var previousZoom=view.getZoom(),center2=view.getCenter(),zoom=payload.zoom,point=view.projectedToPoint?view.projectedToPoint(center2):view.dataToPoint(center2);if(null!=payload.dx&&null!=payload.dy&&(point[0]-=payload.dx,point[1]-=payload.dy,view.setCenter(getCenterCoord(view,point),api)),null!=zoom){if(zoomLimit){var zoomMin=zoomLimit.min||0,zoomMax=zoomLimit.max||Infinity;zoom=Math.max(Math.min(previousZoom*zoom,zoomMax),zoomMin)/previousZoom}view.scaleX*=zoom,view.scaleY*=zoom;var fixX=(payload.originX-view.x)*(zoom-1),fixY=(payload.originY-view.y)*(zoom-1);view.x-=fixX,view.y-=fixY,view.updateTransform(),view.setCenter(getCenterCoord(view,point),api),view.setZoom(zoom*previousZoom)}return{center:view.getCenter(),zoom:view.getZoom()}}(geo,payload,componentModel.get("scaleLimit"),api);componentModel.setCenter&&componentModel.setCenter(res.center),componentModel.setZoom&&componentModel.setZoom(res.zoom),"series"===componentType&&each$d(componentModel.seriesGroup,(function(seriesModel){seriesModel.setCenter(res.center),seriesModel.setZoom(res.zoom)}))}}))}))}var each$a=each$d,isObject=isObject$3,VisualMapping=function(){function VisualMapping2(option){var mappingMethod=option.mappingMethod,visualType=option.type,thisOption=this.option=clone$3(option);this.type=visualType,this.mappingMethod=mappingMethod,this._normalizeData=normalizers[mappingMethod];var visualHandler=VisualMapping2.visualHandlers[visualType];this.applyVisual=visualHandler.applyVisual,this.getColorMapper=visualHandler.getColorMapper,this._normalizedToVisual=visualHandler._normalizedToVisual[mappingMethod],"piecewise"===mappingMethod?(normalizeVisualRange(thisOption),function(thisOption){var pieceList=thisOption.pieceList;thisOption.hasSpecialVisual=!1,each$d(pieceList,(function(piece,index){piece.originIndex=index,null!=piece.visual&&(thisOption.hasSpecialVisual=!0)}))}(thisOption)):"category"===mappingMethod?thisOption.categories?function(thisOption){var categories=thisOption.categories,categoryMap=thisOption.categoryMap={},visual=thisOption.visual;if(each$a(categories,(function(cate,index){categoryMap[cate]=index})),!isArray$1(visual)){var visualArr_1=[];isObject$3(visual)?each$a(visual,(function(v,cate){var index=categoryMap[cate];visualArr_1[null!=index?index:-1]=v})):visualArr_1[-1]=visual,visual=setVisualToOption(thisOption,visualArr_1)}for(var i=categories.length-1;i>=0;i--)null==visual[i]&&(delete categoryMap[categories[i]],categories.pop())}(thisOption):normalizeVisualRange(thisOption,!0):(assert("linear"!==mappingMethod||thisOption.dataExtent),normalizeVisualRange(thisOption))}return VisualMapping2.prototype.mapValueToVisual=function(value){var normalized=this._normalizeData(value);return this._normalizedToVisual(normalized,value)},VisualMapping2.prototype.getNormalizer=function(){return bind$1(this._normalizeData,this)},VisualMapping2.listVisualTypes=function(){return keys(VisualMapping2.visualHandlers)},VisualMapping2.isValidType=function(visualType){return VisualMapping2.visualHandlers.hasOwnProperty(visualType)},VisualMapping2.eachVisual=function(visual,callback,context){isObject$3(visual)?each$d(visual,callback,context):callback.call(context,visual)},VisualMapping2.mapVisual=function(visual,callback,context){var isPrimary,newVisual=isArray$1(visual)?[]:isObject$3(visual)?{}:(isPrimary=!0,null);return VisualMapping2.eachVisual(visual,(function(v,key){var newVal=callback.call(context,v,key);isPrimary?newVisual=newVal:newVisual[key]=newVal})),newVisual},VisualMapping2.retrieveVisuals=function(obj){var hasVisual,ret={};return obj&&each$a(VisualMapping2.visualHandlers,(function(h,visualType){obj.hasOwnProperty(visualType)&&(ret[visualType]=obj[visualType],hasVisual=!0)})),hasVisual?ret:null},VisualMapping2.prepareVisualTypes=function(visualTypes){if(isArray$1(visualTypes))visualTypes=visualTypes.slice();else{if(!isObject(visualTypes))return[];var types_1=[];each$a(visualTypes,(function(item,type){types_1.push(type)})),visualTypes=types_1}return visualTypes.sort((function(type1,type2){return"color"===type2&&"color"!==type1&&0===type1.indexOf("color")?1:-1})),visualTypes},VisualMapping2.dependsOn=function(visualType1,visualType2){return"color"===visualType2?!(!visualType1||0!==visualType1.indexOf(visualType2)):visualType1===visualType2},VisualMapping2.findPieceIndex=function(value,pieceList,findClosestWhenOutside){for(var possibleI,abs2=Infinity,i=0,len2=pieceList.length;i<len2;i++){var pieceValue=pieceList[i].value;if(null!=pieceValue){if(pieceValue===value||isString(pieceValue)&&pieceValue===value+"")return i;findClosestWhenOutside&&updatePossible(pieceValue,i)}}for(i=0,len2=pieceList.length;i<len2;i++){var piece=pieceList[i],interval=piece.interval,close_1=piece.close;if(interval){if(-Infinity===interval[0]){if(littleThan(close_1[1],value,interval[1]))return i}else if(Infinity===interval[1]){if(littleThan(close_1[0],interval[0],value))return i}else if(littleThan(close_1[0],interval[0],value)&&littleThan(close_1[1],value,interval[1]))return i;findClosestWhenOutside&&updatePossible(interval[0],i),findClosestWhenOutside&&updatePossible(interval[1],i)}}if(findClosestWhenOutside)return Infinity===value?pieceList.length-1:-Infinity===value?0:possibleI;function updatePossible(val,index){var newAbs=Math.abs(val-value);newAbs<abs2&&(abs2=newAbs,possibleI=index)}},VisualMapping2.visualHandlers={color:{applyVisual:makeApplyVisual("color"),getColorMapper:function(){var thisOption=this.option;return bind$1("category"===thisOption.mappingMethod?function(value,isNormalized){return!isNormalized&&(value=this._normalizeData(value)),doMapCategory.call(this,value)}:function(value,isNormalized,out2){var returnRGBArray=!!out2;return!isNormalized&&(value=this._normalizeData(value)),out2=fastLerp(value,thisOption.parsedVisual,out2),returnRGBArray?out2:stringify(out2,"rgba")},this)},_normalizedToVisual:{linear:function(normalized){return stringify(fastLerp(normalized,this.option.parsedVisual),"rgba")},category:doMapCategory,piecewise:function(normalized,value){var result=getSpecifiedVisual.call(this,value);return null==result&&(result=stringify(fastLerp(normalized,this.option.parsedVisual),"rgba")),result},fixed:doMapFixed}},colorHue:makePartialColorVisualHandler((function(color$1,value){return modifyHSL(color$1,value)})),colorSaturation:makePartialColorVisualHandler((function(color$1,value){return modifyHSL(color$1,null,value)})),colorLightness:makePartialColorVisualHandler((function(color$1,value){return modifyHSL(color$1,null,null,value)})),colorAlpha:makePartialColorVisualHandler((function(color$1,value){return modifyAlpha(color$1,value)})),decal:{applyVisual:makeApplyVisual("decal"),_normalizedToVisual:{linear:null,category:doMapCategory,piecewise:null,fixed:null}},opacity:{applyVisual:makeApplyVisual("opacity"),_normalizedToVisual:createNormalizedToNumericVisual([0,1])},liftZ:{applyVisual:makeApplyVisual("liftZ"),_normalizedToVisual:{linear:doMapFixed,category:doMapFixed,piecewise:doMapFixed,fixed:doMapFixed}},symbol:{applyVisual:function(value,getter,setter){setter("symbol",this.mapValueToVisual(value))},_normalizedToVisual:{linear:doMapToArray,category:doMapCategory,piecewise:function(normalized,value){var result=getSpecifiedVisual.call(this,value);return null==result&&(result=doMapToArray.call(this,normalized)),result},fixed:doMapFixed}},symbolSize:{applyVisual:makeApplyVisual("symbolSize"),_normalizedToVisual:createNormalizedToNumericVisual([0,1])}},VisualMapping2}();function normalizeVisualRange(thisOption,isCategory2){var visual=thisOption.visual,visualArr=[];isObject$3(visual)?each$a(visual,(function(v){visualArr.push(v)})):null!=visual&&visualArr.push(visual);isCategory2||1!==visualArr.length||{color:1,symbol:1}.hasOwnProperty(thisOption.type)||(visualArr[1]=visualArr[0]),setVisualToOption(thisOption,visualArr)}function makePartialColorVisualHandler(applyValue){return{applyVisual:function(value,getter,setter){var colorChannel=this.mapValueToVisual(value);setter("color",applyValue(getter("color"),colorChannel))},_normalizedToVisual:createNormalizedToNumericVisual([0,1])}}function doMapToArray(normalized){var visual=this.option.visual;return visual[Math.round(linearMap$2(normalized,[0,1],[0,visual.length-1],!0))]||{}}function makeApplyVisual(visualType){return function(value,getter,setter){setter(visualType,this.mapValueToVisual(value))}}function doMapCategory(normalized){var visual=this.option.visual;return visual[this.option.loop&&-1!==normalized?normalized%visual.length:normalized]}function doMapFixed(){return this.option.visual[0]}function createNormalizedToNumericVisual(sourceExtent){return{linear:function(normalized){return linearMap$2(normalized,sourceExtent,this.option.visual,!0)},category:doMapCategory,piecewise:function(normalized,value){var result=getSpecifiedVisual.call(this,value);return null==result&&(result=linearMap$2(normalized,sourceExtent,this.option.visual,!0)),result},fixed:doMapFixed}}function getSpecifiedVisual(value){var thisOption=this.option,pieceList=thisOption.pieceList;if(thisOption.hasSpecialVisual){var piece=pieceList[VisualMapping.findPieceIndex(value,pieceList)];if(piece&&piece.visual)return piece.visual[this.type]}}function setVisualToOption(thisOption,visualArr){return thisOption.visual=visualArr,"color"===thisOption.type&&(thisOption.parsedVisual=map$1(visualArr,(function(item){return parse(item)||[0,0,0,1]}))),visualArr}var normalizers={linear:function(value){return linearMap$2(value,this.option.dataExtent,[0,1],!0)},piecewise:function(value){var pieceList=this.option.pieceList,pieceIndex=VisualMapping.findPieceIndex(value,pieceList,!0);if(null!=pieceIndex)return linearMap$2(pieceIndex,[0,pieceList.length-1],[0,1],!0)},category:function(value){var index=this.option.categories?this.option.categoryMap[value]:value;return null==index?-1:index},fixed:noop};function littleThan(close,a,b){return close?a<=b:a<b}function parallelPreprocessor(option){!function(option){if(option.parallel)return;var hasParallelSeries=!1;each$d(option.series,(function(seriesOpt){seriesOpt&&"parallel"===seriesOpt.type&&(hasParallelSeries=!0)})),hasParallelSeries&&(option.parallel=[{}])}(option),function(option){var axes=normalizeToArray(option.parallelAxis);each$d(axes,(function(axisOption){if(isObject$3(axisOption)){var parallelIndex=axisOption.parallelIndex||0,parallelOption=normalizeToArray(option.parallel)[parallelIndex];parallelOption&&parallelOption.parallelAxisDefault&&merge(axisOption,parallelOption.parallelAxisDefault,!1)}}))}(option)}var ParallelView=function(_super){function ParallelView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=ParallelView2.type,_this}return __extends(ParallelView2,_super),ParallelView2.prototype.render=function(parallelModel,ecModel,api){this._model=parallelModel,this._api=api,this._handlers||(this._handlers={},each$d(handlers$1,(function(handler,eventName){api.getZr().on(eventName,this._handlers[eventName]=bind$1(handler,this))}),this)),createOrUpdate(this,"_throttledDispatchExpand",parallelModel.get("axisExpandRate"),"fixRate")},ParallelView2.prototype.dispose=function(ecModel,api){clear$1(this,"_throttledDispatchExpand"),each$d(this._handlers,(function(handler,eventName){api.getZr().off(eventName,handler)})),this._handlers=null},ParallelView2.prototype._throttledDispatchExpand=function(opt){this._dispatchExpand(opt)},ParallelView2.prototype._dispatchExpand=function(opt){opt&&this._api.dispatchAction(extend({type:"parallelAxisExpand"},opt))},ParallelView2.type="parallel",ParallelView2}(ComponentView),handlers$1={mousedown:function(e2){checkTrigger(this,"click")&&(this._mouseDownPoint=[e2.offsetX,e2.offsetY])},mouseup:function(e2){var mouseDownPoint=this._mouseDownPoint;if(checkTrigger(this,"click")&&mouseDownPoint){var point=[e2.offsetX,e2.offsetY];if(Math.pow(mouseDownPoint[0]-point[0],2)+Math.pow(mouseDownPoint[1]-point[1],2)>5)return;var result=this._model.coordinateSystem.getSlidedAxisExpandWindow([e2.offsetX,e2.offsetY]);"none"!==result.behavior&&this._dispatchExpand({axisExpandWindow:result.axisExpandWindow})}this._mouseDownPoint=null},mousemove:function(e2){if(!this._mouseDownPoint&&checkTrigger(this,"mousemove")){var model=this._model,result=model.coordinateSystem.getSlidedAxisExpandWindow([e2.offsetX,e2.offsetY]),behavior=result.behavior;"jump"===behavior&&this._throttledDispatchExpand.debounceNextCall(model.get("axisExpandDebounce")),this._throttledDispatchExpand("none"===behavior?null:{axisExpandWindow:result.axisExpandWindow,animation:"jump"===behavior?null:{duration:0}})}}};function checkTrigger(view,triggerOn){var model=view._model;return model.get("axisExpandable")&&model.get("axisExpandTriggerOn")===triggerOn}var ParallelModel=function(_super){function ParallelModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=ParallelModel2.type,_this}return __extends(ParallelModel2,_super),ParallelModel2.prototype.init=function(){_super.prototype.init.apply(this,arguments),this.mergeOption({})},ParallelModel2.prototype.mergeOption=function(newOption){var thisOption=this.option;newOption&&merge(thisOption,newOption,!0),this._initDimensions()},ParallelModel2.prototype.contains=function(model,ecModel){var parallelIndex=model.get("parallelIndex");return null!=parallelIndex&&ecModel.getComponent("parallel",parallelIndex)===this},ParallelModel2.prototype.setAxisExpand=function(opt){each$d(["axisExpandable","axisExpandCenter","axisExpandCount","axisExpandWidth","axisExpandWindow"],(function(name){opt.hasOwnProperty(name)&&(this.option[name]=opt[name])}),this)},ParallelModel2.prototype._initDimensions=function(){var dimensions=this.dimensions=[],parallelAxisIndex=this.parallelAxisIndex=[];each$d(filter(this.ecModel.queryComponents({mainType:"parallelAxis"}),(function(axisModel){return(axisModel.get("parallelIndex")||0)===this.componentIndex}),this),(function(axisModel){dimensions.push("dim"+axisModel.get("dim")),parallelAxisIndex.push(axisModel.componentIndex)}))},ParallelModel2.type="parallel",ParallelModel2.dependencies=["parallelAxis"],ParallelModel2.layoutMode="box",ParallelModel2.defaultOption={z:0,left:80,top:60,right:80,bottom:60,layout:"horizontal",axisExpandable:!1,axisExpandCenter:null,axisExpandCount:0,axisExpandWidth:50,axisExpandRate:17,axisExpandDebounce:50,axisExpandSlideTriggerArea:[-.15,.05,.4],axisExpandTriggerOn:"click",parallelAxisDefault:null},ParallelModel2}(ComponentModel),ParallelAxis=function(_super){function ParallelAxis2(dim,scale2,coordExtent,axisType,axisIndex){var _this=_super.call(this,dim,scale2,coordExtent)||this;return _this.type=axisType||"value",_this.axisIndex=axisIndex,_this}return __extends(ParallelAxis2,_super),ParallelAxis2.prototype.isHorizontal=function(){return"horizontal"!==this.coordinateSystem.getModel().get("layout")},ParallelAxis2}(Axis);function sliderMove(delta,handleEnds,extent3,handleIndex,minSpan,maxSpan){delta=delta||0;var extentSpan=extent3[1]-extent3[0];if(null!=minSpan&&(minSpan=restrict$1(minSpan,[0,extentSpan])),null!=maxSpan&&(maxSpan=Math.max(maxSpan,null!=minSpan?minSpan:0)),"all"===handleIndex){var handleSpan=Math.abs(handleEnds[1]-handleEnds[0]);handleSpan=restrict$1(handleSpan,[0,extentSpan]),minSpan=maxSpan=restrict$1(handleSpan,[minSpan,maxSpan]),handleIndex=0}handleEnds[0]=restrict$1(handleEnds[0],extent3),handleEnds[1]=restrict$1(handleEnds[1],extent3);var originalDistSign=getSpanSign(handleEnds,handleIndex);handleEnds[handleIndex]+=delta;var currDistSign,extentMinSpan=minSpan||0,realExtent=extent3.slice();return originalDistSign.sign<0?realExtent[0]+=extentMinSpan:realExtent[1]-=extentMinSpan,handleEnds[handleIndex]=restrict$1(handleEnds[handleIndex],realExtent),currDistSign=getSpanSign(handleEnds,handleIndex),null!=minSpan&&(currDistSign.sign!==originalDistSign.sign||currDistSign.span<minSpan)&&(handleEnds[1-handleIndex]=handleEnds[handleIndex]+originalDistSign.sign*minSpan),currDistSign=getSpanSign(handleEnds,handleIndex),null!=maxSpan&&currDistSign.span>maxSpan&&(handleEnds[1-handleIndex]=handleEnds[handleIndex]+currDistSign.sign*maxSpan),handleEnds}function getSpanSign(handleEnds,handleIndex){var dist2=handleEnds[handleIndex]-handleEnds[1-handleIndex];return{span:Math.abs(dist2),sign:dist2>0?-1:dist2<0?1:handleIndex?-1:1}}function restrict$1(value,extend2){return Math.min(null!=extend2[1]?extend2[1]:Infinity,Math.max(null!=extend2[0]?extend2[0]:-Infinity,value))}var each$9=each$d,mathMin$2=Math.min,mathMax$2=Math.max,mathFloor=Math.floor,mathCeil=Math.ceil,round$1=round$3,PI$2=Math.PI,Parallel=function(){function Parallel2(parallelModel,ecModel,api){this.type="parallel",this._axesMap=createHashMap(),this._axesLayout={},this.dimensions=parallelModel.dimensions,this._model=parallelModel,this._init(parallelModel,ecModel,api)}return Parallel2.prototype._init=function(parallelModel,ecModel,api){var dimensions=parallelModel.dimensions,parallelAxisIndex=parallelModel.parallelAxisIndex;each$9(dimensions,(function(dim,idx){var axisIndex=parallelAxisIndex[idx],axisModel=ecModel.getComponent("parallelAxis",axisIndex),axis=this._axesMap.set(dim,new ParallelAxis(dim,createScaleByModel$1(axisModel),[0,0],axisModel.get("type"),axisIndex)),isCategory2="category"===axis.type;axis.onBand=isCategory2&&axisModel.get("boundaryGap"),axis.inverse=axisModel.get("inverse"),axisModel.axis=axis,axis.model=axisModel,axis.coordinateSystem=axisModel.coordinateSystem=this}),this)},Parallel2.prototype.update=function(ecModel,api){this._updateAxesFromSeries(this._model,ecModel)},Parallel2.prototype.containPoint=function(point){var layoutInfo=this._makeLayoutInfo(),axisBase=layoutInfo.axisBase,layoutBase=layoutInfo.layoutBase,pixelDimIndex=layoutInfo.pixelDimIndex,pAxis=point[1-pixelDimIndex],pLayout=point[pixelDimIndex];return pAxis>=axisBase&&pAxis<=axisBase+layoutInfo.axisLength&&pLayout>=layoutBase&&pLayout<=layoutBase+layoutInfo.layoutLength},Parallel2.prototype.getModel=function(){return this._model},Parallel2.prototype._updateAxesFromSeries=function(parallelModel,ecModel){ecModel.eachSeries((function(seriesModel){if(parallelModel.contains(seriesModel,ecModel)){var data=seriesModel.getData();each$9(this.dimensions,(function(dim){var axis=this._axesMap.get(dim);axis.scale.unionExtentFromData(data,data.mapDimension(dim)),niceScaleExtent(axis.scale,axis.model)}),this)}}),this)},Parallel2.prototype.resize=function(parallelModel,api){this._rect=getLayoutRect(parallelModel.getBoxLayoutParams(),{width:api.getWidth(),height:api.getHeight()}),this._layoutAxes()},Parallel2.prototype.getRect=function(){return this._rect},Parallel2.prototype._makeLayoutInfo=function(){var winSize,parallelModel=this._model,rect=this._rect,xy=["x","y"],wh=["width","height"],layout2=parallelModel.get("layout"),pixelDimIndex="horizontal"===layout2?0:1,layoutLength=rect[wh[pixelDimIndex]],layoutExtent=[0,layoutLength],axisCount=this.dimensions.length,axisExpandWidth=restrict(parallelModel.get("axisExpandWidth"),layoutExtent),axisExpandCount=restrict(parallelModel.get("axisExpandCount")||0,[0,axisCount]),axisExpandable=parallelModel.get("axisExpandable")&&axisCount>3&&axisCount>axisExpandCount&&axisExpandCount>1&&axisExpandWidth>0&&layoutLength>0,axisExpandWindow=parallelModel.get("axisExpandWindow");axisExpandWindow?(winSize=restrict(axisExpandWindow[1]-axisExpandWindow[0],layoutExtent),axisExpandWindow[1]=axisExpandWindow[0]+winSize):(winSize=restrict(axisExpandWidth*(axisExpandCount-1),layoutExtent),(axisExpandWindow=[axisExpandWidth*(parallelModel.get("axisExpandCenter")||mathFloor(axisCount/2))-winSize/2])[1]=axisExpandWindow[0]+winSize);var axisCollapseWidth=(layoutLength-winSize)/(axisCount-axisExpandCount);axisCollapseWidth<3&&(axisCollapseWidth=0);var winInnerIndices=[mathFloor(round$1(axisExpandWindow[0]/axisExpandWidth,1))+1,mathCeil(round$1(axisExpandWindow[1]/axisExpandWidth,1))-1],axisExpandWindow0Pos=axisCollapseWidth/axisExpandWidth*axisExpandWindow[0];return{layout:layout2,pixelDimIndex:pixelDimIndex,layoutBase:rect[xy[pixelDimIndex]],layoutLength:layoutLength,axisBase:rect[xy[1-pixelDimIndex]],axisLength:rect[wh[1-pixelDimIndex]],axisExpandable:axisExpandable,axisExpandWidth:axisExpandWidth,axisCollapseWidth:axisCollapseWidth,axisExpandWindow:axisExpandWindow,axisCount:axisCount,winInnerIndices:winInnerIndices,axisExpandWindow0Pos:axisExpandWindow0Pos}},Parallel2.prototype._layoutAxes=function(){var rect=this._rect,axes=this._axesMap,dimensions=this.dimensions,layoutInfo=this._makeLayoutInfo(),layout2=layoutInfo.layout;axes.each((function(axis){var axisExtent=[0,layoutInfo.axisLength],idx=axis.inverse?1:0;axis.setExtent(axisExtent[idx],axisExtent[1-idx])})),each$9(dimensions,(function(dim,idx){var posInfo=(layoutInfo.axisExpandable?layoutAxisWithExpand:layoutAxisWithoutExpand)(idx,layoutInfo),positionTable={horizontal:{x:posInfo.position,y:layoutInfo.axisLength},vertical:{x:0,y:posInfo.position}},rotationTable={horizontal:PI$2/2,vertical:0},position=[positionTable[layout2].x+rect.x,positionTable[layout2].y+rect.y],rotation=rotationTable[layout2],transform=[1,0,0,1,0,0];rotate(transform,transform,rotation),translate(transform,transform,position),this._axesLayout[dim]={position:position,rotation:rotation,transform:transform,axisNameAvailableWidth:posInfo.axisNameAvailableWidth,axisLabelShow:posInfo.axisLabelShow,nameTruncateMaxWidth:posInfo.nameTruncateMaxWidth,tickDirection:1,labelDirection:1}}),this)},Parallel2.prototype.getAxis=function(dim){return this._axesMap.get(dim)},Parallel2.prototype.dataToPoint=function(value,dim){return this.axisCoordToPoint(this._axesMap.get(dim).dataToCoord(value),dim)},Parallel2.prototype.eachActiveState=function(data,callback,start2,end2){null==start2&&(start2=0),null==end2&&(end2=data.count());var axesMap=this._axesMap,dimensions=this.dimensions,dataDimensions=[],axisModels=[];each$d(dimensions,(function(axisDim){dataDimensions.push(data.mapDimension(axisDim)),axisModels.push(axesMap.get(axisDim).model)}));for(var hasActiveSet=this.hasAxisBrushed(),dataIndex=start2;dataIndex<end2;dataIndex++){var activeState=void 0;if(hasActiveSet){activeState="active";for(var values=data.getValues(dataDimensions,dataIndex),j=0,lenj=dimensions.length;j<lenj;j++){if("inactive"===axisModels[j].getActiveState(values[j])){activeState="inactive";break}}}else activeState="normal";callback(activeState,dataIndex)}},Parallel2.prototype.hasAxisBrushed=function(){for(var dimensions=this.dimensions,axesMap=this._axesMap,hasActiveSet=!1,j=0,lenj=dimensions.length;j<lenj;j++)"normal"!==axesMap.get(dimensions[j]).model.getActiveState()&&(hasActiveSet=!0);return hasActiveSet},Parallel2.prototype.axisCoordToPoint=function(coord,dim){return applyTransform([coord,0],this._axesLayout[dim].transform)},Parallel2.prototype.getAxisLayout=function(dim){return clone$3(this._axesLayout[dim])},Parallel2.prototype.getSlidedAxisExpandWindow=function(point){var layoutInfo=this._makeLayoutInfo(),pixelDimIndex=layoutInfo.pixelDimIndex,axisExpandWindow=layoutInfo.axisExpandWindow.slice(),winSize=axisExpandWindow[1]-axisExpandWindow[0],extent3=[0,layoutInfo.axisExpandWidth*(layoutInfo.axisCount-1)];if(!this.containPoint(point))return{behavior:"none",axisExpandWindow:axisExpandWindow};var delta,pointCoord=point[pixelDimIndex]-layoutInfo.layoutBase-layoutInfo.axisExpandWindow0Pos,behavior="slide",axisCollapseWidth=layoutInfo.axisCollapseWidth,triggerArea=this._model.get("axisExpandSlideTriggerArea"),useJump=null!=triggerArea[0];if(axisCollapseWidth)useJump&&axisCollapseWidth&&pointCoord<winSize*triggerArea[0]?(behavior="jump",delta=pointCoord-winSize*triggerArea[2]):useJump&&axisCollapseWidth&&pointCoord>winSize*(1-triggerArea[0])?(behavior="jump",delta=pointCoord-winSize*(1-triggerArea[2])):(delta=pointCoord-winSize*triggerArea[1])>=0&&(delta=pointCoord-winSize*(1-triggerArea[1]))<=0&&(delta=0),(delta*=layoutInfo.axisExpandWidth/axisCollapseWidth)?sliderMove(delta,axisExpandWindow,extent3,"all"):behavior="none";else{var winSize2=axisExpandWindow[1]-axisExpandWindow[0];(axisExpandWindow=[mathMax$2(0,extent3[1]*pointCoord/winSize2-winSize2/2)])[1]=mathMin$2(extent3[1],axisExpandWindow[0]+winSize2),axisExpandWindow[0]=axisExpandWindow[1]-winSize2}return{axisExpandWindow:axisExpandWindow,behavior:behavior}},Parallel2}();function restrict(len2,extent3){return mathMin$2(mathMax$2(len2,extent3[0]),extent3[1])}function layoutAxisWithoutExpand(axisIndex,layoutInfo){var step=layoutInfo.layoutLength/(layoutInfo.axisCount-1);return{position:step*axisIndex,axisNameAvailableWidth:step,axisLabelShow:!0}}function layoutAxisWithExpand(axisIndex,layoutInfo){var position,nameTruncateMaxWidth,layoutLength=layoutInfo.layoutLength,axisExpandWidth=layoutInfo.axisExpandWidth,axisCount=layoutInfo.axisCount,axisCollapseWidth=layoutInfo.axisCollapseWidth,winInnerIndices=layoutInfo.winInnerIndices,axisNameAvailableWidth=axisCollapseWidth,axisLabelShow=!1;return axisIndex<winInnerIndices[0]?(position=axisIndex*axisCollapseWidth,nameTruncateMaxWidth=axisCollapseWidth):axisIndex<=winInnerIndices[1]?(position=layoutInfo.axisExpandWindow0Pos+axisIndex*axisExpandWidth-layoutInfo.axisExpandWindow[0],axisNameAvailableWidth=axisExpandWidth,axisLabelShow=!0):(position=layoutLength-(axisCount-1-axisIndex)*axisCollapseWidth,nameTruncateMaxWidth=axisCollapseWidth),{position:position,axisNameAvailableWidth:axisNameAvailableWidth,axisLabelShow:axisLabelShow,nameTruncateMaxWidth:nameTruncateMaxWidth}}var parallelCoordSysCreator={create:function(ecModel,api){var coordSysList=[];return ecModel.eachComponent("parallel",(function(parallelModel,idx){var coordSys=new Parallel(parallelModel,ecModel,api);coordSys.name="parallel_"+idx,coordSys.resize(parallelModel,api),parallelModel.coordinateSystem=coordSys,coordSys.model=parallelModel,coordSysList.push(coordSys)})),ecModel.eachSeries((function(seriesModel){if("parallel"===seriesModel.get("coordinateSystem")){var parallelModel=seriesModel.getReferringComponents("parallel",SINGLE_REFERRING).models[0];seriesModel.coordinateSystem=parallelModel.coordinateSystem}})),coordSysList}},ParallelAxisModel=function(_super){function ParallelAxisModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=ParallelAxisModel2.type,_this.activeIntervals=[],_this}return __extends(ParallelAxisModel2,_super),ParallelAxisModel2.prototype.getAreaSelectStyle=function(){return makeStyleMapper([["fill","color"],["lineWidth","borderWidth"],["stroke","borderColor"],["width","width"],["opacity","opacity"]])(this.getModel("areaSelectStyle"))},ParallelAxisModel2.prototype.setActiveIntervals=function(intervals){var activeIntervals=this.activeIntervals=clone$3(intervals);if(activeIntervals)for(var i=activeIntervals.length-1;i>=0;i--)asc$2(activeIntervals[i])},ParallelAxisModel2.prototype.getActiveState=function(value){var activeIntervals=this.activeIntervals;if(!activeIntervals.length)return"normal";if(null==value||isNaN(+value))return"inactive";if(1===activeIntervals.length){var interval=activeIntervals[0];if(interval[0]<=value&&value<=interval[1])return"active"}else for(var i=0,len2=activeIntervals.length;i<len2;i++)if(activeIntervals[i][0]<=value&&value<=activeIntervals[i][1])return"active";return"inactive"},ParallelAxisModel2}(ComponentModel);mixin(ParallelAxisModel,AxisModelCommonMixin);var mathMin$1=Math.min,mathMax$1=Math.max,mathPow=Math.pow,DIRECTION_MAP={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},CURSOR_MAP={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},DEFAULT_BRUSH_OPT={brushStyle:{lineWidth:2,stroke:"rgba(210,219,238,0.3)",fill:"#D2DBEE"},transformable:!0,brushMode:"single",removeOnClick:!1},baseUID=0,BrushController=function(_super){function BrushController2(zr){var _this=_super.call(this)||this;return _this._track=[],_this._covers=[],_this._handlers={},_this._zr=zr,_this.group=new Group$2,_this._uid="brushController_"+baseUID++,each$d(pointerHandlers,(function(handler,eventName){this._handlers[eventName]=bind$1(handler,this)}),_this),_this}return __extends(BrushController2,_super),BrushController2.prototype.enableBrush=function(brushOption){return this._brushType&&this._doDisableBrush(),brushOption.brushType&&this._doEnableBrush(brushOption),this},BrushController2.prototype._doEnableBrush=function(brushOption){var zr=this._zr;this._enableGlobalPan||function(zr,resourceKey,userKey){getStore(zr)[resourceKey]=userKey}(zr,"globalPan",this._uid),each$d(this._handlers,(function(handler,eventName){zr.on(eventName,handler)})),this._brushType=brushOption.brushType,this._brushOption=merge(clone$3(DEFAULT_BRUSH_OPT),brushOption,!0)},BrushController2.prototype._doDisableBrush=function(){var zr=this._zr;!function(zr,resourceKey,userKey){var store=getStore(zr);store[resourceKey]===userKey&&(store[resourceKey]=null)}(zr,"globalPan",this._uid),each$d(this._handlers,(function(handler,eventName){zr.off(eventName,handler)})),this._brushType=this._brushOption=null},BrushController2.prototype.setPanels=function(panelOpts){if(panelOpts&&panelOpts.length){var panels_1=this._panels={};each$d(panelOpts,(function(panelOpts2){panels_1[panelOpts2.panelId]=clone$3(panelOpts2)}))}else this._panels=null;return this},BrushController2.prototype.mount=function(opt){opt=opt||{},this._enableGlobalPan=opt.enableGlobalPan;var thisGroup=this.group;return this._zr.add(thisGroup),thisGroup.attr({x:opt.x||0,y:opt.y||0,rotation:opt.rotation||0,scaleX:opt.scaleX||1,scaleY:opt.scaleY||1}),this._transform=thisGroup.getLocalTransform(),this},BrushController2.prototype.updateCovers=function(coverConfigList){coverConfigList=map$1(coverConfigList,(function(coverConfig){return merge(clone$3(DEFAULT_BRUSH_OPT),coverConfig,!0)}));var oldCovers=this._covers,newCovers=this._covers=[],controller=this,creatingCover=this._creatingCover;return new DataDiffer(oldCovers,coverConfigList,(function(cover,index){return getKey(cover.__brushOption,index)}),getKey).add(addOrUpdate).update(addOrUpdate).remove((function(oldIndex){oldCovers[oldIndex]!==creatingCover&&controller.group.remove(oldCovers[oldIndex])})).execute(),this;function getKey(brushOption,index){return(null!=brushOption.id?brushOption.id:"\0-brush-index-"+index)+"-"+brushOption.brushType}function addOrUpdate(newIndex,oldIndex){var newBrushInternal=coverConfigList[newIndex];if(null!=oldIndex&&oldCovers[oldIndex]===creatingCover)newCovers[newIndex]=oldCovers[oldIndex];else{var cover=newCovers[newIndex]=null!=oldIndex?(oldCovers[oldIndex].__brushOption=newBrushInternal,oldCovers[oldIndex]):endCreating(controller,createCover(controller,newBrushInternal));updateCoverAfterCreation(controller,cover)}}},BrushController2.prototype.unmount=function(){return this.enableBrush(!1),clearCovers(this),this._zr.remove(this.group),this},BrushController2.prototype.dispose=function(){this.unmount(),this.off()},BrushController2}(Eventful);function createCover(controller,brushOption){var cover=coverRenderers[brushOption.brushType].createCover(controller,brushOption);return cover.__brushOption=brushOption,updateZ(cover,brushOption),controller.group.add(cover),cover}function endCreating(controller,creatingCover){var coverRenderer=getCoverRenderer(creatingCover);return coverRenderer.endCreating&&(coverRenderer.endCreating(controller,creatingCover),updateZ(creatingCover,creatingCover.__brushOption)),creatingCover}function updateCoverShape(controller,cover){var brushOption=cover.__brushOption;getCoverRenderer(cover).updateCoverShape(controller,cover,brushOption.range,brushOption)}function updateZ(cover,brushOption){var z=brushOption.z;null==z&&(z=1e4),cover.traverse((function(el){el.z=z,el.z2=z}))}function updateCoverAfterCreation(controller,cover){getCoverRenderer(cover).updateCommon(controller,cover),updateCoverShape(controller,cover)}function getCoverRenderer(cover){return coverRenderers[cover.__brushOption.brushType]}function getPanelByPoint(controller,e2,localCursorPoint){var panel,panels=controller._panels;if(!panels)return true;var transform=controller._transform;return each$d(panels,(function(pn){pn.isTargetByCursor(e2,localCursorPoint,transform)&&(panel=pn)})),panel}function getPanelByCover(controller,cover){var panels=controller._panels;if(!panels)return true;var panelId=cover.__brushOption.panelId;return null==panelId||panels[panelId]}function clearCovers(controller){var covers=controller._covers,originalLength=covers.length;return each$d(covers,(function(cover){controller.group.remove(cover)}),controller),covers.length=0,!!originalLength}function trigger(controller,opt){var areas=map$1(controller._covers,(function(cover){var brushOption=cover.__brushOption,range=clone$3(brushOption.range);return{brushType:brushOption.brushType,panelId:brushOption.panelId,range:range}}));controller.trigger("brush",{areas:areas,isEnd:!!opt.isEnd,removeOnClick:!!opt.removeOnClick})}function getTrackEnds(track){var tail=track.length-1;return tail<0&&(tail=0),[track[0],track[tail]]}function createBaseRectCover(rectRangeConverter,controller,brushOption,edgeNameSequences){var cover=new Group$2;return cover.add(new Rect$1({name:"main",style:makeStyle(brushOption),silent:!0,draggable:!0,cursor:"move",drift:curry$1(driftRect,rectRangeConverter,controller,cover,["n","s","w","e"]),ondragend:curry$1(trigger,controller,{isEnd:!0})})),each$d(edgeNameSequences,(function(nameSequence){cover.add(new Rect$1({name:nameSequence.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:curry$1(driftRect,rectRangeConverter,controller,cover,nameSequence),ondragend:curry$1(trigger,controller,{isEnd:!0})}))})),cover}function updateBaseRect(controller,cover,localRange,brushOption){var lineWidth=brushOption.brushStyle.lineWidth||0,handleSize=mathMax$1(lineWidth,6),x=localRange[0][0],y=localRange[1][0],xa=x-lineWidth/2,ya=y-lineWidth/2,x2=localRange[0][1],y2=localRange[1][1],x2a=x2-handleSize+lineWidth/2,y2a=y2-handleSize+lineWidth/2,width=x2-x,height=y2-y,widtha=width+lineWidth,heighta=height+lineWidth;updateRectShape(controller,cover,"main",x,y,width,height),brushOption.transformable&&(updateRectShape(controller,cover,"w",xa,ya,handleSize,heighta),updateRectShape(controller,cover,"e",x2a,ya,handleSize,heighta),updateRectShape(controller,cover,"n",xa,ya,widtha,handleSize),updateRectShape(controller,cover,"s",xa,y2a,widtha,handleSize),updateRectShape(controller,cover,"nw",xa,ya,handleSize,handleSize),updateRectShape(controller,cover,"ne",x2a,ya,handleSize,handleSize),updateRectShape(controller,cover,"sw",xa,y2a,handleSize,handleSize),updateRectShape(controller,cover,"se",x2a,y2a,handleSize,handleSize))}function updateCommon$1(controller,cover){var brushOption=cover.__brushOption,transformable=brushOption.transformable,mainEl=cover.childAt(0);mainEl.useStyle(makeStyle(brushOption)),mainEl.attr({silent:!transformable,cursor:transformable?"move":"default"}),each$d([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],(function(nameSequence){var el=cover.childOfName(nameSequence.join("")),globalDir=1===nameSequence.length?getGlobalDirection1(controller,nameSequence[0]):function(controller,localDirNameSeq){var globalDir=[getGlobalDirection1(controller,localDirNameSeq[0]),getGlobalDirection1(controller,localDirNameSeq[1])];return("e"===globalDir[0]||"w"===globalDir[0])&&globalDir.reverse(),globalDir.join("")}(controller,nameSequence);el&&el.attr({silent:!transformable,invisible:!transformable,cursor:transformable?CURSOR_MAP[globalDir]+"-resize":null})}))}function updateRectShape(controller,cover,name,x,y,w,h){var points2,xmin,ymin,xmax,ymax,el=cover.childOfName(name);el&&el.setShape((points2=clipByPanel(controller,cover,[[x,y],[x+w,y+h]]),xmin=mathMin$1(points2[0][0],points2[1][0]),ymin=mathMin$1(points2[0][1],points2[1][1]),xmax=mathMax$1(points2[0][0],points2[1][0]),ymax=mathMax$1(points2[0][1],points2[1][1]),{x:xmin,y:ymin,width:xmax-xmin,height:ymax-ymin}))}function makeStyle(brushOption){return defaults({strokeNoScale:!0},brushOption.brushStyle)}function formatRectRange(x,y,x2,y2){var min3=[mathMin$1(x,x2),mathMin$1(y,y2)],max3=[mathMax$1(x,x2),mathMax$1(y,y2)];return[[min3[0],max3[0]],[min3[1],max3[1]]]}function getGlobalDirection1(controller,localDirName){var dir3=transformDirection({w:"left",e:"right",n:"top",s:"bottom"}[localDirName],function(controller){return getTransform$1(controller.group)}(controller));return{left:"w",right:"e",top:"n",bottom:"s"}[dir3]}function driftRect(rectRangeConverter,controller,cover,dirNameSequence,dx,dy){var brushOption=cover.__brushOption,rectRange=rectRangeConverter.toRectRange(brushOption.range),localDelta=toLocalDelta(controller,dx,dy);each$d(dirNameSequence,(function(dirName){var ind=DIRECTION_MAP[dirName];rectRange[ind[0]][ind[1]]+=localDelta[ind[0]]})),brushOption.range=rectRangeConverter.fromRectRange(formatRectRange(rectRange[0][0],rectRange[1][0],rectRange[0][1],rectRange[1][1])),updateCoverAfterCreation(controller,cover),trigger(controller,{isEnd:!1})}function driftPolygon(controller,cover,dx,dy){var range=cover.__brushOption.range,localDelta=toLocalDelta(controller,dx,dy);each$d(range,(function(point){point[0]+=localDelta[0],point[1]+=localDelta[1]})),updateCoverAfterCreation(controller,cover),trigger(controller,{isEnd:!1})}function toLocalDelta(controller,dx,dy){var thisGroup=controller.group,localD=thisGroup.transformCoordToLocal(dx,dy),localZero=thisGroup.transformCoordToLocal(0,0);return[localD[0]-localZero[0],localD[1]-localZero[1]]}function clipByPanel(controller,cover,data){var panel=getPanelByCover(controller,cover);return panel&&true!==panel?panel.clipPath(data,controller._transform):clone$3(data)}function preventDefault(e2){var rawE=e2.event;rawE.preventDefault&&rawE.preventDefault()}function mainShapeContain(cover,x,y){return cover.childOfName("main").contain(x,y)}function updateCoverByMouse(controller,e2,localCursorPoint,isEnd){var eventParams,creatingCover=controller._creatingCover,panel=controller._creatingPanel,thisBrushOption=controller._brushOption;if(controller._track.push(localCursorPoint.slice()),function(controller){var track=controller._track;if(!track.length)return!1;var p2=track[track.length-1],p1=track[0],dx=p2[0]-p1[0],dy=p2[1]-p1[1];return mathPow(dx*dx+dy*dy,.5)>6}(controller)||creatingCover){if(panel&&!creatingCover){"single"===thisBrushOption.brushMode&&clearCovers(controller);var brushOption=clone$3(thisBrushOption);brushOption.brushType=determineBrushType(brushOption.brushType,panel),brushOption.panelId=true===panel?null:panel.panelId,creatingCover=controller._creatingCover=createCover(controller,brushOption),controller._covers.push(creatingCover)}if(creatingCover){var coverRenderer=coverRenderers[determineBrushType(controller._brushType,panel)];creatingCover.__brushOption.range=coverRenderer.getCreatingRange(clipByPanel(controller,creatingCover,controller._track)),isEnd&&(endCreating(controller,creatingCover),coverRenderer.updateCommon(controller,creatingCover)),updateCoverShape(controller,creatingCover),eventParams={isEnd:isEnd}}}else isEnd&&"single"===thisBrushOption.brushMode&&thisBrushOption.removeOnClick&&getPanelByPoint(controller,e2,localCursorPoint)&&clearCovers(controller)&&(eventParams={isEnd:isEnd,removeOnClick:!0});return eventParams}function determineBrushType(brushType,panel){return"auto"===brushType?panel.defaultBrushType:brushType}var pointerHandlers={mousedown:function(e2){if(this._dragging)handleDragEnd(this,e2);else if(!e2.target||!e2.target.draggable){preventDefault(e2);var localCursorPoint=this.group.transformCoordToLocal(e2.offsetX,e2.offsetY);this._creatingCover=null,(this._creatingPanel=getPanelByPoint(this,e2,localCursorPoint))&&(this._dragging=!0,this._track=[localCursorPoint.slice()])}},mousemove:function(e2){var x=e2.offsetX,y=e2.offsetY,localCursorPoint=this.group.transformCoordToLocal(x,y);if(function(controller,e2,localCursorPoint){if(controller._brushType&&!function(controller,x,y){var zr=controller._zr;return x<0||x>zr.getWidth()||y<0||y>zr.getHeight()}(controller,e2.offsetX,e2.offsetY)){var zr=controller._zr,covers=controller._covers,currPanel=getPanelByPoint(controller,e2,localCursorPoint);if(!controller._dragging)for(var i=0;i<covers.length;i++){var brushOption=covers[i].__brushOption;if(currPanel&&(!0===currPanel||brushOption.panelId===currPanel.panelId)&&coverRenderers[brushOption.brushType].contain(covers[i],localCursorPoint[0],localCursorPoint[1]))return}currPanel&&zr.setCursorStyle("crosshair")}}(this,e2,localCursorPoint),this._dragging){preventDefault(e2);var eventParams=updateCoverByMouse(this,e2,localCursorPoint,!1);eventParams&&trigger(this,eventParams)}},mouseup:function(e2){handleDragEnd(this,e2)}};function handleDragEnd(controller,e2){if(controller._dragging){preventDefault(e2);var x=e2.offsetX,y=e2.offsetY,localCursorPoint=controller.group.transformCoordToLocal(x,y),eventParams=updateCoverByMouse(controller,e2,localCursorPoint,!0);controller._dragging=!1,controller._track=[],controller._creatingCover=null,eventParams&&trigger(controller,eventParams)}}var coverRenderers={lineX:getLineRenderer(0),lineY:getLineRenderer(1),rect:{createCover:function(controller,brushOption){function returnInput(range){return range}return createBaseRectCover({toRectRange:returnInput,fromRectRange:returnInput},controller,brushOption,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(localTrack){var ends=getTrackEnds(localTrack);return formatRectRange(ends[1][0],ends[1][1],ends[0][0],ends[0][1])},updateCoverShape:function(controller,cover,localRange,brushOption){updateBaseRect(controller,cover,localRange,brushOption)},updateCommon:updateCommon$1,contain:mainShapeContain},polygon:{createCover:function(controller,brushOption){var cover=new Group$2;return cover.add(new Polyline({name:"main",style:makeStyle(brushOption),silent:!0})),cover},getCreatingRange:function(localTrack){return localTrack},endCreating:function(controller,cover){cover.remove(cover.childAt(0)),cover.add(new Polygon({name:"main",draggable:!0,drift:curry$1(driftPolygon,controller,cover),ondragend:curry$1(trigger,controller,{isEnd:!0})}))},updateCoverShape:function(controller,cover,localRange,brushOption){cover.childAt(0).setShape({points:clipByPanel(controller,cover,localRange)})},updateCommon:updateCommon$1,contain:mainShapeContain}};function getLineRenderer(xyIndex){return{createCover:function(controller,brushOption){return createBaseRectCover({toRectRange:function(range){var rectRange=[range,[0,100]];return xyIndex&&rectRange.reverse(),rectRange},fromRectRange:function(rectRange){return rectRange[xyIndex]}},controller,brushOption,[[["w"],["e"]],[["n"],["s"]]][xyIndex])},getCreatingRange:function(localTrack){var ends=getTrackEnds(localTrack);return[mathMin$1(ends[0][xyIndex],ends[1][xyIndex]),mathMax$1(ends[0][xyIndex],ends[1][xyIndex])]},updateCoverShape:function(controller,cover,localRange,brushOption){var otherExtent,panel=getPanelByCover(controller,cover);if(true!==panel&&panel.getLinearBrushOtherExtent)otherExtent=panel.getLinearBrushOtherExtent(xyIndex);else{var zr=controller._zr;otherExtent=[0,[zr.getWidth(),zr.getHeight()][1-xyIndex]]}var rectRange=[localRange,otherExtent];xyIndex&&rectRange.reverse(),updateBaseRect(controller,cover,rectRange,brushOption)},updateCommon:updateCommon$1,contain:mainShapeContain}}function makeRectPanelClipPath(rect){return rect=normalizeRect(rect),function(localPoints){return clipPointsByRect(localPoints,rect)}}function makeLinearBrushOtherExtent(rect,specifiedXYIndex){return rect=normalizeRect(rect),function(xyIndex){var idx=null!=specifiedXYIndex?specifiedXYIndex:xyIndex,brushWidth=idx?rect.width:rect.height,base2=idx?rect.x:rect.y;return[base2,base2+(brushWidth||0)]}}function makeRectIsTargetByCursor(rect,api,targetModel){var boundingRect=normalizeRect(rect);return function(e2,localCursorPoint){return boundingRect.contain(localCursorPoint[0],localCursorPoint[1])&&!onIrrelevantElement(e2,api,targetModel)}}function normalizeRect(rect){return BoundingRect.create(rect)}var elementList$1=["axisLine","axisTickLabel","axisName"],ParallelAxisView=function(_super){function ParallelAxisView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=ParallelAxisView2.type,_this}return __extends(ParallelAxisView2,_super),ParallelAxisView2.prototype.init=function(ecModel,api){_super.prototype.init.apply(this,arguments),(this._brushController=new BrushController(api.getZr())).on("brush",bind$1(this._onBrush,this))},ParallelAxisView2.prototype.render=function(axisModel,ecModel,api,payload){if(!function(axisModel,ecModel,payload){return payload&&"axisAreaSelect"===payload.type&&ecModel.findComponents({mainType:"parallelAxis",query:payload})[0]===axisModel}(axisModel,ecModel,payload)){this.axisModel=axisModel,this.api=api,this.group.removeAll();var oldAxisGroup=this._axisGroup;if(this._axisGroup=new Group$2,this.group.add(this._axisGroup),axisModel.get("show")){var coordSysModel=function(axisModel,ecModel){return ecModel.getComponent("parallel",axisModel.get("parallelIndex"))}(axisModel,ecModel),coordSys=coordSysModel.coordinateSystem,areaSelectStyle=axisModel.getAreaSelectStyle(),areaWidth=areaSelectStyle.width,dim=axisModel.axis.dim,builderOpt=extend({strokeContainThreshold:areaWidth},coordSys.getAxisLayout(dim)),axisBuilder=new AxisBuilder(axisModel,builderOpt);each$d(elementList$1,axisBuilder.add,axisBuilder),this._axisGroup.add(axisBuilder.getGroup()),this._refreshBrushController(builderOpt,areaSelectStyle,axisModel,coordSysModel,areaWidth,api),groupTransition(oldAxisGroup,this._axisGroup,axisModel)}}},ParallelAxisView2.prototype._refreshBrushController=function(builderOpt,areaSelectStyle,axisModel,coordSysModel,areaWidth,api){var extent3=axisModel.axis.getExtent(),extentLen=extent3[1]-extent3[0],extra=Math.min(30,.1*Math.abs(extentLen)),rect=BoundingRect.create({x:extent3[0],y:-areaWidth/2,width:extentLen,height:areaWidth});rect.x-=extra,rect.width+=2*extra,this._brushController.mount({enableGlobalPan:!0,rotation:builderOpt.rotation,x:builderOpt.position[0],y:builderOpt.position[1]}).setPanels([{panelId:"pl",clipPath:makeRectPanelClipPath(rect),isTargetByCursor:makeRectIsTargetByCursor(rect,api,coordSysModel),getLinearBrushOtherExtent:makeLinearBrushOtherExtent(rect,0)}]).enableBrush({brushType:"lineX",brushStyle:areaSelectStyle,removeOnClick:!0}).updateCovers(function(axisModel){var axis=axisModel.axis;return map$1(axisModel.activeIntervals,(function(interval){return{brushType:"lineX",panelId:"pl",range:[axis.dataToCoord(interval[0],!0),axis.dataToCoord(interval[1],!0)]}}))}(axisModel))},ParallelAxisView2.prototype._onBrush=function(eventParam){var coverInfoList=eventParam.areas,axisModel=this.axisModel,axis=axisModel.axis,intervals=map$1(coverInfoList,(function(coverInfo){return[axis.coordToData(coverInfo.range[0],!0),axis.coordToData(coverInfo.range[1],!0)]}));(!axisModel.option.realtime===eventParam.isEnd||eventParam.removeOnClick)&&this.api.dispatchAction({type:"axisAreaSelect",parallelAxisId:axisModel.id,intervals:intervals})},ParallelAxisView2.prototype.dispose=function(){this._brushController.dispose()},ParallelAxisView2.type="parallelAxis",ParallelAxisView2}(ComponentView);var actionInfo={type:"axisAreaSelect",event:"axisAreaSelected"};var defaultAxisOption={type:"value",areaSelectStyle:{width:20,borderWidth:1,borderColor:"rgba(160,197,232)",color:"rgba(160,197,232)",opacity:.3},realtime:!0,z:10};var BAR_BORDER_WIDTH_QUERY=["itemStyle","borderWidth"],LAYOUT_ATTRS=[{xy:"x",wh:"width",index:0,posDesc:["left","right"]},{xy:"y",wh:"height",index:1,posDesc:["top","bottom"]}],pathForLineWidth=new Circle,PictorialBarView=function(_super){function PictorialBarView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=PictorialBarView2.type,_this}return __extends(PictorialBarView2,_super),PictorialBarView2.prototype.render=function(seriesModel,ecModel,api){var group=this.group,data=seriesModel.getData(),oldData=this._data,cartesian=seriesModel.coordinateSystem,isHorizontal=cartesian.getBaseAxis().isHorizontal(),coordSysRect=cartesian.master.getRect(),opt={ecSize:{width:api.getWidth(),height:api.getHeight()},seriesModel:seriesModel,coordSys:cartesian,coordSysExtent:[[coordSysRect.x,coordSysRect.x+coordSysRect.width],[coordSysRect.y,coordSysRect.y+coordSysRect.height]],isHorizontal:isHorizontal,valueDim:LAYOUT_ATTRS[+isHorizontal],categoryDim:LAYOUT_ATTRS[1-+isHorizontal]};data.diff(oldData).add((function(dataIndex){if(data.hasValue(dataIndex)){var itemModel=getItemModel(data,dataIndex),symbolMeta=getSymbolMeta(data,dataIndex,itemModel,opt),bar=createBar(data,opt,symbolMeta);data.setItemGraphicEl(dataIndex,bar),group.add(bar),updateCommon(bar,opt,symbolMeta)}})).update((function(newIndex,oldIndex){var bar=oldData.getItemGraphicEl(oldIndex);if(data.hasValue(newIndex)){var itemModel=getItemModel(data,newIndex),symbolMeta=getSymbolMeta(data,newIndex,itemModel,opt),pictorialShapeStr=getShapeStr(data,symbolMeta);bar&&pictorialShapeStr!==bar.__pictorialShapeStr&&(group.remove(bar),data.setItemGraphicEl(newIndex,null),bar=null),bar?function(bar,opt,symbolMeta){var animationModel=symbolMeta.animationModel,dataIndex=symbolMeta.dataIndex,bundle=bar.__pictorialBundle;updateProps$1(bundle,{x:symbolMeta.bundlePosition[0],y:symbolMeta.bundlePosition[1]},animationModel,dataIndex),symbolMeta.symbolRepeat?createOrUpdateRepeatSymbols(bar,opt,symbolMeta,!0):createOrUpdateSingleSymbol(bar,opt,symbolMeta,!0);createOrUpdateBarRect(bar,symbolMeta,!0),createOrUpdateClip(bar,opt,symbolMeta,!0)}(bar,opt,symbolMeta):bar=createBar(data,opt,symbolMeta,!0),data.setItemGraphicEl(newIndex,bar),bar.__pictorialSymbolMeta=symbolMeta,group.add(bar),updateCommon(bar,opt,symbolMeta)}else group.remove(bar)})).remove((function(dataIndex){var bar=oldData.getItemGraphicEl(dataIndex);bar&&removeBar(oldData,dataIndex,bar.__pictorialSymbolMeta.animationModel,bar)})).execute();var clipPath=seriesModel.get("clip",!0)?createClipPath(seriesModel.coordinateSystem,!1,seriesModel):null;return clipPath?group.setClipPath(clipPath):group.removeClipPath(),this._data=data,this.group},PictorialBarView2.prototype.remove=function(ecModel,api){var group=this.group,data=this._data;ecModel.get("animation")?data&&data.eachItemGraphicEl((function(bar){removeBar(data,getECData(bar).dataIndex,ecModel,bar)})):group.removeAll()},PictorialBarView2.type="pictorialBar",PictorialBarView2}(ChartView);function getSymbolMeta(data,dataIndex,itemModel,opt){var layout2=data.getItemLayout(dataIndex),symbolRepeat=itemModel.get("symbolRepeat"),symbolClip=itemModel.get("symbolClip"),symbolPosition=itemModel.get("symbolPosition")||"start",rotation=(itemModel.get("symbolRotate")||0)*Math.PI/180||0,symbolPatternSize=itemModel.get("symbolPatternSize")||2,isAnimationEnabled2=itemModel.isAnimationEnabled(),symbolMeta={dataIndex:dataIndex,layout:layout2,itemModel:itemModel,symbolType:data.getItemVisual(dataIndex,"symbol")||"circle",style:data.getItemVisual(dataIndex,"style"),symbolClip:symbolClip,symbolRepeat:symbolRepeat,symbolRepeatDirection:itemModel.get("symbolRepeatDirection"),symbolPatternSize:symbolPatternSize,rotation:rotation,animationModel:isAnimationEnabled2?itemModel:null,hoverScale:isAnimationEnabled2&&itemModel.get(["emphasis","scale"]),z2:itemModel.getShallow("z",!0)||0};!function(itemModel,symbolRepeat,layout2,opt,outputSymbolMeta){var boundingLength,valueDim=opt.valueDim,symbolBoundingData=itemModel.get("symbolBoundingData"),valueAxis2=opt.coordSys.getOtherAxis(opt.coordSys.getBaseAxis()),zeroPx=valueAxis2.toGlobalCoord(valueAxis2.dataToCoord(0)),pxSignIdx=1-+(layout2[valueDim.wh]<=0);if(isArray$1(symbolBoundingData)){var symbolBoundingExtent=[convertToCoordOnAxis(valueAxis2,symbolBoundingData[0])-zeroPx,convertToCoordOnAxis(valueAxis2,symbolBoundingData[1])-zeroPx];symbolBoundingExtent[1]<symbolBoundingExtent[0]&&symbolBoundingExtent.reverse(),boundingLength=symbolBoundingExtent[pxSignIdx]}else boundingLength=null!=symbolBoundingData?convertToCoordOnAxis(valueAxis2,symbolBoundingData)-zeroPx:symbolRepeat?opt.coordSysExtent[valueDim.index][pxSignIdx]-zeroPx:layout2[valueDim.wh];outputSymbolMeta.boundingLength=boundingLength,symbolRepeat&&(outputSymbolMeta.repeatCutLength=layout2[valueDim.wh]);var isXAxis="x"===valueDim.xy,isInverse=valueAxis2.inverse;outputSymbolMeta.pxSign=isXAxis&&!isInverse||!isXAxis&&isInverse?boundingLength>=0?1:-1:boundingLength>0?1:-1}(itemModel,symbolRepeat,layout2,opt,symbolMeta),function(data,dataIndex,layout2,symbolRepeat,symbolClip,boundingLength,pxSign,symbolPatternSize,opt,outputSymbolMeta){var parsedSymbolSize,valueDim=opt.valueDim,categoryDim=opt.categoryDim,categorySize=Math.abs(layout2[categoryDim.wh]),symbolSize=data.getItemVisual(dataIndex,"symbolSize");parsedSymbolSize=isArray$1(symbolSize)?symbolSize.slice():null==symbolSize?["100%","100%"]:[symbolSize,symbolSize];parsedSymbolSize[categoryDim.index]=parsePercent(parsedSymbolSize[categoryDim.index],categorySize),parsedSymbolSize[valueDim.index]=parsePercent(parsedSymbolSize[valueDim.index],symbolRepeat?categorySize:Math.abs(boundingLength)),outputSymbolMeta.symbolSize=parsedSymbolSize;var symbolScale=outputSymbolMeta.symbolScale=[parsedSymbolSize[0]/symbolPatternSize,parsedSymbolSize[1]/symbolPatternSize];symbolScale[valueDim.index]*=(opt.isHorizontal?-1:1)*pxSign}(data,dataIndex,layout2,symbolRepeat,0,symbolMeta.boundingLength,symbolMeta.pxSign,symbolPatternSize,opt,symbolMeta),function(itemModel,symbolScale,rotation,opt,outputSymbolMeta){var valueLineWidth=itemModel.get(BAR_BORDER_WIDTH_QUERY)||0;valueLineWidth&&(pathForLineWidth.attr({scaleX:symbolScale[0],scaleY:symbolScale[1],rotation:rotation}),pathForLineWidth.updateTransform(),valueLineWidth/=pathForLineWidth.getLineScale(),valueLineWidth*=symbolScale[opt.valueDim.index]);outputSymbolMeta.valueLineWidth=valueLineWidth||0}(itemModel,symbolMeta.symbolScale,rotation,opt,symbolMeta);var symbolSize=symbolMeta.symbolSize,symbolOffset=normalizeSymbolOffset(itemModel.get("symbolOffset"),symbolSize);return function(itemModel,symbolSize,layout2,symbolRepeat,symbolClip,symbolOffset,symbolPosition,valueLineWidth,boundingLength,repeatCutLength,opt,outputSymbolMeta){var categoryDim=opt.categoryDim,valueDim=opt.valueDim,pxSign=outputSymbolMeta.pxSign,unitLength=Math.max(symbolSize[valueDim.index]+valueLineWidth,0),pathLen=unitLength;if(symbolRepeat){var absBoundingLength=Math.abs(boundingLength),symbolMargin=retrieve(itemModel.get("symbolMargin"),"15%")+"",hasEndGap=!1;symbolMargin.lastIndexOf("!")===symbolMargin.length-1&&(hasEndGap=!0,symbolMargin=symbolMargin.slice(0,symbolMargin.length-1));var symbolMarginNumeric=parsePercent(symbolMargin,symbolSize[valueDim.index]),uLenWithMargin=Math.max(unitLength+2*symbolMarginNumeric,0),endFix=hasEndGap?0:2*symbolMarginNumeric,repeatSpecified=isNumeric(symbolRepeat),repeatTimes=repeatSpecified?symbolRepeat:toIntTimes((absBoundingLength+endFix)/uLenWithMargin);uLenWithMargin=unitLength+2*(symbolMarginNumeric=(absBoundingLength-repeatTimes*unitLength)/2/(hasEndGap?repeatTimes:Math.max(repeatTimes-1,1))),endFix=hasEndGap?0:2*symbolMarginNumeric,repeatSpecified||"fixed"===symbolRepeat||(repeatTimes=repeatCutLength?toIntTimes((Math.abs(repeatCutLength)+endFix)/uLenWithMargin):0),pathLen=repeatTimes*uLenWithMargin-endFix,outputSymbolMeta.repeatTimes=repeatTimes,outputSymbolMeta.symbolMargin=symbolMarginNumeric}var sizeFix=pxSign*(pathLen/2),pathPosition=outputSymbolMeta.pathPosition=[];pathPosition[categoryDim.index]=layout2[categoryDim.wh]/2,pathPosition[valueDim.index]="start"===symbolPosition?sizeFix:"end"===symbolPosition?boundingLength-sizeFix:boundingLength/2,symbolOffset&&(pathPosition[0]+=symbolOffset[0],pathPosition[1]+=symbolOffset[1]);var bundlePosition=outputSymbolMeta.bundlePosition=[];bundlePosition[categoryDim.index]=layout2[categoryDim.xy],bundlePosition[valueDim.index]=layout2[valueDim.xy];var barRectShape=outputSymbolMeta.barRectShape=extend({},layout2);barRectShape[valueDim.wh]=pxSign*Math.max(Math.abs(layout2[valueDim.wh]),Math.abs(pathPosition[valueDim.index]+sizeFix)),barRectShape[categoryDim.wh]=layout2[categoryDim.wh];var clipShape=outputSymbolMeta.clipShape={};clipShape[categoryDim.xy]=-layout2[categoryDim.xy],clipShape[categoryDim.wh]=opt.ecSize[categoryDim.wh],clipShape[valueDim.xy]=0,clipShape[valueDim.wh]=layout2[valueDim.wh]}(itemModel,symbolSize,layout2,symbolRepeat,0,symbolOffset,symbolPosition,symbolMeta.valueLineWidth,symbolMeta.boundingLength,symbolMeta.repeatCutLength,opt,symbolMeta),symbolMeta}function convertToCoordOnAxis(axis,value){return axis.toGlobalCoord(axis.dataToCoord(axis.scale.parse(value)))}function createPath(symbolMeta){var symbolPatternSize=symbolMeta.symbolPatternSize,path=createSymbol(symbolMeta.symbolType,-symbolPatternSize/2,-symbolPatternSize/2,symbolPatternSize,symbolPatternSize);return path.attr({culling:!0}),"image"!==path.type&&path.setStyle({strokeNoScale:!0}),path}function createOrUpdateRepeatSymbols(bar,opt,symbolMeta,isUpdate){var bundle=bar.__pictorialBundle,symbolSize=symbolMeta.symbolSize,valueLineWidth=symbolMeta.valueLineWidth,pathPosition=symbolMeta.pathPosition,valueDim=opt.valueDim,repeatTimes=symbolMeta.repeatTimes||0,index=0,unit=symbolSize[opt.valueDim.index]+valueLineWidth+2*symbolMeta.symbolMargin;for(eachPath(bar,(function(path2){path2.__pictorialAnimationIndex=index,path2.__pictorialRepeatTimes=repeatTimes,index<repeatTimes?updateAttr(path2,null,makeTarget(index),symbolMeta,isUpdate):updateAttr(path2,null,{scaleX:0,scaleY:0},symbolMeta,isUpdate,(function(){bundle.remove(path2)})),index++}));index<repeatTimes;index++){var path=createPath(symbolMeta);path.__pictorialAnimationIndex=index,path.__pictorialRepeatTimes=repeatTimes,bundle.add(path);var target=makeTarget(index);updateAttr(path,{x:target.x,y:target.y,scaleX:0,scaleY:0},{scaleX:target.scaleX,scaleY:target.scaleY,rotation:target.rotation},symbolMeta,isUpdate)}function makeTarget(index2){var position=pathPosition.slice(),pxSign=symbolMeta.pxSign,i=index2;return("start"===symbolMeta.symbolRepeatDirection?pxSign>0:pxSign<0)&&(i=repeatTimes-1-index2),position[valueDim.index]=unit*(i-repeatTimes/2+.5)+pathPosition[valueDim.index],{x:position[0],y:position[1],scaleX:symbolMeta.symbolScale[0],scaleY:symbolMeta.symbolScale[1],rotation:symbolMeta.rotation}}}function createOrUpdateSingleSymbol(bar,opt,symbolMeta,isUpdate){var bundle=bar.__pictorialBundle,mainPath=bar.__pictorialMainPath;mainPath?updateAttr(mainPath,null,{x:symbolMeta.pathPosition[0],y:symbolMeta.pathPosition[1],scaleX:symbolMeta.symbolScale[0],scaleY:symbolMeta.symbolScale[1],rotation:symbolMeta.rotation},symbolMeta,isUpdate):(mainPath=bar.__pictorialMainPath=createPath(symbolMeta),bundle.add(mainPath),updateAttr(mainPath,{x:symbolMeta.pathPosition[0],y:symbolMeta.pathPosition[1],scaleX:0,scaleY:0,rotation:symbolMeta.rotation},{scaleX:symbolMeta.symbolScale[0],scaleY:symbolMeta.symbolScale[1]},symbolMeta,isUpdate))}function createOrUpdateBarRect(bar,symbolMeta,isUpdate){var rectShape=extend({},symbolMeta.barRectShape),barRect=bar.__pictorialBarRect;barRect?updateAttr(barRect,null,{shape:rectShape},symbolMeta,isUpdate):((barRect=bar.__pictorialBarRect=new Rect$1({z2:2,shape:rectShape,silent:!0,style:{stroke:"transparent",fill:"transparent",lineWidth:0}})).disableMorphing=!0,bar.add(barRect))}function createOrUpdateClip(bar,opt,symbolMeta,isUpdate){if(symbolMeta.symbolClip){var clipPath=bar.__pictorialClipPath,clipShape=extend({},symbolMeta.clipShape),valueDim=opt.valueDim,animationModel=symbolMeta.animationModel,dataIndex=symbolMeta.dataIndex;if(clipPath)updateProps$1(clipPath,{shape:clipShape},animationModel,dataIndex);else{clipShape[valueDim.wh]=0,clipPath=new Rect$1({shape:clipShape}),bar.__pictorialBundle.setClipPath(clipPath),bar.__pictorialClipPath=clipPath;var target={};target[valueDim.wh]=symbolMeta.clipShape[valueDim.wh],graphic$1[isUpdate?"updateProps":"initProps"](clipPath,{shape:target},animationModel,dataIndex)}}}function getItemModel(data,dataIndex){var itemModel=data.getItemModel(dataIndex);return itemModel.getAnimationDelayParams=getAnimationDelayParams,itemModel.isAnimationEnabled=isAnimationEnabled,itemModel}function getAnimationDelayParams(path){return{index:path.__pictorialAnimationIndex,count:path.__pictorialRepeatTimes}}function isAnimationEnabled(){return this.parentModel.isAnimationEnabled()&&!!this.getShallow("animation")}function createBar(data,opt,symbolMeta,isUpdate){var bar=new Group$2,bundle=new Group$2;return bar.add(bundle),bar.__pictorialBundle=bundle,bundle.x=symbolMeta.bundlePosition[0],bundle.y=symbolMeta.bundlePosition[1],symbolMeta.symbolRepeat?createOrUpdateRepeatSymbols(bar,opt,symbolMeta):createOrUpdateSingleSymbol(bar,0,symbolMeta),createOrUpdateBarRect(bar,symbolMeta,isUpdate),createOrUpdateClip(bar,opt,symbolMeta,isUpdate),bar.__pictorialShapeStr=getShapeStr(data,symbolMeta),bar.__pictorialSymbolMeta=symbolMeta,bar}function removeBar(data,dataIndex,animationModel,bar){var labelRect=bar.__pictorialBarRect;labelRect&&labelRect.removeTextContent();var paths=[];eachPath(bar,(function(path){paths.push(path)})),bar.__pictorialMainPath&&paths.push(bar.__pictorialMainPath),bar.__pictorialClipPath&&(animationModel=null),each$d(paths,(function(path){removeElement(path,{scaleX:0,scaleY:0},animationModel,dataIndex,(function(){bar.parent&&bar.parent.remove(bar)}))})),data.setItemGraphicEl(dataIndex,null)}function getShapeStr(data,symbolMeta){return[data.getItemVisual(symbolMeta.dataIndex,"symbol")||"none",!!symbolMeta.symbolRepeat,!!symbolMeta.symbolClip].join(":")}function eachPath(bar,cb,context){each$d(bar.__pictorialBundle.children(),(function(el){el!==bar.__pictorialBarRect&&cb.call(context,el)}))}function updateAttr(el,immediateAttrs,animationAttrs,symbolMeta,isUpdate,cb){immediateAttrs&&el.attr(immediateAttrs),symbolMeta.symbolClip&&!isUpdate?animationAttrs&&el.attr(animationAttrs):animationAttrs&&graphic$1[isUpdate?"updateProps":"initProps"](el,animationAttrs,symbolMeta.animationModel,symbolMeta.dataIndex,cb)}function updateCommon(bar,opt,symbolMeta){var dataIndex=symbolMeta.dataIndex,itemModel=symbolMeta.itemModel,emphasisModel=itemModel.getModel("emphasis"),emphasisStyle=emphasisModel.getModel("itemStyle").getItemStyle(),blurStyle=itemModel.getModel(["blur","itemStyle"]).getItemStyle(),selectStyle=itemModel.getModel(["select","itemStyle"]).getItemStyle(),cursorStyle=itemModel.getShallow("cursor"),focus=emphasisModel.get("focus"),blurScope=emphasisModel.get("blurScope"),hoverScale=emphasisModel.get("scale");eachPath(bar,(function(path){if(path instanceof ZRImage){var pathStyle=path.style;path.useStyle(extend({image:pathStyle.image,x:pathStyle.x,y:pathStyle.y,width:pathStyle.width,height:pathStyle.height},symbolMeta.style))}else path.useStyle(symbolMeta.style);var emphasisState=path.ensureState("emphasis");emphasisState.style=emphasisStyle,hoverScale&&(emphasisState.scaleX=1.1*path.scaleX,emphasisState.scaleY=1.1*path.scaleY),path.ensureState("blur").style=blurStyle,path.ensureState("select").style=selectStyle,cursorStyle&&(path.cursor=cursorStyle),path.z2=symbolMeta.z2}));var barPositionOutside=opt.valueDim.posDesc[+(symbolMeta.boundingLength>0)],barRect=bar.__pictorialBarRect;barRect.ignoreClip=!0,setLabelStyle(barRect,getLabelStatesModels(itemModel),{labelFetcher:opt.seriesModel,labelDataIndex:dataIndex,defaultText:getDefaultLabel(opt.seriesModel.getData(),dataIndex),inheritColor:symbolMeta.style.fill,defaultOpacity:symbolMeta.style.opacity,defaultOutsidePosition:barPositionOutside}),toggleHoverEmphasis(bar,focus,blurScope,emphasisModel.get("disabled"))}function toIntTimes(times){var roundedTimes=Math.round(times);return Math.abs(times-roundedTimes)<1e-4?roundedTimes:Math.ceil(times)}var PictorialBarSeriesModel=function(_super){function PictorialBarSeriesModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=PictorialBarSeriesModel2.type,_this.hasSymbolVisual=!0,_this.defaultSymbol="roundRect",_this}return __extends(PictorialBarSeriesModel2,_super),PictorialBarSeriesModel2.prototype.getInitialData=function(option){return option.stack=null,_super.prototype.getInitialData.apply(this,arguments)},PictorialBarSeriesModel2.type="series.pictorialBar",PictorialBarSeriesModel2.dependencies=["grid"],PictorialBarSeriesModel2.defaultOption=inheritDefaultOption(BaseBarSeriesModel.defaultOption,{symbol:"circle",symbolSize:null,symbolRotate:null,symbolPosition:null,symbolOffset:null,symbolMargin:null,symbolRepeat:!1,symbolRepeatDirection:"end",symbolClip:!1,symbolBoundingData:null,symbolPatternSize:400,barGap:"-100%",clip:!1,progressive:0,emphasis:{scale:!1},select:{itemStyle:{borderColor:"#212121"}}}),PictorialBarSeriesModel2}(BaseBarSeriesModel);function convertEC4CompatibleRichItem(out2,richItem){richItem&&(richItem.font=richItem.textFont||richItem.font,hasOwn(richItem,"textStrokeWidth")&&(out2.lineWidth=richItem.textStrokeWidth),hasOwn(richItem,"textAlign")&&(out2.align=richItem.textAlign),hasOwn(richItem,"textVerticalAlign")&&(out2.verticalAlign=richItem.textVerticalAlign),hasOwn(richItem,"textLineHeight")&&(out2.lineHeight=richItem.textLineHeight),hasOwn(richItem,"textWidth")&&(out2.width=richItem.textWidth),hasOwn(richItem,"textHeight")&&(out2.height=richItem.textHeight),hasOwn(richItem,"textBackgroundColor")&&(out2.backgroundColor=richItem.textBackgroundColor),hasOwn(richItem,"textPadding")&&(out2.padding=richItem.textPadding),hasOwn(richItem,"textBorderColor")&&(out2.borderColor=richItem.textBorderColor),hasOwn(richItem,"textBorderWidth")&&(out2.borderWidth=richItem.textBorderWidth),hasOwn(richItem,"textBorderRadius")&&(out2.borderRadius=richItem.textBorderRadius),hasOwn(richItem,"textBoxShadowColor")&&(out2.shadowColor=richItem.textBoxShadowColor),hasOwn(richItem,"textBoxShadowBlur")&&(out2.shadowBlur=richItem.textBoxShadowBlur),hasOwn(richItem,"textBoxShadowOffsetX")&&(out2.shadowOffsetX=richItem.textBoxShadowOffsetX),hasOwn(richItem,"textBoxShadowOffsetY")&&(out2.shadowOffsetY=richItem.textBoxShadowOffsetY))}var LEGACY_TRANSFORM_PROPS_MAP={position:["x","y"],scale:["scaleX","scaleY"],origin:["originX","originY"]},LEGACY_TRANSFORM_PROPS=keys(LEGACY_TRANSFORM_PROPS_MAP);reduce(TRANSFORMABLE_PROPS,(function(obj,key){return obj[key]=1,obj}),{}),TRANSFORMABLE_PROPS.join(", ");var ELEMENT_ANIMATABLE_PROPS=["","style","shape","extra"],transitionInnerStore=makeInner();function getElementAnimationConfig(animationType,el,elOption,parentModel,dataIndex){var animationProp=animationType+"Animation",config=getAnimationConfig(animationType,parentModel,dataIndex)||{},userDuring=transitionInnerStore(el).userDuring;return config.duration>0&&(config.during=userDuring?bind$1(duringCall,{el:el,userDuring:userDuring}):null,config.setToFinal=!0,config.scope=animationType),extend(config,elOption[animationProp]),config}function applyUpdateTransition(el,elOption,animatableModel,opts){var dataIndex=(opts=opts||{}).dataIndex,isInit=opts.isInit,clearStyle=opts.clearStyle,hasAnimation=animatableModel.isAnimationEnabled(),store=transitionInnerStore(el),styleOpt=elOption.style;store.userDuring=elOption.during;var transFromProps={},propsToSet={};if(function(el,elOption,allProps){for(var i=0;i<LEGACY_TRANSFORM_PROPS.length;i++){var legacyName=LEGACY_TRANSFORM_PROPS[i],xyName=LEGACY_TRANSFORM_PROPS_MAP[legacyName],legacyArr=elOption[legacyName];legacyArr&&(allProps[xyName[0]]=legacyArr[0],allProps[xyName[1]]=legacyArr[1])}for(i=0;i<TRANSFORMABLE_PROPS.length;i++){var key=TRANSFORMABLE_PROPS[i];null!=elOption[key]&&(allProps[key]=elOption[key])}}(0,elOption,propsToSet),prepareShapeOrExtraAllPropsFinal("shape",elOption,propsToSet),prepareShapeOrExtraAllPropsFinal("extra",elOption,propsToSet),!isInit&&hasAnimation&&(function(el,elOption,transFromProps){for(var transition=elOption.transition,transitionKeys=isTransitionAll(transition)?TRANSFORMABLE_PROPS:normalizeToArray(transition||[]),i=0;i<transitionKeys.length;i++){var key=transitionKeys[i];if("style"!==key&&"shape"!==key&&"extra"!==key){var elVal=el[key];transFromProps[key]=elVal}}}(el,elOption,transFromProps),prepareShapeOrExtraTransitionFrom("shape",el,elOption,transFromProps),prepareShapeOrExtraTransitionFrom("extra",el,elOption,transFromProps),function(fromEl,elOption,styleOpt,transFromProps){if(!styleOpt)return;var transFromStyleProps,fromElStyle=fromEl.style;if(fromElStyle){var styleTransition=styleOpt.transition,elTransition=elOption.transition;if(styleTransition&&!isTransitionAll(styleTransition)){var transitionKeys=normalizeToArray(styleTransition);!transFromStyleProps&&(transFromStyleProps=transFromProps.style={});for(var i=0;i<transitionKeys.length;i++){var elVal=fromElStyle[key=transitionKeys[i]];transFromStyleProps[key]=elVal}}else if(fromEl.getAnimationStyleProps&&(isTransitionAll(elTransition)||isTransitionAll(styleTransition)||indexOf(elTransition,"style")>=0)){var animationProps=fromEl.getAnimationStyleProps(),animationStyleProps=animationProps?animationProps.style:null;if(animationStyleProps){!transFromStyleProps&&(transFromStyleProps=transFromProps.style={});var styleKeys=keys(styleOpt);for(i=0;i<styleKeys.length;i++){var key;if(animationStyleProps[key=styleKeys[i]]){elVal=fromElStyle[key];transFromStyleProps[key]=elVal}}}}}}(el,elOption,styleOpt,transFromProps)),propsToSet.style=styleOpt,function(el,allPropsFinal,clearStyle){var styleOpt=allPropsFinal.style;if(!el.isGroup&&styleOpt){if(clearStyle){el.useStyle({});for(var animators=el.animators,i=0;i<animators.length;i++){var animator=animators[i];"style"===animator.targetName&&animator.changeTarget(el.style)}}el.setStyle(styleOpt)}allPropsFinal.style=null,el.attr(allPropsFinal),allPropsFinal.style=styleOpt}(el,propsToSet,clearStyle),function(el,elOption){hasOwn(elOption,"silent")&&(el.silent=elOption.silent),hasOwn(elOption,"ignore")&&(el.ignore=elOption.ignore),el instanceof Displayable&&hasOwn(elOption,"invisible")&&(el.invisible=elOption.invisible);el instanceof Path&&hasOwn(elOption,"autoBatch")&&(el.autoBatch=elOption.autoBatch)}(el,elOption),hasAnimation)if(isInit){var enterFromProps_1={};each$d(ELEMENT_ANIMATABLE_PROPS,(function(propName){var prop=propName?elOption[propName]:elOption;prop&&prop.enterFrom&&(propName&&(enterFromProps_1[propName]=enterFromProps_1[propName]||{}),extend(propName?enterFromProps_1[propName]:enterFromProps_1,prop.enterFrom))}));var config=getElementAnimationConfig("enter",el,elOption,animatableModel,dataIndex);config.duration>0&&el.animateFrom(enterFromProps_1,config)}else!function(el,elOption,dataIndex,model,transFromProps){var config=getElementAnimationConfig("update",el,elOption,model,dataIndex);config.duration>0&&el.animateFrom(transFromProps,config)}(el,elOption,dataIndex||0,animatableModel,transFromProps);updateLeaveTo(el,elOption),styleOpt?el.dirty():el.markRedraw()}function updateLeaveTo(el,elOption){for(var leaveToProps=transitionInnerStore(el).leaveToProps,i=0;i<ELEMENT_ANIMATABLE_PROPS.length;i++){var propName=ELEMENT_ANIMATABLE_PROPS[i],prop=propName?elOption[propName]:elOption;prop&&prop.leaveTo&&(leaveToProps||(leaveToProps=transitionInnerStore(el).leaveToProps={}),propName&&(leaveToProps[propName]=leaveToProps[propName]||{}),extend(propName?leaveToProps[propName]:leaveToProps,prop.leaveTo))}}function isTransitionAll(transition){return"all"===transition}var tmpDuringScope={},transitionDuringAPI={setTransform:function(key,val){return tmpDuringScope.el[key]=val,this},getTransform:function(key){return tmpDuringScope.el[key]},setShape:function(key,val){var el=tmpDuringScope.el;return(el.shape||(el.shape={}))[key]=val,el.dirtyShape&&el.dirtyShape(),this},getShape:function(key){var shape=tmpDuringScope.el.shape;if(shape)return shape[key]},setStyle:function(key,val){var el=tmpDuringScope.el,style=el.style;return style&&(style[key]=val,el.dirtyStyle&&el.dirtyStyle()),this},getStyle:function(key){var style=tmpDuringScope.el.style;if(style)return style[key]},setExtra:function(key,val){return(tmpDuringScope.el.extra||(tmpDuringScope.el.extra={}))[key]=val,this},getExtra:function(key){var extra=tmpDuringScope.el.extra;if(extra)return extra[key]}};function duringCall(){var el=this.el;if(el){var latestUserDuring=transitionInnerStore(el).userDuring,scopeUserDuring=this.userDuring;latestUserDuring===scopeUserDuring?(tmpDuringScope.el=el,scopeUserDuring(transitionDuringAPI)):this.el=this.userDuring=null}}function prepareShapeOrExtraTransitionFrom(mainAttr,fromEl,elOption,transFromProps){var attrOpt=elOption[mainAttr];if(attrOpt){var transFromPropsInAttr,elPropsInAttr=fromEl[mainAttr];if(elPropsInAttr){var transition=elOption.transition,attrTransition=attrOpt.transition;if(attrTransition)if(!transFromPropsInAttr&&(transFromPropsInAttr=transFromProps[mainAttr]={}),isTransitionAll(attrTransition))extend(transFromPropsInAttr,elPropsInAttr);else for(var transitionKeys=normalizeToArray(attrTransition),i=0;i<transitionKeys.length;i++){var elVal=elPropsInAttr[key=transitionKeys[i]];transFromPropsInAttr[key]=elVal}else if(isTransitionAll(transition)||indexOf(transition,mainAttr)>=0){!transFromPropsInAttr&&(transFromPropsInAttr=transFromProps[mainAttr]={});var elPropsInAttrKeys=keys(elPropsInAttr);for(i=0;i<elPropsInAttrKeys.length;i++){var key;elVal=elPropsInAttr[key=elPropsInAttrKeys[i]];isNonStyleTransitionEnabled(attrOpt[key],elVal)&&(transFromPropsInAttr[key]=elVal)}}}}}function prepareShapeOrExtraAllPropsFinal(mainAttr,elOption,allProps){var attrOpt=elOption[mainAttr];if(attrOpt)for(var allPropsInAttr=allProps[mainAttr]={},keysInAttr=keys(attrOpt),i=0;i<keysInAttr.length;i++){var key=keysInAttr[i];allPropsInAttr[key]=cloneValue(attrOpt[key])}}function isNonStyleTransitionEnabled(optVal,elVal){return isArrayLike(optVal)?optVal!==elVal:null!=optVal&&isFinite(optVal)}var getStateToRestore=makeInner(),KEYFRAME_EXCLUDE_KEYS=["percent","easing","shape","style","extra"];function applyKeyframeAnimation(el,animationOpts,animatableModel){if(animatableModel.isAnimationEnabled()&&animationOpts)if(isArray$1(animationOpts))each$d(animationOpts,(function(singleAnimationOpts){applyKeyframeAnimation(el,singleAnimationOpts,animatableModel)}));else{var keyframes=animationOpts.keyframes,duration=animationOpts.duration;if(animatableModel&&null==duration){var config=getAnimationConfig("enter",animatableModel,0);duration=config&&config.duration}if(keyframes&&duration){var stateToRestore=getStateToRestore(el);each$d(ELEMENT_ANIMATABLE_PROPS,(function(targetPropName){var animator;targetPropName&&!el[targetPropName]||(keyframes.sort((function(a,b){return a.percent-b.percent})),each$d(keyframes,(function(kf){var animators=el.animators,kfValues=targetPropName?kf[targetPropName]:kf;if(kfValues){var propKeys=keys(kfValues);if(targetPropName||(propKeys=filter(propKeys,(function(key){return indexOf(KEYFRAME_EXCLUDE_KEYS,key)<0}))),propKeys.length){animator||((animator=el.animate(targetPropName,animationOpts.loop,!0)).scope="keyframe");for(var i=0;i<animators.length;i++)animators[i]!==animator&&animators[i].targetName===animator.targetName&&animators[i].stopTracks(propKeys);targetPropName&&(stateToRestore[targetPropName]=stateToRestore[targetPropName]||{});var savedTarget=targetPropName?stateToRestore[targetPropName]:stateToRestore;each$d(propKeys,(function(key){savedTarget[key]=((targetPropName?el[targetPropName]:el)||{})[key]})),animator.whenWithKeys(duration*kf.percent,kfValues,propKeys,kf.easing)}}})),animator&&animator.delay(animationOpts.delay||0).duration(duration).start(animationOpts.easing))}))}}}var inner$7=makeInner(),clone=clone$3,bind=bind$1,BaseAxisPointer=function(){function BaseAxisPointer2(){this._dragging=!1,this.animationThreshold=15}return BaseAxisPointer2.prototype.render=function(axisModel,axisPointerModel,api,forceRender){var value=axisPointerModel.get("value"),status=axisPointerModel.get("status");if(this._axisModel=axisModel,this._axisPointerModel=axisPointerModel,this._api=api,forceRender||this._lastValue!==value||this._lastStatus!==status){this._lastValue=value,this._lastStatus=status;var group=this._group,handle=this._handle;if(!status||"hide"===status)return group&&group.hide(),void(handle&&handle.hide());group&&group.show(),handle&&handle.show();var elOption={};this.makeElOption(elOption,value,axisModel,axisPointerModel,api);var graphicKey=elOption.graphicKey;graphicKey!==this._lastGraphicKey&&this.clear(api),this._lastGraphicKey=graphicKey;var moveAnimation=this._moveAnimation=this.determineAnimation(axisModel,axisPointerModel);if(group){var doUpdateProps=curry$1(updateProps,axisPointerModel,moveAnimation);this.updatePointerEl(group,elOption,doUpdateProps),this.updateLabelEl(group,elOption,doUpdateProps,axisPointerModel)}else group=this._group=new Group$2,this.createPointerEl(group,elOption,axisModel,axisPointerModel),this.createLabelEl(group,elOption,axisModel,axisPointerModel),api.getZr().add(group);updateMandatoryProps(group,axisPointerModel,!0),this._renderHandle(value)}},BaseAxisPointer2.prototype.remove=function(api){this.clear(api)},BaseAxisPointer2.prototype.dispose=function(api){this.clear(api)},BaseAxisPointer2.prototype.determineAnimation=function(axisModel,axisPointerModel){var animation=axisPointerModel.get("animation"),axis=axisModel.axis,isCategoryAxis="category"===axis.type,useSnap=axisPointerModel.get("snap");if(!useSnap&&!isCategoryAxis)return!1;if("auto"===animation||null==animation){var animationThreshold=this.animationThreshold;if(isCategoryAxis&&axis.getBandWidth()>animationThreshold)return!0;if(useSnap){var seriesDataCount=getAxisInfo(axisModel).seriesDataCount,axisExtent=axis.getExtent();return Math.abs(axisExtent[0]-axisExtent[1])/seriesDataCount>animationThreshold}return!1}return!0===animation},BaseAxisPointer2.prototype.makeElOption=function(elOption,value,axisModel,axisPointerModel,api){},BaseAxisPointer2.prototype.createPointerEl=function(group,elOption,axisModel,axisPointerModel){var pointerOption=elOption.pointer;if(pointerOption){var pointerEl=inner$7(group).pointerEl=new graphic$1[pointerOption.type](clone(elOption.pointer));group.add(pointerEl)}},BaseAxisPointer2.prototype.createLabelEl=function(group,elOption,axisModel,axisPointerModel){if(elOption.label){var labelEl=inner$7(group).labelEl=new ZRText(clone(elOption.label));group.add(labelEl),updateLabelShowHide(labelEl,axisPointerModel)}},BaseAxisPointer2.prototype.updatePointerEl=function(group,elOption,updateProps2){var pointerEl=inner$7(group).pointerEl;pointerEl&&elOption.pointer&&(pointerEl.setStyle(elOption.pointer.style),updateProps2(pointerEl,{shape:elOption.pointer.shape}))},BaseAxisPointer2.prototype.updateLabelEl=function(group,elOption,updateProps2,axisPointerModel){var labelEl=inner$7(group).labelEl;labelEl&&(labelEl.setStyle(elOption.label.style),updateProps2(labelEl,{x:elOption.label.x,y:elOption.label.y}),updateLabelShowHide(labelEl,axisPointerModel))},BaseAxisPointer2.prototype._renderHandle=function(value){if(!this._dragging&&this.updateHandleTransform){var isInit,axisPointerModel=this._axisPointerModel,zr=this._api.getZr(),handle=this._handle,handleModel=axisPointerModel.getModel("handle"),status=axisPointerModel.get("status");if(!handleModel.get("show")||!status||"hide"===status)return handle&&zr.remove(handle),void(this._handle=null);this._handle||(isInit=!0,handle=this._handle=createIcon(handleModel.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(e2){stop(e2.event)},onmousedown:bind(this._onHandleDragMove,this,0,0),drift:bind(this._onHandleDragMove,this),ondragend:bind(this._onHandleDragEnd,this)}),zr.add(handle)),updateMandatoryProps(handle,axisPointerModel,!1),handle.setStyle(handleModel.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var handleSize=handleModel.get("size");isArray$1(handleSize)||(handleSize=[handleSize,handleSize]),handle.scaleX=handleSize[0]/2,handle.scaleY=handleSize[1]/2,createOrUpdate(this,"_doDispatchAxisPointer",handleModel.get("throttle")||0,"fixRate"),this._moveHandleToValue(value,isInit)}},BaseAxisPointer2.prototype._moveHandleToValue=function(value,isInit){updateProps(this._axisPointerModel,!isInit&&this._moveAnimation,this._handle,getHandleTransProps(this.getHandleTransform(value,this._axisModel,this._axisPointerModel)))},BaseAxisPointer2.prototype._onHandleDragMove=function(dx,dy){var handle=this._handle;if(handle){this._dragging=!0;var trans=this.updateHandleTransform(getHandleTransProps(handle),[dx,dy],this._axisModel,this._axisPointerModel);this._payloadInfo=trans,handle.stopAnimation(),handle.attr(getHandleTransProps(trans)),inner$7(handle).lastProp=null,this._doDispatchAxisPointer()}},BaseAxisPointer2.prototype._doDispatchAxisPointer=function(){if(this._handle){var payloadInfo=this._payloadInfo,axisModel=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:payloadInfo.cursorPoint[0],y:payloadInfo.cursorPoint[1],tooltipOption:payloadInfo.tooltipOption,axesInfo:[{axisDim:axisModel.axis.dim,axisIndex:axisModel.componentIndex}]})}},BaseAxisPointer2.prototype._onHandleDragEnd=function(){if(this._dragging=!1,this._handle){var value=this._axisPointerModel.get("value");this._moveHandleToValue(value),this._api.dispatchAction({type:"hideTip"})}},BaseAxisPointer2.prototype.clear=function(api){this._lastValue=null,this._lastStatus=null;var zr=api.getZr(),group=this._group,handle=this._handle;zr&&group&&(this._lastGraphicKey=null,group&&zr.remove(group),handle&&zr.remove(handle),this._group=null,this._handle=null,this._payloadInfo=null),clear$1(this,"_doDispatchAxisPointer")},BaseAxisPointer2.prototype.doClear=function(){},BaseAxisPointer2.prototype.buildLabel=function(xy,wh,xDimIndex){return{x:xy[xDimIndex=xDimIndex||0],y:xy[1-xDimIndex],width:wh[xDimIndex],height:wh[1-xDimIndex]}},BaseAxisPointer2}();function updateProps(animationModel,moveAnimation,el,props){propsEqual(inner$7(el).lastProp,props)||(inner$7(el).lastProp=props,moveAnimation?updateProps$1(el,props,animationModel):(el.stopAnimation(),el.attr(props)))}function propsEqual(lastProps,newProps){if(isObject$3(lastProps)&&isObject$3(newProps)){var equals_1=!0;return each$d(newProps,(function(item,key){equals_1=equals_1&&propsEqual(lastProps[key],item)})),!!equals_1}return lastProps===newProps}function updateLabelShowHide(labelEl,axisPointerModel){labelEl[axisPointerModel.get(["label","show"])?"show":"hide"]()}function getHandleTransProps(trans){return{x:trans.x||0,y:trans.y||0,rotation:trans.rotation||0}}function updateMandatoryProps(group,axisPointerModel,silent){var z=axisPointerModel.get("z"),zlevel=axisPointerModel.get("zlevel");group&&group.traverse((function(el){"group"!==el.type&&(null!=z&&(el.z=z),null!=zlevel&&(el.zlevel=zlevel),el.silent=silent)}))}function buildElStyle(axisPointerModel){var style,axisPointerType=axisPointerModel.get("type"),styleModel=axisPointerModel.getModel(axisPointerType+"Style");return"line"===axisPointerType?(style=styleModel.getLineStyle()).fill=null:"shadow"===axisPointerType&&((style=styleModel.getAreaStyle()).stroke=null),style}function buildLabelElOption(elOption,axisModel,axisPointerModel,api,labelPos){var text=getValueLabel(axisPointerModel.get("value"),axisModel.axis,axisModel.ecModel,axisPointerModel.get("seriesDataIndices"),{precision:axisPointerModel.get(["label","precision"]),formatter:axisPointerModel.get(["label","formatter"])}),labelModel=axisPointerModel.getModel("label"),paddings=normalizeCssArray(labelModel.get("padding")||0),font=labelModel.getFont(),textRect=getBoundingRect(text,font),position=labelPos.position,width=textRect.width+paddings[1]+paddings[3],height=textRect.height+paddings[0]+paddings[2],align=labelPos.align;"right"===align&&(position[0]-=width),"center"===align&&(position[0]-=width/2);var verticalAlign=labelPos.verticalAlign;"bottom"===verticalAlign&&(position[1]-=height),"middle"===verticalAlign&&(position[1]-=height/2),function(position,width,height,api){var viewWidth=api.getWidth(),viewHeight=api.getHeight();position[0]=Math.min(position[0]+width,viewWidth)-width,position[1]=Math.min(position[1]+height,viewHeight)-height,position[0]=Math.max(position[0],0),position[1]=Math.max(position[1],0)}(position,width,height,api);var bgColor=labelModel.get("backgroundColor");bgColor&&"auto"!==bgColor||(bgColor=axisModel.get(["axisLine","lineStyle","color"])),elOption.label={x:position[0],y:position[1],style:createTextStyle$1(labelModel,{text:text,font:font,fill:labelModel.getTextColor(),padding:paddings,backgroundColor:bgColor}),z2:10}}function getValueLabel(value,axis,ecModel,seriesDataIndices,opt){value=axis.scale.parse(value);var text=axis.scale.getLabel({value:value},{precision:opt.precision}),formatter=opt.formatter;if(formatter){var params_1={value:getAxisRawValue(axis,{value:value}),axisDimension:axis.dim,axisIndex:axis.index,seriesData:[]};each$d(seriesDataIndices,(function(idxItem){var series=ecModel.getSeriesByIndex(idxItem.seriesIndex),dataIndex=idxItem.dataIndexInside,dataParams=series&&series.getDataParams(dataIndex);dataParams&&params_1.seriesData.push(dataParams)})),isString(formatter)?text=formatter.replace("{value}",text):isFunction(formatter)&&(text=formatter(params_1))}return text}function getTransformedPosition(axis,value,layoutInfo){var transform=[1,0,0,1,0,0];return rotate(transform,transform,layoutInfo.rotation),translate(transform,transform,layoutInfo.position),applyTransform([axis.dataToCoord(value),(layoutInfo.labelOffset||0)+(layoutInfo.labelDirection||1)*(layoutInfo.labelMargin||0)],transform)}function makeLineShape(p1,p2,xDimIndex){return{x1:p1[xDimIndex=xDimIndex||0],y1:p1[1-xDimIndex],x2:p2[xDimIndex],y2:p2[1-xDimIndex]}}function makeSectorShape(cx,cy,r0,r,startAngle,endAngle){return{cx:cx,cy:cy,r0:r0,r:r,startAngle:startAngle,endAngle:endAngle,clockwise:!0}}var CartesianAxisPointer=function(_super){function CartesianAxisPointer2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(CartesianAxisPointer2,_super),CartesianAxisPointer2.prototype.makeElOption=function(elOption,value,axisModel,axisPointerModel,api){var axis=axisModel.axis,grid=axis.grid,axisPointerType=axisPointerModel.get("type"),otherExtent=getCartesian(grid,axis).getOtherAxis(axis).getGlobalExtent(),pixelValue=axis.toGlobalCoord(axis.dataToCoord(value,!0));if(axisPointerType&&"none"!==axisPointerType){var elStyle=buildElStyle(axisPointerModel),pointerOption=pointerShapeBuilder$1[axisPointerType](axis,pixelValue,otherExtent);pointerOption.style=elStyle,elOption.graphicKey=pointerOption.type,elOption.pointer=pointerOption}!function(value,elOption,layoutInfo,axisModel,axisPointerModel,api){var textLayout=AxisBuilder.innerTextLayout(layoutInfo.rotation,0,layoutInfo.labelDirection);layoutInfo.labelMargin=axisPointerModel.get(["label","margin"]),buildLabelElOption(elOption,axisModel,axisPointerModel,api,{position:getTransformedPosition(axisModel.axis,value,layoutInfo),align:textLayout.textAlign,verticalAlign:textLayout.textVerticalAlign})}(value,elOption,layout$1(grid.model,axisModel),axisModel,axisPointerModel,api)},CartesianAxisPointer2.prototype.getHandleTransform=function(value,axisModel,axisPointerModel){var layoutInfo=layout$1(axisModel.axis.grid.model,axisModel,{labelInside:!1});layoutInfo.labelMargin=axisPointerModel.get(["handle","margin"]);var pos=getTransformedPosition(axisModel.axis,value,layoutInfo);return{x:pos[0],y:pos[1],rotation:layoutInfo.rotation+(layoutInfo.labelDirection<0?Math.PI:0)}},CartesianAxisPointer2.prototype.updateHandleTransform=function(transform,delta,axisModel,axisPointerModel){var axis=axisModel.axis,grid=axis.grid,axisExtent=axis.getGlobalExtent(!0),otherExtent=getCartesian(grid,axis).getOtherAxis(axis).getGlobalExtent(),dimIndex="x"===axis.dim?0:1,currPosition=[transform.x,transform.y];currPosition[dimIndex]+=delta[dimIndex],currPosition[dimIndex]=Math.min(axisExtent[1],currPosition[dimIndex]),currPosition[dimIndex]=Math.max(axisExtent[0],currPosition[dimIndex]);var cursorOtherValue=(otherExtent[1]+otherExtent[0])/2,cursorPoint=[cursorOtherValue,cursorOtherValue];cursorPoint[dimIndex]=currPosition[dimIndex];return{x:currPosition[0],y:currPosition[1],rotation:transform.rotation,cursorPoint:cursorPoint,tooltipOption:[{verticalAlign:"middle"},{align:"center"}][dimIndex]}},CartesianAxisPointer2}(BaseAxisPointer);function getCartesian(grid,axis){var opt={};return opt[axis.dim+"AxisIndex"]=axis.index,grid.getCartesian(opt)}var pointerShapeBuilder$1={line:function(axis,pixelValue,otherExtent){return{type:"Line",subPixelOptimize:!0,shape:makeLineShape([pixelValue,otherExtent[0]],[pixelValue,otherExtent[1]],getAxisDimIndex(axis))}},shadow:function(axis,pixelValue,otherExtent){var xy,wh,xDimIndex,bandWidth=Math.max(1,axis.getBandWidth()),span=otherExtent[1]-otherExtent[0];return{type:"Rect",shape:(xy=[pixelValue-bandWidth/2,otherExtent[0]],wh=[bandWidth,span],xDimIndex=getAxisDimIndex(axis),{x:xy[xDimIndex=xDimIndex||0],y:xy[1-xDimIndex],width:wh[xDimIndex],height:wh[1-xDimIndex]})}}};function getAxisDimIndex(axis){return"x"===axis.dim?0:1}var AxisPointerModel=function(_super){function AxisPointerModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=AxisPointerModel2.type,_this}return __extends(AxisPointerModel2,_super),AxisPointerModel2.type="axisPointer",AxisPointerModel2.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,triggerEmphasis:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},AxisPointerModel2}(ComponentModel),inner$6=makeInner(),each$8=each$d;function register(key,api,handler){if(!env.node){var zr=api.getZr();inner$6(zr).records||(inner$6(zr).records={}),function(zr,api){if(inner$6(zr).initialized)return;function useHandler(eventType,cb){zr.on(eventType,(function(e2){var dis=function(api){var pendings={showTip:[],hideTip:[]},dispatchAction2=function(payload){var pendingList=pendings[payload.type];pendingList?pendingList.push(payload):(payload.dispatchAction=dispatchAction2,api.dispatchAction(payload))};return{dispatchAction:dispatchAction2,pendings:pendings}}(api);each$8(inner$6(zr).records,(function(record){record&&cb(record,e2,dis.dispatchAction)})),function(pendings,api){var actuallyPayload,showLen=pendings.showTip.length,hideLen=pendings.hideTip.length;showLen?actuallyPayload=pendings.showTip[showLen-1]:hideLen&&(actuallyPayload=pendings.hideTip[hideLen-1]);actuallyPayload&&(actuallyPayload.dispatchAction=null,api.dispatchAction(actuallyPayload))}(dis.pendings,api)}))}inner$6(zr).initialized=!0,useHandler("click",curry$1(doEnter,"click")),useHandler("mousemove",curry$1(doEnter,"mousemove")),useHandler("globalout",onLeave)}(zr,api),(inner$6(zr).records[key]||(inner$6(zr).records[key]={})).handler=handler}}function onLeave(record,e2,dispatchAction2){record.handler("leave",null,dispatchAction2)}function doEnter(currTrigger,record,e2,dispatchAction2){record.handler(currTrigger,e2,dispatchAction2)}function unregister(key,api){if(!env.node){var zr=api.getZr();(inner$6(zr).records||{})[key]&&(inner$6(zr).records[key]=null)}}var AxisPointerView=function(_super){function AxisPointerView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=AxisPointerView2.type,_this}return __extends(AxisPointerView2,_super),AxisPointerView2.prototype.render=function(globalAxisPointerModel,ecModel,api){var globalTooltipModel=ecModel.getComponent("tooltip"),triggerOn=globalAxisPointerModel.get("triggerOn")||globalTooltipModel&&globalTooltipModel.get("triggerOn")||"mousemove|click";register("axisPointer",api,(function(currTrigger,e2,dispatchAction2){"none"!==triggerOn&&("leave"===currTrigger||triggerOn.indexOf(currTrigger)>=0)&&dispatchAction2({type:"updateAxisPointer",currTrigger:currTrigger,x:e2&&e2.offsetX,y:e2&&e2.offsetY})}))},AxisPointerView2.prototype.remove=function(ecModel,api){unregister("axisPointer",api)},AxisPointerView2.prototype.dispose=function(ecModel,api){unregister("axisPointer",api)},AxisPointerView2.type="axisPointer",AxisPointerView2}(ComponentView);function findPointFromSeries(finder,ecModel){var seriesModel,point=[],seriesIndex=finder.seriesIndex;if(null==seriesIndex||!(seriesModel=ecModel.getSeriesByIndex(seriesIndex)))return{point:[]};var data=seriesModel.getData(),dataIndex=queryDataIndex(data,finder);if(null==dataIndex||dataIndex<0||isArray$1(dataIndex))return{point:[]};var el=data.getItemGraphicEl(dataIndex),coordSys=seriesModel.coordinateSystem;if(seriesModel.getTooltipPosition)point=seriesModel.getTooltipPosition(dataIndex)||[];else if(coordSys&&coordSys.dataToPoint)if(finder.isStacked){var baseAxis=coordSys.getBaseAxis(),valueAxisDim=coordSys.getOtherAxis(baseAxis).dim,baseAxisDim=baseAxis.dim,baseDataOffset="x"===valueAxisDim||"radius"===valueAxisDim?1:0,baseDim=data.mapDimension(baseAxisDim),stackedData=[];stackedData[baseDataOffset]=data.get(baseDim,dataIndex),stackedData[1-baseDataOffset]=data.get(data.getCalculationInfo("stackResultDimension"),dataIndex),point=coordSys.dataToPoint(stackedData)||[]}else point=coordSys.dataToPoint(data.getValues(map$1(coordSys.dimensions,(function(dim){return data.mapDimension(dim)})),dataIndex))||[];else if(el){var rect=el.getBoundingRect().clone();rect.applyTransform(el.transform),point=[rect.x+rect.width/2,rect.y+rect.height/2]}return{point:point,el:el}}var inner$5=makeInner();function axisTrigger(payload,ecModel,api){var currTrigger=payload.currTrigger,point=[payload.x,payload.y],finder=payload,dispatchAction2=payload.dispatchAction||bind$1(api.dispatchAction,api),coordSysAxesInfo=ecModel.getComponent("axisPointer").coordSysAxesInfo;if(coordSysAxesInfo){illegalPoint(point)&&(point=findPointFromSeries({seriesIndex:finder.seriesIndex,dataIndex:finder.dataIndex},ecModel).point);var isIllegalPoint=illegalPoint(point),inputAxesInfo=finder.axesInfo,axesInfo=coordSysAxesInfo.axesInfo,shouldHide="leave"===currTrigger||illegalPoint(point),outputPayload={},showValueMap={},dataByCoordSys={list:[],map:{}},updaters={showPointer:curry$1(showPointer,showValueMap),showTooltip:curry$1(showTooltip,dataByCoordSys)};each$d(coordSysAxesInfo.coordSysMap,(function(coordSys,coordSysKey){var coordSysContainsPoint=isIllegalPoint||coordSys.containPoint(point);each$d(coordSysAxesInfo.coordSysAxesInfo[coordSysKey],(function(axisInfo,key){var axis=axisInfo.axis,inputAxisInfo=function(inputAxesInfo,axisInfo){for(var i=0;i<(inputAxesInfo||[]).length;i++){var inputAxisInfo=inputAxesInfo[i];if(axisInfo.axis.dim===inputAxisInfo.axisDim&&axisInfo.axis.model.componentIndex===inputAxisInfo.axisIndex)return inputAxisInfo}}(inputAxesInfo,axisInfo);if(!shouldHide&&coordSysContainsPoint&&(!inputAxesInfo||inputAxisInfo)){var val=inputAxisInfo&&inputAxisInfo.value;null!=val||isIllegalPoint||(val=axis.pointToData(point)),null!=val&&processOnAxis(axisInfo,val,updaters,!1,outputPayload)}}))}));var linkTriggers={};return each$d(axesInfo,(function(tarAxisInfo,tarKey){var linkGroup=tarAxisInfo.linkGroup;linkGroup&&!showValueMap[tarKey]&&each$d(linkGroup.axesInfo,(function(srcAxisInfo,srcKey){var srcValItem=showValueMap[srcKey];if(srcAxisInfo!==tarAxisInfo&&srcValItem){var val=srcValItem.value;linkGroup.mapper&&(val=tarAxisInfo.axis.scale.parse(linkGroup.mapper(val,makeMapperParam(srcAxisInfo),makeMapperParam(tarAxisInfo)))),linkTriggers[tarAxisInfo.key]=val}}))})),each$d(linkTriggers,(function(val,tarKey){processOnAxis(axesInfo[tarKey],val,updaters,!0,outputPayload)})),function(showValueMap,axesInfo,outputPayload){var outputAxesInfo=outputPayload.axesInfo=[];each$d(axesInfo,(function(axisInfo,key){var option=axisInfo.axisPointerModel.option,valItem=showValueMap[key];valItem?(!axisInfo.useHandle&&(option.status="show"),option.value=valItem.value,option.seriesDataIndices=(valItem.payloadBatch||[]).slice()):!axisInfo.useHandle&&(option.status="hide"),"show"===option.status&&outputAxesInfo.push({axisDim:axisInfo.axis.dim,axisIndex:axisInfo.axis.model.componentIndex,value:option.value})}))}(showValueMap,axesInfo,outputPayload),function(dataByCoordSys,point,payload,dispatchAction2){if(illegalPoint(point)||!dataByCoordSys.list.length)return void dispatchAction2({type:"hideTip"});var sampleItem=((dataByCoordSys.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};dispatchAction2({type:"showTip",escapeConnect:!0,x:point[0],y:point[1],tooltipOption:payload.tooltipOption,position:payload.position,dataIndexInside:sampleItem.dataIndexInside,dataIndex:sampleItem.dataIndex,seriesIndex:sampleItem.seriesIndex,dataByCoordSys:dataByCoordSys.list})}(dataByCoordSys,point,payload,dispatchAction2),function(axesInfo,dispatchAction2,api){var zr=api.getZr(),highDownKey="axisPointerLastHighlights",lastHighlights=inner$5(zr)[highDownKey]||{},newHighlights=inner$5(zr)[highDownKey]={};each$d(axesInfo,(function(axisInfo,key){var option=axisInfo.axisPointerModel.option;"show"===option.status&&axisInfo.triggerEmphasis&&each$d(option.seriesDataIndices,(function(batchItem){var key2=batchItem.seriesIndex+" | "+batchItem.dataIndex;newHighlights[key2]=batchItem}))}));var toHighlight=[],toDownplay=[];each$d(lastHighlights,(function(batchItem,key){!newHighlights[key]&&toDownplay.push(batchItem)})),each$d(newHighlights,(function(batchItem,key){!lastHighlights[key]&&toHighlight.push(batchItem)})),toDownplay.length&&api.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:toDownplay}),toHighlight.length&&api.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:toHighlight})}(axesInfo,0,api),outputPayload}}function processOnAxis(axisInfo,newValue,updaters,noSnap,outputFinder){var axis=axisInfo.axis;if(!axis.scale.isBlank()&&axis.containData(newValue))if(axisInfo.involveSeries){var payloadInfo=function(value,axisInfo){var axis=axisInfo.axis,dim=axis.dim,snapToValue=value,payloadBatch=[],minDist=Number.MAX_VALUE,minDiff=-1;return each$d(axisInfo.seriesModels,(function(series,idx){var seriesNestestValue,dataIndices,dataDim=series.getData().mapDimensionsAll(dim);if(series.getAxisTooltipData){var result=series.getAxisTooltipData(dataDim,value,axis);dataIndices=result.dataIndices,seriesNestestValue=result.nestestValue}else{if(!(dataIndices=series.getData().indicesOfNearest(dataDim[0],value,"category"===axis.type?.5:null)).length)return;seriesNestestValue=series.getData().get(dataDim[0],dataIndices[0])}if(null!=seriesNestestValue&&isFinite(seriesNestestValue)){var diff=value-seriesNestestValue,dist2=Math.abs(diff);dist2<=minDist&&((dist2<minDist||diff>=0&&minDiff<0)&&(minDist=dist2,minDiff=diff,snapToValue=seriesNestestValue,payloadBatch.length=0),each$d(dataIndices,(function(dataIndex){payloadBatch.push({seriesIndex:series.seriesIndex,dataIndexInside:dataIndex,dataIndex:series.getData().getRawIndex(dataIndex)})})))}})),{payloadBatch:payloadBatch,snapToValue:snapToValue}}(newValue,axisInfo),payloadBatch=payloadInfo.payloadBatch,snapToValue=payloadInfo.snapToValue;payloadBatch[0]&&null==outputFinder.seriesIndex&&extend(outputFinder,payloadBatch[0]),!noSnap&&axisInfo.snap&&axis.containData(snapToValue)&&null!=snapToValue&&(newValue=snapToValue),updaters.showPointer(axisInfo,newValue,payloadBatch),updaters.showTooltip(axisInfo,payloadInfo,snapToValue)}else updaters.showPointer(axisInfo,newValue)}function showPointer(showValueMap,axisInfo,value,payloadBatch){showValueMap[axisInfo.key]={value:value,payloadBatch:payloadBatch}}function showTooltip(dataByCoordSys,axisInfo,payloadInfo,value){var payloadBatch=payloadInfo.payloadBatch,axis=axisInfo.axis,axisModel=axis.model,axisPointerModel=axisInfo.axisPointerModel;if(axisInfo.triggerTooltip&&payloadBatch.length){var coordSysModel=axisInfo.coordSys.model,coordSysKey=makeKey(coordSysModel),coordSysItem=dataByCoordSys.map[coordSysKey];coordSysItem||(coordSysItem=dataByCoordSys.map[coordSysKey]={coordSysId:coordSysModel.id,coordSysIndex:coordSysModel.componentIndex,coordSysType:coordSysModel.type,coordSysMainType:coordSysModel.mainType,dataByAxis:[]},dataByCoordSys.list.push(coordSysItem)),coordSysItem.dataByAxis.push({axisDim:axis.dim,axisIndex:axisModel.componentIndex,axisType:axisModel.type,axisId:axisModel.id,value:value,valueLabelOpt:{precision:axisPointerModel.get(["label","precision"]),formatter:axisPointerModel.get(["label","formatter"])},seriesDataIndices:payloadBatch.slice()})}}function makeMapperParam(axisInfo){var axisModel=axisInfo.axis.model,item={},dim=item.axisDim=axisInfo.axis.dim;return item.axisIndex=item[dim+"AxisIndex"]=axisModel.componentIndex,item.axisName=item[dim+"AxisName"]=axisModel.name,item.axisId=item[dim+"AxisId"]=axisModel.id,item}function illegalPoint(point){return!point||null==point[0]||isNaN(point[0])||null==point[1]||isNaN(point[1])}function install$k(registers){AxisView.registerAxisPointerClass("CartesianAxisPointer",CartesianAxisPointer),registers.registerComponentModel(AxisPointerModel),registers.registerComponentView(AxisPointerView),registers.registerPreprocessor((function(option){if(option){(!option.axisPointer||0===option.axisPointer.length)&&(option.axisPointer={});var link=option.axisPointer.link;link&&!isArray$1(link)&&(option.axisPointer.link=[link])}})),registers.registerProcessor(registers.PRIORITY.PROCESSOR.STATISTIC,(function(ecModel,api){ecModel.getComponent("axisPointer").coordSysAxesInfo=collect(ecModel,api)})),registers.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},axisTrigger)}var PolarAxisPointer=function(_super){function PolarAxisPointer2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(PolarAxisPointer2,_super),PolarAxisPointer2.prototype.makeElOption=function(elOption,value,axisModel,axisPointerModel,api){var axis=axisModel.axis;"angle"===axis.dim&&(this.animationThreshold=Math.PI/18);var polar=axis.polar,otherExtent=polar.getOtherAxis(axis).getExtent(),coordValue=axis.dataToCoord(value),axisPointerType=axisPointerModel.get("type");if(axisPointerType&&"none"!==axisPointerType){var elStyle=buildElStyle(axisPointerModel),pointerOption=pointerShapeBuilder[axisPointerType](axis,polar,coordValue,otherExtent);pointerOption.style=elStyle,elOption.graphicKey=pointerOption.type,elOption.pointer=pointerOption}var labelPos=function(value,axisModel,axisPointerModel,polar,labelMargin){var axis=axisModel.axis,coord=axis.dataToCoord(value),axisAngle=polar.getAngleAxis().getExtent()[0];axisAngle=axisAngle/180*Math.PI;var position,align,verticalAlign,radiusExtent=polar.getRadiusAxis().getExtent();if("radius"===axis.dim){var transform=[1,0,0,1,0,0];rotate(transform,transform,axisAngle),translate(transform,transform,[polar.cx,polar.cy]),position=applyTransform([coord,-labelMargin],transform);var labelRotation=axisModel.getModel("axisLabel").get("rotate")||0,labelLayout=AxisBuilder.innerTextLayout(axisAngle,labelRotation*Math.PI/180,-1);align=labelLayout.textAlign,verticalAlign=labelLayout.textVerticalAlign}else{var r=radiusExtent[1];position=polar.coordToPoint([r+labelMargin,coord]);var cx=polar.cx,cy=polar.cy;align=Math.abs(position[0]-cx)/r<.3?"center":position[0]>cx?"left":"right",verticalAlign=Math.abs(position[1]-cy)/r<.3?"middle":position[1]>cy?"top":"bottom"}return{position:position,align:align,verticalAlign:verticalAlign}}(value,axisModel,0,polar,axisPointerModel.get(["label","margin"]));buildLabelElOption(elOption,axisModel,axisPointerModel,api,labelPos)},PolarAxisPointer2}(BaseAxisPointer);var pointerShapeBuilder={line:function(axis,polar,coordValue,otherExtent){return"angle"===axis.dim?{type:"Line",shape:makeLineShape(polar.coordToPoint([otherExtent[0],coordValue]),polar.coordToPoint([otherExtent[1],coordValue]))}:{type:"Circle",shape:{cx:polar.cx,cy:polar.cy,r:coordValue}}},shadow:function(axis,polar,coordValue,otherExtent){var bandWidth=Math.max(1,axis.getBandWidth()),radian=Math.PI/180;return"angle"===axis.dim?{type:"Sector",shape:makeSectorShape(polar.cx,polar.cy,otherExtent[0],otherExtent[1],(-coordValue-bandWidth/2)*radian,(bandWidth/2-coordValue)*radian)}:{type:"Sector",shape:makeSectorShape(polar.cx,polar.cy,coordValue-bandWidth/2,coordValue+bandWidth/2,0,2*Math.PI)}}},PolarModel=function(_super){function PolarModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=PolarModel2.type,_this}return __extends(PolarModel2,_super),PolarModel2.prototype.findAxisModel=function(axisType){var foundAxisModel;return this.ecModel.eachComponent(axisType,(function(axisModel){axisModel.getCoordSysModel()===this&&(foundAxisModel=axisModel)}),this),foundAxisModel},PolarModel2.type="polar",PolarModel2.dependencies=["radiusAxis","angleAxis"],PolarModel2.defaultOption={z:0,center:["50%","50%"],radius:"80%"},PolarModel2}(ComponentModel),PolarAxisModel=function(_super){function PolarAxisModel2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(PolarAxisModel2,_super),PolarAxisModel2.prototype.getCoordSysModel=function(){return this.getReferringComponents("polar",SINGLE_REFERRING).models[0]},PolarAxisModel2.type="polarAxis",PolarAxisModel2}(ComponentModel);mixin(PolarAxisModel,AxisModelCommonMixin);var AngleAxisModel=function(_super){function AngleAxisModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=AngleAxisModel2.type,_this}return __extends(AngleAxisModel2,_super),AngleAxisModel2.type="angleAxis",AngleAxisModel2}(PolarAxisModel),RadiusAxisModel=function(_super){function RadiusAxisModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=RadiusAxisModel2.type,_this}return __extends(RadiusAxisModel2,_super),RadiusAxisModel2.type="radiusAxis",RadiusAxisModel2}(PolarAxisModel),RadiusAxis=function(_super){function RadiusAxis2(scale2,radiusExtent){return _super.call(this,"radius",scale2,radiusExtent)||this}return __extends(RadiusAxis2,_super),RadiusAxis2.prototype.pointToData=function(point,clamp2){return this.polar.pointToData(point,clamp2)["radius"===this.dim?0:1]},RadiusAxis2}(Axis);RadiusAxis.prototype.dataToRadius=Axis.prototype.dataToCoord,RadiusAxis.prototype.radiusToData=Axis.prototype.coordToData;var inner$4=makeInner(),AngleAxis=function(_super){function AngleAxis2(scale2,angleExtent){return _super.call(this,"angle",scale2,angleExtent||[0,360])||this}return __extends(AngleAxis2,_super),AngleAxis2.prototype.pointToData=function(point,clamp2){return this.polar.pointToData(point,clamp2)["radius"===this.dim?0:1]},AngleAxis2.prototype.calculateCategoryInterval=function(){var labelModel=this.getLabelModel(),ordinalScale=this.scale,ordinalExtent=ordinalScale.getExtent(),tickCount=ordinalScale.count();if(ordinalExtent[1]-ordinalExtent[0]<1)return 0;var tickValue=ordinalExtent[0],unitSpan=this.dataToCoord(tickValue+1)-this.dataToCoord(tickValue),unitH=Math.abs(unitSpan),rect=getBoundingRect(null==tickValue?"":tickValue+"",labelModel.getFont(),"center","top"),dh=Math.max(rect.height,7)/unitH;isNaN(dh)&&(dh=Infinity);var interval=Math.max(0,Math.floor(dh)),cache=inner$4(this.model),lastAutoInterval=cache.lastAutoInterval,lastTickCount=cache.lastTickCount;return null!=lastAutoInterval&&null!=lastTickCount&&Math.abs(lastAutoInterval-interval)<=1&&Math.abs(lastTickCount-tickCount)<=1&&lastAutoInterval>interval?interval=lastAutoInterval:(cache.lastTickCount=tickCount,cache.lastAutoInterval=interval),interval},AngleAxis2}(Axis);AngleAxis.prototype.dataToAngle=Axis.prototype.dataToCoord,AngleAxis.prototype.angleToData=Axis.prototype.coordToData;var polarDimensions=["radius","angle"],Polar=function(){function Polar2(name){this.dimensions=polarDimensions,this.type="polar",this.cx=0,this.cy=0,this._radiusAxis=new RadiusAxis,this._angleAxis=new AngleAxis,this.axisPointerEnabled=!0,this.name=name||"",this._radiusAxis.polar=this._angleAxis.polar=this}return Polar2.prototype.containPoint=function(point){var coord=this.pointToCoord(point);return this._radiusAxis.contain(coord[0])&&this._angleAxis.contain(coord[1])},Polar2.prototype.containData=function(data){return this._radiusAxis.containData(data[0])&&this._angleAxis.containData(data[1])},Polar2.prototype.getAxis=function(dim){return this["_"+dim+"Axis"]},Polar2.prototype.getAxes=function(){return[this._radiusAxis,this._angleAxis]},Polar2.prototype.getAxesByScale=function(scaleType){var axes=[],angleAxis=this._angleAxis,radiusAxis=this._radiusAxis;return angleAxis.scale.type===scaleType&&axes.push(angleAxis),radiusAxis.scale.type===scaleType&&axes.push(radiusAxis),axes},Polar2.prototype.getAngleAxis=function(){return this._angleAxis},Polar2.prototype.getRadiusAxis=function(){return this._radiusAxis},Polar2.prototype.getOtherAxis=function(axis){var angleAxis=this._angleAxis;return axis===angleAxis?this._radiusAxis:angleAxis},Polar2.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},Polar2.prototype.getTooltipAxes=function(dim){var baseAxis=null!=dim&&"auto"!==dim?this.getAxis(dim):this.getBaseAxis();return{baseAxes:[baseAxis],otherAxes:[this.getOtherAxis(baseAxis)]}},Polar2.prototype.dataToPoint=function(data,clamp2){return this.coordToPoint([this._radiusAxis.dataToRadius(data[0],clamp2),this._angleAxis.dataToAngle(data[1],clamp2)])},Polar2.prototype.pointToData=function(point,clamp2){var coord=this.pointToCoord(point);return[this._radiusAxis.radiusToData(coord[0],clamp2),this._angleAxis.angleToData(coord[1],clamp2)]},Polar2.prototype.pointToCoord=function(point){var dx=point[0]-this.cx,dy=point[1]-this.cy,angleAxis=this.getAngleAxis(),extent3=angleAxis.getExtent(),minAngle=Math.min(extent3[0],extent3[1]),maxAngle=Math.max(extent3[0],extent3[1]);angleAxis.inverse?minAngle=maxAngle-360:maxAngle=minAngle+360;var radius=Math.sqrt(dx*dx+dy*dy);dx/=radius,dy/=radius;for(var radian=Math.atan2(-dy,dx)/Math.PI*180,dir3=radian<minAngle?1:-1;radian<minAngle||radian>maxAngle;)radian+=360*dir3;return[radius,radian]},Polar2.prototype.coordToPoint=function(coord){var radius=coord[0],radian=coord[1]/180*Math.PI;return[Math.cos(radian)*radius+this.cx,-Math.sin(radian)*radius+this.cy]},Polar2.prototype.getArea=function(){var angleAxis=this.getAngleAxis(),radiusExtent=this.getRadiusAxis().getExtent().slice();radiusExtent[0]>radiusExtent[1]&&radiusExtent.reverse();var angleExtent=angleAxis.getExtent(),RADIAN2=Math.PI/180;return{cx:this.cx,cy:this.cy,r0:radiusExtent[0],r:radiusExtent[1],startAngle:-angleExtent[0]*RADIAN2,endAngle:-angleExtent[1]*RADIAN2,clockwise:angleAxis.inverse,contain:function(x,y){var dx=x-this.cx,dy=y-this.cy,d2=dx*dx+dy*dy,r=this.r,r0=this.r0;return r!==r0&&d2-1e-4<=r*r&&d2+1e-4>=r0*r0}}},Polar2.prototype.convertToPixel=function(ecModel,finder,value){return getCoordSys$1(finder)===this?this.dataToPoint(value):null},Polar2.prototype.convertFromPixel=function(ecModel,finder,pixel){return getCoordSys$1(finder)===this?this.pointToData(pixel):null},Polar2}();function getCoordSys$1(finder){var seriesModel=finder.seriesModel,polarModel=finder.polarModel;return polarModel&&polarModel.coordinateSystem||seriesModel&&seriesModel.coordinateSystem}function updatePolarScale(ecModel,api){var polar=this,angleAxis=polar.getAngleAxis(),radiusAxis=polar.getRadiusAxis();if(angleAxis.scale.setExtent(Infinity,-Infinity),radiusAxis.scale.setExtent(Infinity,-Infinity),ecModel.eachSeries((function(seriesModel){if(seriesModel.coordinateSystem===polar){var data_1=seriesModel.getData();each$d(getDataDimensionsOnAxis(data_1,"radius"),(function(dim){radiusAxis.scale.unionExtentFromData(data_1,dim)})),each$d(getDataDimensionsOnAxis(data_1,"angle"),(function(dim){angleAxis.scale.unionExtentFromData(data_1,dim)}))}})),niceScaleExtent(angleAxis.scale,angleAxis.model),niceScaleExtent(radiusAxis.scale,radiusAxis.model),"category"===angleAxis.type&&!angleAxis.onBand){var extent3=angleAxis.getExtent(),diff=360/angleAxis.scale.count();angleAxis.inverse?extent3[1]+=diff:extent3[1]-=diff,angleAxis.setExtent(extent3[0],extent3[1])}}function setAxis(axis,axisModel){var _a2;if(axis.type=axisModel.get("type"),axis.scale=createScaleByModel$1(axisModel),axis.onBand=axisModel.get("boundaryGap")&&"category"===axis.type,axis.inverse=axisModel.get("inverse"),function(axisModel){return"angleAxis"===axisModel.mainType}(axisModel)){axis.inverse=axis.inverse!==axisModel.get("clockwise");var startAngle=axisModel.get("startAngle"),endAngle=null!==(_a2=axisModel.get("endAngle"))&&void 0!==_a2?_a2:startAngle+(axis.inverse?-360:360);axis.setExtent(startAngle,endAngle)}axisModel.axis=axis,axis.model=axisModel}var polarCreator={dimensions:polarDimensions,create:function(ecModel,api){var polarList=[];return ecModel.eachComponent("polar",(function(polarModel,idx){var polar=new Polar(idx+"");polar.update=updatePolarScale;var radiusAxis=polar.getRadiusAxis(),angleAxis=polar.getAngleAxis(),radiusAxisModel=polarModel.findAxisModel("radiusAxis"),angleAxisModel=polarModel.findAxisModel("angleAxis");setAxis(radiusAxis,radiusAxisModel),setAxis(angleAxis,angleAxisModel),function(polar,polarModel,api){var center2=polarModel.get("center"),width=api.getWidth(),height=api.getHeight();polar.cx=parsePercent(center2[0],width),polar.cy=parsePercent(center2[1],height);var radiusAxis=polar.getRadiusAxis(),size=Math.min(width,height)/2,radius=polarModel.get("radius");null==radius?radius=[0,"100%"]:isArray$1(radius)||(radius=[0,radius]);var parsedRadius=[parsePercent(radius[0],size),parsePercent(radius[1],size)];radiusAxis.inverse?radiusAxis.setExtent(parsedRadius[1],parsedRadius[0]):radiusAxis.setExtent(parsedRadius[0],parsedRadius[1])}(polar,polarModel,api),polarList.push(polar),polarModel.coordinateSystem=polar,polar.model=polarModel})),ecModel.eachSeries((function(seriesModel){if("polar"===seriesModel.get("coordinateSystem")){var polarModel=seriesModel.getReferringComponents("polar",SINGLE_REFERRING).models[0];seriesModel.coordinateSystem=polarModel.coordinateSystem}})),polarList}},elementList=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function getAxisLineShape(polar,rExtent,angle){rExtent[1]>rExtent[0]&&(rExtent=rExtent.slice().reverse());var start2=polar.coordToPoint([rExtent[0],angle]),end2=polar.coordToPoint([rExtent[1],angle]);return{x1:start2[0],y1:start2[1],x2:end2[0],y2:end2[1]}}function getRadiusIdx(polar){return polar.getRadiusAxis().inverse?0:1}function fixAngleOverlap(list){var firstItem=list[0],lastItem=list[list.length-1];firstItem&&lastItem&&Math.abs(Math.abs(firstItem.coord-lastItem.coord)-360)<1e-4&&list.pop()}var AngleAxisView=function(_super){function AngleAxisView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=AngleAxisView2.type,_this.axisPointerClass="PolarAxisPointer",_this}return __extends(AngleAxisView2,_super),AngleAxisView2.prototype.render=function(angleAxisModel,ecModel){if(this.group.removeAll(),angleAxisModel.get("show")){var angleAxis=angleAxisModel.axis,polar=angleAxis.polar,radiusExtent=polar.getRadiusAxis().getExtent(),ticksAngles=angleAxis.getTicksCoords(),minorTickAngles=angleAxis.getMinorTicksCoords(),labels=map$1(angleAxis.getViewLabels(),(function(labelItem){labelItem=clone$3(labelItem);var scale2=angleAxis.scale,tickValue="ordinal"===scale2.type?scale2.getRawOrdinalNumber(labelItem.tickValue):labelItem.tickValue;return labelItem.coord=angleAxis.dataToCoord(tickValue),labelItem}));fixAngleOverlap(labels),fixAngleOverlap(ticksAngles),each$d(elementList,(function(name){!angleAxisModel.get([name,"show"])||angleAxis.scale.isBlank()&&"axisLine"!==name||angelAxisElementsBuilders[name](this.group,angleAxisModel,polar,ticksAngles,minorTickAngles,radiusExtent,labels)}),this)}},AngleAxisView2.type="angleAxis",AngleAxisView2}(AxisView),angelAxisElementsBuilders={axisLine:function(group,angleAxisModel,polar,ticksAngles,minorTickAngles,radiusExtent){var shape,lineStyleModel=angleAxisModel.getModel(["axisLine","lineStyle"]),angleAxis=polar.getAngleAxis(),RADIAN2=Math.PI/180,angleExtent=angleAxis.getExtent(),rId=getRadiusIdx(polar),r0Id=rId?0:1,shapeType=360===Math.abs(angleExtent[1]-angleExtent[0])?"Circle":"Arc";(shape=0===radiusExtent[r0Id]?new graphic$1[shapeType]({shape:{cx:polar.cx,cy:polar.cy,r:radiusExtent[rId],startAngle:-angleExtent[0]*RADIAN2,endAngle:-angleExtent[1]*RADIAN2,clockwise:angleAxis.inverse},style:lineStyleModel.getLineStyle(),z2:1,silent:!0}):new Ring({shape:{cx:polar.cx,cy:polar.cy,r:radiusExtent[rId],r0:radiusExtent[r0Id]},style:lineStyleModel.getLineStyle(),z2:1,silent:!0})).style.fill=null,group.add(shape)},axisTick:function(group,angleAxisModel,polar,ticksAngles,minorTickAngles,radiusExtent){var tickModel=angleAxisModel.getModel("axisTick"),tickLen=(tickModel.get("inside")?-1:1)*tickModel.get("length"),radius=radiusExtent[getRadiusIdx(polar)],lines=map$1(ticksAngles,(function(tickAngleItem){return new Line({shape:getAxisLineShape(polar,[radius,radius+tickLen],tickAngleItem.coord)})}));group.add(mergePath(lines,{style:defaults(tickModel.getModel("lineStyle").getLineStyle(),{stroke:angleAxisModel.get(["axisLine","lineStyle","color"])})}))},minorTick:function(group,angleAxisModel,polar,tickAngles,minorTickAngles,radiusExtent){if(minorTickAngles.length){for(var tickModel=angleAxisModel.getModel("axisTick"),minorTickModel=angleAxisModel.getModel("minorTick"),tickLen=(tickModel.get("inside")?-1:1)*minorTickModel.get("length"),radius=radiusExtent[getRadiusIdx(polar)],lines=[],i=0;i<minorTickAngles.length;i++)for(var k=0;k<minorTickAngles[i].length;k++)lines.push(new Line({shape:getAxisLineShape(polar,[radius,radius+tickLen],minorTickAngles[i][k].coord)}));group.add(mergePath(lines,{style:defaults(minorTickModel.getModel("lineStyle").getLineStyle(),defaults(tickModel.getLineStyle(),{stroke:angleAxisModel.get(["axisLine","lineStyle","color"])}))}))}},axisLabel:function(group,angleAxisModel,polar,ticksAngles,minorTickAngles,radiusExtent,labels){var rawCategoryData=angleAxisModel.getCategories(!0),commonLabelModel=angleAxisModel.getModel("axisLabel"),labelMargin=commonLabelModel.get("margin"),triggerEvent=angleAxisModel.get("triggerEvent");each$d(labels,(function(labelItem,idx){var labelModel=commonLabelModel,tickValue=labelItem.tickValue,r=radiusExtent[getRadiusIdx(polar)],p=polar.coordToPoint([r+labelMargin,labelItem.coord]),cx=polar.cx,cy=polar.cy,labelTextAlign=Math.abs(p[0]-cx)/r<.3?"center":p[0]>cx?"left":"right",labelTextVerticalAlign=Math.abs(p[1]-cy)/r<.3?"middle":p[1]>cy?"top":"bottom";if(rawCategoryData&&rawCategoryData[tickValue]){var rawCategoryItem=rawCategoryData[tickValue];isObject$3(rawCategoryItem)&&rawCategoryItem.textStyle&&(labelModel=new Model(rawCategoryItem.textStyle,commonLabelModel,commonLabelModel.ecModel))}var textEl=new ZRText({silent:AxisBuilder.isLabelSilent(angleAxisModel),style:createTextStyle$1(labelModel,{x:p[0],y:p[1],fill:labelModel.getTextColor()||angleAxisModel.get(["axisLine","lineStyle","color"]),text:labelItem.formattedLabel,align:labelTextAlign,verticalAlign:labelTextVerticalAlign})});if(group.add(textEl),triggerEvent){var eventData=AxisBuilder.makeAxisEventDataBase(angleAxisModel);eventData.targetType="axisLabel",eventData.value=labelItem.rawLabel,getECData(textEl).eventData=eventData}}),this)},splitLine:function(group,angleAxisModel,polar,ticksAngles,minorTickAngles,radiusExtent){var lineStyleModel=angleAxisModel.getModel("splitLine").getModel("lineStyle"),lineColors=lineStyleModel.get("color"),lineCount=0;lineColors=lineColors instanceof Array?lineColors:[lineColors];for(var splitLines=[],i=0;i<ticksAngles.length;i++){var colorIndex=lineCount++%lineColors.length;splitLines[colorIndex]=splitLines[colorIndex]||[],splitLines[colorIndex].push(new Line({shape:getAxisLineShape(polar,radiusExtent,ticksAngles[i].coord)}))}for(i=0;i<splitLines.length;i++)group.add(mergePath(splitLines[i],{style:defaults({stroke:lineColors[i%lineColors.length]},lineStyleModel.getLineStyle()),silent:!0,z:angleAxisModel.get("z")}))},minorSplitLine:function(group,angleAxisModel,polar,ticksAngles,minorTickAngles,radiusExtent){if(minorTickAngles.length){for(var lineStyleModel=angleAxisModel.getModel("minorSplitLine").getModel("lineStyle"),lines=[],i=0;i<minorTickAngles.length;i++)for(var k=0;k<minorTickAngles[i].length;k++)lines.push(new Line({shape:getAxisLineShape(polar,radiusExtent,minorTickAngles[i][k].coord)}));group.add(mergePath(lines,{style:lineStyleModel.getLineStyle(),silent:!0,z:angleAxisModel.get("z")}))}},splitArea:function(group,angleAxisModel,polar,ticksAngles,minorTickAngles,radiusExtent){if(ticksAngles.length){var areaStyleModel=angleAxisModel.getModel("splitArea").getModel("areaStyle"),areaColors=areaStyleModel.get("color"),lineCount=0;areaColors=areaColors instanceof Array?areaColors:[areaColors];for(var splitAreas=[],RADIAN2=Math.PI/180,prevAngle=-ticksAngles[0].coord*RADIAN2,r0=Math.min(radiusExtent[0],radiusExtent[1]),r1=Math.max(radiusExtent[0],radiusExtent[1]),clockwise=angleAxisModel.get("clockwise"),i=1,len2=ticksAngles.length;i<=len2;i++){var coord=i===len2?ticksAngles[0].coord:ticksAngles[i].coord,colorIndex=lineCount++%areaColors.length;splitAreas[colorIndex]=splitAreas[colorIndex]||[],splitAreas[colorIndex].push(new Sector({shape:{cx:polar.cx,cy:polar.cy,r0:r0,r:r1,startAngle:prevAngle,endAngle:-coord*RADIAN2,clockwise:clockwise},silent:!0})),prevAngle=-coord*RADIAN2}for(i=0;i<splitAreas.length;i++)group.add(mergePath(splitAreas[i],{style:defaults({fill:areaColors[i%areaColors.length]},areaStyleModel.getAreaStyle()),silent:!0}))}}},axisBuilderAttrs=["axisLine","axisTickLabel","axisName"],selfBuilderAttrs=["splitLine","splitArea","minorSplitLine"],RadiusAxisView=function(_super){function RadiusAxisView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=RadiusAxisView2.type,_this.axisPointerClass="PolarAxisPointer",_this}return __extends(RadiusAxisView2,_super),RadiusAxisView2.prototype.render=function(radiusAxisModel,ecModel){if(this.group.removeAll(),radiusAxisModel.get("show")){var oldAxisGroup=this._axisGroup,newAxisGroup=this._axisGroup=new Group$2;this.group.add(newAxisGroup);var radiusAxis=radiusAxisModel.axis,polar=radiusAxis.polar,angleAxis=polar.getAngleAxis(),ticksCoords=radiusAxis.getTicksCoords(),minorTicksCoords=radiusAxis.getMinorTicksCoords(),axisAngle=angleAxis.getExtent()[0],radiusExtent=radiusAxis.getExtent(),layout2=function(polar,radiusAxisModel,axisAngle){return{position:[polar.cx,polar.cy],rotation:axisAngle/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:radiusAxisModel.getModel("axisLabel").get("rotate"),z2:1}}(polar,radiusAxisModel,axisAngle),axisBuilder=new AxisBuilder(radiusAxisModel,layout2);each$d(axisBuilderAttrs,axisBuilder.add,axisBuilder),newAxisGroup.add(axisBuilder.getGroup()),groupTransition(oldAxisGroup,newAxisGroup,radiusAxisModel),each$d(selfBuilderAttrs,(function(name){radiusAxisModel.get([name,"show"])&&!radiusAxis.scale.isBlank()&&axisElementBuilders[name](this.group,radiusAxisModel,polar,axisAngle,radiusExtent,ticksCoords,minorTicksCoords)}),this)}},RadiusAxisView2.type="radiusAxis",RadiusAxisView2}(AxisView),axisElementBuilders={splitLine:function(group,radiusAxisModel,polar,axisAngle,radiusExtent,ticksCoords){var lineStyleModel=radiusAxisModel.getModel("splitLine").getModel("lineStyle"),lineColors=lineStyleModel.get("color"),lineCount=0,angleAxis=polar.getAngleAxis(),RADIAN2=Math.PI/180,angleExtent=angleAxis.getExtent(),shapeType=360===Math.abs(angleExtent[1]-angleExtent[0])?"Circle":"Arc";lineColors=lineColors instanceof Array?lineColors:[lineColors];for(var splitLines=[],i=0;i<ticksCoords.length;i++){var colorIndex=lineCount++%lineColors.length;splitLines[colorIndex]=splitLines[colorIndex]||[],splitLines[colorIndex].push(new graphic$1[shapeType]({shape:{cx:polar.cx,cy:polar.cy,r:Math.max(ticksCoords[i].coord,0),startAngle:-angleExtent[0]*RADIAN2,endAngle:-angleExtent[1]*RADIAN2,clockwise:angleAxis.inverse}}))}for(i=0;i<splitLines.length;i++)group.add(mergePath(splitLines[i],{style:defaults({stroke:lineColors[i%lineColors.length],fill:null},lineStyleModel.getLineStyle()),silent:!0}))},minorSplitLine:function(group,radiusAxisModel,polar,axisAngle,radiusExtent,ticksCoords,minorTicksCoords){if(minorTicksCoords.length){for(var lineStyleModel=radiusAxisModel.getModel("minorSplitLine").getModel("lineStyle"),lines=[],i=0;i<minorTicksCoords.length;i++)for(var k=0;k<minorTicksCoords[i].length;k++)lines.push(new Circle({shape:{cx:polar.cx,cy:polar.cy,r:minorTicksCoords[i][k].coord}}));group.add(mergePath(lines,{style:defaults({fill:null},lineStyleModel.getLineStyle()),silent:!0}))}},splitArea:function(group,radiusAxisModel,polar,axisAngle,radiusExtent,ticksCoords){if(ticksCoords.length){var areaStyleModel=radiusAxisModel.getModel("splitArea").getModel("areaStyle"),areaColors=areaStyleModel.get("color"),lineCount=0;areaColors=areaColors instanceof Array?areaColors:[areaColors];for(var splitAreas=[],prevRadius=ticksCoords[0].coord,i=1;i<ticksCoords.length;i++){var colorIndex=lineCount++%areaColors.length;splitAreas[colorIndex]=splitAreas[colorIndex]||[],splitAreas[colorIndex].push(new Sector({shape:{cx:polar.cx,cy:polar.cy,r0:prevRadius,r:ticksCoords[i].coord,startAngle:0,endAngle:2*Math.PI},silent:!0})),prevRadius=ticksCoords[i].coord}for(i=0;i<splitAreas.length;i++)group.add(mergePath(splitAreas[i],{style:defaults({fill:areaColors[i%areaColors.length]},areaStyleModel.getAreaStyle()),silent:!0}))}}};function getSeriesStackId(seriesModel){return seriesModel.get("stack")||"__ec_stack_"+seriesModel.seriesIndex}function getAxisKey(polar,axis){return axis.dim+polar.model.componentIndex}function barLayoutPolar(seriesType2,ecModel,api){var lastStackCoords={},barWidthAndOffset=function(barSeries){var columnsMap={};each$d(barSeries,(function(seriesModel,idx){var data=seriesModel.getData(),polar=seriesModel.coordinateSystem,baseAxis=polar.getBaseAxis(),axisKey=getAxisKey(polar,baseAxis),axisExtent=baseAxis.getExtent(),bandWidth="category"===baseAxis.type?baseAxis.getBandWidth():Math.abs(axisExtent[1]-axisExtent[0])/data.count(),columnsOnAxis=columnsMap[axisKey]||{bandWidth:bandWidth,remainedWidth:bandWidth,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},stacks=columnsOnAxis.stacks;columnsMap[axisKey]=columnsOnAxis;var stackId=getSeriesStackId(seriesModel);stacks[stackId]||columnsOnAxis.autoWidthCount++,stacks[stackId]=stacks[stackId]||{width:0,maxWidth:0};var barWidth=parsePercent(seriesModel.get("barWidth"),bandWidth),barMaxWidth=parsePercent(seriesModel.get("barMaxWidth"),bandWidth),barGap=seriesModel.get("barGap"),barCategoryGap=seriesModel.get("barCategoryGap");barWidth&&!stacks[stackId].width&&(barWidth=Math.min(columnsOnAxis.remainedWidth,barWidth),stacks[stackId].width=barWidth,columnsOnAxis.remainedWidth-=barWidth),barMaxWidth&&(stacks[stackId].maxWidth=barMaxWidth),null!=barGap&&(columnsOnAxis.gap=barGap),null!=barCategoryGap&&(columnsOnAxis.categoryGap=barCategoryGap)}));var result={};return each$d(columnsMap,(function(columnsOnAxis,coordSysName){result[coordSysName]={};var stacks=columnsOnAxis.stacks,bandWidth=columnsOnAxis.bandWidth,categoryGap=parsePercent(columnsOnAxis.categoryGap,bandWidth),barGapPercent=parsePercent(columnsOnAxis.gap,1),remainedWidth=columnsOnAxis.remainedWidth,autoWidthCount=columnsOnAxis.autoWidthCount,autoWidth=(remainedWidth-categoryGap)/(autoWidthCount+(autoWidthCount-1)*barGapPercent);autoWidth=Math.max(autoWidth,0),each$d(stacks,(function(column,stack){var maxWidth=column.maxWidth;maxWidth&&maxWidth<autoWidth&&(maxWidth=Math.min(maxWidth,remainedWidth),column.width&&(maxWidth=Math.min(maxWidth,column.width)),remainedWidth-=maxWidth,column.width=maxWidth,autoWidthCount--)})),autoWidth=(remainedWidth-categoryGap)/(autoWidthCount+(autoWidthCount-1)*barGapPercent),autoWidth=Math.max(autoWidth,0);var lastColumn,widthSum=0;each$d(stacks,(function(column,idx){column.width||(column.width=autoWidth),lastColumn=column,widthSum+=column.width*(1+barGapPercent)})),lastColumn&&(widthSum-=lastColumn.width*barGapPercent);var offset=-widthSum/2;each$d(stacks,(function(column,stackId){result[coordSysName][stackId]=result[coordSysName][stackId]||{offset:offset,width:column.width},offset+=column.width*(1+barGapPercent)}))})),result}(filter(ecModel.getSeriesByType(seriesType2),(function(seriesModel){return!ecModel.isSeriesFiltered(seriesModel)&&seriesModel.coordinateSystem&&"polar"===seriesModel.coordinateSystem.type})));ecModel.eachSeriesByType(seriesType2,(function(seriesModel){if("polar"===seriesModel.coordinateSystem.type){var data=seriesModel.getData(),polar=seriesModel.coordinateSystem,baseAxis=polar.getBaseAxis(),axisKey=getAxisKey(polar,baseAxis),stackId=getSeriesStackId(seriesModel),columnLayoutInfo=barWidthAndOffset[axisKey][stackId],columnOffset=columnLayoutInfo.offset,columnWidth=columnLayoutInfo.width,valueAxis2=polar.getOtherAxis(baseAxis),cx=seriesModel.coordinateSystem.cx,cy=seriesModel.coordinateSystem.cy,barMinHeight=seriesModel.get("barMinHeight")||0,barMinAngle=seriesModel.get("barMinAngle")||0;lastStackCoords[stackId]=lastStackCoords[stackId]||[];for(var valueDim=data.mapDimension(valueAxis2.dim),baseDim=data.mapDimension(baseAxis.dim),stacked=isDimensionStacked(data,valueDim),clampLayout="radius"!==baseAxis.dim||!seriesModel.get("roundCap",!0),startValue=valueAxis2.model.get("startValue"),valueAxisStart=valueAxis2.dataToCoord(startValue||0),idx=0,len2=data.count();idx<len2;idx++){var value=data.get(valueDim,idx),baseValue=data.get(baseDim,idx),sign=value>=0?"p":"n",baseCoord=valueAxisStart;stacked&&(lastStackCoords[stackId][baseValue]||(lastStackCoords[stackId][baseValue]={p:valueAxisStart,n:valueAxisStart}),baseCoord=lastStackCoords[stackId][baseValue][sign]);var r0=void 0,r=void 0,startAngle=void 0,endAngle=void 0;if("radius"===valueAxis2.dim){var radiusSpan=valueAxis2.dataToCoord(value)-valueAxisStart,angle=baseAxis.dataToCoord(baseValue);Math.abs(radiusSpan)<barMinHeight&&(radiusSpan=(radiusSpan<0?-1:1)*barMinHeight),r0=baseCoord,r=baseCoord+radiusSpan,endAngle=(startAngle=angle-columnOffset)-columnWidth,stacked&&(lastStackCoords[stackId][baseValue][sign]=r)}else{var angleSpan=valueAxis2.dataToCoord(value,clampLayout)-valueAxisStart,radius=baseAxis.dataToCoord(baseValue);Math.abs(angleSpan)<barMinAngle&&(angleSpan=(angleSpan<0?-1:1)*barMinAngle),r=(r0=radius+columnOffset)+columnWidth,startAngle=baseCoord,endAngle=baseCoord+angleSpan,stacked&&(lastStackCoords[stackId][baseValue][sign]=endAngle)}data.setItemLayout(idx,{cx:cx,cy:cy,r0:r0,r:r,startAngle:-startAngle*Math.PI/180,endAngle:-endAngle*Math.PI/180,clockwise:startAngle>=endAngle})}}}))}var angleAxisExtraOption={startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:0}},radiusAxisExtraOption={splitNumber:5},PolarView=function(_super){function PolarView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=PolarView2.type,_this}return __extends(PolarView2,_super),PolarView2.type="polar",PolarView2}(ComponentView);var CalendarModel=function(_super){function CalendarModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=CalendarModel2.type,_this}return __extends(CalendarModel2,_super),CalendarModel2.prototype.init=function(option,parentModel,ecModel){var inputPositionParams=getLayoutParams(option);_super.prototype.init.apply(this,arguments),mergeAndNormalizeLayoutParams$1(option,inputPositionParams)},CalendarModel2.prototype.mergeOption=function(option){_super.prototype.mergeOption.apply(this,arguments),mergeAndNormalizeLayoutParams$1(this.option,option)},CalendarModel2.prototype.getCellSize=function(){return this.option.cellSize},CalendarModel2.type="calendar",CalendarModel2.defaultOption={z:2,left:80,top:60,cellSize:20,orient:"horizontal",splitLine:{show:!0,lineStyle:{color:"#000",width:1,type:"solid"}},itemStyle:{color:"#fff",borderWidth:1,borderColor:"#ccc"},dayLabel:{show:!0,firstDay:0,position:"start",margin:"50%",color:"#000"},monthLabel:{show:!0,position:"start",margin:5,align:"center",formatter:null,color:"#000"},yearLabel:{show:!0,position:null,margin:30,formatter:null,color:"#ccc",fontFamily:"sans-serif",fontWeight:"bolder",fontSize:20}},CalendarModel2}(ComponentModel);function mergeAndNormalizeLayoutParams$1(target,raw){var cellSizeArr,cellSize=target.cellSize;1===(cellSizeArr=isArray$1(cellSize)?cellSize:target.cellSize=[cellSize,cellSize]).length&&(cellSizeArr[1]=cellSizeArr[0]);var ignoreSize=map$1([0,1],(function(hvIdx){return function(option,hvIdx){return null!=option[HV_NAMES[hvIdx][0]]||null!=option[HV_NAMES[hvIdx][1]]&&null!=option[HV_NAMES[hvIdx][2]]}(raw,hvIdx)&&(cellSizeArr[hvIdx]="auto"),null!=cellSizeArr[hvIdx]&&"auto"!==cellSizeArr[hvIdx]}));mergeLayoutParam(target,raw,{type:"box",ignoreSize:ignoreSize})}var CalendarView=function(_super){function CalendarView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=CalendarView2.type,_this}return __extends(CalendarView2,_super),CalendarView2.prototype.render=function(calendarModel,ecModel,api){var group=this.group;group.removeAll();var coordSys=calendarModel.coordinateSystem,rangeData=coordSys.getRangeInfo(),orient=coordSys.getOrient(),localeModel=ecModel.getLocaleModel();this._renderDayRect(calendarModel,rangeData,group),this._renderLines(calendarModel,rangeData,orient,group),this._renderYearText(calendarModel,rangeData,orient,group),this._renderMonthText(calendarModel,localeModel,orient,group),this._renderWeekText(calendarModel,localeModel,rangeData,orient,group)},CalendarView2.prototype._renderDayRect=function(calendarModel,rangeData,group){for(var coordSys=calendarModel.coordinateSystem,itemRectStyleModel=calendarModel.getModel("itemStyle").getItemStyle(),sw=coordSys.getCellWidth(),sh=coordSys.getCellHeight(),i=rangeData.start.time;i<=rangeData.end.time;i=coordSys.getNextNDay(i,1).time){var point=coordSys.dataToRect([i],!1).tl,rect=new Rect$1({shape:{x:point[0],y:point[1],width:sw,height:sh},cursor:"default",style:itemRectStyleModel});group.add(rect)}},CalendarView2.prototype._renderLines=function(calendarModel,rangeData,orient,group){var self2=this,coordSys=calendarModel.coordinateSystem,lineStyleModel=calendarModel.getModel(["splitLine","lineStyle"]).getLineStyle(),show=calendarModel.get(["splitLine","show"]),lineWidth=lineStyleModel.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var firstDay=rangeData.start,i=0;firstDay.time<=rangeData.end.time;i++){addPoints(firstDay.formatedDate),0===i&&(firstDay=coordSys.getDateInfo(rangeData.start.y+"-"+rangeData.start.m));var date=firstDay.date;date.setMonth(date.getMonth()+1),firstDay=coordSys.getDateInfo(date)}function addPoints(date2){self2._firstDayOfMonth.push(coordSys.getDateInfo(date2)),self2._firstDayPoints.push(coordSys.dataToRect([date2],!1).tl);var points2=self2._getLinePointsOfOneWeek(calendarModel,date2,orient);self2._tlpoints.push(points2[0]),self2._blpoints.push(points2[points2.length-1]),show&&self2._drawSplitline(points2,lineStyleModel,group)}addPoints(coordSys.getNextNDay(rangeData.end.time,1).formatedDate),show&&this._drawSplitline(self2._getEdgesPoints(self2._tlpoints,lineWidth,orient),lineStyleModel,group),show&&this._drawSplitline(self2._getEdgesPoints(self2._blpoints,lineWidth,orient),lineStyleModel,group)},CalendarView2.prototype._getEdgesPoints=function(points2,lineWidth,orient){var rs=[points2[0].slice(),points2[points2.length-1].slice()],idx="horizontal"===orient?0:1;return rs[0][idx]=rs[0][idx]-lineWidth/2,rs[1][idx]=rs[1][idx]+lineWidth/2,rs},CalendarView2.prototype._drawSplitline=function(points2,lineStyle,group){var poyline=new Polyline({z2:20,shape:{points:points2},style:lineStyle});group.add(poyline)},CalendarView2.prototype._getLinePointsOfOneWeek=function(calendarModel,date,orient){for(var coordSys=calendarModel.coordinateSystem,parsedDate=coordSys.getDateInfo(date),points2=[],i=0;i<7;i++){var tmpD=coordSys.getNextNDay(parsedDate.time,i),point=coordSys.dataToRect([tmpD.time],!1);points2[2*tmpD.day]=point.tl,points2[2*tmpD.day+1]=point["horizontal"===orient?"bl":"tr"]}return points2},CalendarView2.prototype._formatterLabel=function(formatter,params){return isString(formatter)&&formatter?(tpl=formatter,each$d(params,(function(value,key){tpl=tpl.replace("{"+key+"}",value)})),tpl):isFunction(formatter)?formatter(params):params.nameMap;var tpl},CalendarView2.prototype._yearTextPositionControl=function(textEl,point,orient,position,margin){var x=point[0],y=point[1],aligns=["center","bottom"];"bottom"===position?(y+=margin,aligns=["center","top"]):"left"===position?x-=margin:"right"===position?(x+=margin,aligns=["center","top"]):y-=margin;var rotate2=0;return"left"!==position&&"right"!==position||(rotate2=Math.PI/2),{rotation:rotate2,x:x,y:y,style:{align:aligns[0],verticalAlign:aligns[1]}}},CalendarView2.prototype._renderYearText=function(calendarModel,rangeData,orient,group){var yearLabel=calendarModel.getModel("yearLabel");if(yearLabel.get("show")){var margin=yearLabel.get("margin"),pos=yearLabel.get("position");pos||(pos="horizontal"!==orient?"top":"left");var points2=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]],xc=(points2[0][0]+points2[1][0])/2,yc=(points2[0][1]+points2[1][1])/2,idx="horizontal"===orient?0:1,posPoints={top:[xc,points2[idx][1]],bottom:[xc,points2[1-idx][1]],left:[points2[1-idx][0],yc],right:[points2[idx][0],yc]},name=rangeData.start.y;+rangeData.end.y>+rangeData.start.y&&(name=name+"-"+rangeData.end.y);var formatter=yearLabel.get("formatter"),params={start:rangeData.start.y,end:rangeData.end.y,nameMap:name},content=this._formatterLabel(formatter,params),yearText=new ZRText({z2:30,style:createTextStyle$1(yearLabel,{text:content}),silent:yearLabel.get("silent")});yearText.attr(this._yearTextPositionControl(yearText,posPoints[pos],orient,pos,margin)),group.add(yearText)}},CalendarView2.prototype._monthTextPositionControl=function(point,isCenter,orient,position,margin){var align="left",vAlign="top",x=point[0],y=point[1];return"horizontal"===orient?(y+=margin,isCenter&&(align="center"),"start"===position&&(vAlign="bottom")):(x+=margin,isCenter&&(vAlign="middle"),"start"===position&&(align="right")),{x:x,y:y,align:align,verticalAlign:vAlign}},CalendarView2.prototype._renderMonthText=function(calendarModel,localeModel,orient,group){var monthLabel=calendarModel.getModel("monthLabel");if(monthLabel.get("show")){var nameMap=monthLabel.get("nameMap"),margin=monthLabel.get("margin"),pos=monthLabel.get("position"),align=monthLabel.get("align"),termPoints=[this._tlpoints,this._blpoints];nameMap&&!isString(nameMap)||(nameMap&&(localeModel=getLocaleModel(nameMap)||localeModel),nameMap=localeModel.get(["time","monthAbbr"])||[]);var idx="start"===pos?0:1,axis="horizontal"===orient?0:1;margin="start"===pos?-margin:margin;for(var isCenter="center"===align,labelSilent=monthLabel.get("silent"),i=0;i<termPoints[idx].length-1;i++){var tmp=termPoints[idx][i].slice(),firstDay=this._firstDayOfMonth[i];if(isCenter){var firstDayPoints=this._firstDayPoints[i];tmp[axis]=(firstDayPoints[axis]+termPoints[0][i+1][axis])/2}var formatter=monthLabel.get("formatter"),name_1=nameMap[+firstDay.m-1],params={yyyy:firstDay.y,yy:(firstDay.y+"").slice(2),MM:firstDay.m,M:+firstDay.m,nameMap:name_1},content=this._formatterLabel(formatter,params),monthText=new ZRText({z2:30,style:extend(createTextStyle$1(monthLabel,{text:content}),this._monthTextPositionControl(tmp,isCenter,orient,pos,margin)),silent:labelSilent});group.add(monthText)}}},CalendarView2.prototype._weekTextPositionControl=function(point,orient,position,margin,cellSize){var align="center",vAlign="middle",x=point[0],y=point[1],isStart="start"===position;return"horizontal"===orient?(x=x+margin+(isStart?1:-1)*cellSize[0]/2,align=isStart?"right":"left"):(y=y+margin+(isStart?1:-1)*cellSize[1]/2,vAlign=isStart?"bottom":"top"),{x:x,y:y,align:align,verticalAlign:vAlign}},CalendarView2.prototype._renderWeekText=function(calendarModel,localeModel,rangeData,orient,group){var dayLabel=calendarModel.getModel("dayLabel");if(dayLabel.get("show")){var coordSys=calendarModel.coordinateSystem,pos=dayLabel.get("position"),nameMap=dayLabel.get("nameMap"),margin=dayLabel.get("margin"),firstDayOfWeek=coordSys.getFirstDayOfWeek();if(!nameMap||isString(nameMap))nameMap&&(localeModel=getLocaleModel(nameMap)||localeModel),nameMap=localeModel.get(["time","dayOfWeekShort"])||map$1(localeModel.get(["time","dayOfWeekAbbr"]),(function(val){return val[0]}));var start2=coordSys.getNextNDay(rangeData.end.time,7-rangeData.lweek).time,cellSize=[coordSys.getCellWidth(),coordSys.getCellHeight()];margin=parsePercent(margin,Math.min(cellSize[1],cellSize[0])),"start"===pos&&(start2=coordSys.getNextNDay(rangeData.start.time,-(7+rangeData.fweek)).time,margin=-margin);for(var labelSilent=dayLabel.get("silent"),i=0;i<7;i++){var day,tmpD=coordSys.getNextNDay(start2,i),point=coordSys.dataToRect([tmpD.time],!1).center;day=Math.abs((i+firstDayOfWeek)%7);var weekText=new ZRText({z2:30,style:extend(createTextStyle$1(dayLabel,{text:nameMap[day]}),this._weekTextPositionControl(point,orient,pos,margin,cellSize)),silent:labelSilent});group.add(weekText)}}},CalendarView2.type="calendar",CalendarView2}(ComponentView),Calendar=function(){function Calendar2(calendarModel,ecModel,api){this.type="calendar",this.dimensions=Calendar2.dimensions,this.getDimensionsInfo=Calendar2.getDimensionsInfo,this._model=calendarModel}return Calendar2.getDimensionsInfo=function(){return[{name:"time",type:"time"},"value"]},Calendar2.prototype.getRangeInfo=function(){return this._rangeInfo},Calendar2.prototype.getModel=function(){return this._model},Calendar2.prototype.getRect=function(){return this._rect},Calendar2.prototype.getCellWidth=function(){return this._sw},Calendar2.prototype.getCellHeight=function(){return this._sh},Calendar2.prototype.getOrient=function(){return this._orient},Calendar2.prototype.getFirstDayOfWeek=function(){return this._firstDayOfWeek},Calendar2.prototype.getDateInfo=function(date){var y=(date=parseDate(date)).getFullYear(),m2=date.getMonth()+1,mStr=m2<10?"0"+m2:""+m2,d=date.getDate(),dStr=d<10?"0"+d:""+d,day=date.getDay();return{y:y+"",m:mStr,d:dStr,day:day=Math.abs((day+7-this.getFirstDayOfWeek())%7),time:date.getTime(),formatedDate:y+"-"+mStr+"-"+dStr,date:date}},Calendar2.prototype.getNextNDay=function(date,n){return 0===(n=n||0)||(date=new Date(this.getDateInfo(date).time)).setDate(date.getDate()+n),this.getDateInfo(date)},Calendar2.prototype.update=function(ecModel,api){this._firstDayOfWeek=+this._model.getModel("dayLabel").get("firstDay"),this._orient=this._model.get("orient"),this._lineWidth=this._model.getModel("itemStyle").getItemStyle().lineWidth||0,this._rangeInfo=this._getRangeInfo(this._initRangeOption());var weeks=this._rangeInfo.weeks||1,whNames=["width","height"],cellSize=this._model.getCellSize().slice(),layoutParams=this._model.getBoxLayoutParams(),cellNumbers="horizontal"===this._orient?[weeks,7]:[7,weeks];each$d([0,1],(function(idx){cellSizeSpecified(cellSize,idx)&&(layoutParams[whNames[idx]]=cellSize[idx]*cellNumbers[idx])}));var whGlobal={width:api.getWidth(),height:api.getHeight()},calendarRect=this._rect=getLayoutRect(layoutParams,whGlobal);function cellSizeSpecified(cellSize2,idx){return null!=cellSize2[idx]&&"auto"!==cellSize2[idx]}each$d([0,1],(function(idx){cellSizeSpecified(cellSize,idx)||(cellSize[idx]=calendarRect[whNames[idx]]/cellNumbers[idx])})),this._sw=cellSize[0],this._sh=cellSize[1]},Calendar2.prototype.dataToPoint=function(data,clamp2){isArray$1(data)&&(data=data[0]),null==clamp2&&(clamp2=!0);var dayInfo=this.getDateInfo(data),range=this._rangeInfo,date=dayInfo.formatedDate;if(clamp2&&!(dayInfo.time>=range.start.time&&dayInfo.time<range.end.time+864e5))return[NaN,NaN];var week=dayInfo.day,nthWeek=this._getRangeInfo([range.start.time,date]).nthWeek;return"vertical"===this._orient?[this._rect.x+week*this._sw+this._sw/2,this._rect.y+nthWeek*this._sh+this._sh/2]:[this._rect.x+nthWeek*this._sw+this._sw/2,this._rect.y+week*this._sh+this._sh/2]},Calendar2.prototype.pointToData=function(point){var date=this.pointToDate(point);return date&&date.time},Calendar2.prototype.dataToRect=function(data,clamp2){var point=this.dataToPoint(data,clamp2);return{contentShape:{x:point[0]-(this._sw-this._lineWidth)/2,y:point[1]-(this._sh-this._lineWidth)/2,width:this._sw-this._lineWidth,height:this._sh-this._lineWidth},center:point,tl:[point[0]-this._sw/2,point[1]-this._sh/2],tr:[point[0]+this._sw/2,point[1]-this._sh/2],br:[point[0]+this._sw/2,point[1]+this._sh/2],bl:[point[0]-this._sw/2,point[1]+this._sh/2]}},Calendar2.prototype.pointToDate=function(point){var nthX=Math.floor((point[0]-this._rect.x)/this._sw)+1,nthY=Math.floor((point[1]-this._rect.y)/this._sh)+1,range=this._rangeInfo.range;return"vertical"===this._orient?this._getDateByWeeksAndDay(nthY,nthX-1,range):this._getDateByWeeksAndDay(nthX,nthY-1,range)},Calendar2.prototype.convertToPixel=function(ecModel,finder,value){var coordSys=getCoordSys(finder);return coordSys===this?coordSys.dataToPoint(value):null},Calendar2.prototype.convertFromPixel=function(ecModel,finder,pixel){var coordSys=getCoordSys(finder);return coordSys===this?coordSys.pointToData(pixel):null},Calendar2.prototype.containPoint=function(point){return console.warn("Not implemented."),!1},Calendar2.prototype._initRangeOption=function(){var normalizedRange,range=this._model.get("range");if(isArray$1(range)&&1===range.length&&(range=range[0]),isArray$1(range))normalizedRange=range;else{var rangeStr=range.toString();if(/^\d{4}$/.test(rangeStr)&&(normalizedRange=[rangeStr+"-01-01",rangeStr+"-12-31"]),/^\d{4}[\/|-]\d{1,2}$/.test(rangeStr)){var start2=this.getDateInfo(rangeStr),firstDay=start2.date;firstDay.setMonth(firstDay.getMonth()+1);var end2=this.getNextNDay(firstDay,-1);normalizedRange=[start2.formatedDate,end2.formatedDate]}/^\d{4}[\/|-]\d{1,2}[\/|-]\d{1,2}$/.test(rangeStr)&&(normalizedRange=[rangeStr,rangeStr])}if(!normalizedRange)return range;var tmp=this._getRangeInfo(normalizedRange);return tmp.start.time>tmp.end.time&&normalizedRange.reverse(),normalizedRange},Calendar2.prototype._getRangeInfo=function(range){var reversed,parsedRange=[this.getDateInfo(range[0]),this.getDateInfo(range[1])];parsedRange[0].time>parsedRange[1].time&&(reversed=!0,parsedRange.reverse());var allDay=Math.floor(parsedRange[1].time/864e5)-Math.floor(parsedRange[0].time/864e5)+1,date=new Date(parsedRange[0].time),startDateNum=date.getDate(),endDateNum=parsedRange[1].date.getDate();date.setDate(startDateNum+allDay-1);var dateNum=date.getDate();if(dateNum!==endDateNum)for(var sign=date.getTime()-parsedRange[1].time>0?1:-1;(dateNum=date.getDate())!==endDateNum&&(date.getTime()-parsedRange[1].time)*sign>0;)allDay-=sign,date.setDate(dateNum-sign);var weeks=Math.floor((allDay+parsedRange[0].day+6)/7),nthWeek=reversed?1-weeks:weeks-1;return reversed&&parsedRange.reverse(),{range:[parsedRange[0].formatedDate,parsedRange[1].formatedDate],start:parsedRange[0],end:parsedRange[1],allDay:allDay,weeks:weeks,nthWeek:nthWeek,fweek:parsedRange[0].day,lweek:parsedRange[1].day}},Calendar2.prototype._getDateByWeeksAndDay=function(nthWeek,day,range){var rangeInfo=this._getRangeInfo(range);if(nthWeek>rangeInfo.weeks||0===nthWeek&&day<rangeInfo.fweek||nthWeek===rangeInfo.weeks&&day>rangeInfo.lweek)return null;var nthDay=7*(nthWeek-1)-rangeInfo.fweek+day,date=new Date(rangeInfo.start.time);return date.setDate(+rangeInfo.start.d+nthDay),this.getDateInfo(date)},Calendar2.create=function(ecModel,api){var calendarList=[];return ecModel.eachComponent("calendar",(function(calendarModel){var calendar=new Calendar2(calendarModel);calendarList.push(calendar),calendarModel.coordinateSystem=calendar})),ecModel.eachSeries((function(calendarSeries){"calendar"===calendarSeries.get("coordinateSystem")&&(calendarSeries.coordinateSystem=calendarList[calendarSeries.get("calendarIndex")||0])})),calendarList},Calendar2.dimensions=["time","value"],Calendar2}();function getCoordSys(finder){var calendarModel=finder.calendarModel,seriesModel=finder.seriesModel;return calendarModel?calendarModel.coordinateSystem:seriesModel?seriesModel.coordinateSystem:null}function isSetLoc(obj,props){var isSet;return each$d(props,(function(prop){null!=obj[prop]&&"auto"!==obj[prop]&&(isSet=!0)})),isSet}var TRANSITION_PROPS_TO_COPY=["transition","enterFrom","leaveTo"],ROOT_TRANSITION_PROPS_TO_COPY=TRANSITION_PROPS_TO_COPY.concat(["enterAnimation","updateAnimation","leaveAnimation"]);function copyTransitionInfo(target,source,targetProp){if(targetProp&&(!target[targetProp]&&source[targetProp]&&(target[targetProp]={}),target=target[targetProp],source=source[targetProp]),target&&source)for(var props=targetProp?TRANSITION_PROPS_TO_COPY:ROOT_TRANSITION_PROPS_TO_COPY,i=0;i<props.length;i++){var prop=props[i];null==target[prop]&&null!=source[prop]&&(target[prop]=source[prop])}}var GraphicComponentModel=function(_super){function GraphicComponentModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=GraphicComponentModel2.type,_this.preventAutoZ=!0,_this}return __extends(GraphicComponentModel2,_super),GraphicComponentModel2.prototype.mergeOption=function(option,ecModel){var elements=this.option.elements;this.option.elements=null,_super.prototype.mergeOption.call(this,option,ecModel),this.option.elements=elements},GraphicComponentModel2.prototype.optionUpdated=function(newOption,isInit){var thisOption=this.option,newList=(isInit?thisOption:newOption).elements,existList=thisOption.elements=isInit?[]:thisOption.elements,flattenedList=[];this._flatten(newList,flattenedList,null);var mappingResult=mappingToExists(existList,flattenedList,"normalMerge"),elOptionsToUpdate=this._elOptionsToUpdate=[];each$d(mappingResult,(function(resultItem,index){var newElOption=resultItem.newOption;newElOption&&(elOptionsToUpdate.push(newElOption),function(resultItem,newElOption){var existElOption=resultItem.existing;if(newElOption.id=resultItem.keyInfo.id,!newElOption.type&&existElOption&&(newElOption.type=existElOption.type),null==newElOption.parentId){var newElParentOption=newElOption.parentOption;newElParentOption?newElOption.parentId=newElParentOption.id:existElOption&&(newElOption.parentId=existElOption.parentId)}newElOption.parentOption=null}(resultItem,newElOption),function(existList,index,newElOption){var newElOptCopy=extend({},newElOption),existElOption=existList[index],$action=newElOption.$action||"merge";"merge"===$action?existElOption?(merge(existElOption,newElOptCopy,!0),mergeLayoutParam(existElOption,newElOptCopy,{ignoreSize:!0}),copyLayoutParams(newElOption,existElOption),copyTransitionInfo(newElOption,existElOption),copyTransitionInfo(newElOption,existElOption,"shape"),copyTransitionInfo(newElOption,existElOption,"style"),copyTransitionInfo(newElOption,existElOption,"extra"),newElOption.clipPath=existElOption.clipPath):existList[index]=newElOptCopy:"replace"===$action?existList[index]=newElOptCopy:"remove"===$action&&existElOption&&(existList[index]=null)}(existList,index,newElOption),function(existItem,newElOption){if(existItem&&(existItem.hv=newElOption.hv=[isSetLoc(newElOption,["left","right"]),isSetLoc(newElOption,["top","bottom"])],"group"===existItem.type)){var existingGroupOpt=existItem,newGroupOpt=newElOption;null==existingGroupOpt.width&&(existingGroupOpt.width=newGroupOpt.width=0),null==existingGroupOpt.height&&(existingGroupOpt.height=newGroupOpt.height=0)}}(existList[index],newElOption))}),this),thisOption.elements=filter(existList,(function(item){return item&&delete item.$action,null!=item}))},GraphicComponentModel2.prototype._flatten=function(optionList,result,parentOption){each$d(optionList,(function(option){if(option){parentOption&&(option.parentOption=parentOption),result.push(option);var children=option.children;children&&children.length&&this._flatten(children,result,option),delete option.children}}),this)},GraphicComponentModel2.prototype.useElOptionsToUpdate=function(){var els=this._elOptionsToUpdate;return this._elOptionsToUpdate=null,els},GraphicComponentModel2.type="graphic",GraphicComponentModel2.defaultOption={elements:[]},GraphicComponentModel2}(ComponentModel),nonShapeGraphicElements={path:null,compoundPath:null,group:Group$2,image:ZRImage,text:ZRText},inner$3=makeInner(),GraphicComponentView=function(_super){function GraphicComponentView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=GraphicComponentView2.type,_this}return __extends(GraphicComponentView2,_super),GraphicComponentView2.prototype.init=function(){this._elMap=createHashMap()},GraphicComponentView2.prototype.render=function(graphicModel,ecModel,api){graphicModel!==this._lastGraphicModel&&this._clear(),this._lastGraphicModel=graphicModel,this._updateElements(graphicModel),this._relocate(graphicModel,api)},GraphicComponentView2.prototype._updateElements=function(graphicModel){var elOptionsToUpdate=graphicModel.useElOptionsToUpdate();if(elOptionsToUpdate){var elMap=this._elMap,rootGroup=this.group,globalZ=graphicModel.get("z"),globalZLevel=graphicModel.get("zlevel");each$d(elOptionsToUpdate,(function(elOption){var id=convertOptionIdName(elOption.id,null),elExisting=null!=id?elMap.get(id):null,parentId=convertOptionIdName(elOption.parentId,null),targetElParent=null!=parentId?elMap.get(parentId):rootGroup,elType=elOption.type,elOptionStyle=elOption.style;"text"===elType&&elOptionStyle&&elOption.hv&&elOption.hv[1]&&(elOptionStyle.textVerticalAlign=elOptionStyle.textBaseline=elOptionStyle.verticalAlign=elOptionStyle.align=null);var textContentOption=elOption.textContent,textConfig=elOption.textConfig;if(elOptionStyle&&function(style,elType,hasOwnTextContentOption,hasOwnTextConfig){return style&&(style.legacy||!1!==style.legacy&&!hasOwnTextContentOption&&!hasOwnTextConfig&&"tspan"!==elType&&("text"===elType||hasOwn(style,"text")))}(elOptionStyle,elType,!!textConfig,!!textContentOption)){var convertResult=function(hostStyle,elType){var textConfig,textContent,textContentStyle,srcStyle=hostStyle;if("text"===elType)textContentStyle=srcStyle;else{textContentStyle={},hasOwn(srcStyle,"text")&&(textContentStyle.text=srcStyle.text),hasOwn(srcStyle,"rich")&&(textContentStyle.rich=srcStyle.rich),hasOwn(srcStyle,"textFill")&&(textContentStyle.fill=srcStyle.textFill),hasOwn(srcStyle,"textStroke")&&(textContentStyle.stroke=srcStyle.textStroke),hasOwn(srcStyle,"fontFamily")&&(textContentStyle.fontFamily=srcStyle.fontFamily),hasOwn(srcStyle,"fontSize")&&(textContentStyle.fontSize=srcStyle.fontSize),hasOwn(srcStyle,"fontStyle")&&(textContentStyle.fontStyle=srcStyle.fontStyle),hasOwn(srcStyle,"fontWeight")&&(textContentStyle.fontWeight=srcStyle.fontWeight),textContent={type:"text",style:textContentStyle,silent:!0},textConfig={};var hasOwnPos=hasOwn(srcStyle,"textPosition");textConfig.position=hasOwnPos?srcStyle.textPosition:"inside",hasOwn(srcStyle,"textPosition")&&(textConfig.position=srcStyle.textPosition),hasOwn(srcStyle,"textOffset")&&(textConfig.offset=srcStyle.textOffset),hasOwn(srcStyle,"textRotation")&&(textConfig.rotation=srcStyle.textRotation),hasOwn(srcStyle,"textDistance")&&(textConfig.distance=srcStyle.textDistance)}return convertEC4CompatibleRichItem(textContentStyle,hostStyle),each$d(textContentStyle.rich,(function(richItem){convertEC4CompatibleRichItem(richItem,richItem)})),{textConfig:textConfig,textContent:textContent}}(elOptionStyle,elType);!textConfig&&convertResult.textConfig&&(textConfig=elOption.textConfig=convertResult.textConfig),!textContentOption&&convertResult.textContent&&(textContentOption=convertResult.textContent)}var elOptionCleaned=function(elOption){return elOption=extend({},elOption),each$d(["id","parentId","$action","hv","bounding","textContent","clipPath"].concat(LOCATION_PARAMS),(function(name){delete elOption[name]})),elOption}(elOption),$action=elOption.$action||"merge",isMerge="merge"===$action,isReplace="replace"===$action;if(isMerge){var el_1=elExisting;(isInit=!elExisting)?el_1=createEl(id,targetElParent,elOption.type,elMap):(el_1&&(inner$3(el_1).isNew=!1),function(el){el.stopAnimation("keyframe"),el.attr(getStateToRestore(el))}(el_1)),el_1&&(applyUpdateTransition(el_1,elOptionCleaned,graphicModel,{isInit:isInit}),updateCommonAttrs(el_1,elOption,globalZ,globalZLevel))}else if(isReplace){removeEl(elExisting,elOption,elMap,graphicModel);var el_2=createEl(id,targetElParent,elOption.type,elMap);el_2&&(applyUpdateTransition(el_2,elOptionCleaned,graphicModel,{isInit:!0}),updateCommonAttrs(el_2,elOption,globalZ,globalZLevel))}else"remove"===$action&&(updateLeaveTo(elExisting,elOption),removeEl(elExisting,elOption,elMap,graphicModel));var el=elMap.get(id);if(el&&textContentOption)if(isMerge){var textContentExisting=el.getTextContent();textContentExisting?textContentExisting.attr(textContentOption):el.setTextContent(new ZRText(textContentOption))}else isReplace&&el.setTextContent(new ZRText(textContentOption));if(el){var clipPathOption=elOption.clipPath;if(clipPathOption){var clipPathType=clipPathOption.type,clipPath=void 0,isInit=!1;if(isMerge){var oldClipPath=el.getClipPath();clipPath=(isInit=!oldClipPath||inner$3(oldClipPath).type!==clipPathType)?newEl(clipPathType):oldClipPath}else isReplace&&(isInit=!0,clipPath=newEl(clipPathType));el.setClipPath(clipPath),applyUpdateTransition(clipPath,clipPathOption,graphicModel,{isInit:isInit}),applyKeyframeAnimation(clipPath,clipPathOption.keyframeAnimation,graphicModel)}var elInner=inner$3(el);el.setTextConfig(textConfig),elInner.option=elOption,function(el,graphicModel,elOption){var eventData=getECData(el).eventData;el.silent||el.ignore||eventData||(eventData=getECData(el).eventData={componentType:"graphic",componentIndex:graphicModel.componentIndex,name:el.name});eventData&&(eventData.info=elOption.info)}(el,graphicModel,elOption),setTooltipConfig({el:el,componentModel:graphicModel,itemName:el.name,itemTooltipOption:elOption.tooltip}),applyKeyframeAnimation(el,elOption.keyframeAnimation,graphicModel)}}))}},GraphicComponentView2.prototype._relocate=function(graphicModel,api){for(var elOptions=graphicModel.option.elements,rootGroup=this.group,elMap=this._elMap,apiWidth=api.getWidth(),apiHeight=api.getHeight(),xy=["x","y"],i=0;i<elOptions.length;i++){if((el=null!=(id=convertOptionIdName((elOption=elOptions[i]).id,null))?elMap.get(id):null)&&el.isGroup){var isParentRoot=(parentEl=el.parent)===rootGroup,elInner=inner$3(el),parentElInner=inner$3(parentEl);elInner.width=parsePercent(elInner.option.width,isParentRoot?apiWidth:parentElInner.width)||0,elInner.height=parsePercent(elInner.option.height,isParentRoot?apiHeight:parentElInner.height)||0}}for(i=elOptions.length-1;i>=0;i--){var elOption,id,el;if(el=null!=(id=convertOptionIdName((elOption=elOptions[i]).id,null))?elMap.get(id):null){var parentEl=el.parent,layoutPos=(parentElInner=inner$3(parentEl),{}),layouted=positionElement(el,elOption,parentEl===rootGroup?{width:apiWidth,height:apiHeight}:{width:parentElInner.width,height:parentElInner.height},null,{hv:elOption.hv,boundingMode:elOption.bounding},layoutPos);if(!inner$3(el).isNew&&layouted){for(var transition=elOption.transition,animatePos={},k=0;k<xy.length;k++){var key=xy[k],val=layoutPos[key];transition&&(isTransitionAll(transition)||indexOf(transition,key)>=0)?animatePos[key]=val:el[key]=val}updateProps$1(el,animatePos,graphicModel,0)}else el.attr(layoutPos)}}},GraphicComponentView2.prototype._clear=function(){var _this=this,elMap=this._elMap;elMap.each((function(el){removeEl(el,inner$3(el).option,elMap,_this._lastGraphicModel)})),this._elMap=createHashMap()},GraphicComponentView2.prototype.dispose=function(){this._clear()},GraphicComponentView2.type="graphic",GraphicComponentView2}(ComponentView);function newEl(graphicType){var el=new(hasOwn(nonShapeGraphicElements,graphicType)?nonShapeGraphicElements[graphicType]:getShapeClass(graphicType))({});return inner$3(el).type=graphicType,el}function createEl(id,targetElParent,graphicType,elMap){var el=newEl(graphicType);return targetElParent.add(el),elMap.set(id,el),inner$3(el).id=id,inner$3(el).isNew=!0,el}function removeEl(elExisting,elOption,elMap,graphicModel){elExisting&&elExisting.parent&&("group"===elExisting.type&&elExisting.traverse((function(el){removeEl(el,elOption,elMap,graphicModel)})),function(el,elOption,animatableModel){if(el){var parent_1=el.parent,leaveToProps=transitionInnerStore(el).leaveToProps;if(leaveToProps){var config=getElementAnimationConfig("update",el,elOption,animatableModel,0);config.done=function(){parent_1.remove(el)},el.animateTo(leaveToProps,config)}else parent_1.remove(el)}}(elExisting,elOption,graphicModel),elMap.removeKey(inner$3(elExisting).id))}function updateCommonAttrs(el,elOption,defaultZ,defaultZlevel){el.isGroup||each$d([["cursor",Displayable.prototype.cursor],["zlevel",defaultZlevel||0],["z",defaultZ||0],["z2",0]],(function(item){var prop=item[0];hasOwn(elOption,prop)?el[prop]=retrieve2(elOption[prop],item[1]):null==el[prop]&&(el[prop]=item[1])})),each$d(keys(elOption),(function(key){if(0===key.indexOf("on")){var val=elOption[key];el[key]=isFunction(val)?val:null}})),hasOwn(elOption,"draggable")&&(el.draggable=elOption.draggable),null!=elOption.name&&(el.name=elOption.name),null!=elOption.id&&(el.id=elOption.id)}var DATA_ZOOM_AXIS_DIMENSIONS=["x","y","radius","angle","single"],SERIES_COORDS=["cartesian2d","polar","singleAxis"];function getAxisMainType(axisDim){return axisDim+"Axis"}function findEffectedDataZooms(ecModel,payload){var foundNewLink,axisRecords=createHashMap(),effectedModels=[],effectedModelMap=createHashMap();ecModel.eachComponent({mainType:"dataZoom",query:payload},(function(dataZoomModel){effectedModelMap.get(dataZoomModel.uid)||addToEffected(dataZoomModel)}));do{foundNewLink=!1,ecModel.eachComponent("dataZoom",processSingle)}while(foundNewLink);function processSingle(dataZoomModel){!effectedModelMap.get(dataZoomModel.uid)&&function(dataZoomModel){var isLink=!1;return dataZoomModel.eachTargetAxis((function(axisDim,axisIndex){var axisIdxArr=axisRecords.get(axisDim);axisIdxArr&&axisIdxArr[axisIndex]&&(isLink=!0)})),isLink}(dataZoomModel)&&(addToEffected(dataZoomModel),foundNewLink=!0)}function addToEffected(dataZoom){effectedModelMap.set(dataZoom.uid,!0),effectedModels.push(dataZoom),dataZoom.eachTargetAxis((function(axisDim,axisIndex){(axisRecords.get(axisDim)||axisRecords.set(axisDim,[]))[axisIndex]=!0}))}return effectedModels}function collectReferCoordSysModelInfo(dataZoomModel){var ecModel=dataZoomModel.ecModel,coordSysInfoWrap={infoList:[],infoMap:createHashMap()};return dataZoomModel.eachTargetAxis((function(axisDim,axisIndex){var axisModel=ecModel.getComponent(getAxisMainType(axisDim),axisIndex);if(axisModel){var coordSysModel=axisModel.getCoordSysModel();if(coordSysModel){var coordSysUid=coordSysModel.uid,coordSysInfo=coordSysInfoWrap.infoMap.get(coordSysUid);coordSysInfo||(coordSysInfo={model:coordSysModel,axisModels:[]},coordSysInfoWrap.infoList.push(coordSysInfo),coordSysInfoWrap.infoMap.set(coordSysUid,coordSysInfo)),coordSysInfo.axisModels.push(axisModel)}}})),coordSysInfoWrap}var DataZoomAxisInfo=function(){function DataZoomAxisInfo2(){this.indexList=[],this.indexMap=[]}return DataZoomAxisInfo2.prototype.add=function(axisCmptIdx){this.indexMap[axisCmptIdx]||(this.indexList.push(axisCmptIdx),this.indexMap[axisCmptIdx]=!0)},DataZoomAxisInfo2}(),DataZoomModel=function(_super){function DataZoomModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=DataZoomModel2.type,_this._autoThrottle=!0,_this._noTarget=!0,_this._rangePropMode=["percent","percent"],_this}return __extends(DataZoomModel2,_super),DataZoomModel2.prototype.init=function(option,parentModel,ecModel){var inputRawOption=retrieveRawOption(option);this.settledOption=inputRawOption,this.mergeDefaultAndTheme(option,ecModel),this._doInit(inputRawOption)},DataZoomModel2.prototype.mergeOption=function(newOption){var inputRawOption=retrieveRawOption(newOption);merge(this.option,newOption,!0),merge(this.settledOption,inputRawOption,!0),this._doInit(inputRawOption)},DataZoomModel2.prototype._doInit=function(inputRawOption){var thisOption=this.option;this._setDefaultThrottle(inputRawOption),this._updateRangeUse(inputRawOption);var settledOption=this.settledOption;each$d([["start","startValue"],["end","endValue"]],(function(names,index){"value"===this._rangePropMode[index]&&(thisOption[names[0]]=settledOption[names[0]]=null)}),this),this._resetTarget()},DataZoomModel2.prototype._resetTarget=function(){var optionOrient=this.get("orient",!0),targetAxisIndexMap=this._targetAxisInfoMap=createHashMap();this._fillSpecifiedTargetAxis(targetAxisIndexMap)?this._orient=optionOrient||this._makeAutoOrientByTargetAxis():(this._orient=optionOrient||"horizontal",this._fillAutoTargetAxisByOrient(targetAxisIndexMap,this._orient)),this._noTarget=!0,targetAxisIndexMap.each((function(axisInfo){axisInfo.indexList.length&&(this._noTarget=!1)}),this)},DataZoomModel2.prototype._fillSpecifiedTargetAxis=function(targetAxisIndexMap){var hasAxisSpecified=!1;return each$d(DATA_ZOOM_AXIS_DIMENSIONS,(function(axisDim){var refering=this.getReferringComponents(getAxisMainType(axisDim),MULTIPLE_REFERRING);if(refering.specified){hasAxisSpecified=!0;var axisInfo=new DataZoomAxisInfo;each$d(refering.models,(function(axisModel){axisInfo.add(axisModel.componentIndex)})),targetAxisIndexMap.set(axisDim,axisInfo)}}),this),hasAxisSpecified},DataZoomModel2.prototype._fillAutoTargetAxisByOrient=function(targetAxisIndexMap,orient){var ecModel=this.ecModel,needAuto=!0;if(needAuto){var axisDim="vertical"===orient?"y":"x";setParallelAxis(ecModel.findComponents({mainType:axisDim+"Axis"}),axisDim)}needAuto&&setParallelAxis(ecModel.findComponents({mainType:"singleAxis",filter:function(axisModel){return axisModel.get("orient",!0)===orient}}),"single");function setParallelAxis(axisModels2,axisDim2){var axisModel=axisModels2[0];if(axisModel){var axisInfo=new DataZoomAxisInfo;if(axisInfo.add(axisModel.componentIndex),targetAxisIndexMap.set(axisDim2,axisInfo),needAuto=!1,"x"===axisDim2||"y"===axisDim2){var gridModel_1=axisModel.getReferringComponents("grid",SINGLE_REFERRING).models[0];gridModel_1&&each$d(axisModels2,(function(axModel){axisModel.componentIndex!==axModel.componentIndex&&gridModel_1===axModel.getReferringComponents("grid",SINGLE_REFERRING).models[0]&&axisInfo.add(axModel.componentIndex)}))}}}needAuto&&each$d(DATA_ZOOM_AXIS_DIMENSIONS,(function(axisDim2){if(needAuto){var axisModels2=ecModel.findComponents({mainType:getAxisMainType(axisDim2),filter:function(axisModel){return"category"===axisModel.get("type",!0)}});if(axisModels2[0]){var axisInfo=new DataZoomAxisInfo;axisInfo.add(axisModels2[0].componentIndex),targetAxisIndexMap.set(axisDim2,axisInfo),needAuto=!1}}}),this)},DataZoomModel2.prototype._makeAutoOrientByTargetAxis=function(){var dim;return this.eachTargetAxis((function(axisDim){!dim&&(dim=axisDim)}),this),"y"===dim?"vertical":"horizontal"},DataZoomModel2.prototype._setDefaultThrottle=function(inputRawOption){if(inputRawOption.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var globalOption=this.ecModel.option;this.option.throttle=globalOption.animation&&globalOption.animationDurationUpdate>0?100:20}},DataZoomModel2.prototype._updateRangeUse=function(inputRawOption){var rangePropMode=this._rangePropMode,rangeModeInOption=this.get("rangeMode");each$d([["start","startValue"],["end","endValue"]],(function(names,index){var percentSpecified=null!=inputRawOption[names[0]],valueSpecified=null!=inputRawOption[names[1]];percentSpecified&&!valueSpecified?rangePropMode[index]="percent":!percentSpecified&&valueSpecified?rangePropMode[index]="value":rangeModeInOption?rangePropMode[index]=rangeModeInOption[index]:percentSpecified&&(rangePropMode[index]="percent")}))},DataZoomModel2.prototype.noTarget=function(){return this._noTarget},DataZoomModel2.prototype.getFirstTargetAxisModel=function(){var firstAxisModel;return this.eachTargetAxis((function(axisDim,axisIndex){null==firstAxisModel&&(firstAxisModel=this.ecModel.getComponent(getAxisMainType(axisDim),axisIndex))}),this),firstAxisModel},DataZoomModel2.prototype.eachTargetAxis=function(callback,context){this._targetAxisInfoMap.each((function(axisInfo,axisDim){each$d(axisInfo.indexList,(function(axisIndex){callback.call(context,axisDim,axisIndex)}))}))},DataZoomModel2.prototype.getAxisProxy=function(axisDim,axisIndex){var axisModel=this.getAxisModel(axisDim,axisIndex);if(axisModel)return axisModel.__dzAxisProxy},DataZoomModel2.prototype.getAxisModel=function(axisDim,axisIndex){var axisInfo=this._targetAxisInfoMap.get(axisDim);if(axisInfo&&axisInfo.indexMap[axisIndex])return this.ecModel.getComponent(getAxisMainType(axisDim),axisIndex)},DataZoomModel2.prototype.setRawRange=function(opt){var thisOption=this.option,settledOption=this.settledOption;each$d([["start","startValue"],["end","endValue"]],(function(names){null==opt[names[0]]&&null==opt[names[1]]||(thisOption[names[0]]=settledOption[names[0]]=opt[names[0]],thisOption[names[1]]=settledOption[names[1]]=opt[names[1]])}),this),this._updateRangeUse(opt)},DataZoomModel2.prototype.setCalculatedRange=function(opt){var option=this.option;each$d(["start","startValue","end","endValue"],(function(name){option[name]=opt[name]}))},DataZoomModel2.prototype.getPercentRange=function(){var axisProxy=this.findRepresentativeAxisProxy();if(axisProxy)return axisProxy.getDataPercentWindow()},DataZoomModel2.prototype.getValueRange=function(axisDim,axisIndex){if(null!=axisDim||null!=axisIndex)return this.getAxisProxy(axisDim,axisIndex).getDataValueWindow();var axisProxy=this.findRepresentativeAxisProxy();return axisProxy?axisProxy.getDataValueWindow():void 0},DataZoomModel2.prototype.findRepresentativeAxisProxy=function(axisModel){if(axisModel)return axisModel.__dzAxisProxy;for(var firstProxy,axisDimList=this._targetAxisInfoMap.keys(),i=0;i<axisDimList.length;i++)for(var axisDim=axisDimList[i],axisInfo=this._targetAxisInfoMap.get(axisDim),j=0;j<axisInfo.indexList.length;j++){var proxy=this.getAxisProxy(axisDim,axisInfo.indexList[j]);if(proxy.hostedBy(this))return proxy;firstProxy||(firstProxy=proxy)}return firstProxy},DataZoomModel2.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},DataZoomModel2.prototype.getOrient=function(){return this._orient},DataZoomModel2.type="dataZoom",DataZoomModel2.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],DataZoomModel2.defaultOption={z:4,filterMode:"filter",start:0,end:100},DataZoomModel2}(ComponentModel);function retrieveRawOption(option){var ret={};return each$d(["start","end","startValue","endValue","throttle"],(function(name){option.hasOwnProperty(name)&&(ret[name]=option[name])})),ret}var SelectDataZoomModel=function(_super){function SelectDataZoomModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=SelectDataZoomModel2.type,_this}return __extends(SelectDataZoomModel2,_super),SelectDataZoomModel2.type="dataZoom.select",SelectDataZoomModel2}(DataZoomModel),DataZoomView=function(_super){function DataZoomView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=DataZoomView2.type,_this}return __extends(DataZoomView2,_super),DataZoomView2.prototype.render=function(dataZoomModel,ecModel,api,payload){this.dataZoomModel=dataZoomModel,this.ecModel=ecModel,this.api=api},DataZoomView2.type="dataZoom",DataZoomView2}(ComponentView),SelectDataZoomView=function(_super){function SelectDataZoomView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=SelectDataZoomView2.type,_this}return __extends(SelectDataZoomView2,_super),SelectDataZoomView2.type="dataZoom.select",SelectDataZoomView2}(DataZoomView),each$7=each$d,asc$1=asc$2,AxisProxy=function(){function AxisProxy2(dimName,axisIndex,dataZoomModel,ecModel){this._dimName=dimName,this._axisIndex=axisIndex,this.ecModel=ecModel,this._dataZoomModel=dataZoomModel}return AxisProxy2.prototype.hostedBy=function(dataZoomModel){return this._dataZoomModel===dataZoomModel},AxisProxy2.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},AxisProxy2.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},AxisProxy2.prototype.getTargetSeriesModels=function(){var seriesModels=[];return this.ecModel.eachSeries((function(seriesModel){if(function(seriesModel){var coordType=seriesModel.get("coordinateSystem");return indexOf(SERIES_COORDS,coordType)>=0}(seriesModel)){var axisMainType=getAxisMainType(this._dimName),axisModel=seriesModel.getReferringComponents(axisMainType,SINGLE_REFERRING).models[0];axisModel&&this._axisIndex===axisModel.componentIndex&&seriesModels.push(seriesModel)}}),this),seriesModels},AxisProxy2.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},AxisProxy2.prototype.getMinMaxSpan=function(){return clone$3(this._minMaxSpan)},AxisProxy2.prototype.calculateDataWindow=function(opt){var hasPropModeValue,dataExtent=this._dataExtent,scale2=this.getAxisModel().axis.scale,rangePropMode=this._dataZoomModel.getRangePropMode(),percentExtent=[0,100],percentWindow=[],valueWindow=[];each$7(["start","end"],(function(prop,idx){var boundPercent=opt[prop],boundValue=opt[prop+"Value"];"percent"===rangePropMode[idx]?(null==boundPercent&&(boundPercent=percentExtent[idx]),boundValue=scale2.parse(linearMap$2(boundPercent,percentExtent,dataExtent))):(hasPropModeValue=!0,boundPercent=linearMap$2(boundValue=null==boundValue?dataExtent[idx]:scale2.parse(boundValue),dataExtent,percentExtent)),valueWindow[idx]=null==boundValue||isNaN(boundValue)?dataExtent[idx]:boundValue,percentWindow[idx]=null==boundPercent||isNaN(boundPercent)?percentExtent[idx]:boundPercent})),asc$1(valueWindow),asc$1(percentWindow);var spans=this._minMaxSpan;function restrictSet(fromWindow,toWindow,fromExtent,toExtent,toValue){var suffix=toValue?"Span":"ValueSpan";sliderMove(0,fromWindow,fromExtent,"all",spans["min"+suffix],spans["max"+suffix]);for(var i=0;i<2;i++)toWindow[i]=linearMap$2(fromWindow[i],fromExtent,toExtent,!0),toValue&&(toWindow[i]=scale2.parse(toWindow[i]))}return hasPropModeValue?restrictSet(valueWindow,percentWindow,dataExtent,percentExtent,!1):restrictSet(percentWindow,valueWindow,percentExtent,dataExtent,!0),{valueWindow:valueWindow,percentWindow:percentWindow}},AxisProxy2.prototype.reset=function(dataZoomModel){if(dataZoomModel===this._dataZoomModel){var targetSeries=this.getTargetSeriesModels();this._dataExtent=function(axisProxy,axisDim,seriesModels){var dataExtent=[Infinity,-Infinity];each$7(seriesModels,(function(seriesModel){!function(dataExtent,data,axisDim){data&&each$d(getDataDimensionsOnAxis(data,axisDim),(function(dim){var seriesExtent=data.getApproximateExtent(dim);seriesExtent[0]<dataExtent[0]&&(dataExtent[0]=seriesExtent[0]),seriesExtent[1]>dataExtent[1]&&(dataExtent[1]=seriesExtent[1])}))}(dataExtent,seriesModel.getData(),axisDim)}));var axisModel=axisProxy.getAxisModel(),rawExtentResult=ensureScaleRawExtentInfo(axisModel.axis.scale,axisModel,dataExtent).calculate();return[rawExtentResult.min,rawExtentResult.max]}(this,this._dimName,targetSeries),this._updateMinMaxSpan();var dataWindow=this.calculateDataWindow(dataZoomModel.settledOption);this._valueWindow=dataWindow.valueWindow,this._percentWindow=dataWindow.percentWindow,this._setAxisModel()}},AxisProxy2.prototype.filterData=function(dataZoomModel,api){if(dataZoomModel===this._dataZoomModel){var axisDim=this._dimName,seriesModels=this.getTargetSeriesModels(),filterMode=dataZoomModel.get("filterMode"),valueWindow=this._valueWindow;"none"!==filterMode&&each$7(seriesModels,(function(seriesModel){var seriesData=seriesModel.getData(),dataDims=seriesData.mapDimensionsAll(axisDim);if(dataDims.length){if("weakFilter"===filterMode){var store_1=seriesData.getStore(),dataDimIndices_1=map$1(dataDims,(function(dim){return seriesData.getDimensionIndex(dim)}),seriesData);seriesData.filterSelf((function(dataIndex){for(var leftOut,rightOut,hasValue,i=0;i<dataDims.length;i++){var value=store_1.get(dataDimIndices_1[i],dataIndex),thisHasValue=!isNaN(value),thisLeftOut=value<valueWindow[0],thisRightOut=value>valueWindow[1];if(thisHasValue&&!thisLeftOut&&!thisRightOut)return!0;thisHasValue&&(hasValue=!0),thisLeftOut&&(leftOut=!0),thisRightOut&&(rightOut=!0)}return hasValue&&leftOut&&rightOut}))}else each$7(dataDims,(function(dim){if("empty"===filterMode)seriesModel.setData(seriesData=seriesData.map(dim,(function(value){return function(value){return value>=valueWindow[0]&&value<=valueWindow[1]}(value)?value:NaN})));else{var range={};range[dim]=valueWindow,seriesData.selectRange(range)}}));each$7(dataDims,(function(dim){seriesData.setApproximateExtent(valueWindow,dim)}))}}))}},AxisProxy2.prototype._updateMinMaxSpan=function(){var minMaxSpan=this._minMaxSpan={},dataZoomModel=this._dataZoomModel,dataExtent=this._dataExtent;each$7(["min","max"],(function(minMax){var percentSpan=dataZoomModel.get(minMax+"Span"),valueSpan=dataZoomModel.get(minMax+"ValueSpan");null!=valueSpan&&(valueSpan=this.getAxisModel().axis.scale.parse(valueSpan)),null!=valueSpan?percentSpan=linearMap$2(dataExtent[0]+valueSpan,dataExtent,[0,100],!0):null!=percentSpan&&(valueSpan=linearMap$2(percentSpan,[0,100],dataExtent,!0)-dataExtent[0]),minMaxSpan[minMax+"Span"]=percentSpan,minMaxSpan[minMax+"ValueSpan"]=valueSpan}),this)},AxisProxy2.prototype._setAxisModel=function(){var axisModel=this.getAxisModel(),percentWindow=this._percentWindow,valueWindow=this._valueWindow;if(percentWindow){var precision=getPixelPrecision(valueWindow,[0,500]);precision=Math.min(precision,20);var rawExtentInfo=axisModel.axis.scale.rawExtentInfo;0!==percentWindow[0]&&rawExtentInfo.setDeterminedMinMax("min",+valueWindow[0].toFixed(precision)),100!==percentWindow[1]&&rawExtentInfo.setDeterminedMinMax("max",+valueWindow[1].toFixed(precision)),rawExtentInfo.freeze()}},AxisProxy2}();var dataZoomProcessor={getTargetSeries:function(ecModel){function eachAxisModel(cb){ecModel.eachComponent("dataZoom",(function(dataZoomModel){dataZoomModel.eachTargetAxis((function(axisDim,axisIndex){var axisModel=ecModel.getComponent(getAxisMainType(axisDim),axisIndex);cb(axisDim,axisIndex,axisModel,dataZoomModel)}))}))}eachAxisModel((function(axisDim,axisIndex,axisModel,dataZoomModel){axisModel.__dzAxisProxy=null}));var proxyList=[];eachAxisModel((function(axisDim,axisIndex,axisModel,dataZoomModel){axisModel.__dzAxisProxy||(axisModel.__dzAxisProxy=new AxisProxy(axisDim,axisIndex,dataZoomModel,ecModel),proxyList.push(axisModel.__dzAxisProxy))}));var seriesModelMap=createHashMap();return each$d(proxyList,(function(axisProxy){each$d(axisProxy.getTargetSeriesModels(),(function(seriesModel){seriesModelMap.set(seriesModel.uid,seriesModel)}))})),seriesModelMap},overallReset:function(ecModel,api){ecModel.eachComponent("dataZoom",(function(dataZoomModel){dataZoomModel.eachTargetAxis((function(axisDim,axisIndex){dataZoomModel.getAxisProxy(axisDim,axisIndex).reset(dataZoomModel)})),dataZoomModel.eachTargetAxis((function(axisDim,axisIndex){dataZoomModel.getAxisProxy(axisDim,axisIndex).filterData(dataZoomModel,api)}))})),ecModel.eachComponent("dataZoom",(function(dataZoomModel){var axisProxy=dataZoomModel.findRepresentativeAxisProxy();if(axisProxy){var percentRange=axisProxy.getDataPercentWindow(),valueRange=axisProxy.getDataValueWindow();dataZoomModel.setCalculatedRange({start:percentRange[0],end:percentRange[1],startValue:valueRange[0],endValue:valueRange[1]})}}))}};var installed$1=!1;function installCommon$1(registers){installed$1||(installed$1=!0,registers.registerProcessor(registers.PRIORITY.PROCESSOR.FILTER,dataZoomProcessor),function(registers){registers.registerAction("dataZoom",(function(payload,ecModel){each$d(findEffectedDataZooms(ecModel,payload),(function(dataZoomModel){dataZoomModel.setRawRange({start:payload.start,end:payload.end,startValue:payload.startValue,endValue:payload.endValue})}))}))}(registers),registers.registerSubTypeDefaulter("dataZoom",(function(){return"slider"})))}function install$f(registers){registers.registerComponentModel(SelectDataZoomModel),registers.registerComponentView(SelectDataZoomView),installCommon$1(registers)}var ToolboxFeature=function(){return function(){}}(),features={};function registerFeature(name,ctor){features[name]=ctor}function getFeature(name){return features[name]}var ToolboxModel=function(_super){function ToolboxModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=ToolboxModel2.type,_this}return __extends(ToolboxModel2,_super),ToolboxModel2.prototype.optionUpdated=function(){_super.prototype.optionUpdated.apply(this,arguments);var ecModel=this.ecModel;each$d(this.option.feature,(function(featureOpt,featureName){var Feature=getFeature(featureName);Feature&&(Feature.getDefaultOption&&(Feature.defaultOption=Feature.getDefaultOption(ecModel)),merge(featureOpt,Feature.defaultOption))}))},ToolboxModel2.type="toolbox",ToolboxModel2.layoutMode={type:"box",ignoreSize:!0},ToolboxModel2.defaultOption={show:!0,z:6,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1,position:"bottom"}},ToolboxModel2}(ComponentModel);function makeBackground(rect,componentModel){var padding=normalizeCssArray(componentModel.get("padding")),style=componentModel.getItemStyle(["color","opacity"]);return style.fill=componentModel.get("backgroundColor"),rect=new Rect$1({shape:{x:rect.x-padding[3],y:rect.y-padding[0],width:rect.width+padding[1]+padding[3],height:rect.height+padding[0]+padding[2],r:componentModel.get("borderRadius")},style:style,silent:!0,z2:-1})}var ToolboxView=function(_super){function ToolboxView2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ToolboxView2,_super),ToolboxView2.prototype.render=function(toolboxModel,ecModel,api,payload){var group=this.group;if(group.removeAll(),toolboxModel.get("show")){var itemSize=+toolboxModel.get("itemSize"),isVertical="vertical"===toolboxModel.get("orient"),featureOpts=toolboxModel.get("feature")||{},features2=this._features||(this._features={}),featureNames=[];each$d(featureOpts,(function(opt,name){featureNames.push(name)})),new DataDiffer(this._featureNames||[],featureNames).add(processFeature).update(processFeature).remove(curry$1(processFeature,null)).execute(),this._featureNames=featureNames,function(group,componentModel,api){var boxLayoutParams=componentModel.getBoxLayoutParams(),padding=componentModel.get("padding"),viewportSize={width:api.getWidth(),height:api.getHeight()},rect=getLayoutRect(boxLayoutParams,viewportSize,padding);box(componentModel.get("orient"),group,componentModel.get("itemGap"),rect.width,rect.height),positionElement(group,boxLayoutParams,viewportSize,padding)}(group,toolboxModel,api),group.add(makeBackground(group.getBoundingRect(),toolboxModel)),isVertical||group.eachChild((function(icon){var titleText=icon.__title,emphasisState=icon.ensureState("emphasis"),emphasisTextConfig=emphasisState.textConfig||(emphasisState.textConfig={}),textContent=icon.getTextContent(),emphasisTextState=textContent&&textContent.ensureState("emphasis");if(emphasisTextState&&!isFunction(emphasisTextState)&&titleText){var emphasisTextStyle=emphasisTextState.style||(emphasisTextState.style={}),rect=getBoundingRect(titleText,ZRText.makeFont(emphasisTextStyle)),offsetX=icon.x+group.x,needPutOnTop=!1;icon.y+group.y+itemSize+rect.height>api.getHeight()&&(emphasisTextConfig.position="top",needPutOnTop=!0);var topOffset=needPutOnTop?-5-rect.height:itemSize+10;offsetX+rect.width/2>api.getWidth()?(emphasisTextConfig.position=["100%",topOffset],emphasisTextStyle.align="right"):offsetX-rect.width/2<0&&(emphasisTextConfig.position=[0,topOffset],emphasisTextStyle.align="left")}}))}function processFeature(newIndex,oldIndex){var feature,featureName=featureNames[newIndex],oldName=featureNames[oldIndex],featureOpt=featureOpts[featureName],featureModel=new Model(featureOpt,toolboxModel,toolboxModel.ecModel);if(payload&&null!=payload.newTitle&&payload.featureName===featureName&&(featureOpt.title=payload.newTitle),featureName&&!oldName){if(function(featureName){return 0===featureName.indexOf("my")}(featureName))feature={onclick:featureModel.option.onclick,featureName:featureName};else{var Feature=getFeature(featureName);if(!Feature)return;feature=new Feature}features2[featureName]=feature}else if(!(feature=features2[oldName]))return;feature.uid=getUID("toolbox-feature"),feature.model=featureModel,feature.ecModel=ecModel,feature.api=api;var isToolboxFeature=feature instanceof ToolboxFeature;featureName||!oldName?!featureModel.get("show")||isToolboxFeature&&feature.unusable?isToolboxFeature&&feature.remove&&feature.remove(ecModel,api):(!function(featureModel,feature,featureName){var iconsMap,titlesMap,iconStyleModel=featureModel.getModel("iconStyle"),iconStyleEmphasisModel=featureModel.getModel(["emphasis","iconStyle"]),icons=feature instanceof ToolboxFeature&&feature.getIcons?feature.getIcons():featureModel.get("icon"),titles=featureModel.get("title")||{};isString(icons)?(iconsMap={})[featureName]=icons:iconsMap=icons;isString(titles)?(titlesMap={})[featureName]=titles:titlesMap=titles;var iconPaths=featureModel.iconPaths={};each$d(iconsMap,(function(iconStr,iconName){var path=createIcon(iconStr,{},{x:-itemSize/2,y:-itemSize/2,width:itemSize,height:itemSize});path.setStyle(iconStyleModel.getItemStyle()),path.ensureState("emphasis").style=iconStyleEmphasisModel.getItemStyle();var textContent=new ZRText({style:{text:titlesMap[iconName],align:iconStyleEmphasisModel.get("textAlign"),borderRadius:iconStyleEmphasisModel.get("textBorderRadius"),padding:iconStyleEmphasisModel.get("textPadding"),fill:null,font:getFont({fontStyle:iconStyleEmphasisModel.get("textFontStyle"),fontFamily:iconStyleEmphasisModel.get("textFontFamily"),fontSize:iconStyleEmphasisModel.get("textFontSize"),fontWeight:iconStyleEmphasisModel.get("textFontWeight")},ecModel)},ignore:!0});path.setTextContent(textContent),setTooltipConfig({el:path,componentModel:toolboxModel,itemName:iconName,formatterParamsExtra:{title:titlesMap[iconName]}}),path.__title=titlesMap[iconName],path.on("mouseover",(function(){var hoverStyle=iconStyleEmphasisModel.getItemStyle(),defaultTextPosition=isVertical?null==toolboxModel.get("right")&&"right"!==toolboxModel.get("left")?"right":"left":null==toolboxModel.get("bottom")&&"bottom"!==toolboxModel.get("top")?"bottom":"top";textContent.setStyle({fill:iconStyleEmphasisModel.get("textFill")||hoverStyle.fill||hoverStyle.stroke||"#000",backgroundColor:iconStyleEmphasisModel.get("textBackgroundColor")}),path.setTextConfig({position:iconStyleEmphasisModel.get("textPosition")||defaultTextPosition}),textContent.ignore=!toolboxModel.get("showTitle"),api.enterEmphasis(this)})).on("mouseout",(function(){"emphasis"!==featureModel.get(["iconStatus",iconName])&&api.leaveEmphasis(this),textContent.hide()})),("emphasis"===featureModel.get(["iconStatus",iconName])?enterEmphasis:leaveEmphasis)(path),group.add(path),path.on("click",bind$1(feature.onclick,feature,ecModel,api,iconName)),iconPaths[iconName]=path}))}(featureModel,feature,featureName),featureModel.setIconStatus=function(iconName,status){var option=this.option,iconPaths=this.iconPaths;option.iconStatus=option.iconStatus||{},option.iconStatus[iconName]=status,iconPaths[iconName]&&("emphasis"===status?enterEmphasis:leaveEmphasis)(iconPaths[iconName])},feature instanceof ToolboxFeature&&feature.render&&feature.render(featureModel,ecModel,api,payload)):isToolboxFeature&&feature.dispose&&feature.dispose(ecModel,api)}},ToolboxView2.prototype.updateView=function(toolboxModel,ecModel,api,payload){each$d(this._features,(function(feature){feature instanceof ToolboxFeature&&feature.updateView&&feature.updateView(feature.model,ecModel,api,payload)}))},ToolboxView2.prototype.remove=function(ecModel,api){each$d(this._features,(function(feature){feature instanceof ToolboxFeature&&feature.remove&&feature.remove(ecModel,api)})),this.group.removeAll()},ToolboxView2.prototype.dispose=function(ecModel,api){each$d(this._features,(function(feature){feature instanceof ToolboxFeature&&feature.dispose&&feature.dispose(ecModel,api)}))},ToolboxView2.type="toolbox",ToolboxView2}(ComponentView);var SaveAsImage=function(_super){function SaveAsImage2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(SaveAsImage2,_super),SaveAsImage2.prototype.onclick=function(ecModel,api){var model=this.model,title=model.get("name")||ecModel.get("title.0.text")||"echarts",isSvg="svg"===api.getZr().painter.getType(),type=isSvg?"svg":model.get("type",!0)||"png",url=api.getConnectedDataURL({type:type,backgroundColor:model.get("backgroundColor",!0)||ecModel.get("backgroundColor")||"#fff",connectedBackgroundColor:model.get("connectedBackgroundColor"),excludeComponents:model.get("excludeComponents"),pixelRatio:model.get("pixelRatio")}),browser=env.browser;if("function"!=typeof MouseEvent||!browser.newEdge&&(browser.ie||browser.edge))if(window.navigator.msSaveOrOpenBlob||isSvg){var parts=url.split(","),base64Encoded=parts[0].indexOf("base64")>-1,bstr=isSvg?decodeURIComponent(parts[1]):parts[1];base64Encoded&&(bstr=window.atob(bstr));var filename=title+"."+type;if(window.navigator.msSaveOrOpenBlob){for(var n=bstr.length,u8arr=new Uint8Array(n);n--;)u8arr[n]=bstr.charCodeAt(n);var blob=new Blob([u8arr]);window.navigator.msSaveOrOpenBlob(blob,filename)}else{var frame=document.createElement("iframe");document.body.appendChild(frame);var cw=frame.contentWindow,doc=cw.document;doc.open("image/svg+xml","replace"),doc.write(bstr),doc.close(),cw.focus(),doc.execCommand("SaveAs",!0,filename),document.body.removeChild(frame)}}else{var lang=model.get("lang"),html='<body style="margin:0;"><img src="'+url+'" style="max-width:100%;" title="'+(lang&&lang[0]||"")+'" /></body>',tab=window.open();tab.document.write(html),tab.document.title=title}else{var $a=document.createElement("a");$a.download=title+"."+type,$a.target="_blank",$a.href=url;var evt=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});$a.dispatchEvent(evt)}},SaveAsImage2.getDefaultOption=function(ecModel){return{show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:ecModel.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:ecModel.getLocaleModel().get(["toolbox","saveAsImage","lang"])}},SaveAsImage2}(ToolboxFeature),radioTypes=[["line","bar"],["stack"]],MagicType=function(_super){function MagicType2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(MagicType2,_super),MagicType2.prototype.getIcons=function(){var model=this.model,availableIcons=model.get("icon"),icons={};return each$d(model.get("type"),(function(type){availableIcons[type]&&(icons[type]=availableIcons[type])})),icons},MagicType2.getDefaultOption=function(ecModel){return{show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:ecModel.getLocaleModel().get(["toolbox","magicType","title"]),option:{},seriesIndex:{}}},MagicType2.prototype.onclick=function(ecModel,api,type){var model=this.model,seriesIndex=model.get(["seriesIndex",type]);if(seriesOptGenreator[type]){var newTitle,newOption={series:[]};each$d(radioTypes,(function(radio){indexOf(radio,type)>=0&&each$d(radio,(function(item){model.setIconStatus(item,"normal")}))})),model.setIconStatus(type,"emphasis"),ecModel.eachComponent({mainType:"series",query:null==seriesIndex?null:{seriesIndex:seriesIndex}},(function(seriesModel){var seriesType2=seriesModel.subType,seriesId=seriesModel.id,newSeriesOpt=seriesOptGenreator[type](seriesType2,seriesId,seriesModel,model);newSeriesOpt&&(defaults(newSeriesOpt,seriesModel.option),newOption.series.push(newSeriesOpt));var coordSys=seriesModel.coordinateSystem;if(coordSys&&"cartesian2d"===coordSys.type&&("line"===type||"bar"===type)){var categoryAxis2=coordSys.getAxesByScale("ordinal")[0];if(categoryAxis2){var axisType=categoryAxis2.dim+"Axis",axisIndex=seriesModel.getReferringComponents(axisType,SINGLE_REFERRING).models[0].componentIndex;newOption[axisType]=newOption[axisType]||[];for(var i=0;i<=axisIndex;i++)newOption[axisType][axisIndex]=newOption[axisType][axisIndex]||{};newOption[axisType][axisIndex].boundaryGap="bar"===type}}}));var currentType=type;"stack"===type&&(newTitle=merge({stack:model.option.title.tiled,tiled:model.option.title.stack},model.option.title),"emphasis"!==model.get(["iconStatus",type])&&(currentType="tiled")),api.dispatchAction({type:"changeMagicType",currentType:currentType,newOption:newOption,newTitle:newTitle,featureName:"magicType"})}},MagicType2}(ToolboxFeature),seriesOptGenreator={line:function(seriesType2,seriesId,seriesModel,model){if("bar"===seriesType2)return merge({id:seriesId,type:"line",data:seriesModel.get("data"),stack:seriesModel.get("stack"),markPoint:seriesModel.get("markPoint"),markLine:seriesModel.get("markLine")},model.get(["option","line"])||{},!0)},bar:function(seriesType2,seriesId,seriesModel,model){if("line"===seriesType2)return merge({id:seriesId,type:"bar",data:seriesModel.get("data"),stack:seriesModel.get("stack"),markPoint:seriesModel.get("markPoint"),markLine:seriesModel.get("markLine")},model.get(["option","bar"])||{},!0)},stack:function(seriesType2,seriesId,seriesModel,model){var isStack="__ec_magicType_stack__"===seriesModel.get("stack");if("line"===seriesType2||"bar"===seriesType2)return model.setIconStatus("stack",isStack?"normal":"emphasis"),merge({id:seriesId,stack:isStack?"":"__ec_magicType_stack__"},model.get(["option","stack"])||{},!0)}};registerAction({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},(function(payload,ecModel){ecModel.mergeOption(payload.newOption)}));var BLOCK_SPLITER=new Array(60).join("-");function trim(str){return str.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}var itemSplitRegex=new RegExp("[\t]+","g");function parseContents(str,blockMetaList){var blocks=str.split(new RegExp("\n*"+BLOCK_SPLITER+"\n*","g")),newOption={series:[]};return each$d(blocks,(function(block,idx){if(function(block){if(block.slice(0,block.indexOf("\n")).indexOf("\t")>=0)return!0}(block)){var result=function(tsv){for(var tsvLines=tsv.split(/\n+/g),categories=[],series=map$1(trim(tsvLines.shift()).split(itemSplitRegex),(function(header){return{name:header,data:[]}})),i=0;i<tsvLines.length;i++){var items=trim(tsvLines[i]).split(itemSplitRegex);categories.push(items.shift());for(var j=0;j<items.length;j++)series[j]&&(series[j].data[i]=items[j])}return{series:series,categories:categories}}(block),blockMeta=blockMetaList[idx],axisKey=blockMeta.axisDim+"Axis";blockMeta&&(newOption[axisKey]=newOption[axisKey]||[],newOption[axisKey][blockMeta.axisIndex]={data:result.categories},newOption.series=newOption.series.concat(result.series))}else{result=function(str){for(var lines=str.split(/\n+/g),seriesName=trim(lines.shift()),data=[],i=0;i<lines.length;i++){var line=trim(lines[i]);if(line){var items=line.split(itemSplitRegex),name_1="",value=void 0,hasName=!1;isNaN(items[0])?(hasName=!0,name_1=items[0],items=items.slice(1),data[i]={name:name_1,value:[]},value=data[i].value):value=data[i]=[];for(var j=0;j<items.length;j++)value.push(+items[j]);1===value.length&&(hasName?data[i].value=value[0]:data[i]=value[0])}}return{name:seriesName,data:data}}(block);newOption.series.push(result)}})),newOption}var DataView=function(_super){function DataView2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(DataView2,_super),DataView2.prototype.onclick=function(ecModel,api){setTimeout((function(){api.dispatchAction({type:"hideTip"})}));var container=api.getDom(),model=this.model;this._dom&&container.removeChild(this._dom);var root=document.createElement("div");root.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;padding:5px",root.style.backgroundColor=model.get("backgroundColor")||"#fff";var header=document.createElement("h4"),lang=model.get("lang")||[];header.innerHTML=lang[0]||model.get("title"),header.style.cssText="margin:10px 20px",header.style.color=model.get("textColor");var viewMain=document.createElement("div"),textarea=document.createElement("textarea");viewMain.style.cssText="overflow:auto";var optionToContent=model.get("optionToContent"),contentToOption=model.get("contentToOption"),result=function(ecModel){var series,groups,tables,result=function(ecModel){var seriesGroupByCategoryAxis={},otherSeries=[],meta=[];return ecModel.eachRawSeries((function(seriesModel){var coordSys=seriesModel.coordinateSystem;if(!coordSys||"cartesian2d"!==coordSys.type&&"polar"!==coordSys.type)otherSeries.push(seriesModel);else{var baseAxis=coordSys.getBaseAxis();if("category"===baseAxis.type){var key=baseAxis.dim+"_"+baseAxis.index;seriesGroupByCategoryAxis[key]||(seriesGroupByCategoryAxis[key]={categoryAxis:baseAxis,valueAxis:coordSys.getOtherAxis(baseAxis),series:[]},meta.push({axisDim:baseAxis.dim,axisIndex:baseAxis.index})),seriesGroupByCategoryAxis[key].series.push(seriesModel)}else otherSeries.push(seriesModel)}})),{seriesGroupByCategoryAxis:seriesGroupByCategoryAxis,other:otherSeries,meta:meta}}(ecModel);return{value:filter([(groups=result.seriesGroupByCategoryAxis,tables=[],each$d(groups,(function(group,key){var categoryAxis2=group.categoryAxis,valueAxisDim=group.valueAxis.dim,headers=[" "].concat(map$1(group.series,(function(series){return series.name}))),columns=[categoryAxis2.model.getCategories()];each$d(group.series,(function(series){var rawData=series.getRawData();columns.push(series.getRawData().mapArray(rawData.mapDimension(valueAxisDim),(function(val){return val})))}));for(var lines=[headers.join("\t")],i=0;i<columns[0].length;i++){for(var items=[],j=0;j<columns.length;j++)items.push(columns[j][i]);lines.push(items.join("\t"))}tables.push(lines.join("\n"))})),tables.join("\n\n"+BLOCK_SPLITER+"\n\n")),(series=result.other,map$1(series,(function(series2){var data=series2.getRawData(),lines=[series2.name],vals=[];return data.each(data.dimensions,(function(){for(var argLen=arguments.length,dataIndex=arguments[argLen-1],name=data.getName(dataIndex),i=0;i<argLen-1;i++)vals[i]=arguments[i];lines.push((name?name+"\t":"")+vals.join("\t"))})),lines.join("\n")})).join("\n\n"+BLOCK_SPLITER+"\n\n"))],(function(str){return!!str.replace(/[\n\t\s]/g,"")})).join("\n\n"+BLOCK_SPLITER+"\n\n"),meta:result.meta}}(ecModel);if(isFunction(optionToContent)){var htmlOrDom=optionToContent(api.getOption());isString(htmlOrDom)?viewMain.innerHTML=htmlOrDom:isDom(htmlOrDom)&&viewMain.appendChild(htmlOrDom)}else{textarea.readOnly=model.get("readOnly");var style=textarea.style;style.cssText="display:block;width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;resize:none;box-sizing:border-box;outline:none",style.color=model.get("textColor"),style.borderColor=model.get("textareaBorderColor"),style.backgroundColor=model.get("textareaColor"),textarea.value=result.value,viewMain.appendChild(textarea)}var blockMetaList=result.meta,buttonContainer=document.createElement("div");buttonContainer.style.cssText="position:absolute;bottom:5px;left:0;right:0";var buttonStyle="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",closeButton=document.createElement("div"),refreshButton=document.createElement("div");buttonStyle+=";background-color:"+model.get("buttonColor"),buttonStyle+=";color:"+model.get("buttonTextColor");var self2=this;function close(){container.removeChild(root),self2._dom=null}addEventListener(closeButton,"click",close),addEventListener(refreshButton,"click",(function(){if(null==contentToOption&&null!=optionToContent||null!=contentToOption&&null==optionToContent)close();else{var newOption;try{newOption=isFunction(contentToOption)?contentToOption(viewMain,api.getOption()):parseContents(textarea.value,blockMetaList)}catch(e2){throw close(),new Error("Data view format error "+e2)}newOption&&api.dispatchAction({type:"changeDataView",newOption:newOption}),close()}})),closeButton.innerHTML=lang[1],refreshButton.innerHTML=lang[2],refreshButton.style.cssText=closeButton.style.cssText=buttonStyle,!model.get("readOnly")&&buttonContainer.appendChild(refreshButton),buttonContainer.appendChild(closeButton),root.appendChild(header),root.appendChild(viewMain),root.appendChild(buttonContainer),viewMain.style.height=container.clientHeight-80+"px",container.appendChild(root),this._dom=root},DataView2.prototype.remove=function(ecModel,api){this._dom&&api.getDom().removeChild(this._dom)},DataView2.prototype.dispose=function(ecModel,api){this.remove(ecModel,api)},DataView2.getDefaultOption=function(ecModel){return{show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:ecModel.getLocaleModel().get(["toolbox","dataView","title"]),lang:ecModel.getLocaleModel().get(["toolbox","dataView","lang"]),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"}},DataView2}(ToolboxFeature);function tryMergeDataOption(newData,originalData){return map$1(newData,(function(newVal,idx){var original=originalData&&originalData[idx];if(isObject$3(original)&&!isArray$1(original)){isObject$3(newVal)&&!isArray$1(newVal)||(newVal={value:newVal});var shouldDeleteName=null!=original.name&&null==newVal.name;return newVal=defaults(newVal,original),shouldDeleteName&&delete newVal.name,newVal}return newVal}))}registerAction({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},(function(payload,ecModel){var newSeriesOptList=[];each$d(payload.newOption.series,(function(seriesOpt){var seriesModel=ecModel.getSeriesByName(seriesOpt.name)[0];if(seriesModel){var originalData=seriesModel.get("data");newSeriesOptList.push({name:seriesOpt.name,data:tryMergeDataOption(seriesOpt.data,originalData)})}else newSeriesOptList.push(extend({type:"scatter"},seriesOpt))})),ecModel.mergeOption(defaults({series:newSeriesOptList},payload.newOption))}));var each$6=each$d,inner$2=makeInner();function getStoreSnapshots(ecModel){var store=inner$2(ecModel);return store.snapshots||(store.snapshots=[{}]),store.snapshots}var RestoreOption=function(_super){function RestoreOption2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(RestoreOption2,_super),RestoreOption2.prototype.onclick=function(ecModel,api){!function(ecModel){inner$2(ecModel).snapshots=null}(ecModel),api.dispatchAction({type:"restore",from:this.uid})},RestoreOption2.getDefaultOption=function(ecModel){return{show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:ecModel.getLocaleModel().get(["toolbox","restore","title"])}},RestoreOption2}(ToolboxFeature);registerAction({type:"restore",event:"restore",update:"prepareAndUpdate"},(function(payload,ecModel){ecModel.resetOption("recreate")}));var INCLUDE_FINDER_MAIN_TYPES=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],BrushTargetManager=function(){function BrushTargetManager2(finder,ecModel,opt){var _this=this;this._targetInfoList=[];var foundCpts=parseFinder(ecModel,finder);each$d(targetInfoBuilders,(function(builder,type){(!opt||!opt.include||indexOf(opt.include,type)>=0)&&builder(foundCpts,_this._targetInfoList)}))}return BrushTargetManager2.prototype.setOutputRanges=function(areas,ecModel){return this.matchOutputRanges(areas,ecModel,(function(area,coordRange,coordSys){if((area.coordRanges||(area.coordRanges=[])).push(coordRange),!area.coordRange){area.coordRange=coordRange;var result=coordConvert[area.brushType](0,coordSys,coordRange);area.__rangeOffset={offset:diffProcessor[area.brushType](result.values,area.range,[1,1]),xyMinMax:result.xyMinMax}}})),areas},BrushTargetManager2.prototype.matchOutputRanges=function(areas,ecModel,cb){each$d(areas,(function(area){var targetInfo=this.findTargetInfo(area,ecModel);targetInfo&&!0!==targetInfo&&each$d(targetInfo.coordSyses,(function(coordSys){var result=coordConvert[area.brushType](1,coordSys,area.range,!0);cb(area,result.values,coordSys,ecModel)}))}),this)},BrushTargetManager2.prototype.setInputRanges=function(areas,ecModel){each$d(areas,(function(area){var xyMinMaxCurr,xyMinMaxOrigin,sizeCurr,sizeOrigin,scales,targetInfo=this.findTargetInfo(area,ecModel);if(area.range=area.range||[],targetInfo&&!0!==targetInfo){area.panelId=targetInfo.panelId;var result=coordConvert[area.brushType](0,targetInfo.coordSys,area.coordRange),rangeOffset=area.__rangeOffset;area.range=rangeOffset?diffProcessor[area.brushType](result.values,rangeOffset.offset,(xyMinMaxCurr=result.xyMinMax,xyMinMaxOrigin=rangeOffset.xyMinMax,sizeCurr=getSize(xyMinMaxCurr),sizeOrigin=getSize(xyMinMaxOrigin),scales=[sizeCurr[0]/sizeOrigin[0],sizeCurr[1]/sizeOrigin[1]],isNaN(scales[0])&&(scales[0]=1),isNaN(scales[1])&&(scales[1]=1),scales)):result.values}}),this)},BrushTargetManager2.prototype.makePanelOpts=function(api,getDefaultBrushType){return map$1(this._targetInfoList,(function(targetInfo){var rect=targetInfo.getPanelRect();return{panelId:targetInfo.panelId,defaultBrushType:getDefaultBrushType?getDefaultBrushType(targetInfo):null,clipPath:makeRectPanelClipPath(rect),isTargetByCursor:makeRectIsTargetByCursor(rect,api,targetInfo.coordSysModel),getLinearBrushOtherExtent:makeLinearBrushOtherExtent(rect)}}))},BrushTargetManager2.prototype.controlSeries=function(area,seriesModel,ecModel){var targetInfo=this.findTargetInfo(area,ecModel);return!0===targetInfo||targetInfo&&indexOf(targetInfo.coordSyses,seriesModel.coordinateSystem)>=0},BrushTargetManager2.prototype.findTargetInfo=function(area,ecModel){for(var targetInfoList=this._targetInfoList,foundCpts=parseFinder(ecModel,area),i=0;i<targetInfoList.length;i++){var targetInfo=targetInfoList[i],areaPanelId=area.panelId;if(areaPanelId){if(targetInfo.panelId===areaPanelId)return targetInfo}else for(var j=0;j<targetInfoMatchers.length;j++)if(targetInfoMatchers[j](foundCpts,targetInfo))return targetInfo}return!0},BrushTargetManager2}();function formatMinMax(minMax){return minMax[0]>minMax[1]&&minMax.reverse(),minMax}function parseFinder(ecModel,finder){return parseFinder$1(ecModel,finder,{includeMainTypes:INCLUDE_FINDER_MAIN_TYPES})}var targetInfoBuilders={grid:function(foundCpts,targetInfoList){var xAxisModels=foundCpts.xAxisModels,yAxisModels=foundCpts.yAxisModels,gridModels=foundCpts.gridModels,gridModelMap=createHashMap(),xAxesHas={},yAxesHas={};(xAxisModels||yAxisModels||gridModels)&&(each$d(xAxisModels,(function(axisModel){var gridModel=axisModel.axis.grid.model;gridModelMap.set(gridModel.id,gridModel),xAxesHas[gridModel.id]=!0})),each$d(yAxisModels,(function(axisModel){var gridModel=axisModel.axis.grid.model;gridModelMap.set(gridModel.id,gridModel),yAxesHas[gridModel.id]=!0})),each$d(gridModels,(function(gridModel){gridModelMap.set(gridModel.id,gridModel),xAxesHas[gridModel.id]=!0,yAxesHas[gridModel.id]=!0})),gridModelMap.each((function(gridModel){var grid=gridModel.coordinateSystem,cartesians=[];each$d(grid.getCartesians(),(function(cartesian,index){(indexOf(xAxisModels,cartesian.getAxis("x").model)>=0||indexOf(yAxisModels,cartesian.getAxis("y").model)>=0)&&cartesians.push(cartesian)})),targetInfoList.push({panelId:"grid--"+gridModel.id,gridModel:gridModel,coordSysModel:gridModel,coordSys:cartesians[0],coordSyses:cartesians,getPanelRect:panelRectBuilders.grid,xAxisDeclared:xAxesHas[gridModel.id],yAxisDeclared:yAxesHas[gridModel.id]})})))},geo:function(foundCpts,targetInfoList){each$d(foundCpts.geoModels,(function(geoModel){var coordSys=geoModel.coordinateSystem;targetInfoList.push({panelId:"geo--"+geoModel.id,geoModel:geoModel,coordSysModel:geoModel,coordSys:coordSys,coordSyses:[coordSys],getPanelRect:panelRectBuilders.geo})}))}},targetInfoMatchers=[function(foundCpts,targetInfo){var xAxisModel=foundCpts.xAxisModel,yAxisModel=foundCpts.yAxisModel,gridModel=foundCpts.gridModel;return!gridModel&&xAxisModel&&(gridModel=xAxisModel.axis.grid.model),!gridModel&&yAxisModel&&(gridModel=yAxisModel.axis.grid.model),gridModel&&gridModel===targetInfo.gridModel},function(foundCpts,targetInfo){var geoModel=foundCpts.geoModel;return geoModel&&geoModel===targetInfo.geoModel}],panelRectBuilders={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var coordSys=this.coordSys,rect=coordSys.getBoundingRect().clone();return rect.applyTransform(getTransform$1(coordSys)),rect}},coordConvert={lineX:curry$1(axisConvert,0),lineY:curry$1(axisConvert,1),rect:function(to,coordSys,rangeOrCoordRange,clamp2){var xminymin=to?coordSys.pointToData([rangeOrCoordRange[0][0],rangeOrCoordRange[1][0]],clamp2):coordSys.dataToPoint([rangeOrCoordRange[0][0],rangeOrCoordRange[1][0]],clamp2),xmaxymax=to?coordSys.pointToData([rangeOrCoordRange[0][1],rangeOrCoordRange[1][1]],clamp2):coordSys.dataToPoint([rangeOrCoordRange[0][1],rangeOrCoordRange[1][1]],clamp2),values=[formatMinMax([xminymin[0],xmaxymax[0]]),formatMinMax([xminymin[1],xmaxymax[1]])];return{values:values,xyMinMax:values}},polygon:function(to,coordSys,rangeOrCoordRange,clamp2){var xyMinMax=[[Infinity,-Infinity],[Infinity,-Infinity]];return{values:map$1(rangeOrCoordRange,(function(item){var p=to?coordSys.pointToData(item,clamp2):coordSys.dataToPoint(item,clamp2);return xyMinMax[0][0]=Math.min(xyMinMax[0][0],p[0]),xyMinMax[1][0]=Math.min(xyMinMax[1][0],p[1]),xyMinMax[0][1]=Math.max(xyMinMax[0][1],p[0]),xyMinMax[1][1]=Math.max(xyMinMax[1][1],p[1]),p})),xyMinMax:xyMinMax}}};function axisConvert(axisNameIndex,to,coordSys,rangeOrCoordRange){var axis=coordSys.getAxis(["x","y"][axisNameIndex]),values=formatMinMax(map$1([0,1],(function(i){return to?axis.coordToData(axis.toLocalCoord(rangeOrCoordRange[i]),!0):axis.toGlobalCoord(axis.dataToCoord(rangeOrCoordRange[i]))}))),xyMinMax=[];return xyMinMax[axisNameIndex]=values,xyMinMax[1-axisNameIndex]=[NaN,NaN],{values:values,xyMinMax:xyMinMax}}var diffProcessor={lineX:curry$1(axisDiffProcessor,0),lineY:curry$1(axisDiffProcessor,1),rect:function(values,refer,scales){return[[values[0][0]-scales[0]*refer[0][0],values[0][1]-scales[0]*refer[0][1]],[values[1][0]-scales[1]*refer[1][0],values[1][1]-scales[1]*refer[1][1]]]},polygon:function(values,refer,scales){return map$1(values,(function(item,idx){return[item[0]-scales[0]*refer[idx][0],item[1]-scales[1]*refer[idx][1]]}))}};function axisDiffProcessor(axisNameIndex,values,refer,scales){return[values[0]-scales[axisNameIndex]*refer[0],values[1]-scales[axisNameIndex]*refer[1]]}function getSize(xyMinMax){return xyMinMax?[xyMinMax[0][1]-xyMinMax[0][0],xyMinMax[1][1]-xyMinMax[1][0]]:[NaN,NaN]}var mainType,creator,each$5=each$d,DATA_ZOOM_ID_BASE="\0_ec_\0"+"toolbox-dataZoom_",DataZoomFeature=function(_super){function DataZoomFeature2(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(DataZoomFeature2,_super),DataZoomFeature2.prototype.render=function(featureModel,ecModel,api,payload){this._brushController||(this._brushController=new BrushController(api.getZr()),this._brushController.on("brush",bind$1(this._onBrush,this)).mount()),function(featureModel,ecModel,view,payload,api){var zoomActive=view._isZoomActive;payload&&"takeGlobalCursor"===payload.type&&(zoomActive="dataZoomSelect"===payload.key&&payload.dataZoomSelectActive);view._isZoomActive=zoomActive,featureModel.setIconStatus("zoom",zoomActive?"emphasis":"normal");var brushTargetManager=new BrushTargetManager(makeAxisFinder(featureModel),ecModel,{include:["grid"]}),panels=brushTargetManager.makePanelOpts(api,(function(targetInfo){return targetInfo.xAxisDeclared&&!targetInfo.yAxisDeclared?"lineX":!targetInfo.xAxisDeclared&&targetInfo.yAxisDeclared?"lineY":"rect"}));view._brushController.setPanels(panels).enableBrush(!(!zoomActive||!panels.length)&&{brushType:"auto",brushStyle:featureModel.getModel("brushStyle").getItemStyle()})}(featureModel,ecModel,this,payload,api),function(featureModel,ecModel){featureModel.setIconStatus("back",function(ecModel){return getStoreSnapshots(ecModel).length}(ecModel)>1?"emphasis":"normal")}(featureModel,ecModel)},DataZoomFeature2.prototype.onclick=function(ecModel,api,type){handlers[type].call(this)},DataZoomFeature2.prototype.remove=function(ecModel,api){this._brushController&&this._brushController.unmount()},DataZoomFeature2.prototype.dispose=function(ecModel,api){this._brushController&&this._brushController.dispose()},DataZoomFeature2.prototype._onBrush=function(eventParam){var areas=eventParam.areas;if(eventParam.isEnd&&areas.length){var snapshot={},ecModel=this.ecModel;this._brushController.updateCovers([]),new BrushTargetManager(makeAxisFinder(this.model),ecModel,{include:["grid"]}).matchOutputRanges(areas,ecModel,(function(area,coordRange,coordSys){if("cartesian2d"===coordSys.type){var brushType=area.brushType;"rect"===brushType?(setBatch("x",coordSys,coordRange[0]),setBatch("y",coordSys,coordRange[1])):setBatch({lineX:"x",lineY:"y"}[brushType],coordSys,coordRange)}})),function(ecModel,newSnapshot){var storedSnapshots=getStoreSnapshots(ecModel);each$6(newSnapshot,(function(batchItem,dataZoomId){for(var i=storedSnapshots.length-1;i>=0&&!storedSnapshots[i][dataZoomId];i--);if(i<0){var dataZoomModel=ecModel.queryComponents({mainType:"dataZoom",subType:"select",id:dataZoomId})[0];if(dataZoomModel){var percentRange=dataZoomModel.getPercentRange();storedSnapshots[0][dataZoomId]={dataZoomId:dataZoomId,start:percentRange[0],end:percentRange[1]}}}})),storedSnapshots.push(newSnapshot)}(ecModel,snapshot),this._dispatchZoomAction(snapshot)}function setBatch(dimName,coordSys,minMax){var axis=coordSys.getAxis(dimName),axisModel=axis.model,dataZoomModel=function(dimName,axisModel,ecModel2){var found;return ecModel2.eachComponent({mainType:"dataZoom",subType:"select"},(function(dzModel){dzModel.getAxisModel(dimName,axisModel.componentIndex)&&(found=dzModel)})),found}(dimName,axisModel,ecModel),minMaxSpan=dataZoomModel.findRepresentativeAxisProxy(axisModel).getMinMaxSpan();null==minMaxSpan.minValueSpan&&null==minMaxSpan.maxValueSpan||(minMax=sliderMove(0,minMax.slice(),axis.scale.getExtent(),0,minMaxSpan.minValueSpan,minMaxSpan.maxValueSpan)),dataZoomModel&&(snapshot[dataZoomModel.id]={dataZoomId:dataZoomModel.id,startValue:minMax[0],endValue:minMax[1]})}},DataZoomFeature2.prototype._dispatchZoomAction=function(snapshot){var batch=[];each$5(snapshot,(function(batchItem,dataZoomId){batch.push(clone$3(batchItem))})),batch.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:batch})},DataZoomFeature2.getDefaultOption=function(ecModel){return{show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:ecModel.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}}},DataZoomFeature2}(ToolboxFeature),handlers={zoom:function(){var nextActive=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:nextActive})},back:function(){this._dispatchZoomAction(function(ecModel){var storedSnapshots=getStoreSnapshots(ecModel),head=storedSnapshots[storedSnapshots.length-1];storedSnapshots.length>1&&storedSnapshots.pop();var snapshot={};return each$6(head,(function(batchItem,dataZoomId){for(var i=storedSnapshots.length-1;i>=0;i--)if(batchItem=storedSnapshots[i][dataZoomId]){snapshot[dataZoomId]=batchItem;break}})),snapshot}(this.ecModel))}};function makeAxisFinder(dzFeatureModel){var setting={xAxisIndex:dzFeatureModel.get("xAxisIndex",!0),yAxisIndex:dzFeatureModel.get("yAxisIndex",!0),xAxisId:dzFeatureModel.get("xAxisId",!0),yAxisId:dzFeatureModel.get("yAxisId",!0)};return null==setting.xAxisIndex&&null==setting.xAxisId&&(setting.xAxisIndex="all"),null==setting.yAxisIndex&&null==setting.yAxisId&&(setting.yAxisIndex="all"),setting}mainType="dataZoom",creator=function(ecModel){var toolboxModel=ecModel.getComponent("toolbox",0),featureDataZoomPath=["feature","dataZoom"];if(toolboxModel&&null!=toolboxModel.get(featureDataZoomPath)){var dzFeatureModel=toolboxModel.getModel(featureDataZoomPath),dzOptions=[],finderResult=parseFinder$1(ecModel,makeAxisFinder(dzFeatureModel));return each$5(finderResult.xAxisModels,(function(axisModel){return buildInternalOptions(axisModel,"xAxis","xAxisIndex")})),each$5(finderResult.yAxisModels,(function(axisModel){return buildInternalOptions(axisModel,"yAxis","yAxisIndex")})),dzOptions}function buildInternalOptions(axisModel,axisMainType,axisIndexPropName){var axisIndex=axisModel.componentIndex,newOpt={type:"select",$fromToolbox:!0,filterMode:dzFeatureModel.get("filterMode",!0)||"filter",id:DATA_ZOOM_ID_BASE+axisMainType+axisIndex};newOpt[axisIndexPropName]=axisIndex,dzOptions.push(newOpt)}},assert(null==internalOptionCreatorMap.get(mainType)&&creator),internalOptionCreatorMap.set(mainType,creator);var TooltipModel=function(_super){function TooltipModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=TooltipModel2.type,_this}return __extends(TooltipModel2,_super),TooltipModel2.type="tooltip",TooltipModel2.dependencies=["axisPointer"],TooltipModel2.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},TooltipModel2}(ComponentModel);function shouldTooltipConfine(tooltipModel){var confineOption=tooltipModel.get("confine");return null!=confineOption?!!confineOption:"richText"===tooltipModel.get("renderMode")}function testStyle(styleProps){if(env.domSupported)for(var style=document.documentElement.style,i=0,len2=styleProps.length;i<len2;i++)if(styleProps[i]in style)return styleProps[i]}var TRANSFORM_VENDOR=testStyle(["transform","webkitTransform","OTransform","MozTransform","msTransform"]);function toCSSVendorPrefix(styleVendor,styleProp){if(!styleVendor)return styleProp;styleProp=toCamelCase(styleProp,!0);var idx=styleVendor.indexOf(styleProp);return(styleVendor=-1===idx?styleProp:"-"+styleVendor.slice(0,idx)+"-"+styleProp).toLowerCase()}var CSS_TRANSITION_VENDOR=toCSSVendorPrefix(testStyle(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),"transition"),CSS_TRANSFORM_VENDOR=toCSSVendorPrefix(TRANSFORM_VENDOR,"transform"),gCssText="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(env.transform3dSupported?"will-change:transform;":"");function assembleTransform(x,y,toString){var x0=x.toFixed(0)+"px",y0=y.toFixed(0)+"px";if(!env.transformSupported)return toString?"top:"+y0+";left:"+x0+";":[["top",y0],["left",x0]];var is3d=env.transform3dSupported,translate2="translate"+(is3d?"3d":"")+"("+x0+","+y0+(is3d?",0":"")+")";return toString?"top:0;left:0;"+CSS_TRANSFORM_VENDOR+":"+translate2+";":[["top",0],["left",0],[TRANSFORM_VENDOR,translate2]]}function assembleCssText(tooltipModel,enableTransition,onlyFade){var cssText=[],transitionDuration=tooltipModel.get("transitionDuration"),backgroundColor2=tooltipModel.get("backgroundColor"),shadowBlur=tooltipModel.get("shadowBlur"),shadowColor=tooltipModel.get("shadowColor"),shadowOffsetX=tooltipModel.get("shadowOffsetX"),shadowOffsetY=tooltipModel.get("shadowOffsetY"),textStyleModel=tooltipModel.getModel("textStyle"),padding=getPaddingFromTooltipModel(tooltipModel,"html"),boxShadow=shadowOffsetX+"px "+shadowOffsetY+"px "+shadowBlur+"px "+shadowColor;return cssText.push("box-shadow:"+boxShadow),enableTransition&&transitionDuration&&cssText.push(function(duration,onlyFade){var transitionOption=" "+duration/2+"s cubic-bezier(0.23,1,0.32,1)",transitionText="opacity"+transitionOption+",visibility"+transitionOption;return onlyFade||(transitionOption=" "+duration+"s cubic-bezier(0.23,1,0.32,1)",transitionText+=env.transformSupported?","+CSS_TRANSFORM_VENDOR+transitionOption:",left"+transitionOption+",top"+transitionOption),CSS_TRANSITION_VENDOR+":"+transitionText}(transitionDuration,onlyFade)),backgroundColor2&&cssText.push("background-color:"+backgroundColor2),each$d(["width","color","radius"],(function(name){var borderName="border-"+name,camelCase=toCamelCase(borderName),val=tooltipModel.get(camelCase);null!=val&&cssText.push(borderName+":"+val+("color"===name?"":"px"))})),cssText.push(function(textStyleModel){var cssText=[],fontSize=textStyleModel.get("fontSize"),color2=textStyleModel.getTextColor();color2&&cssText.push("color:"+color2),cssText.push("font:"+textStyleModel.getFont());var lineHeight=retrieve2(textStyleModel.get("lineHeight"),Math.round(3*fontSize/2));fontSize&&cssText.push("line-height:"+lineHeight+"px");var shadowColor=textStyleModel.get("textShadowColor"),shadowBlur=textStyleModel.get("textShadowBlur")||0,shadowOffsetX=textStyleModel.get("textShadowOffsetX")||0,shadowOffsetY=textStyleModel.get("textShadowOffsetY")||0;return shadowColor&&shadowBlur&&cssText.push("text-shadow:"+shadowOffsetX+"px "+shadowOffsetY+"px "+shadowBlur+"px "+shadowColor),each$d(["decoration","align"],(function(name){var val=textStyleModel.get(name);val&&cssText.push("text-"+name+":"+val)})),cssText.join(";")}(textStyleModel)),null!=padding&&cssText.push("padding:"+normalizeCssArray(padding).join("px ")+"px"),cssText.join(";")+";"}function makeStyleCoord$1(out2,zr,container,zrX,zrY){var zrPainter=zr&&zr.painter;if(container){var zrViewportRoot=zrPainter&&zrPainter.getViewportRoot();zrViewportRoot&&function(out2,elFrom,elTarget,inX,inY){transformCoordWithViewport(_calcOut$1,elFrom,inX,inY,!0)&&transformCoordWithViewport(out2,elTarget,_calcOut$1[0],_calcOut$1[1])}(out2,zrViewportRoot,container,zrX,zrY)}else{out2[0]=zrX,out2[1]=zrY;var viewportRootOffset=zrPainter&&zrPainter.getViewportRootOffset();viewportRootOffset&&(out2[0]+=viewportRootOffset.offsetLeft,out2[1]+=viewportRootOffset.offsetTop)}out2[2]=out2[0]/zr.getWidth(),out2[3]=out2[1]/zr.getHeight()}var TooltipHTMLContent=function(){function TooltipHTMLContent2(api,opt){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,env.wxa)return null;var el=document.createElement("div");el.domBelongToZr=!0,this.el=el;var zr=this._zr=api.getZr(),appendTo=opt.appendTo,container=appendTo&&(isString(appendTo)?document.querySelector(appendTo):isDom(appendTo)?appendTo:isFunction(appendTo)&&appendTo(api.getDom()));makeStyleCoord$1(this._styleCoord,zr,container,api.getWidth()/2,api.getHeight()/2),(container||api.getDom()).appendChild(el),this._api=api,this._container=container;var self2=this;el.onmouseenter=function(){self2._enterable&&(clearTimeout(self2._hideTimeout),self2._show=!0),self2._inContent=!0},el.onmousemove=function(e2){if(e2=e2||window.event,!self2._enterable){var handler=zr.handler;normalizeEvent(zr.painter.getViewportRoot(),e2,!0),handler.dispatch("mousemove",e2)}},el.onmouseleave=function(){self2._inContent=!1,self2._enterable&&self2._show&&self2.hideLater(self2._hideDelay)}}return TooltipHTMLContent2.prototype.update=function(tooltipModel){if(!this._container){var container=this._api.getDom(),position=(style="position",(stl=(el=container).currentStyle||document.defaultView&&document.defaultView.getComputedStyle(el))?stl[style]:null),domStyle=container.style;"absolute"!==domStyle.position&&"absolute"!==position&&(domStyle.position="relative")}var el,style,stl,alwaysShowContent=tooltipModel.get("alwaysShowContent");alwaysShowContent&&this._moveIfResized(),this._alwaysShowContent=alwaysShowContent,this.el.className=tooltipModel.get("className")||""},TooltipHTMLContent2.prototype.show=function(tooltipModel,nearPointColor){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var el=this.el,style=el.style,styleCoord=this._styleCoord;el.innerHTML?style.cssText=gCssText+assembleCssText(tooltipModel,!this._firstShow,this._longHide)+assembleTransform(styleCoord[0],styleCoord[1],!0)+"border-color:"+convertToColorString(nearPointColor)+";"+(tooltipModel.get("extraCssText")||"")+";pointer-events:"+(this._enterable?"auto":"none"):style.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},TooltipHTMLContent2.prototype.setContent=function(content,markers,tooltipModel,borderColor,arrowPosition){var el=this.el;if(null!=content){var arrow="";if(isString(arrowPosition)&&"item"===tooltipModel.get("trigger")&&!shouldTooltipConfine(tooltipModel)&&(arrow=function(tooltipModel,borderColor,arrowPosition){if(!isString(arrowPosition)||"inside"===arrowPosition)return"";var backgroundColor2=tooltipModel.get("backgroundColor"),borderWidth=tooltipModel.get("borderWidth");borderColor=convertToColorString(borderColor);var pos,rotateDeg,arrowPos="left"===(pos=arrowPosition)?"right":"right"===pos?"left":"top"===pos?"bottom":"top",arrowSize=Math.max(1.5*Math.round(borderWidth),6),positionStyle="",transformStyle=CSS_TRANSFORM_VENDOR+":";indexOf(["left","right"],arrowPos)>-1?(positionStyle+="top:50%",transformStyle+="translateY(-50%) rotate("+(rotateDeg="left"===arrowPos?-225:-45)+"deg)"):(positionStyle+="left:50%",transformStyle+="translateX(-50%) rotate("+(rotateDeg="top"===arrowPos?225:45)+"deg)");var rotateRadian=rotateDeg*Math.PI/180,arrowWH=arrowSize+borderWidth,rotatedWH=arrowWH*Math.abs(Math.cos(rotateRadian))+arrowWH*Math.abs(Math.sin(rotateRadian)),borderStyle=borderColor+" solid "+borderWidth+"px;";return'<div style="'+["position:absolute;width:"+arrowSize+"px;height:"+arrowSize+"px;z-index:-1;",(positionStyle+=";"+arrowPos+":-"+Math.round(100*((rotatedWH-Math.SQRT2*borderWidth)/2+Math.SQRT2*borderWidth-(rotatedWH-arrowWH)/2))/100+"px")+";"+transformStyle+";","border-bottom:"+borderStyle,"border-right:"+borderStyle,"background-color:"+backgroundColor2+";"].join("")+'"></div>'}(tooltipModel,borderColor,arrowPosition)),isString(content))el.innerHTML=content+arrow;else if(content){el.innerHTML="",isArray$1(content)||(content=[content]);for(var i=0;i<content.length;i++)isDom(content[i])&&content[i].parentNode!==el&&el.appendChild(content[i]);if(arrow&&el.childNodes.length){var arrowEl=document.createElement("div");arrowEl.innerHTML=arrow,el.appendChild(arrowEl)}}}else el.innerHTML=""},TooltipHTMLContent2.prototype.setEnterable=function(enterable){this._enterable=enterable},TooltipHTMLContent2.prototype.getSize=function(){var el=this.el;return el?[el.offsetWidth,el.offsetHeight]:[0,0]},TooltipHTMLContent2.prototype.moveTo=function(zrX,zrY){if(this.el){var styleCoord=this._styleCoord;if(makeStyleCoord$1(styleCoord,this._zr,this._container,zrX,zrY),null!=styleCoord[0]&&null!=styleCoord[1]){var style_1=this.el.style;each$d(assembleTransform(styleCoord[0],styleCoord[1]),(function(transform){style_1[transform[0]]=transform[1]}))}}},TooltipHTMLContent2.prototype._moveIfResized=function(){var ratioX=this._styleCoord[2],ratioY=this._styleCoord[3];this.moveTo(ratioX*this._zr.getWidth(),ratioY*this._zr.getHeight())},TooltipHTMLContent2.prototype.hide=function(){var _this=this,style=this.el.style;style.visibility="hidden",style.opacity="0",env.transform3dSupported&&(style.willChange=""),this._show=!1,this._longHideTimeout=setTimeout((function(){return _this._longHide=!0}),500)},TooltipHTMLContent2.prototype.hideLater=function(time2){!this._show||this._inContent&&this._enterable||this._alwaysShowContent||(time2?(this._hideDelay=time2,this._show=!1,this._hideTimeout=setTimeout(bind$1(this.hide,this),time2)):this.hide())},TooltipHTMLContent2.prototype.isShow=function(){return this._show},TooltipHTMLContent2.prototype.dispose=function(){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var parentNode2=this.el.parentNode;parentNode2&&parentNode2.removeChild(this.el),this.el=this._container=null},TooltipHTMLContent2}(),TooltipRichContent=function(){function TooltipRichContent2(api){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=api.getZr(),makeStyleCoord(this._styleCoord,this._zr,api.getWidth()/2,api.getHeight()/2)}return TooltipRichContent2.prototype.update=function(tooltipModel){var alwaysShowContent=tooltipModel.get("alwaysShowContent");alwaysShowContent&&this._moveIfResized(),this._alwaysShowContent=alwaysShowContent},TooltipRichContent2.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},TooltipRichContent2.prototype.setContent=function(content,markupStyleCreator,tooltipModel,borderColor,arrowPosition){var _this=this;isObject$3(content)&&throwError(""),this.el&&this._zr.remove(this.el);var textStyleModel=tooltipModel.getModel("textStyle");this.el=new ZRText({style:{rich:markupStyleCreator.richTextStyles,text:content,lineHeight:22,borderWidth:1,borderColor:borderColor,textShadowColor:textStyleModel.get("textShadowColor"),fill:tooltipModel.get(["textStyle","color"]),padding:getPaddingFromTooltipModel(tooltipModel,"richText"),verticalAlign:"top",align:"left"},z:tooltipModel.get("z")}),each$d(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],(function(propName){_this.el.style[propName]=tooltipModel.get(propName)})),each$d(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],(function(propName){_this.el.style[propName]=textStyleModel.get(propName)||0})),this._zr.add(this.el);var self2=this;this.el.on("mouseover",(function(){self2._enterable&&(clearTimeout(self2._hideTimeout),self2._show=!0),self2._inContent=!0})),this.el.on("mouseout",(function(){self2._enterable&&self2._show&&self2.hideLater(self2._hideDelay),self2._inContent=!1}))},TooltipRichContent2.prototype.setEnterable=function(enterable){this._enterable=enterable},TooltipRichContent2.prototype.getSize=function(){var el=this.el,bounding=this.el.getBoundingRect(),shadowOuterSize=calcShadowOuterSize(el.style);return[bounding.width+shadowOuterSize.left+shadowOuterSize.right,bounding.height+shadowOuterSize.top+shadowOuterSize.bottom]},TooltipRichContent2.prototype.moveTo=function(x,y){var el=this.el;if(el){var styleCoord=this._styleCoord;makeStyleCoord(styleCoord,this._zr,x,y),x=styleCoord[0],y=styleCoord[1];var style=el.style,borderWidth=mathMaxWith0(style.borderWidth||0),shadowOuterSize=calcShadowOuterSize(style);el.x=x+borderWidth+shadowOuterSize.left,el.y=y+borderWidth+shadowOuterSize.top,el.markRedraw()}},TooltipRichContent2.prototype._moveIfResized=function(){var ratioX=this._styleCoord[2],ratioY=this._styleCoord[3];this.moveTo(ratioX*this._zr.getWidth(),ratioY*this._zr.getHeight())},TooltipRichContent2.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},TooltipRichContent2.prototype.hideLater=function(time2){!this._show||this._inContent&&this._enterable||this._alwaysShowContent||(time2?(this._hideDelay=time2,this._show=!1,this._hideTimeout=setTimeout(bind$1(this.hide,this),time2)):this.hide())},TooltipRichContent2.prototype.isShow=function(){return this._show},TooltipRichContent2.prototype.dispose=function(){this._zr.remove(this.el)},TooltipRichContent2}();function mathMaxWith0(val){return Math.max(0,val)}function calcShadowOuterSize(style){var shadowBlur=mathMaxWith0(style.shadowBlur||0),shadowOffsetX=mathMaxWith0(style.shadowOffsetX||0),shadowOffsetY=mathMaxWith0(style.shadowOffsetY||0);return{left:mathMaxWith0(shadowBlur-shadowOffsetX),right:mathMaxWith0(shadowBlur+shadowOffsetX),top:mathMaxWith0(shadowBlur-shadowOffsetY),bottom:mathMaxWith0(shadowBlur+shadowOffsetY)}}function makeStyleCoord(out2,zr,zrX,zrY){out2[0]=zrX,out2[1]=zrY,out2[2]=out2[0]/zr.getWidth(),out2[3]=out2[1]/zr.getHeight()}var proxyRect=new Rect$1({shape:{x:-1,y:-1,width:2,height:2}}),TooltipView=function(_super){function TooltipView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=TooltipView2.type,_this}return __extends(TooltipView2,_super),TooltipView2.prototype.init=function(ecModel,api){if(!env.node&&api.getDom()){var renderModeOption,tooltipModel=ecModel.getComponent("tooltip"),renderMode=this._renderMode="auto"===(renderModeOption=tooltipModel.get("renderMode"))?env.domSupported?"html":"richText":renderModeOption||"html";this._tooltipContent="richText"===renderMode?new TooltipRichContent(api):new TooltipHTMLContent(api,{appendTo:tooltipModel.get("appendToBody",!0)?"body":tooltipModel.get("appendTo",!0)})}},TooltipView2.prototype.render=function(tooltipModel,ecModel,api){if(!env.node&&api.getDom()){this.group.removeAll(),this._tooltipModel=tooltipModel,this._ecModel=ecModel,this._api=api;var tooltipContent=this._tooltipContent;tooltipContent.update(tooltipModel),tooltipContent.setEnterable(tooltipModel.get("enterable")),this._initGlobalListener(),this._keepShow(),"richText"!==this._renderMode&&tooltipModel.get("transitionDuration")?createOrUpdate(this,"_updatePosition",50,"fixRate"):clear$1(this,"_updatePosition")}},TooltipView2.prototype._initGlobalListener=function(){var triggerOn=this._tooltipModel.get("triggerOn");register("itemTooltip",this._api,bind$1((function(currTrigger,e2,dispatchAction2){"none"!==triggerOn&&(triggerOn.indexOf(currTrigger)>=0?this._tryShow(e2,dispatchAction2):"leave"===currTrigger&&this._hide(dispatchAction2))}),this))},TooltipView2.prototype._keepShow=function(){var tooltipModel=this._tooltipModel,ecModel=this._ecModel,api=this._api,triggerOn=tooltipModel.get("triggerOn");if(null!=this._lastX&&null!=this._lastY&&"none"!==triggerOn&&"click"!==triggerOn){var self_1=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout((function(){!api.isDisposed()&&self_1.manuallyShowTip(tooltipModel,ecModel,api,{x:self_1._lastX,y:self_1._lastY,dataByCoordSys:self_1._lastDataByCoordSys})}))}},TooltipView2.prototype.manuallyShowTip=function(tooltipModel,ecModel,api,payload){if(payload.from!==this.uid&&!env.node&&api.getDom()){var dispatchAction2=makeDispatchAction(payload,api);this._ticket="";var dataByCoordSys=payload.dataByCoordSys,cmptRef=function(payload,ecModel,api){var queryOptionMap=preParseFinder(payload).queryOptionMap,componentMainType=queryOptionMap.keys()[0];if(!componentMainType||"series"===componentMainType)return;var queryResult=queryReferringComponents(ecModel,componentMainType,queryOptionMap.get(componentMainType),{useDefault:!1,enableAll:!1,enableNone:!1}),model=queryResult.models[0];if(!model)return;var el,view=api.getViewOfComponentModel(model);if(view.group.traverse((function(subEl){var tooltipConfig=getECData(subEl).tooltipConfig;if(tooltipConfig&&tooltipConfig.name===payload.name)return el=subEl,!0})),el)return{componentMainType:componentMainType,componentIndex:model.componentIndex,el:el}}(payload,ecModel,api);if(cmptRef){var rect=cmptRef.el.getBoundingRect().clone();rect.applyTransform(cmptRef.el.transform),this._tryShow({offsetX:rect.x+rect.width/2,offsetY:rect.y+rect.height/2,target:cmptRef.el,position:payload.position,positionDefault:"bottom"},dispatchAction2)}else if(payload.tooltip&&null!=payload.x&&null!=payload.y){var el=proxyRect;el.x=payload.x,el.y=payload.y,el.update(),getECData(el).tooltipConfig={name:null,option:payload.tooltip},this._tryShow({offsetX:payload.x,offsetY:payload.y,target:el},dispatchAction2)}else if(dataByCoordSys)this._tryShow({offsetX:payload.x,offsetY:payload.y,position:payload.position,dataByCoordSys:dataByCoordSys,tooltipOption:payload.tooltipOption},dispatchAction2);else if(null!=payload.seriesIndex){if(this._manuallyAxisShowTip(tooltipModel,ecModel,api,payload))return;var pointInfo=findPointFromSeries(payload,ecModel),cx=pointInfo.point[0],cy=pointInfo.point[1];null!=cx&&null!=cy&&this._tryShow({offsetX:cx,offsetY:cy,target:pointInfo.el,position:payload.position,positionDefault:"bottom"},dispatchAction2)}else null!=payload.x&&null!=payload.y&&(api.dispatchAction({type:"updateAxisPointer",x:payload.x,y:payload.y}),this._tryShow({offsetX:payload.x,offsetY:payload.y,position:payload.position,target:api.getZr().findHover(payload.x,payload.y).target},dispatchAction2))}},TooltipView2.prototype.manuallyHideTip=function(tooltipModel,ecModel,api,payload){var tooltipContent=this._tooltipContent;this._tooltipModel&&tooltipContent.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,payload.from!==this.uid&&this._hide(makeDispatchAction(payload,api))},TooltipView2.prototype._manuallyAxisShowTip=function(tooltipModel,ecModel,api,payload){var seriesIndex=payload.seriesIndex,dataIndex=payload.dataIndex,coordSysAxesInfo=ecModel.getComponent("axisPointer").coordSysAxesInfo;if(null!=seriesIndex&&null!=dataIndex&&null!=coordSysAxesInfo){var seriesModel=ecModel.getSeriesByIndex(seriesIndex);if(seriesModel)if("axis"===buildTooltipModel([seriesModel.getData().getItemModel(dataIndex),seriesModel,(seriesModel.coordinateSystem||{}).model],this._tooltipModel).get("trigger"))return api.dispatchAction({type:"updateAxisPointer",seriesIndex:seriesIndex,dataIndex:dataIndex,position:payload.position}),!0}},TooltipView2.prototype._tryShow=function(e2,dispatchAction2){var el=e2.target;if(this._tooltipModel){this._lastX=e2.offsetX,this._lastY=e2.offsetY;var dataByCoordSys=e2.dataByCoordSys;if(dataByCoordSys&&dataByCoordSys.length)this._showAxisTooltip(dataByCoordSys,e2);else if(el){var seriesDispatcher_1,cmptDispatcher_1;if("legend"===getECData(el).ssrType)return;this._lastDataByCoordSys=null,findEventDispatcher(el,(function(target){return null!=getECData(target).dataIndex?(seriesDispatcher_1=target,!0):null!=getECData(target).tooltipConfig?(cmptDispatcher_1=target,!0):void 0}),!0),seriesDispatcher_1?this._showSeriesItemTooltip(e2,seriesDispatcher_1,dispatchAction2):cmptDispatcher_1?this._showComponentItemTooltip(e2,cmptDispatcher_1,dispatchAction2):this._hide(dispatchAction2)}else this._lastDataByCoordSys=null,this._hide(dispatchAction2)}},TooltipView2.prototype._showOrMove=function(tooltipModel,cb){var delay=tooltipModel.get("showDelay");cb=bind$1(cb,this),clearTimeout(this._showTimout),delay>0?this._showTimout=setTimeout(cb,delay):cb()},TooltipView2.prototype._showAxisTooltip=function(dataByCoordSys,e2){var ecModel=this._ecModel,globalTooltipModel=this._tooltipModel,point=[e2.offsetX,e2.offsetY],singleTooltipModel=buildTooltipModel([e2.tooltipOption],globalTooltipModel),renderMode=this._renderMode,cbParamsList=[],articleMarkup=createTooltipMarkup("section",{blocks:[],noHeader:!0}),markupTextArrLegacy=[],markupStyleCreator=new TooltipMarkupStyleCreator;each$d(dataByCoordSys,(function(itemCoordSys){each$d(itemCoordSys.dataByAxis,(function(axisItem){var axisModel=ecModel.getComponent(axisItem.axisDim+"Axis",axisItem.axisIndex),axisValue=axisItem.value;if(axisModel&&null!=axisValue){var axisValueLabel=getValueLabel(axisValue,axisModel.axis,ecModel,axisItem.seriesDataIndices,axisItem.valueLabelOpt),axisSectionMarkup=createTooltipMarkup("section",{header:axisValueLabel,noHeader:!trim$1(axisValueLabel),sortBlocks:!0,blocks:[]});articleMarkup.blocks.push(axisSectionMarkup),each$d(axisItem.seriesDataIndices,(function(idxItem){var series=ecModel.getSeriesByIndex(idxItem.seriesIndex),dataIndex=idxItem.dataIndexInside,cbParams=series.getDataParams(dataIndex);if(!(cbParams.dataIndex<0)){cbParams.axisDim=axisItem.axisDim,cbParams.axisIndex=axisItem.axisIndex,cbParams.axisType=axisItem.axisType,cbParams.axisId=axisItem.axisId,cbParams.axisValue=getAxisRawValue(axisModel.axis,{value:axisValue}),cbParams.axisValueLabel=axisValueLabel,cbParams.marker=markupStyleCreator.makeTooltipMarker("item",convertToColorString(cbParams.color),renderMode);var seriesTooltipResult=normalizeTooltipFormatResult(series.formatTooltip(dataIndex,!0,null)),frag=seriesTooltipResult.frag;if(frag){var valueFormatter=buildTooltipModel([series],globalTooltipModel).get("valueFormatter");axisSectionMarkup.blocks.push(valueFormatter?extend({valueFormatter:valueFormatter},frag):frag)}seriesTooltipResult.text&&markupTextArrLegacy.push(seriesTooltipResult.text),cbParamsList.push(cbParams)}}))}}))})),articleMarkup.blocks.reverse(),markupTextArrLegacy.reverse();var positionExpr=e2.position,orderMode=singleTooltipModel.get("order"),builtMarkupText=buildTooltipMarkup(articleMarkup,markupStyleCreator,renderMode,orderMode,ecModel.get("useUTC"),singleTooltipModel.get("textStyle"));builtMarkupText&&markupTextArrLegacy.unshift(builtMarkupText);var blockBreak="richText"===renderMode?"\n\n":"<br/>",allMarkupText=markupTextArrLegacy.join(blockBreak);this._showOrMove(singleTooltipModel,(function(){this._updateContentNotChangedOnAxis(dataByCoordSys,cbParamsList)?this._updatePosition(singleTooltipModel,positionExpr,point[0],point[1],this._tooltipContent,cbParamsList):this._showTooltipContent(singleTooltipModel,allMarkupText,cbParamsList,Math.random()+"",point[0],point[1],positionExpr,null,markupStyleCreator)}))},TooltipView2.prototype._showSeriesItemTooltip=function(e2,dispatcher,dispatchAction2){var ecModel=this._ecModel,ecData=getECData(dispatcher),seriesIndex=ecData.seriesIndex,seriesModel=ecModel.getSeriesByIndex(seriesIndex),dataModel=ecData.dataModel||seriesModel,dataIndex=ecData.dataIndex,dataType=ecData.dataType,data=dataModel.getData(dataType),renderMode=this._renderMode,positionDefault=e2.positionDefault,tooltipModel=buildTooltipModel([data.getItemModel(dataIndex),dataModel,seriesModel&&(seriesModel.coordinateSystem||{}).model],this._tooltipModel,positionDefault?{position:positionDefault}:null),tooltipTrigger=tooltipModel.get("trigger");if(null==tooltipTrigger||"item"===tooltipTrigger){var params=dataModel.getDataParams(dataIndex,dataType),markupStyleCreator=new TooltipMarkupStyleCreator;params.marker=markupStyleCreator.makeTooltipMarker("item",convertToColorString(params.color),renderMode);var seriesTooltipResult=normalizeTooltipFormatResult(dataModel.formatTooltip(dataIndex,!1,dataType)),orderMode=tooltipModel.get("order"),valueFormatter=tooltipModel.get("valueFormatter"),frag=seriesTooltipResult.frag,markupText=frag?buildTooltipMarkup(valueFormatter?extend({valueFormatter:valueFormatter},frag):frag,markupStyleCreator,renderMode,orderMode,ecModel.get("useUTC"),tooltipModel.get("textStyle")):seriesTooltipResult.text,asyncTicket="item_"+dataModel.name+"_"+dataIndex;this._showOrMove(tooltipModel,(function(){this._showTooltipContent(tooltipModel,markupText,params,asyncTicket,e2.offsetX,e2.offsetY,e2.position,e2.target,markupStyleCreator)})),dispatchAction2({type:"showTip",dataIndexInside:dataIndex,dataIndex:data.getRawIndex(dataIndex),seriesIndex:seriesIndex,from:this.uid})}},TooltipView2.prototype._showComponentItemTooltip=function(e2,el,dispatchAction2){var isHTMLRenderMode="html"===this._renderMode,ecData=getECData(el),tooltipOpt=ecData.tooltipConfig.option||{},encodeHTMLContent=tooltipOpt.encodeHTMLContent;if(isString(tooltipOpt)){tooltipOpt={content:tooltipOpt,formatter:tooltipOpt},encodeHTMLContent=!0}encodeHTMLContent&&isHTMLRenderMode&&tooltipOpt.content&&((tooltipOpt=clone$3(tooltipOpt)).content=encodeHTML(tooltipOpt.content));var tooltipModelCascade=[tooltipOpt],cmpt=this._ecModel.getComponent(ecData.componentMainType,ecData.componentIndex);cmpt&&tooltipModelCascade.push(cmpt),tooltipModelCascade.push({formatter:tooltipOpt.content});var positionDefault=e2.positionDefault,subTooltipModel=buildTooltipModel(tooltipModelCascade,this._tooltipModel,positionDefault?{position:positionDefault}:null),defaultHtml=subTooltipModel.get("content"),asyncTicket=Math.random()+"",markupStyleCreator=new TooltipMarkupStyleCreator;this._showOrMove(subTooltipModel,(function(){var formatterParams=clone$3(subTooltipModel.get("formatterParams")||{});this._showTooltipContent(subTooltipModel,defaultHtml,formatterParams,asyncTicket,e2.offsetX,e2.offsetY,e2.position,el,markupStyleCreator)})),dispatchAction2({type:"showTip",from:this.uid})},TooltipView2.prototype._showTooltipContent=function(tooltipModel,defaultHtml,params,asyncTicket,x,y,positionExpr,el,markupStyleCreator){if(this._ticket="",tooltipModel.get("showContent")&&tooltipModel.get("show")){var tooltipContent=this._tooltipContent;tooltipContent.setEnterable(tooltipModel.get("enterable"));var formatter=tooltipModel.get("formatter");positionExpr=positionExpr||tooltipModel.get("position");var html=defaultHtml,nearPointColor=this._getNearestPoint([x,y],params,tooltipModel.get("trigger"),tooltipModel.get("borderColor")).color;if(formatter)if(isString(formatter)){var useUTC=tooltipModel.ecModel.get("useUTC"),params0=isArray$1(params)?params[0]:params;html=formatter,params0&&params0.axisType&&params0.axisType.indexOf("time")>=0&&(html=format$1(params0.axisValue,html,useUTC)),html=formatTpl(html,params,!0)}else if(isFunction(formatter)){var callback=bind$1((function(cbTicket,html2){cbTicket===this._ticket&&(tooltipContent.setContent(html2,markupStyleCreator,tooltipModel,nearPointColor,positionExpr),this._updatePosition(tooltipModel,positionExpr,x,y,tooltipContent,params,el))}),this);this._ticket=asyncTicket,html=formatter(params,asyncTicket,callback)}else html=formatter;tooltipContent.setContent(html,markupStyleCreator,tooltipModel,nearPointColor,positionExpr),tooltipContent.show(tooltipModel,nearPointColor),this._updatePosition(tooltipModel,positionExpr,x,y,tooltipContent,params,el)}},TooltipView2.prototype._getNearestPoint=function(point,tooltipDataParams,trigger2,borderColor){return"axis"===trigger2||isArray$1(tooltipDataParams)?{color:borderColor||("html"===this._renderMode?"#fff":"none")}:isArray$1(tooltipDataParams)?void 0:{color:borderColor||tooltipDataParams.color||tooltipDataParams.borderColor}},TooltipView2.prototype._updatePosition=function(tooltipModel,positionExpr,x,y,content,params,el){var viewWidth=this._api.getWidth(),viewHeight=this._api.getHeight();positionExpr=positionExpr||tooltipModel.get("position");var contentSize=content.getSize(),align=tooltipModel.get("align"),vAlign=tooltipModel.get("verticalAlign"),rect=el&&el.getBoundingRect().clone();if(el&&rect.applyTransform(el.transform),isFunction(positionExpr)&&(positionExpr=positionExpr([x,y],params,content.el,rect,{viewSize:[viewWidth,viewHeight],contentSize:contentSize.slice()})),isArray$1(positionExpr))x=parsePercent(positionExpr[0],viewWidth),y=parsePercent(positionExpr[1],viewHeight);else if(isObject$3(positionExpr)){var boxLayoutPosition=positionExpr;boxLayoutPosition.width=contentSize[0],boxLayoutPosition.height=contentSize[1];var layoutRect=getLayoutRect(boxLayoutPosition,{width:viewWidth,height:viewHeight});x=layoutRect.x,y=layoutRect.y,align=null,vAlign=null}else if(isString(positionExpr)&&el){var pos=function(position,rect,contentSize,borderWidth){var domWidth=contentSize[0],domHeight=contentSize[1],offset=Math.ceil(Math.SQRT2*borderWidth)+8,x=0,y=0,rectWidth=rect.width,rectHeight=rect.height;switch(position){case"inside":x=rect.x+rectWidth/2-domWidth/2,y=rect.y+rectHeight/2-domHeight/2;break;case"top":x=rect.x+rectWidth/2-domWidth/2,y=rect.y-domHeight-offset;break;case"bottom":x=rect.x+rectWidth/2-domWidth/2,y=rect.y+rectHeight+offset;break;case"left":x=rect.x-domWidth-offset,y=rect.y+rectHeight/2-domHeight/2;break;case"right":x=rect.x+rectWidth+offset,y=rect.y+rectHeight/2-domHeight/2}return[x,y]}(positionExpr,rect,contentSize,tooltipModel.get("borderWidth"));x=pos[0],y=pos[1]}else{pos=function(x,y,content,viewWidth,viewHeight,gapH,gapV){var size=content.getSize(),width=size[0],height=size[1];null!=gapH&&(x+width+gapH+2>viewWidth?x-=width+gapH:x+=gapH);null!=gapV&&(y+height+gapV>viewHeight?y-=height+gapV:y+=gapV);return[x,y]}(x,y,content,viewWidth,viewHeight,align?null:20,vAlign?null:20);x=pos[0],y=pos[1]}if(align&&(x-=isCenterAlign(align)?contentSize[0]/2:"right"===align?contentSize[0]:0),vAlign&&(y-=isCenterAlign(vAlign)?contentSize[1]/2:"bottom"===vAlign?contentSize[1]:0),shouldTooltipConfine(tooltipModel)){pos=function(x,y,content,viewWidth,viewHeight){var size=content.getSize(),width=size[0],height=size[1];return x=Math.min(x+width,viewWidth)-width,y=Math.min(y+height,viewHeight)-height,x=Math.max(x,0),y=Math.max(y,0),[x,y]}(x,y,content,viewWidth,viewHeight);x=pos[0],y=pos[1]}content.moveTo(x,y)},TooltipView2.prototype._updateContentNotChangedOnAxis=function(dataByCoordSys,cbParamsList){var lastCoordSys=this._lastDataByCoordSys,lastCbParamsList=this._cbParamsList,contentNotChanged=!!lastCoordSys&&lastCoordSys.length===dataByCoordSys.length;return contentNotChanged&&each$d(lastCoordSys,(function(lastItemCoordSys,indexCoordSys){var lastDataByAxis=lastItemCoordSys.dataByAxis||[],thisDataByAxis=(dataByCoordSys[indexCoordSys]||{}).dataByAxis||[];(contentNotChanged=contentNotChanged&&lastDataByAxis.length===thisDataByAxis.length)&&each$d(lastDataByAxis,(function(lastItem,indexAxis){var thisItem=thisDataByAxis[indexAxis]||{},lastIndices=lastItem.seriesDataIndices||[],newIndices=thisItem.seriesDataIndices||[];(contentNotChanged=contentNotChanged&&lastItem.value===thisItem.value&&lastItem.axisType===thisItem.axisType&&lastItem.axisId===thisItem.axisId&&lastIndices.length===newIndices.length)&&each$d(lastIndices,(function(lastIdxItem,j){var newIdxItem=newIndices[j];contentNotChanged=contentNotChanged&&lastIdxItem.seriesIndex===newIdxItem.seriesIndex&&lastIdxItem.dataIndex===newIdxItem.dataIndex})),lastCbParamsList&&each$d(lastItem.seriesDataIndices,(function(idxItem){var seriesIdx=idxItem.seriesIndex,cbParams=cbParamsList[seriesIdx],lastCbParams=lastCbParamsList[seriesIdx];cbParams&&lastCbParams&&lastCbParams.data!==cbParams.data&&(contentNotChanged=!1)}))}))})),this._lastDataByCoordSys=dataByCoordSys,this._cbParamsList=cbParamsList,!!contentNotChanged},TooltipView2.prototype._hide=function(dispatchAction2){this._lastDataByCoordSys=null,dispatchAction2({type:"hideTip",from:this.uid})},TooltipView2.prototype.dispose=function(ecModel,api){!env.node&&api.getDom()&&(clear$1(this,"_updatePosition"),this._tooltipContent.dispose(),unregister("itemTooltip",api))},TooltipView2.type="tooltip",TooltipView2}(ComponentView);function buildTooltipModel(modelCascade,globalTooltipModel,defaultTooltipOption){var resultModel,ecModel=globalTooltipModel.ecModel;defaultTooltipOption?(resultModel=new Model(defaultTooltipOption,ecModel,ecModel),resultModel=new Model(globalTooltipModel.option,resultModel,ecModel)):resultModel=globalTooltipModel;for(var i=modelCascade.length-1;i>=0;i--){var tooltipOpt=modelCascade[i];tooltipOpt&&(tooltipOpt instanceof Model&&(tooltipOpt=tooltipOpt.get("tooltip",!0)),isString(tooltipOpt)&&(tooltipOpt={formatter:tooltipOpt}),tooltipOpt&&(resultModel=new Model(tooltipOpt,resultModel,ecModel)))}return resultModel}function makeDispatchAction(payload,api){return payload.dispatchAction||bind$1(api.dispatchAction,api)}function isCenterAlign(align){return"center"===align||"middle"===align}var each$4=each$d;function hasKeys(obj){if(obj)for(var name_1 in obj)if(obj.hasOwnProperty(name_1))return!0}function createVisualMappings(option,stateList,supplementVisualOption){var visualMappings={};return each$4(stateList,(function(state){var Creater,mappings=visualMappings[state]=((Creater=function(){}).prototype.__hidden=Creater.prototype,new Creater);each$4(option[state],(function(visualData,visualType){if(VisualMapping.isValidType(visualType)){var mappingOption={type:visualType,visual:visualData};supplementVisualOption&&supplementVisualOption(mappingOption,state),mappings[visualType]=new VisualMapping(mappingOption),"opacity"===visualType&&((mappingOption=clone$3(mappingOption)).type="colorAlpha",mappings.__hidden.__alphaForOpacity=new VisualMapping(mappingOption))}}))})),visualMappings}var TitleModel=function(_super){function TitleModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=TitleModel2.type,_this.layoutMode={type:"box",ignoreSize:!0},_this}return __extends(TitleModel2,_super),TitleModel2.type="title",TitleModel2.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},TitleModel2}(ComponentModel),TitleView=function(_super){function TitleView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=TitleView2.type,_this}return __extends(TitleView2,_super),TitleView2.prototype.render=function(titleModel,ecModel,api){if(this.group.removeAll(),titleModel.get("show")){var group=this.group,textStyleModel=titleModel.getModel("textStyle"),subtextStyleModel=titleModel.getModel("subtextStyle"),textAlign=titleModel.get("textAlign"),textVerticalAlign=retrieve2(titleModel.get("textBaseline"),titleModel.get("textVerticalAlign")),textEl=new ZRText({style:createTextStyle$1(textStyleModel,{text:titleModel.get("text"),fill:textStyleModel.getTextColor()},{disableBox:!0}),z2:10}),textRect=textEl.getBoundingRect(),subText=titleModel.get("subtext"),subTextEl=new ZRText({style:createTextStyle$1(subtextStyleModel,{text:subText,fill:subtextStyleModel.getTextColor(),y:textRect.height+titleModel.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),link=titleModel.get("link"),sublink=titleModel.get("sublink"),triggerEvent=titleModel.get("triggerEvent",!0);textEl.silent=!link&&!triggerEvent,subTextEl.silent=!sublink&&!triggerEvent,link&&textEl.on("click",(function(){windowOpen(link,"_"+titleModel.get("target"))})),sublink&&subTextEl.on("click",(function(){windowOpen(sublink,"_"+titleModel.get("subtarget"))})),getECData(textEl).eventData=getECData(subTextEl).eventData=triggerEvent?{componentType:"title",componentIndex:titleModel.componentIndex}:null,group.add(textEl),subText&&group.add(subTextEl);var groupRect=group.getBoundingRect(),layoutOption=titleModel.getBoxLayoutParams();layoutOption.width=groupRect.width,layoutOption.height=groupRect.height;var layoutRect=getLayoutRect(layoutOption,{width:api.getWidth(),height:api.getHeight()},titleModel.get("padding"));textAlign||("middle"===(textAlign=titleModel.get("left")||titleModel.get("right"))&&(textAlign="center"),"right"===textAlign?layoutRect.x+=layoutRect.width:"center"===textAlign&&(layoutRect.x+=layoutRect.width/2)),textVerticalAlign||("center"===(textVerticalAlign=titleModel.get("top")||titleModel.get("bottom"))&&(textVerticalAlign="middle"),"bottom"===textVerticalAlign?layoutRect.y+=layoutRect.height:"middle"===textVerticalAlign&&(layoutRect.y+=layoutRect.height/2),textVerticalAlign=textVerticalAlign||"top"),group.x=layoutRect.x,group.y=layoutRect.y,group.markRedraw();var alignStyle={align:textAlign,verticalAlign:textVerticalAlign};textEl.setStyle(alignStyle),subTextEl.setStyle(alignStyle),groupRect=group.getBoundingRect();var padding=layoutRect.margin,style=titleModel.getItemStyle(["color","opacity"]);style.fill=titleModel.get("backgroundColor");var rect=new Rect$1({shape:{x:groupRect.x-padding[3],y:groupRect.y-padding[0],width:groupRect.width+padding[1]+padding[3],height:groupRect.height+padding[0]+padding[2],r:titleModel.get("borderRadius")},style:style,subPixelOptimize:!0,silent:!0});group.add(rect)}},TitleView2.type="title",TitleView2}(ComponentView);var TimelineModel=function(_super){function TimelineModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=TimelineModel2.type,_this.layoutMode="box",_this}return __extends(TimelineModel2,_super),TimelineModel2.prototype.init=function(option,parentModel,ecModel){this.mergeDefaultAndTheme(option,ecModel),this._initData()},TimelineModel2.prototype.mergeOption=function(option){_super.prototype.mergeOption.apply(this,arguments),this._initData()},TimelineModel2.prototype.setCurrentIndex=function(currentIndex){null==currentIndex&&(currentIndex=this.option.currentIndex);var count2=this._data.count();this.option.loop?currentIndex=(currentIndex%count2+count2)%count2:(currentIndex>=count2&&(currentIndex=count2-1),currentIndex<0&&(currentIndex=0)),this.option.currentIndex=currentIndex},TimelineModel2.prototype.getCurrentIndex=function(){return this.option.currentIndex},TimelineModel2.prototype.isIndexMax=function(){return this.getCurrentIndex()>=this._data.count()-1},TimelineModel2.prototype.setPlayState=function(state){this.option.autoPlay=!!state},TimelineModel2.prototype.getPlayState=function(){return!!this.option.autoPlay},TimelineModel2.prototype._initData=function(){var processedDataArr,thisOption=this.option,dataArr=thisOption.data||[],axisType=thisOption.axisType,names=this._names=[];"category"===axisType?(processedDataArr=[],each$d(dataArr,(function(item,index){var newItem,value=convertOptionIdName(getDataItemValue(item),"");isObject$3(item)?(newItem=clone$3(item)).value=index:newItem=index,processedDataArr.push(newItem),names.push(value)}))):processedDataArr=dataArr;var dimType={category:"ordinal",time:"time",value:"number"}[axisType]||"number";(this._data=new SeriesData([{name:"value",type:dimType}],this)).initData(processedDataArr,names)},TimelineModel2.prototype.getData=function(){return this._data},TimelineModel2.prototype.getCategories=function(){if("category"===this.get("axisType"))return this._names.slice()},TimelineModel2.type="timeline",TimelineModel2.defaultOption={z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{},label:{color:"#000"},data:[]},TimelineModel2}(ComponentModel),SliderTimelineModel=function(_super){function SliderTimelineModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=SliderTimelineModel2.type,_this}return __extends(SliderTimelineModel2,_super),SliderTimelineModel2.type="timeline.slider",SliderTimelineModel2.defaultOption=inheritDefaultOption(TimelineModel.defaultOption,{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"circle",symbolSize:12,lineStyle:{show:!0,width:2,color:"#DAE1F5"},label:{position:"auto",show:!0,interval:"auto",rotate:0,color:"#A4B1D7"},itemStyle:{color:"#A4B1D7",borderWidth:1},checkpointStyle:{symbol:"circle",symbolSize:15,color:"#316bf3",borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0, 0, 0, 0.3)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:24,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"M2,18.5A1.52,1.52,0,0,1,.92,18a1.49,1.49,0,0,1,0-2.12L7.81,9.36,1,3.11A1.5,1.5,0,1,1,3,.89l8,7.34a1.48,1.48,0,0,1,.49,1.09,1.51,1.51,0,0,1-.46,1.1L3,18.08A1.5,1.5,0,0,1,2,18.5Z",prevIcon:"M10,.5A1.52,1.52,0,0,1,11.08,1a1.49,1.49,0,0,1,0,2.12L4.19,9.64,11,15.89a1.5,1.5,0,1,1-2,2.22L1,10.77A1.48,1.48,0,0,1,.5,9.68,1.51,1.51,0,0,1,1,8.58L9,.92A1.5,1.5,0,0,1,10,.5Z",prevBtnSize:18,nextBtnSize:18,color:"#A4B1D7",borderColor:"#A4B1D7",borderWidth:1},emphasis:{label:{show:!0,color:"#6f778d"},itemStyle:{color:"#316BF3"},controlStyle:{color:"#316BF3",borderColor:"#316BF3",borderWidth:2}},progress:{lineStyle:{color:"#316BF3"},itemStyle:{color:"#316BF3"},label:{color:"#6f778d"}},data:[]}),SliderTimelineModel2}(TimelineModel);mixin(SliderTimelineModel,DataFormatMixin.prototype);var TimelineView=function(_super){function TimelineView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=TimelineView2.type,_this}return __extends(TimelineView2,_super),TimelineView2.type="timeline",TimelineView2}(ComponentView),TimelineAxis=function(_super){function TimelineAxis2(dim,scale2,coordExtent,axisType){var _this=_super.call(this,dim,scale2,coordExtent)||this;return _this.type=axisType||"value",_this}return __extends(TimelineAxis2,_super),TimelineAxis2.prototype.getLabelModel=function(){return this.model.getModel("label")},TimelineAxis2.prototype.isHorizontal=function(){return"horizontal"===this.model.get("orient")},TimelineAxis2}(Axis),PI$1=Math.PI,labelDataIndexStore=makeInner(),SliderTimelineView=function(_super){function SliderTimelineView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=SliderTimelineView2.type,_this}return __extends(SliderTimelineView2,_super),SliderTimelineView2.prototype.init=function(ecModel,api){this.api=api},SliderTimelineView2.prototype.render=function(timelineModel,ecModel,api){if(this.model=timelineModel,this.api=api,this.ecModel=ecModel,this.group.removeAll(),timelineModel.get("show",!0)){var layoutInfo_1=this._layout(timelineModel,api),mainGroup_1=this._createGroup("_mainGroup"),labelGroup=this._createGroup("_labelGroup"),axis_1=this._axis=this._createAxis(layoutInfo_1,timelineModel);timelineModel.formatTooltip=function(dataIndex){return createTooltipMarkup("nameValue",{noName:!0,value:axis_1.scale.getLabel({value:dataIndex})})},each$d(["AxisLine","AxisTick","Control","CurrentPointer"],(function(name){this["_render"+name](layoutInfo_1,mainGroup_1,axis_1,timelineModel)}),this),this._renderAxisLabel(layoutInfo_1,labelGroup,axis_1,timelineModel),this._position(layoutInfo_1,timelineModel)}this._doPlayStop(),this._updateTicksStatus()},SliderTimelineView2.prototype.remove=function(){this._clearTimer(),this.group.removeAll()},SliderTimelineView2.prototype.dispose=function(){this._clearTimer()},SliderTimelineView2.prototype._layout=function(timelineModel,api){var parsedLabelPos,playPosition,prevBtnPosition,nextBtnPosition,labelPosOpt=timelineModel.get(["label","position"]),orient=timelineModel.get("orient"),viewRect2=function(model,api){return getLayoutRect(model.getBoxLayoutParams(),{width:api.getWidth(),height:api.getHeight()},model.get("padding"))}(timelineModel,api),labelAlignMap={horizontal:"center",vertical:(parsedLabelPos=null==labelPosOpt||"auto"===labelPosOpt?"horizontal"===orient?viewRect2.y+viewRect2.height/2<api.getHeight()/2?"-":"+":viewRect2.x+viewRect2.width/2<api.getWidth()/2?"+":"-":isString(labelPosOpt)?{horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[orient][labelPosOpt]:labelPosOpt)>=0||"+"===parsedLabelPos?"left":"right"},labelBaselineMap={horizontal:parsedLabelPos>=0||"+"===parsedLabelPos?"top":"bottom",vertical:"middle"},rotationMap={horizontal:0,vertical:PI$1/2},mainLength="vertical"===orient?viewRect2.height:viewRect2.width,controlModel=timelineModel.getModel("controlStyle"),showControl=controlModel.get("show",!0),controlSize=showControl?controlModel.get("itemSize"):0,controlGap=showControl?controlModel.get("itemGap"):0,sizePlusGap=controlSize+controlGap,labelRotation=timelineModel.get(["label","rotate"])||0;labelRotation=labelRotation*PI$1/180;var controlPosition=controlModel.get("position",!0),showPlayBtn=showControl&&controlModel.get("showPlayBtn",!0),showPrevBtn=showControl&&controlModel.get("showPrevBtn",!0),showNextBtn=showControl&&controlModel.get("showNextBtn",!0),xLeft=0,xRight=mainLength;"left"===controlPosition||"bottom"===controlPosition?(showPlayBtn&&(playPosition=[0,0],xLeft+=sizePlusGap),showPrevBtn&&(prevBtnPosition=[xLeft,0],xLeft+=sizePlusGap),showNextBtn&&(nextBtnPosition=[xRight-controlSize,0],xRight-=sizePlusGap)):(showPlayBtn&&(playPosition=[xRight-controlSize,0],xRight-=sizePlusGap),showPrevBtn&&(prevBtnPosition=[0,0],xLeft+=sizePlusGap),showNextBtn&&(nextBtnPosition=[xRight-controlSize,0],xRight-=sizePlusGap));var axisExtent=[xLeft,xRight];return timelineModel.get("inverse")&&axisExtent.reverse(),{viewRect:viewRect2,mainLength:mainLength,orient:orient,rotation:rotationMap[orient],labelRotation:labelRotation,labelPosOpt:parsedLabelPos,labelAlign:timelineModel.get(["label","align"])||labelAlignMap[orient],labelBaseline:timelineModel.get(["label","verticalAlign"])||timelineModel.get(["label","baseline"])||labelBaselineMap[orient],playPosition:playPosition,prevBtnPosition:prevBtnPosition,nextBtnPosition:nextBtnPosition,axisExtent:axisExtent,controlSize:controlSize,controlGap:controlGap}},SliderTimelineView2.prototype._position=function(layoutInfo,timelineModel){var mainGroup=this._mainGroup,labelGroup=this._labelGroup,viewRect2=layoutInfo.viewRect;if("vertical"===layoutInfo.orient){var m2=[1,0,0,1,0,0],rotateOriginX=viewRect2.x,rotateOriginY=viewRect2.y+viewRect2.height;translate(m2,m2,[-rotateOriginX,-rotateOriginY]),rotate(m2,m2,-PI$1/2),translate(m2,m2,[rotateOriginX,rotateOriginY]),(viewRect2=viewRect2.clone()).applyTransform(m2)}var viewBound=getBound(viewRect2),mainBound=getBound(mainGroup.getBoundingRect()),labelBound=getBound(labelGroup.getBoundingRect()),mainPosition=[mainGroup.x,mainGroup.y],labelsPosition=[labelGroup.x,labelGroup.y];labelsPosition[0]=mainPosition[0]=viewBound[0][0];var mainBoundIdx,labelPosOpt=layoutInfo.labelPosOpt;null==labelPosOpt||isString(labelPosOpt)?(toBound(mainPosition,mainBound,viewBound,1,mainBoundIdx="+"===labelPosOpt?0:1),toBound(labelsPosition,labelBound,viewBound,1,1-mainBoundIdx)):(toBound(mainPosition,mainBound,viewBound,1,mainBoundIdx=labelPosOpt>=0?0:1),labelsPosition[1]=mainPosition[1]+labelPosOpt);function setOrigin(targetGroup){targetGroup.originX=viewBound[0][0]-targetGroup.x,targetGroup.originY=viewBound[1][0]-targetGroup.y}function getBound(rect){return[[rect.x,rect.x+rect.width],[rect.y,rect.y+rect.height]]}function toBound(fromPos,from,to,dimIdx,boundIdx){fromPos[dimIdx]+=to[dimIdx][boundIdx]-from[dimIdx][boundIdx]}mainGroup.setPosition(mainPosition),labelGroup.setPosition(labelsPosition),mainGroup.rotation=labelGroup.rotation=layoutInfo.rotation,setOrigin(mainGroup),setOrigin(labelGroup)},SliderTimelineView2.prototype._createAxis=function(layoutInfo,timelineModel){var data=timelineModel.getData(),axisType=timelineModel.get("axisType"),scale2=function(model,axisType){if(axisType=axisType||model.get("type"),axisType)switch(axisType){case"category":return new OrdinalScale({ordinalMeta:model.getCategories(),extent:[Infinity,-Infinity]});case"time":return new TimeScale({locale:model.ecModel.getLocaleModel(),useUTC:model.ecModel.get("useUTC")});default:return new IntervalScale}}(timelineModel,axisType);scale2.getTicks=function(){return data.mapArray(["value"],(function(value){return{value:value}}))};var dataExtent=data.getDataExtent("value");scale2.setExtent(dataExtent[0],dataExtent[1]),scale2.calcNiceTicks();var axis=new TimelineAxis("value",scale2,layoutInfo.axisExtent,axisType);return axis.model=timelineModel,axis},SliderTimelineView2.prototype._createGroup=function(key){var newGroup=this[key]=new Group$2;return this.group.add(newGroup),newGroup},SliderTimelineView2.prototype._renderAxisLine=function(layoutInfo,group,axis,timelineModel){var axisExtent=axis.getExtent();if(timelineModel.get(["lineStyle","show"])){var line=new Line({shape:{x1:axisExtent[0],y1:0,x2:axisExtent[1],y2:0},style:extend({lineCap:"round"},timelineModel.getModel("lineStyle").getLineStyle()),silent:!0,z2:1});group.add(line);var progressLine=this._progressLine=new Line({shape:{x1:axisExtent[0],x2:this._currentPointer?this._currentPointer.x:axisExtent[0],y1:0,y2:0},style:defaults({lineCap:"round",lineWidth:line.style.lineWidth},timelineModel.getModel(["progress","lineStyle"]).getLineStyle()),silent:!0,z2:1});group.add(progressLine)}},SliderTimelineView2.prototype._renderAxisTick=function(layoutInfo,group,axis,timelineModel){var _this=this,data=timelineModel.getData(),ticks=axis.scale.getTicks();this._tickSymbols=[],each$d(ticks,(function(tick){var tickCoord=axis.dataToCoord(tick.value),itemModel=data.getItemModel(tick.value),itemStyleModel=itemModel.getModel("itemStyle"),hoverStyleModel=itemModel.getModel(["emphasis","itemStyle"]),progressStyleModel=itemModel.getModel(["progress","itemStyle"]),symbolOpt={x:tickCoord,y:0,onclick:bind$1(_this._changeTimeline,_this,tick.value)},el=giveSymbol(itemModel,itemStyleModel,group,symbolOpt);el.ensureState("emphasis").style=hoverStyleModel.getItemStyle(),el.ensureState("progress").style=progressStyleModel.getItemStyle(),enableHoverEmphasis(el);var ecData=getECData(el);itemModel.get("tooltip")?(ecData.dataIndex=tick.value,ecData.dataModel=timelineModel):ecData.dataIndex=ecData.dataModel=null,_this._tickSymbols.push(el)}))},SliderTimelineView2.prototype._renderAxisLabel=function(layoutInfo,group,axis,timelineModel){var _this=this;if(axis.getLabelModel().get("show")){var data=timelineModel.getData(),labels=axis.getViewLabels();this._tickLabels=[],each$d(labels,(function(labelItem){var dataIndex=labelItem.tickValue,itemModel=data.getItemModel(dataIndex),normalLabelModel=itemModel.getModel("label"),hoverLabelModel=itemModel.getModel(["emphasis","label"]),progressLabelModel=itemModel.getModel(["progress","label"]),tickCoord=axis.dataToCoord(labelItem.tickValue),textEl=new ZRText({x:tickCoord,y:0,rotation:layoutInfo.labelRotation-layoutInfo.rotation,onclick:bind$1(_this._changeTimeline,_this,dataIndex),silent:!1,style:createTextStyle$1(normalLabelModel,{text:labelItem.formattedLabel,align:layoutInfo.labelAlign,verticalAlign:layoutInfo.labelBaseline})});textEl.ensureState("emphasis").style=createTextStyle$1(hoverLabelModel),textEl.ensureState("progress").style=createTextStyle$1(progressLabelModel),group.add(textEl),enableHoverEmphasis(textEl),labelDataIndexStore(textEl).dataIndex=dataIndex,_this._tickLabels.push(textEl)}))}},SliderTimelineView2.prototype._renderControl=function(layoutInfo,group,axis,timelineModel){var controlSize=layoutInfo.controlSize,rotation=layoutInfo.rotation,itemStyle=timelineModel.getModel("controlStyle").getItemStyle(),hoverStyle=timelineModel.getModel(["emphasis","controlStyle"]).getItemStyle(),playState=timelineModel.getPlayState(),inverse=timelineModel.get("inverse",!0);function makeBtn(position,iconName,onclick,willRotate){if(position){var iconSize=parsePercent$1(retrieve2(timelineModel.get(["controlStyle",iconName+"BtnSize"]),controlSize),controlSize),btn=function(timelineModel,objPath,rect,opts){var style=opts.style,icon=createIcon(timelineModel.get(["controlStyle",objPath]),opts,new BoundingRect(rect[0],rect[1],rect[2],rect[3]));style&&icon.setStyle(style);return icon}(timelineModel,iconName+"Icon",[0,-iconSize/2,iconSize,iconSize],{x:position[0],y:position[1],originX:controlSize/2,originY:0,rotation:willRotate?-rotation:0,rectHover:!0,style:itemStyle,onclick:onclick});btn.ensureState("emphasis").style=hoverStyle,group.add(btn),enableHoverEmphasis(btn)}}makeBtn(layoutInfo.nextBtnPosition,"next",bind$1(this._changeTimeline,this,inverse?"-":"+")),makeBtn(layoutInfo.prevBtnPosition,"prev",bind$1(this._changeTimeline,this,inverse?"+":"-")),makeBtn(layoutInfo.playPosition,playState?"stop":"play",bind$1(this._handlePlayClick,this,!playState),!0)},SliderTimelineView2.prototype._renderCurrentPointer=function(layoutInfo,group,axis,timelineModel){var data=timelineModel.getData(),currentIndex=timelineModel.getCurrentIndex(),pointerModel=data.getItemModel(currentIndex).getModel("checkpointStyle"),me=this,callback={onCreate:function(pointer){pointer.draggable=!0,pointer.drift=bind$1(me._handlePointerDrag,me),pointer.ondragend=bind$1(me._handlePointerDragend,me),pointerMoveTo(pointer,me._progressLine,currentIndex,axis,timelineModel,!0)},onUpdate:function(pointer){pointerMoveTo(pointer,me._progressLine,currentIndex,axis,timelineModel)}};this._currentPointer=giveSymbol(pointerModel,pointerModel,this._mainGroup,{},this._currentPointer,callback)},SliderTimelineView2.prototype._handlePlayClick=function(nextState){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:nextState,from:this.uid})},SliderTimelineView2.prototype._handlePointerDrag=function(dx,dy,e2){this._clearTimer(),this._pointerChangeTimeline([e2.offsetX,e2.offsetY])},SliderTimelineView2.prototype._handlePointerDragend=function(e2){this._pointerChangeTimeline([e2.offsetX,e2.offsetY],!0)},SliderTimelineView2.prototype._pointerChangeTimeline=function(mousePos,trigger2){var toCoord=this._toAxisCoord(mousePos)[0],axisExtent=asc$2(this._axis.getExtent().slice());toCoord>axisExtent[1]&&(toCoord=axisExtent[1]),toCoord<axisExtent[0]&&(toCoord=axisExtent[0]),this._currentPointer.x=toCoord,this._currentPointer.markRedraw();var progressLine=this._progressLine;progressLine&&(progressLine.shape.x2=toCoord,progressLine.dirty());var targetDataIndex=this._findNearestTick(toCoord),timelineModel=this.model;(trigger2||targetDataIndex!==timelineModel.getCurrentIndex()&&timelineModel.get("realtime"))&&this._changeTimeline(targetDataIndex)},SliderTimelineView2.prototype._doPlayStop=function(){var _this=this;this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout((function(){var timelineModel=_this.model;_this._changeTimeline(timelineModel.getCurrentIndex()+(timelineModel.get("rewind",!0)?-1:1))}),this.model.get("playInterval")))},SliderTimelineView2.prototype._toAxisCoord=function(vertex){return applyTransform(vertex,this._mainGroup.getLocalTransform(),!0)},SliderTimelineView2.prototype._findNearestTick=function(axisCoord){var targetDataIndex,data=this.model.getData(),dist2=Infinity,axis=this._axis;return data.each(["value"],(function(value,dataIndex){var coord=axis.dataToCoord(value),d=Math.abs(coord-axisCoord);d<dist2&&(dist2=d,targetDataIndex=dataIndex)})),targetDataIndex},SliderTimelineView2.prototype._clearTimer=function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},SliderTimelineView2.prototype._changeTimeline=function(nextIndex){var currentIndex=this.model.getCurrentIndex();"+"===nextIndex?nextIndex=currentIndex+1:"-"===nextIndex&&(nextIndex=currentIndex-1),this.api.dispatchAction({type:"timelineChange",currentIndex:nextIndex,from:this.uid})},SliderTimelineView2.prototype._updateTicksStatus=function(){var currentIndex=this.model.getCurrentIndex(),tickSymbols=this._tickSymbols,tickLabels=this._tickLabels;if(tickSymbols)for(var i=0;i<tickSymbols.length;i++)tickSymbols&&tickSymbols[i]&&tickSymbols[i].toggleState("progress",i<currentIndex);if(tickLabels)for(i=0;i<tickLabels.length;i++)tickLabels&&tickLabels[i]&&tickLabels[i].toggleState("progress",labelDataIndexStore(tickLabels[i]).dataIndex<=currentIndex)},SliderTimelineView2.type="timeline.slider",SliderTimelineView2}(TimelineView);function giveSymbol(hostModel,itemStyleModel,group,opt,symbol,callback){var color2=itemStyleModel.get("color");symbol?(symbol.setColor(color2),group.add(symbol),callback&&callback.onUpdate(symbol)):((symbol=createSymbol(hostModel.get("symbol"),-1,-1,2,2,color2)).setStyle("strokeNoScale",!0),group.add(symbol),callback&&callback.onCreate(symbol));var itemStyle=itemStyleModel.getItemStyle(["color"]);symbol.setStyle(itemStyle),opt=merge({rectHover:!0,z2:100},opt,!0);var symbolSize=normalizeSymbolSize(hostModel.get("symbolSize"));opt.scaleX=symbolSize[0]/2,opt.scaleY=symbolSize[1]/2;var symbolOffset=normalizeSymbolOffset(hostModel.get("symbolOffset"),symbolSize);symbolOffset&&(opt.x=(opt.x||0)+symbolOffset[0],opt.y=(opt.y||0)+symbolOffset[1]);var symbolRotate=hostModel.get("symbolRotate");return opt.rotation=(symbolRotate||0)*Math.PI/180||0,symbol.attr(opt),symbol.updateTransform(),symbol}function pointerMoveTo(pointer,progressLine,dataIndex,axis,timelineModel,noAnimation){if(!pointer.dragging){var pointerModel=timelineModel.getModel("checkpointStyle"),toCoord=axis.dataToCoord(timelineModel.getData().get("value",dataIndex));if(noAnimation||!pointerModel.get("animation",!0))pointer.attr({x:toCoord,y:0}),progressLine&&progressLine.attr({shape:{x2:toCoord}});else{var animationCfg={duration:pointerModel.get("animationDuration",!0),easing:pointerModel.get("animationEasing",!0)};pointer.stopAnimation(null,!0),pointer.animateTo({x:toCoord,y:0},animationCfg),progressLine&&progressLine.animateTo({shape:{x2:toCoord}},animationCfg)}}}function timelinePreprocessor(option){var timelineOpt=option&&option.timeline;isArray$1(timelineOpt)||(timelineOpt=timelineOpt?[timelineOpt]:[]),each$d(timelineOpt,(function(opt){opt&&function(opt){var type=opt.type,ec2Types={number:"value",time:"time"};ec2Types[type]&&(opt.axisType=ec2Types[type],delete opt.type);if(transferItem(opt),has$1(opt,"controlPosition")){var controlStyle=opt.controlStyle||(opt.controlStyle={});has$1(controlStyle,"position")||(controlStyle.position=opt.controlPosition),"none"!==controlStyle.position||has$1(controlStyle,"show")||(controlStyle.show=!1,delete controlStyle.position),delete opt.controlPosition}each$d(opt.data||[],(function(dataItem){isObject$3(dataItem)&&!isArray$1(dataItem)&&(!has$1(dataItem,"value")&&has$1(dataItem,"name")&&(dataItem.value=dataItem.name),transferItem(dataItem))}))}(opt)}))}function transferItem(opt){var itemStyle=opt.itemStyle||(opt.itemStyle={}),itemStyleEmphasis=itemStyle.emphasis||(itemStyle.emphasis={}),label=opt.label||opt.label||{},labelNormal=label.normal||(label.normal={}),excludeLabelAttr={normal:1,emphasis:1};each$d(label,(function(value,name){excludeLabelAttr[name]||has$1(labelNormal,name)||(labelNormal[name]=value)})),itemStyleEmphasis.label&&!has$1(label,"emphasis")&&(label.emphasis=itemStyleEmphasis.label,delete itemStyleEmphasis.label)}function has$1(obj,attr){return obj.hasOwnProperty(attr)}var LegendModel=function(_super){function LegendModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=LegendModel2.type,_this.layoutMode={type:"box",ignoreSize:!0},_this}return __extends(LegendModel2,_super),LegendModel2.prototype.init=function(option,parentModel,ecModel){this.mergeDefaultAndTheme(option,ecModel),option.selected=option.selected||{},this._updateSelector(option)},LegendModel2.prototype.mergeOption=function(option,ecModel){_super.prototype.mergeOption.call(this,option,ecModel),this._updateSelector(option)},LegendModel2.prototype._updateSelector=function(option){var selector=option.selector,ecModel=this.ecModel;!0===selector&&(selector=option.selector=["all","inverse"]),isArray$1(selector)&&each$d(selector,(function(item,index){isString(item)&&(item={type:item}),selector[index]=merge(item,function(ecModel,type){return"all"===type?{type:"all",title:ecModel.getLocaleModel().get(["legend","selector","all"])}:"inverse"===type?{type:"inverse",title:ecModel.getLocaleModel().get(["legend","selector","inverse"])}:void 0}(ecModel,item.type))}))},LegendModel2.prototype.optionUpdated=function(){this._updateData(this.ecModel);var legendData=this._data;if(legendData[0]&&"single"===this.get("selectedMode")){for(var hasSelected=!1,i=0;i<legendData.length;i++){var name_1=legendData[i].get("name");if(this.isSelected(name_1)){this.select(name_1),hasSelected=!0;break}}!hasSelected&&this.select(legendData[0].get("name"))}},LegendModel2.prototype._updateData=function(ecModel){var potentialData=[],availableNames=[];ecModel.eachRawSeries((function(seriesModel){var isPotential,seriesName=seriesModel.name;if(availableNames.push(seriesName),seriesModel.legendVisualProvider){var names=seriesModel.legendVisualProvider.getAllNames();ecModel.isSeriesFiltered(seriesModel)||(availableNames=availableNames.concat(names)),names.length?potentialData=potentialData.concat(names):isPotential=!0}else isPotential=!0;isPotential&&isNameSpecified(seriesModel)&&potentialData.push(seriesModel.name)})),this._availableNames=availableNames;var rawData=this.get("data")||potentialData,legendNameMap=createHashMap(),legendData=map$1(rawData,(function(dataItem){return(isString(dataItem)||isNumber(dataItem))&&(dataItem={name:dataItem}),legendNameMap.get(dataItem.name)?null:(legendNameMap.set(dataItem.name,!0),new Model(dataItem,this,this.ecModel))}),this);this._data=filter(legendData,(function(item){return!!item}))},LegendModel2.prototype.getData=function(){return this._data},LegendModel2.prototype.select=function(name){var selected=this.option.selected;"single"===this.get("selectedMode")&&each$d(this._data,(function(dataItem){selected[dataItem.get("name")]=!1}));selected[name]=!0},LegendModel2.prototype.unSelect=function(name){"single"!==this.get("selectedMode")&&(this.option.selected[name]=!1)},LegendModel2.prototype.toggleSelected=function(name){var selected=this.option.selected;selected.hasOwnProperty(name)||(selected[name]=!0),this[selected[name]?"unSelect":"select"](name)},LegendModel2.prototype.allSelect=function(){var data=this._data,selected=this.option.selected;each$d(data,(function(dataItem){selected[dataItem.get("name",!0)]=!0}))},LegendModel2.prototype.inverseSelect=function(){var data=this._data,selected=this.option.selected;each$d(data,(function(dataItem){var name=dataItem.get("name",!0);selected.hasOwnProperty(name)||(selected[name]=!0),selected[name]=!selected[name]}))},LegendModel2.prototype.isSelected=function(name){var selected=this.option.selected;return!(selected.hasOwnProperty(name)&&!selected[name])&&indexOf(this._availableNames,name)>=0},LegendModel2.prototype.getOrient=function(){return"vertical"===this.get("orient")?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},LegendModel2.type="legend.plain",LegendModel2.dependencies=["series"],LegendModel2.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},LegendModel2}(ComponentModel),curry=curry$1,each$3=each$d,Group$1=Group$2,LegendView=function(_super){function LegendView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=LegendView2.type,_this.newlineDisabled=!1,_this}return __extends(LegendView2,_super),LegendView2.prototype.init=function(){this.group.add(this._contentGroup=new Group$1),this.group.add(this._selectorGroup=new Group$1),this._isFirstRender=!0},LegendView2.prototype.getContentGroup=function(){return this._contentGroup},LegendView2.prototype.getSelectorGroup=function(){return this._selectorGroup},LegendView2.prototype.render=function(legendModel,ecModel,api){var isFirstRender=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),legendModel.get("show",!0)){var itemAlign=legendModel.get("align"),orient=legendModel.get("orient");itemAlign&&"auto"!==itemAlign||(itemAlign="right"===legendModel.get("left")&&"vertical"===orient?"right":"left");var selector=legendModel.get("selector",!0),selectorPosition=legendModel.get("selectorPosition",!0);!selector||selectorPosition&&"auto"!==selectorPosition||(selectorPosition="horizontal"===orient?"end":"start"),this.renderInner(itemAlign,legendModel,ecModel,api,selector,orient,selectorPosition);var positionInfo=legendModel.getBoxLayoutParams(),viewportSize={width:api.getWidth(),height:api.getHeight()},padding=legendModel.get("padding"),maxSize=getLayoutRect(positionInfo,viewportSize,padding),mainRect=this.layoutInner(legendModel,itemAlign,maxSize,isFirstRender,selector,selectorPosition),layoutRect=getLayoutRect(defaults({width:mainRect.width,height:mainRect.height},positionInfo),viewportSize,padding);this.group.x=layoutRect.x-mainRect.x,this.group.y=layoutRect.y-mainRect.y,this.group.markRedraw(),this.group.add(this._backgroundEl=makeBackground(mainRect,legendModel))}},LegendView2.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},LegendView2.prototype.renderInner=function(itemAlign,legendModel,ecModel,api,selector,orient,selectorPosition){var contentGroup=this.getContentGroup(),legendDrawnMap=createHashMap(),selectMode=legendModel.get("selectedMode"),excludeSeriesId=[];ecModel.eachRawSeries((function(seriesModel){!seriesModel.get("legendHoverLink")&&excludeSeriesId.push(seriesModel.id)})),each$3(legendModel.getData(),(function(legendItemModel,dataIndex){var name=legendItemModel.get("name");if(!this.newlineDisabled&&(""===name||"\n"===name)){var g=new Group$1;return g.newline=!0,void contentGroup.add(g)}var seriesModel=ecModel.getSeriesByName(name)[0];if(!legendDrawnMap.get(name))if(seriesModel){var data=seriesModel.getData(),lineVisualStyle=data.getVisual("legendLineStyle")||{},legendIcon=data.getVisual("legendIcon"),style=data.getVisual("style"),itemGroup=this._createItem(seriesModel,name,dataIndex,legendItemModel,legendModel,itemAlign,lineVisualStyle,style,legendIcon,selectMode,api);itemGroup.on("click",curry(dispatchSelectAction,name,null,api,excludeSeriesId)).on("mouseover",curry(dispatchHighlightAction,seriesModel.name,null,api,excludeSeriesId)).on("mouseout",curry(dispatchDownplayAction,seriesModel.name,null,api,excludeSeriesId)),ecModel.ssr&&itemGroup.eachChild((function(child){var ecData=getECData(child);ecData.seriesIndex=seriesModel.seriesIndex,ecData.dataIndex=dataIndex,ecData.ssrType="legend"})),legendDrawnMap.set(name,!0)}else ecModel.eachRawSeries((function(seriesModel2){if(!legendDrawnMap.get(name)&&seriesModel2.legendVisualProvider){var provider=seriesModel2.legendVisualProvider;if(!provider.containName(name))return;var idx=provider.indexOfName(name),style2=provider.getItemVisual(idx,"style"),legendIcon2=provider.getItemVisual(idx,"legendIcon"),colorArr=parse(style2.fill);colorArr&&0===colorArr[3]&&(colorArr[3]=.2,style2=extend(extend({},style2),{fill:stringify(colorArr,"rgba")}));var itemGroup2=this._createItem(seriesModel2,name,dataIndex,legendItemModel,legendModel,itemAlign,{},style2,legendIcon2,selectMode,api);itemGroup2.on("click",curry(dispatchSelectAction,null,name,api,excludeSeriesId)).on("mouseover",curry(dispatchHighlightAction,null,name,api,excludeSeriesId)).on("mouseout",curry(dispatchDownplayAction,null,name,api,excludeSeriesId)),ecModel.ssr&&itemGroup2.eachChild((function(child){var ecData=getECData(child);ecData.seriesIndex=seriesModel2.seriesIndex,ecData.dataIndex=dataIndex,ecData.ssrType="legend"})),legendDrawnMap.set(name,!0)}}),this)}),this),selector&&this._createSelector(selector,legendModel,api,orient,selectorPosition)},LegendView2.prototype._createSelector=function(selector,legendModel,api,orient,selectorPosition){var selectorGroup=this.getSelectorGroup();each$3(selector,(function(selectorItem){var type=selectorItem.type,labelText=new ZRText({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){api.dispatchAction({type:"all"===type?"legendAllSelect":"legendInverseSelect",legendId:legendModel.id})}});selectorGroup.add(labelText),setLabelStyle(labelText,{normal:legendModel.getModel("selectorLabel"),emphasis:legendModel.getModel(["emphasis","selectorLabel"])},{defaultText:selectorItem.title}),enableHoverEmphasis(labelText)}))},LegendView2.prototype._createItem=function(seriesModel,name,dataIndex,legendItemModel,legendModel,itemAlign,lineVisualStyle,itemVisualStyle,legendIcon,selectMode,api){var drawType=seriesModel.visualDrawType,itemWidth=legendModel.get("itemWidth"),itemHeight=legendModel.get("itemHeight"),isSelected=legendModel.isSelected(name),iconRotate=legendItemModel.get("symbolRotate"),symbolKeepAspect=legendItemModel.get("symbolKeepAspect"),legendIconType=legendItemModel.get("icon"),style=function(iconType,legendItemModel,lineVisualStyle,itemVisualStyle,drawType,isSelected,api){function handleCommonProps(style,visualStyle){"auto"===style.lineWidth&&(style.lineWidth=visualStyle.lineWidth>0?2:0),each$3(style,(function(propVal,propName){"inherit"===style[propName]&&(style[propName]=visualStyle[propName])}))}var itemStyleModel=legendItemModel.getModel("itemStyle"),itemStyle=itemStyleModel.getItemStyle(),iconBrushType=0===iconType.lastIndexOf("empty",0)?"fill":"stroke",decalStyle=itemStyleModel.getShallow("decal");itemStyle.decal=decalStyle&&"inherit"!==decalStyle?createOrUpdatePatternFromDecal(decalStyle,api):itemVisualStyle.decal,"inherit"===itemStyle.fill&&(itemStyle.fill=itemVisualStyle[drawType]);"inherit"===itemStyle.stroke&&(itemStyle.stroke=itemVisualStyle[iconBrushType]);"inherit"===itemStyle.opacity&&(itemStyle.opacity=("fill"===drawType?itemVisualStyle:lineVisualStyle).opacity);handleCommonProps(itemStyle,itemVisualStyle);var legendLineModel=legendItemModel.getModel("lineStyle"),lineStyle=legendLineModel.getLineStyle();if(handleCommonProps(lineStyle,lineVisualStyle),"auto"===itemStyle.fill&&(itemStyle.fill=itemVisualStyle.fill),"auto"===itemStyle.stroke&&(itemStyle.stroke=itemVisualStyle.fill),"auto"===lineStyle.stroke&&(lineStyle.stroke=itemVisualStyle.fill),!isSelected){var borderWidth=legendItemModel.get("inactiveBorderWidth"),visualHasBorder=itemStyle[iconBrushType];itemStyle.lineWidth="auto"===borderWidth?itemVisualStyle.lineWidth>0&&visualHasBorder?2:0:itemStyle.lineWidth,itemStyle.fill=legendItemModel.get("inactiveColor"),itemStyle.stroke=legendItemModel.get("inactiveBorderColor"),lineStyle.stroke=legendLineModel.get("inactiveColor"),lineStyle.lineWidth=legendLineModel.get("inactiveWidth")}return{itemStyle:itemStyle,lineStyle:lineStyle}}(legendIcon=legendIconType||legendIcon||"roundRect",legendItemModel,lineVisualStyle,itemVisualStyle,drawType,isSelected,api),itemGroup=new Group$1,textStyleModel=legendItemModel.getModel("textStyle");if(!isFunction(seriesModel.getLegendIcon)||legendIconType&&"inherit"!==legendIconType){var rotate2="inherit"===legendIconType&&seriesModel.getData().getVisual("symbol")?"inherit"===iconRotate?seriesModel.getData().getVisual("symbolRotate"):iconRotate:0;itemGroup.add(function(opt){var symboType=opt.icon||"roundRect",icon=createSymbol(symboType,0,0,opt.itemWidth,opt.itemHeight,opt.itemStyle.fill,opt.symbolKeepAspect);icon.setStyle(opt.itemStyle),icon.rotation=(opt.iconRotate||0)*Math.PI/180,icon.setOrigin([opt.itemWidth/2,opt.itemHeight/2]),symboType.indexOf("empty")>-1&&(icon.style.stroke=icon.style.fill,icon.style.fill="#fff",icon.style.lineWidth=2);return icon}({itemWidth:itemWidth,itemHeight:itemHeight,icon:legendIcon,iconRotate:rotate2,itemStyle:style.itemStyle,lineStyle:style.lineStyle,symbolKeepAspect:symbolKeepAspect}))}else itemGroup.add(seriesModel.getLegendIcon({itemWidth:itemWidth,itemHeight:itemHeight,icon:legendIcon,iconRotate:iconRotate,itemStyle:style.itemStyle,lineStyle:style.lineStyle,symbolKeepAspect:symbolKeepAspect}));var textX="left"===itemAlign?itemWidth+5:-5,textAlign=itemAlign,formatter=legendModel.get("formatter"),content=name;isString(formatter)&&formatter?content=formatter.replace("{name}",null!=name?name:""):isFunction(formatter)&&(content=formatter(name));var textColor=isSelected?textStyleModel.getTextColor():legendItemModel.get("inactiveColor");itemGroup.add(new ZRText({style:createTextStyle$1(textStyleModel,{text:content,x:textX,y:itemHeight/2,fill:textColor,align:textAlign,verticalAlign:"middle"},{inheritColor:textColor})}));var hitRect=new Rect$1({shape:itemGroup.getBoundingRect(),style:{fill:"transparent"}}),tooltipModel=legendItemModel.getModel("tooltip");return tooltipModel.get("show")&&setTooltipConfig({el:hitRect,componentModel:legendModel,itemName:name,itemTooltipOption:tooltipModel.option}),itemGroup.add(hitRect),itemGroup.eachChild((function(child){child.silent=!0})),hitRect.silent=!selectMode,this.getContentGroup().add(itemGroup),enableHoverEmphasis(itemGroup),itemGroup.__legendDataIndex=dataIndex,itemGroup},LegendView2.prototype.layoutInner=function(legendModel,itemAlign,maxSize,isFirstRender,selector,selectorPosition){var contentGroup=this.getContentGroup(),selectorGroup=this.getSelectorGroup();box(legendModel.get("orient"),contentGroup,legendModel.get("itemGap"),maxSize.width,maxSize.height);var contentRect=contentGroup.getBoundingRect(),contentPos=[-contentRect.x,-contentRect.y];if(selectorGroup.markRedraw(),contentGroup.markRedraw(),selector){box("horizontal",selectorGroup,legendModel.get("selectorItemGap",!0));var selectorRect=selectorGroup.getBoundingRect(),selectorPos=[-selectorRect.x,-selectorRect.y],selectorButtonGap=legendModel.get("selectorButtonGap",!0),orientIdx=legendModel.getOrient().index,wh=0===orientIdx?"width":"height",hw=0===orientIdx?"height":"width",yx=0===orientIdx?"y":"x";"end"===selectorPosition?selectorPos[orientIdx]+=contentRect[wh]+selectorButtonGap:contentPos[orientIdx]+=selectorRect[wh]+selectorButtonGap,selectorPos[1-orientIdx]+=contentRect[hw]/2-selectorRect[hw]/2,selectorGroup.x=selectorPos[0],selectorGroup.y=selectorPos[1],contentGroup.x=contentPos[0],contentGroup.y=contentPos[1];var mainRect={x:0,y:0};return mainRect[wh]=contentRect[wh]+selectorButtonGap+selectorRect[wh],mainRect[hw]=Math.max(contentRect[hw],selectorRect[hw]),mainRect[yx]=Math.min(0,selectorRect[yx]+selectorPos[1-orientIdx]),mainRect}return contentGroup.x=contentPos[0],contentGroup.y=contentPos[1],this.group.getBoundingRect()},LegendView2.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},LegendView2.type="legend.plain",LegendView2}(ComponentView);function dispatchSelectAction(seriesName,dataName,api,excludeSeriesId){dispatchDownplayAction(seriesName,dataName,api,excludeSeriesId),api.dispatchAction({type:"legendToggleSelect",name:null!=seriesName?seriesName:dataName}),dispatchHighlightAction(seriesName,dataName,api,excludeSeriesId)}function isUseHoverLayer(api){for(var emphasisState,list=api.getZr().storage.getDisplayList(),i=0,len2=list.length;i<len2&&!(emphasisState=list[i].states.emphasis);)i++;return emphasisState&&emphasisState.hoverLayer}function dispatchHighlightAction(seriesName,dataName,api,excludeSeriesId){isUseHoverLayer(api)||api.dispatchAction({type:"highlight",seriesName:seriesName,name:dataName,excludeSeriesId:excludeSeriesId})}function dispatchDownplayAction(seriesName,dataName,api,excludeSeriesId){isUseHoverLayer(api)||api.dispatchAction({type:"downplay",seriesName:seriesName,name:dataName,excludeSeriesId:excludeSeriesId})}function legendFilter(ecModel){var legendModels=ecModel.findComponents({mainType:"legend"});legendModels&&legendModels.length&&ecModel.filterSeries((function(series){for(var i=0;i<legendModels.length;i++)if(!legendModels[i].isSelected(series.name))return!1;return!0}))}function legendSelectActionHandler(methodName,payload,ecModel){var isAllSelect="allSelect"===methodName||"inverseSelect"===methodName,selectedMap={},actionLegendIndices=[];ecModel.eachComponent({mainType:"legend",query:payload},(function(legendModel){isAllSelect?legendModel[methodName]():legendModel[methodName](payload.name),makeSelectedMap(legendModel,selectedMap),actionLegendIndices.push(legendModel.componentIndex)}));var allSelectedMap={};return ecModel.eachComponent("legend",(function(legendModel){each$d(selectedMap,(function(isSelected,name){legendModel[isSelected?"select":"unSelect"](name)})),makeSelectedMap(legendModel,allSelectedMap)})),isAllSelect?{selected:allSelectedMap,legendIndex:actionLegendIndices}:{name:payload.name,selected:allSelectedMap}}function makeSelectedMap(legendModel,out2){var selectedMap=out2||{};return each$d(legendModel.getData(),(function(model){var name=model.get("name");if("\n"!==name&&""!==name){var isItemSelected=legendModel.isSelected(name);hasOwn(selectedMap,name)?selectedMap[name]=selectedMap[name]&&isItemSelected:selectedMap[name]=isItemSelected}})),selectedMap}function install$a(registers){registers.registerComponentModel(LegendModel),registers.registerComponentView(LegendView),registers.registerProcessor(registers.PRIORITY.PROCESSOR.SERIES_FILTER,legendFilter),registers.registerSubTypeDefaulter("legend",(function(){return"plain"})),function(registers){registers.registerAction("legendToggleSelect","legendselectchanged",curry$1(legendSelectActionHandler,"toggleSelected")),registers.registerAction("legendAllSelect","legendselectall",curry$1(legendSelectActionHandler,"allSelect")),registers.registerAction("legendInverseSelect","legendinverseselect",curry$1(legendSelectActionHandler,"inverseSelect")),registers.registerAction("legendSelect","legendselected",curry$1(legendSelectActionHandler,"select")),registers.registerAction("legendUnSelect","legendunselected",curry$1(legendSelectActionHandler,"unSelect"))}(registers)}var ScrollableLegendModel=function(_super){function ScrollableLegendModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=ScrollableLegendModel2.type,_this}return __extends(ScrollableLegendModel2,_super),ScrollableLegendModel2.prototype.setScrollDataIndex=function(scrollDataIndex){this.option.scrollDataIndex=scrollDataIndex},ScrollableLegendModel2.prototype.init=function(option,parentModel,ecModel){var inputPositionParams=getLayoutParams(option);_super.prototype.init.call(this,option,parentModel,ecModel),mergeAndNormalizeLayoutParams(this,option,inputPositionParams)},ScrollableLegendModel2.prototype.mergeOption=function(option,ecModel){_super.prototype.mergeOption.call(this,option,ecModel),mergeAndNormalizeLayoutParams(this,this.option,option)},ScrollableLegendModel2.type="legend.scroll",ScrollableLegendModel2.defaultOption=inheritDefaultOption(LegendModel.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),ScrollableLegendModel2}(LegendModel);function mergeAndNormalizeLayoutParams(legendModel,target,raw){var ignoreSize=[1,1];ignoreSize[legendModel.getOrient().index]=0,mergeLayoutParam(target,raw,{type:"box",ignoreSize:!!ignoreSize})}var Group=Group$2,WH=["width","height"],XY=["x","y"],ScrollableLegendView=function(_super){function ScrollableLegendView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=ScrollableLegendView2.type,_this.newlineDisabled=!0,_this._currentIndex=0,_this}return __extends(ScrollableLegendView2,_super),ScrollableLegendView2.prototype.init=function(){_super.prototype.init.call(this),this.group.add(this._containerGroup=new Group),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new Group)},ScrollableLegendView2.prototype.resetInner=function(){_super.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},ScrollableLegendView2.prototype.renderInner=function(itemAlign,legendModel,ecModel,api,selector,orient,selectorPosition){var self2=this;_super.prototype.renderInner.call(this,itemAlign,legendModel,ecModel,api,selector,orient,selectorPosition);var controllerGroup=this._controllerGroup,pageIconSize=legendModel.get("pageIconSize",!0),pageIconSizeArr=isArray$1(pageIconSize)?pageIconSize:[pageIconSize,pageIconSize];createPageButton("pagePrev",0);var pageTextStyleModel=legendModel.getModel("pageTextStyle");function createPageButton(name,iconIdx){var pageDataIndexName=name+"DataIndex",icon=createIcon(legendModel.get("pageIcons",!0)[legendModel.getOrient().name][iconIdx],{onclick:bind$1(self2._pageGo,self2,pageDataIndexName,legendModel,api)},{x:-pageIconSizeArr[0]/2,y:-pageIconSizeArr[1]/2,width:pageIconSizeArr[0],height:pageIconSizeArr[1]});icon.name=name,controllerGroup.add(icon)}controllerGroup.add(new ZRText({name:"pageText",style:{text:"xx/xx",fill:pageTextStyleModel.getTextColor(),font:pageTextStyleModel.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),createPageButton("pageNext",1)},ScrollableLegendView2.prototype.layoutInner=function(legendModel,itemAlign,maxSize,isFirstRender,selector,selectorPosition){var selectorGroup=this.getSelectorGroup(),orientIdx=legendModel.getOrient().index,wh=WH[orientIdx],xy=XY[orientIdx],hw=WH[1-orientIdx],yx=XY[1-orientIdx];selector&&box("horizontal",selectorGroup,legendModel.get("selectorItemGap",!0));var selectorButtonGap=legendModel.get("selectorButtonGap",!0),selectorRect=selectorGroup.getBoundingRect(),selectorPos=[-selectorRect.x,-selectorRect.y],processMaxSize=clone$3(maxSize);selector&&(processMaxSize[wh]=maxSize[wh]-selectorRect[wh]-selectorButtonGap);var mainRect=this._layoutContentAndController(legendModel,isFirstRender,processMaxSize,orientIdx,wh,hw,yx,xy);if(selector){if("end"===selectorPosition)selectorPos[orientIdx]+=mainRect[wh]+selectorButtonGap;else{var offset=selectorRect[wh]+selectorButtonGap;selectorPos[orientIdx]-=offset,mainRect[xy]-=offset}mainRect[wh]+=selectorRect[wh]+selectorButtonGap,selectorPos[1-orientIdx]+=mainRect[yx]+mainRect[hw]/2-selectorRect[hw]/2,mainRect[hw]=Math.max(mainRect[hw],selectorRect[hw]),mainRect[yx]=Math.min(mainRect[yx],selectorRect[yx]+selectorPos[1-orientIdx]),selectorGroup.x=selectorPos[0],selectorGroup.y=selectorPos[1],selectorGroup.markRedraw()}return mainRect},ScrollableLegendView2.prototype._layoutContentAndController=function(legendModel,isFirstRender,maxSize,orientIdx,wh,hw,yx,xy){var contentGroup=this.getContentGroup(),containerGroup=this._containerGroup,controllerGroup=this._controllerGroup;box(legendModel.get("orient"),contentGroup,legendModel.get("itemGap"),orientIdx?maxSize.width:null,orientIdx?null:maxSize.height),box("horizontal",controllerGroup,legendModel.get("pageButtonItemGap",!0));var contentRect=contentGroup.getBoundingRect(),controllerRect=controllerGroup.getBoundingRect(),showController=this._showController=contentRect[wh]>maxSize[wh],contentPos=[-contentRect.x,-contentRect.y];isFirstRender||(contentPos[orientIdx]=contentGroup[xy]);var containerPos=[0,0],controllerPos=[-controllerRect.x,-controllerRect.y],pageButtonGap=retrieve2(legendModel.get("pageButtonGap",!0),legendModel.get("itemGap",!0));showController&&("end"===legendModel.get("pageButtonPosition",!0)?controllerPos[orientIdx]+=maxSize[wh]-controllerRect[wh]:containerPos[orientIdx]+=controllerRect[wh]+pageButtonGap);controllerPos[1-orientIdx]+=contentRect[hw]/2-controllerRect[hw]/2,contentGroup.setPosition(contentPos),containerGroup.setPosition(containerPos),controllerGroup.setPosition(controllerPos);var mainRect={x:0,y:0};if(mainRect[wh]=showController?maxSize[wh]:contentRect[wh],mainRect[hw]=Math.max(contentRect[hw],controllerRect[hw]),mainRect[yx]=Math.min(0,controllerRect[yx]+controllerPos[1-orientIdx]),containerGroup.__rectSize=maxSize[wh],showController){var clipShape={x:0,y:0};clipShape[wh]=Math.max(maxSize[wh]-controllerRect[wh]-pageButtonGap,0),clipShape[hw]=mainRect[hw],containerGroup.setClipPath(new Rect$1({shape:clipShape})),containerGroup.__rectSize=clipShape[wh]}else controllerGroup.eachChild((function(child){child.attr({invisible:!0,silent:!0})}));var pageInfo=this._getPageInfo(legendModel);return null!=pageInfo.pageIndex&&updateProps$1(contentGroup,{x:pageInfo.contentPosition[0],y:pageInfo.contentPosition[1]},showController?legendModel:null),this._updatePageInfoView(legendModel,pageInfo),mainRect},ScrollableLegendView2.prototype._pageGo=function(to,legendModel,api){var scrollDataIndex=this._getPageInfo(legendModel)[to];null!=scrollDataIndex&&api.dispatchAction({type:"legendScroll",scrollDataIndex:scrollDataIndex,legendId:legendModel.id})},ScrollableLegendView2.prototype._updatePageInfoView=function(legendModel,pageInfo){var controllerGroup=this._controllerGroup;each$d(["pagePrev","pageNext"],(function(name){var canJump=null!=pageInfo[name+"DataIndex"],icon=controllerGroup.childOfName(name);icon&&(icon.setStyle("fill",canJump?legendModel.get("pageIconColor",!0):legendModel.get("pageIconInactiveColor",!0)),icon.cursor=canJump?"pointer":"default")}));var pageText=controllerGroup.childOfName("pageText"),pageFormatter=legendModel.get("pageFormatter"),pageIndex=pageInfo.pageIndex,current=null!=pageIndex?pageIndex+1:0,total=pageInfo.pageCount;pageText&&pageFormatter&&pageText.setStyle("text",isString(pageFormatter)?pageFormatter.replace("{current}",null==current?"":current+"").replace("{total}",null==total?"":total+""):pageFormatter({current:current,total:total}))},ScrollableLegendView2.prototype._getPageInfo=function(legendModel){var scrollDataIndex=legendModel.get("scrollDataIndex",!0),contentGroup=this.getContentGroup(),containerRectSize=this._containerGroup.__rectSize,orientIdx=legendModel.getOrient().index,wh=WH[orientIdx],xy=XY[orientIdx],targetItemIndex=this._findTargetItemIndex(scrollDataIndex),children=contentGroup.children(),targetItem=children[targetItemIndex],itemCount=children.length,pCount=itemCount?1:0,result={contentPosition:[contentGroup.x,contentGroup.y],pageCount:pCount,pageIndex:pCount-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!targetItem)return result;var targetItemInfo=getItemInfo(targetItem);result.contentPosition[orientIdx]=-targetItemInfo.s;for(var i=targetItemIndex+1,winStartItemInfo=targetItemInfo,winEndItemInfo=targetItemInfo,currItemInfo=null;i<=itemCount;++i)(!(currItemInfo=getItemInfo(children[i]))&&winEndItemInfo.e>winStartItemInfo.s+containerRectSize||currItemInfo&&!intersect2(currItemInfo,winStartItemInfo.s))&&(winStartItemInfo=winEndItemInfo.i>winStartItemInfo.i?winEndItemInfo:currItemInfo)&&(null==result.pageNextDataIndex&&(result.pageNextDataIndex=winStartItemInfo.i),++result.pageCount),winEndItemInfo=currItemInfo;for(i=targetItemIndex-1,winStartItemInfo=targetItemInfo,winEndItemInfo=targetItemInfo,currItemInfo=null;i>=-1;--i)(currItemInfo=getItemInfo(children[i]))&&intersect2(winEndItemInfo,currItemInfo.s)||!(winStartItemInfo.i<winEndItemInfo.i)||(winEndItemInfo=winStartItemInfo,null==result.pagePrevDataIndex&&(result.pagePrevDataIndex=winStartItemInfo.i),++result.pageCount,++result.pageIndex),winStartItemInfo=currItemInfo;return result;function getItemInfo(el){if(el){var itemRect=el.getBoundingRect(),start2=itemRect[xy]+el[xy];return{s:start2,e:start2+itemRect[wh],i:el.__legendDataIndex}}}function intersect2(itemInfo,winStart){return itemInfo.e>=winStart&&itemInfo.s<=winStart+containerRectSize}},ScrollableLegendView2.prototype._findTargetItemIndex=function(targetDataIndex){return this._showController?(this.getContentGroup().eachChild((function(child,idx){var legendDataIdx=child.__legendDataIndex;null==defaultIndex&&null!=legendDataIdx&&(defaultIndex=idx),legendDataIdx===targetDataIndex&&(index=idx)})),null!=index?index:defaultIndex):0;var index,defaultIndex},ScrollableLegendView2.type="legend.scroll",ScrollableLegendView2}(LegendView);function install$9(registers){use(install$a),registers.registerComponentModel(ScrollableLegendModel),registers.registerComponentView(ScrollableLegendView),function(registers){registers.registerAction("legendScroll","legendscroll",(function(payload,ecModel){var scrollDataIndex=payload.scrollDataIndex;null!=scrollDataIndex&&ecModel.eachComponent({mainType:"legend",subType:"scroll",query:payload},(function(legendModel){legendModel.setScrollDataIndex(scrollDataIndex)}))}))}(registers)}var InsideZoomModel=function(_super){function InsideZoomModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=InsideZoomModel2.type,_this}return __extends(InsideZoomModel2,_super),InsideZoomModel2.type="dataZoom.inside",InsideZoomModel2.defaultOption=inheritDefaultOption(DataZoomModel.defaultOption,{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),InsideZoomModel2}(DataZoomModel),inner$1=makeInner();function disposeCoordSysRecord(coordSysRecordMap,coordSysRecord){if(coordSysRecord){coordSysRecordMap.removeKey(coordSysRecord.model.uid);var controller=coordSysRecord.controller;controller&&controller.dispose()}}function dispatchAction(api,batch){api.isDisposed()||api.dispatchAction({type:"dataZoom",animation:{easing:"cubicOut",duration:100},batch:batch})}function containsPoint(coordSysModel,e2,x,y){return coordSysModel.coordinateSystem.containPoint([x,y])}function installDataZoomRoamProcessor(registers){registers.registerProcessor(registers.PRIORITY.PROCESSOR.FILTER,(function(ecModel,api){var apiInner=inner$1(api),coordSysRecordMap=apiInner.coordSysRecordMap||(apiInner.coordSysRecordMap=createHashMap());coordSysRecordMap.each((function(coordSysRecord){coordSysRecord.dataZoomInfoMap=null})),ecModel.eachComponent({mainType:"dataZoom",subType:"inside"},(function(dataZoomModel){each$d(collectReferCoordSysModelInfo(dataZoomModel).infoList,(function(dzCoordSysInfo){var coordSysUid=dzCoordSysInfo.model.uid,coordSysRecord=coordSysRecordMap.get(coordSysUid)||coordSysRecordMap.set(coordSysUid,function(api,coordSysModel){var coordSysRecord={model:coordSysModel,containsPoint:curry$1(containsPoint,coordSysModel),dispatchAction:curry$1(dispatchAction,api),dataZoomInfoMap:null,controller:null},controller=coordSysRecord.controller=new RoamController(api.getZr());return each$d(["pan","zoom","scrollMove"],(function(eventName){controller.on(eventName,(function(event){var batch=[];coordSysRecord.dataZoomInfoMap.each((function(dzInfo){if(event.isAvailableBehavior(dzInfo.model.option)){var method=(dzInfo.getRange||{})[eventName],range=method&&method(dzInfo.dzReferCoordSysInfo,coordSysRecord.model.mainType,coordSysRecord.controller,event);!dzInfo.model.get("disabled",!0)&&range&&batch.push({dataZoomId:dzInfo.model.id,start:range[0],end:range[1]})}})),batch.length&&coordSysRecord.dispatchAction(batch)}))})),coordSysRecord}(api,dzCoordSysInfo.model));(coordSysRecord.dataZoomInfoMap||(coordSysRecord.dataZoomInfoMap=createHashMap())).set(dataZoomModel.uid,{dzReferCoordSysInfo:dzCoordSysInfo,model:dataZoomModel,getRange:null})}))})),coordSysRecordMap.each((function(coordSysRecord){var firstDzInfo,controller=coordSysRecord.controller,dataZoomInfoMap=coordSysRecord.dataZoomInfoMap;if(dataZoomInfoMap){var firstDzKey=dataZoomInfoMap.keys()[0];null!=firstDzKey&&(firstDzInfo=dataZoomInfoMap.get(firstDzKey))}if(firstDzInfo){var controllerParams=function(dataZoomInfoMap){var controlType,typePriority={type_true:2,type_move:1,type_false:0,type_undefined:-1},preventDefaultMouseMove=!0;return dataZoomInfoMap.each((function(dataZoomInfo){var dataZoomModel=dataZoomInfo.model,oneType=!dataZoomModel.get("disabled",!0)&&(!dataZoomModel.get("zoomLock",!0)||"move");typePriority["type_"+oneType]>typePriority["type_"+controlType]&&(controlType=oneType),preventDefaultMouseMove=preventDefaultMouseMove&&dataZoomModel.get("preventDefaultMouseMove",!0)})),{controlType:controlType,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!preventDefaultMouseMove}}}(dataZoomInfoMap);controller.enable(controllerParams.controlType,controllerParams.opt),controller.setPointerChecker(coordSysRecord.containsPoint),createOrUpdate(coordSysRecord,"dispatchAction",firstDzInfo.model.get("throttle",!0),"fixRate")}else disposeCoordSysRecord(coordSysRecordMap,coordSysRecord)}))}))}var InsideZoomView=function(_super){function InsideZoomView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type="dataZoom.inside",_this}return __extends(InsideZoomView2,_super),InsideZoomView2.prototype.render=function(dataZoomModel,ecModel,api){_super.prototype.render.apply(this,arguments),dataZoomModel.noTarget()?this._clear():(this.range=dataZoomModel.getPercentRange(),function(api,dataZoomModel,getRange){inner$1(api).coordSysRecordMap.each((function(coordSysRecord){var dzInfo=coordSysRecord.dataZoomInfoMap.get(dataZoomModel.uid);dzInfo&&(dzInfo.getRange=getRange)}))}(api,dataZoomModel,{pan:bind$1(getRangeHandlers.pan,this),zoom:bind$1(getRangeHandlers.zoom,this),scrollMove:bind$1(getRangeHandlers.scrollMove,this)}))},InsideZoomView2.prototype.dispose=function(){this._clear(),_super.prototype.dispose.apply(this,arguments)},InsideZoomView2.prototype._clear=function(){!function(api,dataZoomModel){for(var coordSysRecordMap=inner$1(api).coordSysRecordMap,coordSysKeyArr=coordSysRecordMap.keys(),i=0;i<coordSysKeyArr.length;i++){var coordSysKey=coordSysKeyArr[i],coordSysRecord=coordSysRecordMap.get(coordSysKey),dataZoomInfoMap=coordSysRecord.dataZoomInfoMap;if(dataZoomInfoMap){var dzUid=dataZoomModel.uid;dataZoomInfoMap.get(dzUid)&&(dataZoomInfoMap.removeKey(dzUid),dataZoomInfoMap.keys().length||disposeCoordSysRecord(coordSysRecordMap,coordSysRecord))}}}(this.api,this.dataZoomModel),this.range=null},InsideZoomView2.type="dataZoom.inside",InsideZoomView2}(DataZoomView),getRangeHandlers={zoom:function(coordSysInfo,coordSysMainType,controller,e2){var lastRange=this.range,range=lastRange.slice(),axisModel=coordSysInfo.axisModels[0];if(axisModel){var directionInfo=getDirectionInfo[coordSysMainType](null,[e2.originX,e2.originY],axisModel,controller,coordSysInfo),percentPoint=(directionInfo.signal>0?directionInfo.pixelStart+directionInfo.pixelLength-directionInfo.pixel:directionInfo.pixel-directionInfo.pixelStart)/directionInfo.pixelLength*(range[1]-range[0])+range[0],scale2=Math.max(1/e2.scale,0);range[0]=(range[0]-percentPoint)*scale2+percentPoint,range[1]=(range[1]-percentPoint)*scale2+percentPoint;var minMaxSpan=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();return sliderMove(0,range,[0,100],0,minMaxSpan.minSpan,minMaxSpan.maxSpan),this.range=range,lastRange[0]!==range[0]||lastRange[1]!==range[1]?range:void 0}},pan:makeMover((function(range,axisModel,coordSysInfo,coordSysMainType,controller,e2){var directionInfo=getDirectionInfo[coordSysMainType]([e2.oldX,e2.oldY],[e2.newX,e2.newY],axisModel,controller,coordSysInfo);return directionInfo.signal*(range[1]-range[0])*directionInfo.pixel/directionInfo.pixelLength})),scrollMove:makeMover((function(range,axisModel,coordSysInfo,coordSysMainType,controller,e2){return getDirectionInfo[coordSysMainType]([0,0],[e2.scrollDelta,e2.scrollDelta],axisModel,controller,coordSysInfo).signal*(range[1]-range[0])*e2.scrollDelta}))};function makeMover(getPercentDelta){return function(coordSysInfo,coordSysMainType,controller,e2){var lastRange=this.range,range=lastRange.slice(),axisModel=coordSysInfo.axisModels[0];if(axisModel)return sliderMove(getPercentDelta(range,axisModel,coordSysInfo,coordSysMainType,controller,e2),range,[0,100],"all"),this.range=range,lastRange[0]!==range[0]||lastRange[1]!==range[1]?range:void 0}}var getDirectionInfo={grid:function(oldPoint,newPoint,axisModel,controller,coordSysInfo){var axis=axisModel.axis,ret={},rect=coordSysInfo.model.coordinateSystem.getRect();return oldPoint=oldPoint||[0,0],"x"===axis.dim?(ret.pixel=newPoint[0]-oldPoint[0],ret.pixelLength=rect.width,ret.pixelStart=rect.x,ret.signal=axis.inverse?1:-1):(ret.pixel=newPoint[1]-oldPoint[1],ret.pixelLength=rect.height,ret.pixelStart=rect.y,ret.signal=axis.inverse?-1:1),ret},polar:function(oldPoint,newPoint,axisModel,controller,coordSysInfo){var axis=axisModel.axis,ret={},polar=coordSysInfo.model.coordinateSystem,radiusExtent=polar.getRadiusAxis().getExtent(),angleExtent=polar.getAngleAxis().getExtent();return oldPoint=oldPoint?polar.pointToCoord(oldPoint):[0,0],newPoint=polar.pointToCoord(newPoint),"radiusAxis"===axisModel.mainType?(ret.pixel=newPoint[0]-oldPoint[0],ret.pixelLength=radiusExtent[1]-radiusExtent[0],ret.pixelStart=radiusExtent[0],ret.signal=axis.inverse?1:-1):(ret.pixel=newPoint[1]-oldPoint[1],ret.pixelLength=angleExtent[1]-angleExtent[0],ret.pixelStart=angleExtent[0],ret.signal=axis.inverse?-1:1),ret},singleAxis:function(oldPoint,newPoint,axisModel,controller,coordSysInfo){var axis=axisModel.axis,rect=coordSysInfo.model.coordinateSystem.getRect(),ret={};return oldPoint=oldPoint||[0,0],"horizontal"===axis.orient?(ret.pixel=newPoint[0]-oldPoint[0],ret.pixelLength=rect.width,ret.pixelStart=rect.x,ret.signal=axis.inverse?1:-1):(ret.pixel=newPoint[1]-oldPoint[1],ret.pixelLength=rect.height,ret.pixelStart=rect.y,ret.signal=axis.inverse?-1:1),ret}};function install$7(registers){installCommon$1(registers),registers.registerComponentModel(InsideZoomModel),registers.registerComponentView(InsideZoomView),installDataZoomRoamProcessor(registers)}var SliderZoomModel=function(_super){function SliderZoomModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=SliderZoomModel2.type,_this}return __extends(SliderZoomModel2,_super),SliderZoomModel2.type="dataZoom.slider",SliderZoomModel2.layoutMode="box",SliderZoomModel2.defaultOption=inheritDefaultOption(DataZoomModel.defaultOption,{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,borderColor:"#d2dbee",borderRadius:3,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#d2dbee",width:.5},areaStyle:{color:"#d2dbee",opacity:.2}},selectedDataBackground:{lineStyle:{color:"#8fb0f7",width:.5},areaStyle:{color:"#8fb0f7",opacity:.2}},fillerColor:"rgba(135,175,274,0.2)",handleIcon:"path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z",handleSize:"100%",handleStyle:{color:"#fff",borderColor:"#ACB8D1"},moveHandleSize:7,moveHandleIcon:"path://M-320.9-50L-320.9-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-348-41-339-50-320.9-50z M-212.3-50L-212.3-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-239.4-41-230.4-50-212.3-50z M-103.7-50L-103.7-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-130.9-41-121.8-50-103.7-50z",moveHandleStyle:{color:"#D2DBEE",opacity:.7},showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#6E7079"},brushSelect:!0,brushStyle:{color:"rgba(135,175,274,0.15)"},emphasis:{handleLabel:{show:!0},handleStyle:{borderColor:"#8FB0F7"},moveHandleStyle:{color:"#8FB0F7"}}}),SliderZoomModel2}(DataZoomModel),Rect=Rect$1,SHOW_DATA_SHADOW_SERIES_TYPE=["line","bar","candlestick","scatter"],REALTIME_ANIMATION_CONFIG={easing:"cubicOut",duration:100,delay:0},SliderZoomView=function(_super){function SliderZoomView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=SliderZoomView2.type,_this._displayables={},_this}return __extends(SliderZoomView2,_super),SliderZoomView2.prototype.init=function(ecModel,api){this.api=api,this._onBrush=bind$1(this._onBrush,this),this._onBrushEnd=bind$1(this._onBrushEnd,this)},SliderZoomView2.prototype.render=function(dataZoomModel,ecModel,api,payload){if(_super.prototype.render.apply(this,arguments),createOrUpdate(this,"_dispatchZoomAction",dataZoomModel.get("throttle"),"fixRate"),this._orient=dataZoomModel.getOrient(),!1!==dataZoomModel.get("show")){if(dataZoomModel.noTarget())return this._clear(),void this.group.removeAll();payload&&"dataZoom"===payload.type&&payload.from===this.uid||this._buildView(),this._updateView()}else this.group.removeAll()},SliderZoomView2.prototype.dispose=function(){this._clear(),_super.prototype.dispose.apply(this,arguments)},SliderZoomView2.prototype._clear=function(){clear$1(this,"_dispatchZoomAction");var zr=this.api.getZr();zr.off("mousemove",this._onBrush),zr.off("mouseup",this._onBrushEnd)},SliderZoomView2.prototype._buildView=function(){var thisGroup=this.group;thisGroup.removeAll(),this._brushing=!1,this._displayables.brushRect=null,this._resetLocation(),this._resetInterval();var barGroup=this._displayables.sliderGroup=new Group$2;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),thisGroup.add(barGroup),this._positionGroup()},SliderZoomView2.prototype._resetLocation=function(){var dataZoomModel=this.dataZoomModel,api=this.api,moveHandleSize=dataZoomModel.get("brushSelect")?7:0,coordRect=this._findCoordRect(),ecSize={width:api.getWidth(),height:api.getHeight()},positionInfo="horizontal"===this._orient?{right:ecSize.width-coordRect.x-coordRect.width,top:ecSize.height-30-7-moveHandleSize,width:coordRect.width,height:30}:{right:7,top:coordRect.y,width:30,height:coordRect.height},layoutParams=getLayoutParams(dataZoomModel.option);each$d(["right","top","width","height"],(function(name){"ph"===layoutParams[name]&&(layoutParams[name]=positionInfo[name])}));var layoutRect=getLayoutRect(layoutParams,ecSize);this._location={x:layoutRect.x,y:layoutRect.y},this._size=[layoutRect.width,layoutRect.height],"vertical"===this._orient&&this._size.reverse()},SliderZoomView2.prototype._positionGroup=function(){var thisGroup=this.group,location=this._location,orient=this._orient,targetAxisModel=this.dataZoomModel.getFirstTargetAxisModel(),inverse=targetAxisModel&&targetAxisModel.get("inverse"),sliderGroup=this._displayables.sliderGroup,otherAxisInverse=(this._dataShadowInfo||{}).otherAxisInverse;sliderGroup.attr("horizontal"!==orient||inverse?"horizontal"===orient&&inverse?{scaleY:otherAxisInverse?1:-1,scaleX:-1}:"vertical"!==orient||inverse?{scaleY:otherAxisInverse?-1:1,scaleX:-1,rotation:Math.PI/2}:{scaleY:otherAxisInverse?-1:1,scaleX:1,rotation:Math.PI/2}:{scaleY:otherAxisInverse?1:-1,scaleX:1});var rect=thisGroup.getBoundingRect([sliderGroup]);thisGroup.x=location.x-rect.x,thisGroup.y=location.y-rect.y,thisGroup.markRedraw()},SliderZoomView2.prototype._getViewExtent=function(){return[0,this._size[0]]},SliderZoomView2.prototype._renderBackground=function(){var dataZoomModel=this.dataZoomModel,size=this._size,barGroup=this._displayables.sliderGroup,brushSelect=dataZoomModel.get("brushSelect");barGroup.add(new Rect({silent:!0,shape:{x:0,y:0,width:size[0],height:size[1]},style:{fill:dataZoomModel.get("backgroundColor")},z2:-40}));var clickPanel=new Rect({shape:{x:0,y:0,width:size[0],height:size[1]},style:{fill:"transparent"},z2:0,onclick:bind$1(this._onClickPanel,this)}),zr=this.api.getZr();brushSelect?(clickPanel.on("mousedown",this._onBrushStart,this),clickPanel.cursor="crosshair",zr.on("mousemove",this._onBrush),zr.on("mouseup",this._onBrushEnd)):(zr.off("mousemove",this._onBrush),zr.off("mouseup",this._onBrushEnd)),barGroup.add(clickPanel)},SliderZoomView2.prototype._renderDataShadow=function(){var info=this._dataShadowInfo=this._prepareDataShadowInfo();if(this._displayables.dataShadowSegs=[],info){var size=this._size,oldSize=this._shadowSize||[],seriesModel=info.series,data=seriesModel.getRawData(),candlestickDim=seriesModel.getShadowDim&&seriesModel.getShadowDim(),otherDim=candlestickDim&&data.getDimensionInfo(candlestickDim)?seriesModel.getShadowDim():info.otherDim;if(null!=otherDim){var polygonPts=this._shadowPolygonPts,polylinePts=this._shadowPolylinePts;if(data!==this._shadowData||otherDim!==this._shadowDim||size[0]!==oldSize[0]||size[1]!==oldSize[1]){var otherDataExtent_1=data.getDataExtent(otherDim),otherOffset=.3*(otherDataExtent_1[1]-otherDataExtent_1[0]);otherDataExtent_1=[otherDataExtent_1[0]-otherOffset,otherDataExtent_1[1]+otherOffset];var lastIsEmpty_1,otherShadowExtent_1=[0,size[1]],thisShadowExtent=[0,size[0]],areaPoints_1=[[size[0],0],[0,0]],linePoints_1=[],step_1=thisShadowExtent[1]/(data.count()-1),thisCoord_1=0,stride_1=Math.round(data.count()/size[0]);data.each([otherDim],(function(value,index){if(stride_1>0&&index%stride_1)thisCoord_1+=step_1;else{var isEmpty=null==value||isNaN(value)||""===value,otherCoord=isEmpty?0:linearMap$2(value,otherDataExtent_1,otherShadowExtent_1,!0);isEmpty&&!lastIsEmpty_1&&index?(areaPoints_1.push([areaPoints_1[areaPoints_1.length-1][0],0]),linePoints_1.push([linePoints_1[linePoints_1.length-1][0],0])):!isEmpty&&lastIsEmpty_1&&(areaPoints_1.push([thisCoord_1,0]),linePoints_1.push([thisCoord_1,0])),areaPoints_1.push([thisCoord_1,otherCoord]),linePoints_1.push([thisCoord_1,otherCoord]),thisCoord_1+=step_1,lastIsEmpty_1=isEmpty}})),polygonPts=this._shadowPolygonPts=areaPoints_1,polylinePts=this._shadowPolylinePts=linePoints_1}this._shadowData=data,this._shadowDim=otherDim,this._shadowSize=[size[0],size[1]];for(var isSelectedArea,model,group2,polygon,polyline,dataZoomModel=this.dataZoomModel,i=0;i<3;i++){var group=(isSelectedArea=1===i,model=void 0,group2=void 0,polygon=void 0,polyline=void 0,model=dataZoomModel.getModel(isSelectedArea?"selectedDataBackground":"dataBackground"),group2=new Group$2,polygon=new Polygon({shape:{points:polygonPts},segmentIgnoreThreshold:1,style:model.getModel("areaStyle").getAreaStyle(),silent:!0,z2:-20}),polyline=new Polyline({shape:{points:polylinePts},segmentIgnoreThreshold:1,style:model.getModel("lineStyle").getLineStyle(),silent:!0,z2:-19}),group2.add(polygon),group2.add(polyline),group2);this._displayables.sliderGroup.add(group),this._displayables.dataShadowSegs.push(group)}}}},SliderZoomView2.prototype._prepareDataShadowInfo=function(){var dataZoomModel=this.dataZoomModel,showDataShadow=dataZoomModel.get("showDataShadow");if(!1!==showDataShadow){var result,ecModel=this.ecModel;return dataZoomModel.eachTargetAxis((function(axisDim,axisIndex){each$d(dataZoomModel.getAxisProxy(axisDim,axisIndex).getTargetSeriesModels(),(function(seriesModel){if(!(result||!0!==showDataShadow&&indexOf(SHOW_DATA_SHADOW_SERIES_TYPE,seriesModel.get("type"))<0)){var otherAxisInverse,thisAxis=ecModel.getComponent(getAxisMainType(axisDim),axisIndex).axis,otherDim={x:"y",y:"x",radius:"angle",angle:"radius"}[axisDim],coordSys=seriesModel.coordinateSystem;null!=otherDim&&coordSys.getOtherAxis&&(otherAxisInverse=coordSys.getOtherAxis(thisAxis).inverse),otherDim=seriesModel.getData().mapDimension(otherDim),result={thisAxis:thisAxis,series:seriesModel,thisDim:axisDim,otherDim:otherDim,otherAxisInverse:otherAxisInverse}}}),this)}),this),result}},SliderZoomView2.prototype._renderHandle=function(){var thisGroup=this.group,displayables=this._displayables,handles=displayables.handles=[null,null],handleLabels=displayables.handleLabels=[null,null],sliderGroup=this._displayables.sliderGroup,size=this._size,dataZoomModel=this.dataZoomModel,api=this.api,borderRadius=dataZoomModel.get("borderRadius")||0,brushSelect=dataZoomModel.get("brushSelect"),filler=displayables.filler=new Rect({silent:brushSelect,style:{fill:dataZoomModel.get("fillerColor")},textConfig:{position:"inside"}});sliderGroup.add(filler),sliderGroup.add(new Rect({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:size[0],height:size[1],r:borderRadius},style:{stroke:dataZoomModel.get("dataBackgroundColor")||dataZoomModel.get("borderColor"),lineWidth:1,fill:"rgba(0,0,0,0)"}})),each$d([0,1],(function(handleIndex){var iconStr=dataZoomModel.get("handleIcon");!symbolBuildProxies[iconStr]&&iconStr.indexOf("path://")<0&&iconStr.indexOf("image://")<0&&(iconStr="path://"+iconStr);var path=createSymbol(iconStr,-1,0,2,2,null,!0);path.attr({cursor:getCursor$1(this._orient),draggable:!0,drift:bind$1(this._onDragMove,this,handleIndex),ondragend:bind$1(this._onDragEnd,this),onmouseover:bind$1(this._showDataInfo,this,!0),onmouseout:bind$1(this._showDataInfo,this,!1),z2:5});var bRect=path.getBoundingRect(),handleSize=dataZoomModel.get("handleSize");this._handleHeight=parsePercent(handleSize,this._size[1]),this._handleWidth=bRect.width/bRect.height*this._handleHeight,path.setStyle(dataZoomModel.getModel("handleStyle").getItemStyle()),path.style.strokeNoScale=!0,path.rectHover=!0,path.ensureState("emphasis").style=dataZoomModel.getModel(["emphasis","handleStyle"]).getItemStyle(),enableHoverEmphasis(path);var handleColor=dataZoomModel.get("handleColor");null!=handleColor&&(path.style.fill=handleColor),sliderGroup.add(handles[handleIndex]=path);var textStyleModel=dataZoomModel.getModel("textStyle"),handleLabelShow=(dataZoomModel.get("handleLabel")||{}).show||!1;thisGroup.add(handleLabels[handleIndex]=new ZRText({silent:!0,invisible:!handleLabelShow,style:createTextStyle$1(textStyleModel,{x:0,y:0,text:"",verticalAlign:"middle",align:"center",fill:textStyleModel.getTextColor(),font:textStyleModel.getFont()}),z2:10}))}),this);var actualMoveZone=filler;if(brushSelect){var moveHandleHeight=parsePercent(dataZoomModel.get("moveHandleSize"),size[1]),moveHandle_1=displayables.moveHandle=new Rect$1({style:dataZoomModel.getModel("moveHandleStyle").getItemStyle(),silent:!0,shape:{r:[0,0,2,2],y:size[1]-.5,height:moveHandleHeight}}),iconSize=.8*moveHandleHeight,moveHandleIcon=displayables.moveHandleIcon=createSymbol(dataZoomModel.get("moveHandleIcon"),-iconSize/2,-iconSize/2,iconSize,iconSize,"#fff",!0);moveHandleIcon.silent=!0,moveHandleIcon.y=size[1]+moveHandleHeight/2-.5,moveHandle_1.ensureState("emphasis").style=dataZoomModel.getModel(["emphasis","moveHandleStyle"]).getItemStyle();var moveZoneExpandSize=Math.min(size[1]/2,Math.max(moveHandleHeight,10));(actualMoveZone=displayables.moveZone=new Rect$1({invisible:!0,shape:{y:size[1]-moveZoneExpandSize,height:moveHandleHeight+moveZoneExpandSize}})).on("mouseover",(function(){api.enterEmphasis(moveHandle_1)})).on("mouseout",(function(){api.leaveEmphasis(moveHandle_1)})),sliderGroup.add(moveHandle_1),sliderGroup.add(moveHandleIcon),sliderGroup.add(actualMoveZone)}actualMoveZone.attr({draggable:!0,cursor:getCursor$1(this._orient),drift:bind$1(this._onDragMove,this,"all"),ondragstart:bind$1(this._showDataInfo,this,!0),ondragend:bind$1(this._onDragEnd,this),onmouseover:bind$1(this._showDataInfo,this,!0),onmouseout:bind$1(this._showDataInfo,this,!1)})},SliderZoomView2.prototype._resetInterval=function(){var range=this._range=this.dataZoomModel.getPercentRange(),viewExtent=this._getViewExtent();this._handleEnds=[linearMap$2(range[0],[0,100],viewExtent,!0),linearMap$2(range[1],[0,100],viewExtent,!0)]},SliderZoomView2.prototype._updateInterval=function(handleIndex,delta){var dataZoomModel=this.dataZoomModel,handleEnds=this._handleEnds,viewExtend=this._getViewExtent(),minMaxSpan=dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan(),percentExtent=[0,100];sliderMove(delta,handleEnds,viewExtend,dataZoomModel.get("zoomLock")?"all":handleIndex,null!=minMaxSpan.minSpan?linearMap$2(minMaxSpan.minSpan,percentExtent,viewExtend,!0):null,null!=minMaxSpan.maxSpan?linearMap$2(minMaxSpan.maxSpan,percentExtent,viewExtend,!0):null);var lastRange=this._range,range=this._range=asc$2([linearMap$2(handleEnds[0],viewExtend,percentExtent,!0),linearMap$2(handleEnds[1],viewExtend,percentExtent,!0)]);return!lastRange||lastRange[0]!==range[0]||lastRange[1]!==range[1]},SliderZoomView2.prototype._updateView=function(nonRealtime){var displaybles=this._displayables,handleEnds=this._handleEnds,handleInterval=asc$2(handleEnds.slice()),size=this._size;each$d([0,1],(function(handleIndex){var handle=displaybles.handles[handleIndex],handleHeight=this._handleHeight;handle.attr({scaleX:handleHeight/2,scaleY:handleHeight/2,x:handleEnds[handleIndex]+(handleIndex?-1:1),y:size[1]/2-handleHeight/2})}),this),displaybles.filler.setShape({x:handleInterval[0],y:0,width:handleInterval[1]-handleInterval[0],height:size[1]});var viewExtent={x:handleInterval[0],width:handleInterval[1]-handleInterval[0]};displaybles.moveHandle&&(displaybles.moveHandle.setShape(viewExtent),displaybles.moveZone.setShape(viewExtent),displaybles.moveZone.getBoundingRect(),displaybles.moveHandleIcon&&displaybles.moveHandleIcon.attr("x",viewExtent.x+viewExtent.width/2));for(var dataShadowSegs=displaybles.dataShadowSegs,segIntervals=[0,handleInterval[0],handleInterval[1],size[0]],i=0;i<dataShadowSegs.length;i++){var segGroup=dataShadowSegs[i],clipPath=segGroup.getClipPath();clipPath||(clipPath=new Rect$1,segGroup.setClipPath(clipPath)),clipPath.setShape({x:segIntervals[i],y:0,width:segIntervals[i+1]-segIntervals[i],height:size[1]})}this._updateDataInfo(nonRealtime)},SliderZoomView2.prototype._updateDataInfo=function(nonRealtime){var dataZoomModel=this.dataZoomModel,displaybles=this._displayables,handleLabels=displaybles.handleLabels,orient=this._orient,labelTexts=["",""];if(dataZoomModel.get("showDetail")){var axisProxy=dataZoomModel.findRepresentativeAxisProxy();if(axisProxy){var axis=axisProxy.getAxisModel().axis,range=this._range,dataInterval=nonRealtime?axisProxy.calculateDataWindow({start:range[0],end:range[1]}).valueWindow:axisProxy.getDataValueWindow();labelTexts=[this._formatLabel(dataInterval[0],axis),this._formatLabel(dataInterval[1],axis)]}}var orderedHandleEnds=asc$2(this._handleEnds.slice());function setLabel(handleIndex){var barTransform=getTransform$1(displaybles.handles[handleIndex].parent,this.group),direction=transformDirection(0===handleIndex?"right":"left",barTransform),offset=this._handleWidth/2+5,textPoint=applyTransform([orderedHandleEnds[handleIndex]+(0===handleIndex?-offset:offset),this._size[1]/2],barTransform);handleLabels[handleIndex].setStyle({x:textPoint[0],y:textPoint[1],verticalAlign:"horizontal"===orient?"middle":direction,align:"horizontal"===orient?direction:"center",text:labelTexts[handleIndex]})}setLabel.call(this,0),setLabel.call(this,1)},SliderZoomView2.prototype._formatLabel=function(value,axis){var dataZoomModel=this.dataZoomModel,labelFormatter=dataZoomModel.get("labelFormatter"),labelPrecision=dataZoomModel.get("labelPrecision");null!=labelPrecision&&"auto"!==labelPrecision||(labelPrecision=axis.getPixelPrecision());var valueStr=null==value||isNaN(value)?"":"category"===axis.type||"time"===axis.type?axis.scale.getLabel({value:Math.round(value)}):value.toFixed(Math.min(labelPrecision,20));return isFunction(labelFormatter)?labelFormatter(value,valueStr):isString(labelFormatter)?labelFormatter.replace("{value}",valueStr):valueStr},SliderZoomView2.prototype._showDataInfo=function(isEmphasis){var normalShow=(this.dataZoomModel.get("handleLabel")||{}).show||!1,emphasisShow=this.dataZoomModel.getModel(["emphasis","handleLabel"]).get("show")||!1,toShow=isEmphasis||this._dragging?emphasisShow:normalShow,displayables=this._displayables,handleLabels=displayables.handleLabels;handleLabels[0].attr("invisible",!toShow),handleLabels[1].attr("invisible",!toShow),displayables.moveHandle&&this.api[toShow?"enterEmphasis":"leaveEmphasis"](displayables.moveHandle,1)},SliderZoomView2.prototype._onDragMove=function(handleIndex,dx,dy,event){this._dragging=!0,stop(event.event);var vertex=applyTransform([dx,dy],this._displayables.sliderGroup.getLocalTransform(),!0),changed=this._updateInterval(handleIndex,vertex[0]),realtime=this.dataZoomModel.get("realtime");this._updateView(!realtime),changed&&realtime&&this._dispatchZoomAction(!0)},SliderZoomView2.prototype._onDragEnd=function(){this._dragging=!1,this._showDataInfo(!1),!this.dataZoomModel.get("realtime")&&this._dispatchZoomAction(!1)},SliderZoomView2.prototype._onClickPanel=function(e2){var size=this._size,localPoint=this._displayables.sliderGroup.transformCoordToLocal(e2.offsetX,e2.offsetY);if(!(localPoint[0]<0||localPoint[0]>size[0]||localPoint[1]<0||localPoint[1]>size[1])){var handleEnds=this._handleEnds,center2=(handleEnds[0]+handleEnds[1])/2,changed=this._updateInterval("all",localPoint[0]-center2);this._updateView(),changed&&this._dispatchZoomAction(!1)}},SliderZoomView2.prototype._onBrushStart=function(e2){var x=e2.offsetX,y=e2.offsetY;this._brushStart=new Point(x,y),this._brushing=!0,this._brushStartTime=+new Date},SliderZoomView2.prototype._onBrushEnd=function(e2){if(this._brushing){var brushRect=this._displayables.brushRect;if(this._brushing=!1,brushRect){brushRect.attr("ignore",!0);var brushShape=brushRect.shape;if(!(+new Date-this._brushStartTime<200&&Math.abs(brushShape.width)<5)){var viewExtend=this._getViewExtent(),percentExtent=[0,100];this._range=asc$2([linearMap$2(brushShape.x,viewExtend,percentExtent,!0),linearMap$2(brushShape.x+brushShape.width,viewExtend,percentExtent,!0)]),this._handleEnds=[brushShape.x,brushShape.x+brushShape.width],this._updateView(),this._dispatchZoomAction(!1)}}}},SliderZoomView2.prototype._onBrush=function(e2){this._brushing&&(stop(e2.event),this._updateBrushRect(e2.offsetX,e2.offsetY))},SliderZoomView2.prototype._updateBrushRect=function(mouseX,mouseY){var displayables=this._displayables,dataZoomModel=this.dataZoomModel,brushRect=displayables.brushRect;brushRect||(brushRect=displayables.brushRect=new Rect({silent:!0,style:dataZoomModel.getModel("brushStyle").getItemStyle()}),displayables.sliderGroup.add(brushRect)),brushRect.attr("ignore",!1);var brushStart=this._brushStart,sliderGroup=this._displayables.sliderGroup,endPoint=sliderGroup.transformCoordToLocal(mouseX,mouseY),startPoint=sliderGroup.transformCoordToLocal(brushStart.x,brushStart.y),size=this._size;endPoint[0]=Math.max(Math.min(size[0],endPoint[0]),0),brushRect.setShape({x:startPoint[0],y:0,width:endPoint[0]-startPoint[0],height:size[1]})},SliderZoomView2.prototype._dispatchZoomAction=function(realtime){var range=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,animation:realtime?REALTIME_ANIMATION_CONFIG:null,start:range[0],end:range[1]})},SliderZoomView2.prototype._findCoordRect=function(){var rect,coordSysInfoList=collectReferCoordSysModelInfo(this.dataZoomModel).infoList;if(!rect&&coordSysInfoList.length){var coordSys=coordSysInfoList[0].model.coordinateSystem;rect=coordSys.getRect&&coordSys.getRect()}if(!rect){var width=this.api.getWidth(),height=this.api.getHeight();rect={x:.2*width,y:.2*height,width:.6*width,height:.6*height}}return rect},SliderZoomView2.type="dataZoom.slider",SliderZoomView2}(DataZoomView);function getCursor$1(orient){return"vertical"===orient?"ns-resize":"ew-resize"}function install$6(registers){registers.registerComponentModel(SliderZoomModel),registers.registerComponentView(SliderZoomView),installCommon$1(registers)}var visualDefault_get=function(visualType,key,isCategory2){var value=clone$3((defaultOption[visualType]||{})[key]);return isCategory2&&isArray$1(value)?value[value.length-1]:value},defaultOption={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}},mapVisual=VisualMapping.mapVisual,eachVisual=VisualMapping.eachVisual,isArray=isArray$1,each$2=each$d,asc=asc$2,linearMap$1=linearMap$2,VisualMapModel=function(_super){function VisualMapModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=VisualMapModel2.type,_this.stateList=["inRange","outOfRange"],_this.replacableOptionKeys=["inRange","outOfRange","target","controller","color"],_this.layoutMode={type:"box",ignoreSize:!0},_this.dataBound=[-Infinity,Infinity],_this.targetVisuals={},_this.controllerVisuals={},_this}return __extends(VisualMapModel2,_super),VisualMapModel2.prototype.init=function(option,parentModel,ecModel){this.mergeDefaultAndTheme(option,ecModel)},VisualMapModel2.prototype.optionUpdated=function(newOption,isInit){var thisOption=this.option;!isInit&&function(thisOption,newOption,keys2){var has2;each$d(keys2,(function(key){newOption.hasOwnProperty(key)&&hasKeys(newOption[key])&&(has2=!0)})),has2&&each$d(keys2,(function(key){newOption.hasOwnProperty(key)&&hasKeys(newOption[key])?thisOption[key]=clone$3(newOption[key]):delete thisOption[key]}))}(thisOption,newOption,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption()},VisualMapModel2.prototype.resetVisual=function(supplementVisualOption){var stateList=this.stateList;supplementVisualOption=bind$1(supplementVisualOption,this),this.controllerVisuals=createVisualMappings(this.option.controller,stateList,supplementVisualOption),this.targetVisuals=createVisualMappings(this.option.target,stateList,supplementVisualOption)},VisualMapModel2.prototype.getItemSymbol=function(){return null},VisualMapModel2.prototype.getTargetSeriesIndices=function(){var optionSeriesIndex=this.option.seriesIndex,seriesIndices=[];return null==optionSeriesIndex||"all"===optionSeriesIndex?this.ecModel.eachSeries((function(seriesModel,index){seriesIndices.push(index)})):seriesIndices=normalizeToArray(optionSeriesIndex),seriesIndices},VisualMapModel2.prototype.eachTargetSeries=function(callback,context){each$d(this.getTargetSeriesIndices(),(function(seriesIndex){var seriesModel=this.ecModel.getSeriesByIndex(seriesIndex);seriesModel&&callback.call(context,seriesModel)}),this)},VisualMapModel2.prototype.isTargetSeries=function(seriesModel){var is=!1;return this.eachTargetSeries((function(model){model===seriesModel&&(is=!0)})),is},VisualMapModel2.prototype.formatValueText=function(value,isCategory2,edgeSymbols){var isMinMax,option=this.option,precision=option.precision,dataBound=this.dataBound,formatter=option.formatter;edgeSymbols=edgeSymbols||["<",">"],isArray$1(value)&&(value=value.slice(),isMinMax=!0);var textValue=isCategory2?value:isMinMax?[toFixed(value[0]),toFixed(value[1])]:toFixed(value);return isString(formatter)?formatter.replace("{value}",isMinMax?textValue[0]:textValue).replace("{value2}",isMinMax?textValue[1]:textValue):isFunction(formatter)?isMinMax?formatter(value[0],value[1]):formatter(value):isMinMax?value[0]===dataBound[0]?edgeSymbols[0]+" "+textValue[1]:value[1]===dataBound[1]?edgeSymbols[1]+" "+textValue[0]:textValue[0]+" - "+textValue[1]:textValue;function toFixed(val){return val===dataBound[0]?"min":val===dataBound[1]?"max":(+val).toFixed(Math.min(precision,20))}},VisualMapModel2.prototype.resetExtent=function(){var thisOption=this.option,extent3=asc([thisOption.min,thisOption.max]);this._dataExtent=extent3},VisualMapModel2.prototype.getDataDimensionIndex=function(data){var optDim=this.option.dimension;if(null!=optDim)return data.getDimensionIndex(optDim);for(var dimNames=data.dimensions,i=dimNames.length-1;i>=0;i--){var dimName=dimNames[i],dimInfo=data.getDimensionInfo(dimName);if(!dimInfo.isCalculationCoord)return dimInfo.storeDimIndex}},VisualMapModel2.prototype.getExtent=function(){return this._dataExtent.slice()},VisualMapModel2.prototype.completeVisualOption=function(){var ecModel=this.ecModel,thisOption=this.option,base2={inRange:thisOption.inRange,outOfRange:thisOption.outOfRange},target=thisOption.target||(thisOption.target={}),controller=thisOption.controller||(thisOption.controller={});merge(target,base2),merge(controller,base2);var isCategory2=this.isCategory();function completeSingle(base3){isArray(thisOption.color)&&!base3.inRange&&(base3.inRange={color:thisOption.color.slice().reverse()}),base3.inRange=base3.inRange||{color:ecModel.get("gradientColor")}}completeSingle.call(this,target),completeSingle.call(this,controller),function(base3,stateExist,stateAbsent){var optExist=base3[stateExist],optAbsent=base3[stateAbsent];optExist&&!optAbsent&&(optAbsent=base3[stateAbsent]={},each$2(optExist,(function(visualData,visualType){if(VisualMapping.isValidType(visualType)){var defa=visualDefault_get(visualType,"inactive",isCategory2);null!=defa&&(optAbsent[visualType]=defa,"color"!==visualType||optAbsent.hasOwnProperty("opacity")||optAbsent.hasOwnProperty("colorAlpha")||(optAbsent.opacity=[0,0]))}})))}.call(this,target,"inRange","outOfRange"),function(controller2){var symbolExists=(controller2.inRange||{}).symbol||(controller2.outOfRange||{}).symbol,symbolSizeExists=(controller2.inRange||{}).symbolSize||(controller2.outOfRange||{}).symbolSize,inactiveColor=this.get("inactiveColor"),defaultSymbol=this.getItemSymbol()||"roundRect";each$2(this.stateList,(function(state){var itemSize=this.itemSize,visuals=controller2[state];visuals||(visuals=controller2[state]={color:isCategory2?inactiveColor:[inactiveColor]}),null==visuals.symbol&&(visuals.symbol=symbolExists&&clone$3(symbolExists)||(isCategory2?defaultSymbol:[defaultSymbol])),null==visuals.symbolSize&&(visuals.symbolSize=symbolSizeExists&&clone$3(symbolSizeExists)||(isCategory2?itemSize[0]:[itemSize[0],itemSize[0]])),visuals.symbol=mapVisual(visuals.symbol,(function(symbol){return"none"===symbol?defaultSymbol:symbol}));var symbolSize=visuals.symbolSize;if(null!=symbolSize){var max_1=-Infinity;eachVisual(symbolSize,(function(value){value>max_1&&(max_1=value)})),visuals.symbolSize=mapVisual(symbolSize,(function(value){return linearMap$1(value,[0,max_1],[0,itemSize[0]],!0)}))}}),this)}.call(this,controller)},VisualMapModel2.prototype.resetItemSize=function(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))]},VisualMapModel2.prototype.isCategory=function(){return!!this.option.categories},VisualMapModel2.prototype.setSelected=function(selected){},VisualMapModel2.prototype.getSelected=function(){return null},VisualMapModel2.prototype.getValueState=function(value){return null},VisualMapModel2.prototype.getVisualMeta=function(getColorVisual2){return null},VisualMapModel2.type="visualMap",VisualMapModel2.dependencies=["series"],VisualMapModel2.defaultOption={show:!0,z:4,seriesIndex:"all",min:0,max:200,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,textStyle:{color:"#333"}},VisualMapModel2}(ComponentModel),DEFAULT_BAR_BOUND=[20,140],ContinuousModel=function(_super){function ContinuousModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=ContinuousModel2.type,_this}return __extends(ContinuousModel2,_super),ContinuousModel2.prototype.optionUpdated=function(newOption,isInit){_super.prototype.optionUpdated.apply(this,arguments),this.resetExtent(),this.resetVisual((function(mappingOption){mappingOption.mappingMethod="linear",mappingOption.dataExtent=this.getExtent()})),this._resetRange()},ContinuousModel2.prototype.resetItemSize=function(){_super.prototype.resetItemSize.apply(this,arguments);var itemSize=this.itemSize;(null==itemSize[0]||isNaN(itemSize[0]))&&(itemSize[0]=DEFAULT_BAR_BOUND[0]),(null==itemSize[1]||isNaN(itemSize[1]))&&(itemSize[1]=DEFAULT_BAR_BOUND[1])},ContinuousModel2.prototype._resetRange=function(){var dataExtent=this.getExtent(),range=this.option.range;!range||range.auto?(dataExtent.auto=1,this.option.range=dataExtent):isArray$1(range)&&(range[0]>range[1]&&range.reverse(),range[0]=Math.max(range[0],dataExtent[0]),range[1]=Math.min(range[1],dataExtent[1]))},ContinuousModel2.prototype.completeVisualOption=function(){_super.prototype.completeVisualOption.apply(this,arguments),each$d(this.stateList,(function(state){var symbolSize=this.option.controller[state].symbolSize;symbolSize&&symbolSize[0]!==symbolSize[1]&&(symbolSize[0]=symbolSize[1]/3)}),this)},ContinuousModel2.prototype.setSelected=function(selected){this.option.range=selected.slice(),this._resetRange()},ContinuousModel2.prototype.getSelected=function(){var dataExtent=this.getExtent(),dataInterval=asc$2((this.get("range")||[]).slice());return dataInterval[0]>dataExtent[1]&&(dataInterval[0]=dataExtent[1]),dataInterval[1]>dataExtent[1]&&(dataInterval[1]=dataExtent[1]),dataInterval[0]<dataExtent[0]&&(dataInterval[0]=dataExtent[0]),dataInterval[1]<dataExtent[0]&&(dataInterval[1]=dataExtent[0]),dataInterval},ContinuousModel2.prototype.getValueState=function(value){var range=this.option.range,dataExtent=this.getExtent();return(range[0]<=dataExtent[0]||range[0]<=value)&&(range[1]>=dataExtent[1]||value<=range[1])?"inRange":"outOfRange"},ContinuousModel2.prototype.findTargetDataIndices=function(range){var result=[];return this.eachTargetSeries((function(seriesModel){var dataIndices=[],data=seriesModel.getData();data.each(this.getDataDimensionIndex(data),(function(value,dataIndex){range[0]<=value&&value<=range[1]&&dataIndices.push(dataIndex)}),this),result.push({seriesId:seriesModel.id,dataIndex:dataIndices})}),this),result},ContinuousModel2.prototype.getVisualMeta=function(getColorVisual2){var oVals=getColorStopValues(this,"outOfRange",this.getExtent()),iVals=getColorStopValues(this,"inRange",this.option.range.slice()),stops=[];function setStop(value,valueState){stops.push({value:value,color:getColorVisual2(value,valueState)})}for(var iIdx=0,oIdx=0,iLen=iVals.length,oLen=oVals.length;oIdx<oLen&&(!iVals.length||oVals[oIdx]<=iVals[0]);oIdx++)oVals[oIdx]<iVals[iIdx]&&setStop(oVals[oIdx],"outOfRange");for(var first=1;iIdx<iLen;iIdx++,first=0)first&&stops.length&&setStop(iVals[iIdx],"outOfRange"),setStop(iVals[iIdx],"inRange");for(first=1;oIdx<oLen;oIdx++)(!iVals.length||iVals[iVals.length-1]<oVals[oIdx])&&(first&&(stops.length&&setStop(stops[stops.length-1].value,"outOfRange"),first=0),setStop(oVals[oIdx],"outOfRange"));var stopsLen=stops.length;return{stops:stops,outerColors:[stopsLen?stops[0].color:"transparent",stopsLen?stops[stopsLen-1].color:"transparent"]}},ContinuousModel2.type="visualMap.continuous",ContinuousModel2.defaultOption=inheritDefaultOption(VisualMapModel.defaultOption,{align:"auto",calculable:!1,hoverLink:!0,realtime:!0,handleIcon:"path://M-11.39,9.77h0a3.5,3.5,0,0,1-3.5,3.5h-22a3.5,3.5,0,0,1-3.5-3.5h0a3.5,3.5,0,0,1,3.5-3.5h22A3.5,3.5,0,0,1-11.39,9.77Z",handleSize:"120%",handleStyle:{borderColor:"#fff",borderWidth:1},indicatorIcon:"circle",indicatorSize:"50%",indicatorStyle:{borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}}),ContinuousModel2}(VisualMapModel);function getColorStopValues(visualMapModel,valueState,dataExtent){if(dataExtent[0]===dataExtent[1])return dataExtent.slice();for(var step=(dataExtent[1]-dataExtent[0])/200,value=dataExtent[0],stopValues=[],i=0;i<=200&&value<dataExtent[1];i++)stopValues.push(value),value+=step;return stopValues.push(dataExtent[1]),stopValues}var VisualMapView=function(_super){function VisualMapView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=VisualMapView2.type,_this.autoPositionValues={left:1,right:1,top:1,bottom:1},_this}return __extends(VisualMapView2,_super),VisualMapView2.prototype.init=function(ecModel,api){this.ecModel=ecModel,this.api=api},VisualMapView2.prototype.render=function(visualMapModel,ecModel,api,payload){this.visualMapModel=visualMapModel,!1!==visualMapModel.get("show")?this.doRender(visualMapModel,ecModel,api,payload):this.group.removeAll()},VisualMapView2.prototype.renderBackground=function(group){var visualMapModel=this.visualMapModel,padding=normalizeCssArray(visualMapModel.get("padding")||0),rect=group.getBoundingRect();group.add(new Rect$1({z2:-1,silent:!0,shape:{x:rect.x-padding[3],y:rect.y-padding[0],width:rect.width+padding[3]+padding[1],height:rect.height+padding[0]+padding[2]},style:{fill:visualMapModel.get("backgroundColor"),stroke:visualMapModel.get("borderColor"),lineWidth:visualMapModel.get("borderWidth")}}))},VisualMapView2.prototype.getControllerVisual=function(targetValue,visualCluster,opts){var forceState=(opts=opts||{}).forceState,visualMapModel=this.visualMapModel,visualObj={};if("color"===visualCluster){var defaultColor=visualMapModel.get("contentColor");visualObj.color=defaultColor}function getter(key){return visualObj[key]}function setter(key,value){visualObj[key]=value}var mappings=visualMapModel.controllerVisuals[forceState||visualMapModel.getValueState(targetValue)];return each$d(VisualMapping.prepareVisualTypes(mappings),(function(type){var visualMapping=mappings[type];opts.convertOpacityToAlpha&&"opacity"===type&&(type="colorAlpha",visualMapping=mappings.__alphaForOpacity),VisualMapping.dependsOn(type,visualCluster)&&visualMapping&&visualMapping.applyVisual(targetValue,getter,setter)})),visualObj[visualCluster]},VisualMapView2.prototype.positionGroup=function(group){var model=this.visualMapModel,api=this.api;positionElement(group,model.getBoxLayoutParams(),{width:api.getWidth(),height:api.getHeight()})},VisualMapView2.prototype.doRender=function(visualMapModel,ecModel,api,payload){},VisualMapView2.type="visualMap",VisualMapView2}(ComponentView),paramsSet=[["left","right","width"],["top","bottom","height"]];function getItemAlign(visualMapModel,api,itemSize){var modelOption=visualMapModel.option,itemAlign=modelOption.align;if(null!=itemAlign&&"auto"!==itemAlign)return itemAlign;for(var ecSize={width:api.getWidth(),height:api.getHeight()},realIndex="horizontal"===modelOption.orient?1:0,reals=paramsSet[realIndex],fakeValue=[0,null,10],layoutInput={},i=0;i<3;i++)layoutInput[paramsSet[1-realIndex][i]]=fakeValue[i],layoutInput[reals[i]]=2===i?itemSize[0]:modelOption[reals[i]];var rParam=[["x","width",3],["y","height",0]][realIndex],rect=getLayoutRect(layoutInput,ecSize,modelOption.padding);return reals[(rect.margin[rParam[2]]||0)+rect[rParam[0]]+.5*rect[rParam[1]]<.5*ecSize[rParam[1]]?0:1]}function makeHighDownBatch(batch,visualMapModel){return each$d(batch||[],(function(batchItem){null!=batchItem.dataIndex&&(batchItem.dataIndexInside=batchItem.dataIndex,batchItem.dataIndex=null),batchItem.highlightKey="visualMap"+(visualMapModel?visualMapModel.componentIndex:"")})),batch}var linearMap=linearMap$2,each$1=each$d,mathMin=Math.min,mathMax=Math.max,ContinuousView=function(_super){function ContinuousView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=ContinuousView2.type,_this._shapes={},_this._dataInterval=[],_this._handleEnds=[],_this._hoverLinkDataIndices=[],_this}return __extends(ContinuousView2,_super),ContinuousView2.prototype.init=function(ecModel,api){_super.prototype.init.call(this,ecModel,api),this._hoverLinkFromSeriesMouseOver=bind$1(this._hoverLinkFromSeriesMouseOver,this),this._hideIndicator=bind$1(this._hideIndicator,this)},ContinuousView2.prototype.doRender=function(visualMapModel,ecModel,api,payload){payload&&"selectDataRange"===payload.type&&payload.from===this.uid||this._buildView()},ContinuousView2.prototype._buildView=function(){this.group.removeAll();var visualMapModel=this.visualMapModel,thisGroup=this.group;this._orient=visualMapModel.get("orient"),this._useHandle=visualMapModel.get("calculable"),this._resetInterval(),this._renderBar(thisGroup);var dataRangeText=visualMapModel.get("text");this._renderEndsText(thisGroup,dataRangeText,0),this._renderEndsText(thisGroup,dataRangeText,1),this._updateView(!0),this.renderBackground(thisGroup),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(thisGroup)},ContinuousView2.prototype._renderEndsText=function(group,dataRangeText,endsIndex){if(dataRangeText){var text=dataRangeText[1-endsIndex];text=null!=text?text+"":"";var visualMapModel=this.visualMapModel,textGap=visualMapModel.get("textGap"),itemSize=visualMapModel.itemSize,barGroup=this._shapes.mainGroup,position=this._applyTransform([itemSize[0]/2,0===endsIndex?-textGap:itemSize[1]+textGap],barGroup),align=this._applyTransform(0===endsIndex?"bottom":"top",barGroup),orient=this._orient,textStyleModel=this.visualMapModel.textStyleModel;this.group.add(new ZRText({style:createTextStyle$1(textStyleModel,{x:position[0],y:position[1],verticalAlign:"horizontal"===orient?"middle":align,align:"horizontal"===orient?align:"center",text:text})}))}},ContinuousView2.prototype._renderBar=function(targetGroup){var visualMapModel=this.visualMapModel,shapes=this._shapes,itemSize=visualMapModel.itemSize,orient=this._orient,useHandle=this._useHandle,itemAlign=getItemAlign(visualMapModel,this.api,itemSize),mainGroup=shapes.mainGroup=this._createBarGroup(itemAlign),gradientBarGroup=new Group$2;mainGroup.add(gradientBarGroup),gradientBarGroup.add(shapes.outOfRange=createPolygon()),gradientBarGroup.add(shapes.inRange=createPolygon(null,useHandle?getCursor(this._orient):null,bind$1(this._dragHandle,this,"all",!1),bind$1(this._dragHandle,this,"all",!0))),gradientBarGroup.setClipPath(new Rect$1({shape:{x:0,y:0,width:itemSize[0],height:itemSize[1],r:3}}));var textRect=visualMapModel.textStyleModel.getTextRect("国"),textSize=mathMax(textRect.width,textRect.height);useHandle&&(shapes.handleThumbs=[],shapes.handleLabels=[],shapes.handleLabelPoints=[],this._createHandle(visualMapModel,mainGroup,0,itemSize,textSize,orient),this._createHandle(visualMapModel,mainGroup,1,itemSize,textSize,orient)),this._createIndicator(visualMapModel,mainGroup,itemSize,textSize,orient),targetGroup.add(mainGroup)},ContinuousView2.prototype._createHandle=function(visualMapModel,mainGroup,handleIndex,itemSize,textSize,orient){var onDrift=bind$1(this._dragHandle,this,handleIndex,!1),onDragEnd=bind$1(this._dragHandle,this,handleIndex,!0),handleSize=parsePercent$1(visualMapModel.get("handleSize"),itemSize[0]),handleThumb=createSymbol(visualMapModel.get("handleIcon"),-handleSize/2,-handleSize/2,handleSize,handleSize,null,!0),cursor=getCursor(this._orient);handleThumb.attr({cursor:cursor,draggable:!0,drift:onDrift,ondragend:onDragEnd,onmousemove:function(e2){stop(e2.event)}}),handleThumb.x=itemSize[0]/2,handleThumb.useStyle(visualMapModel.getModel("handleStyle").getItemStyle()),handleThumb.setStyle({strokeNoScale:!0,strokeFirst:!0}),handleThumb.style.lineWidth*=2,handleThumb.ensureState("emphasis").style=visualMapModel.getModel(["emphasis","handleStyle"]).getItemStyle(),setAsHighDownDispatcher(handleThumb,!0),mainGroup.add(handleThumb);var textStyleModel=this.visualMapModel.textStyleModel,handleLabel=new ZRText({cursor:cursor,draggable:!0,drift:onDrift,onmousemove:function(e2){stop(e2.event)},ondragend:onDragEnd,style:createTextStyle$1(textStyleModel,{x:0,y:0,text:""})});handleLabel.ensureState("blur").style={opacity:.1},handleLabel.stateTransition={duration:200},this.group.add(handleLabel);var handleLabelPoint=[handleSize,0],shapes=this._shapes;shapes.handleThumbs[handleIndex]=handleThumb,shapes.handleLabelPoints[handleIndex]=handleLabelPoint,shapes.handleLabels[handleIndex]=handleLabel},ContinuousView2.prototype._createIndicator=function(visualMapModel,mainGroup,itemSize,textSize,orient){var scale2=parsePercent$1(visualMapModel.get("indicatorSize"),itemSize[0]),indicator=createSymbol(visualMapModel.get("indicatorIcon"),-scale2/2,-scale2/2,scale2,scale2,null,!0);indicator.attr({cursor:"move",invisible:!0,silent:!0,x:itemSize[0]/2});var indicatorStyle=visualMapModel.getModel("indicatorStyle").getItemStyle();if(indicator instanceof ZRImage){var pathStyle=indicator.style;indicator.useStyle(extend({image:pathStyle.image,x:pathStyle.x,y:pathStyle.y,width:pathStyle.width,height:pathStyle.height},indicatorStyle))}else indicator.useStyle(indicatorStyle);mainGroup.add(indicator);var textStyleModel=this.visualMapModel.textStyleModel,indicatorLabel=new ZRText({silent:!0,invisible:!0,style:createTextStyle$1(textStyleModel,{x:0,y:0,text:""})});this.group.add(indicatorLabel);var indicatorLabelPoint=[("horizontal"===orient?textSize/2:6)+itemSize[0]/2,0],shapes=this._shapes;shapes.indicator=indicator,shapes.indicatorLabel=indicatorLabel,shapes.indicatorLabelPoint=indicatorLabelPoint,this._firstShowIndicator=!0},ContinuousView2.prototype._dragHandle=function(handleIndex,isEnd,dx,dy){if(this._useHandle){if(this._dragging=!isEnd,!isEnd){var vertex=this._applyTransform([dx,dy],this._shapes.mainGroup,!0);this._updateInterval(handleIndex,vertex[1]),this._hideIndicator(),this._updateView()}isEnd===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),isEnd?!this._hovering&&this._clearHoverLinkToSeries():useHoverLinkOnHandle(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[handleIndex],!1)}},ContinuousView2.prototype._resetInterval=function(){var visualMapModel=this.visualMapModel,dataInterval=this._dataInterval=visualMapModel.getSelected(),dataExtent=visualMapModel.getExtent(),sizeExtent=[0,visualMapModel.itemSize[1]];this._handleEnds=[linearMap(dataInterval[0],dataExtent,sizeExtent,!0),linearMap(dataInterval[1],dataExtent,sizeExtent,!0)]},ContinuousView2.prototype._updateInterval=function(handleIndex,delta){delta=delta||0;var visualMapModel=this.visualMapModel,handleEnds=this._handleEnds,sizeExtent=[0,visualMapModel.itemSize[1]];sliderMove(delta,handleEnds,sizeExtent,handleIndex,0);var dataExtent=visualMapModel.getExtent();this._dataInterval=[linearMap(handleEnds[0],sizeExtent,dataExtent,!0),linearMap(handleEnds[1],sizeExtent,dataExtent,!0)]},ContinuousView2.prototype._updateView=function(forSketch){var visualMapModel=this.visualMapModel,dataExtent=visualMapModel.getExtent(),shapes=this._shapes,outOfRangeHandleEnds=[0,visualMapModel.itemSize[1]],inRangeHandleEnds=forSketch?outOfRangeHandleEnds:this._handleEnds,visualInRange=this._createBarVisual(this._dataInterval,dataExtent,inRangeHandleEnds,"inRange"),visualOutOfRange=this._createBarVisual(dataExtent,dataExtent,outOfRangeHandleEnds,"outOfRange");shapes.inRange.setStyle({fill:visualInRange.barColor}).setShape("points",visualInRange.barPoints),shapes.outOfRange.setStyle({fill:visualOutOfRange.barColor}).setShape("points",visualOutOfRange.barPoints),this._updateHandle(inRangeHandleEnds,visualInRange)},ContinuousView2.prototype._createBarVisual=function(dataInterval,dataExtent,handleEnds,forceState){var opts={forceState:forceState,convertOpacityToAlpha:!0},colorStops=this._makeColorGradient(dataInterval,opts),symbolSizes=[this.getControllerVisual(dataInterval[0],"symbolSize",opts),this.getControllerVisual(dataInterval[1],"symbolSize",opts)],barPoints=this._createBarPoints(handleEnds,symbolSizes);return{barColor:new LinearGradient(0,0,0,1,colorStops),barPoints:barPoints,handlesColor:[colorStops[0].color,colorStops[colorStops.length-1].color]}},ContinuousView2.prototype._makeColorGradient=function(dataInterval,opts){var colorStops=[],step=(dataInterval[1]-dataInterval[0])/100;colorStops.push({color:this.getControllerVisual(dataInterval[0],"color",opts),offset:0});for(var i=1;i<100;i++){var currValue=dataInterval[0]+step*i;if(currValue>dataInterval[1])break;colorStops.push({color:this.getControllerVisual(currValue,"color",opts),offset:i/100})}return colorStops.push({color:this.getControllerVisual(dataInterval[1],"color",opts),offset:1}),colorStops},ContinuousView2.prototype._createBarPoints=function(handleEnds,symbolSizes){var itemSize=this.visualMapModel.itemSize;return[[itemSize[0]-symbolSizes[0],handleEnds[0]],[itemSize[0],handleEnds[0]],[itemSize[0],handleEnds[1]],[itemSize[0]-symbolSizes[1],handleEnds[1]]]},ContinuousView2.prototype._createBarGroup=function(itemAlign){var orient=this._orient,inverse=this.visualMapModel.get("inverse");return new Group$2("horizontal"!==orient||inverse?"horizontal"===orient&&inverse?{scaleX:"bottom"===itemAlign?-1:1,rotation:-Math.PI/2}:"vertical"!==orient||inverse?{scaleX:"left"===itemAlign?1:-1}:{scaleX:"left"===itemAlign?1:-1,scaleY:-1}:{scaleX:"bottom"===itemAlign?1:-1,rotation:Math.PI/2})},ContinuousView2.prototype._updateHandle=function(handleEnds,visualInRange){if(this._useHandle){var shapes=this._shapes,visualMapModel=this.visualMapModel,handleThumbs=shapes.handleThumbs,handleLabels=shapes.handleLabels,itemSize=visualMapModel.itemSize,dataExtent=visualMapModel.getExtent(),align=this._applyTransform("left",shapes.mainGroup);each$1([0,1],(function(handleIndex){var handleThumb=handleThumbs[handleIndex];handleThumb.setStyle("fill",visualInRange.handlesColor[handleIndex]),handleThumb.y=handleEnds[handleIndex];var val=linearMap(handleEnds[handleIndex],[0,itemSize[1]],dataExtent,!0),symbolSize=this.getControllerVisual(val,"symbolSize");handleThumb.scaleX=handleThumb.scaleY=symbolSize/itemSize[0],handleThumb.x=itemSize[0]-symbolSize/2;var textPoint=applyTransform(shapes.handleLabelPoints[handleIndex],getTransform$1(handleThumb,this.group));if("horizontal"===this._orient){var minimumOffset="left"===align||"top"===align?(itemSize[0]-symbolSize)/2:(itemSize[0]-symbolSize)/-2;textPoint[1]+=minimumOffset}handleLabels[handleIndex].setStyle({x:textPoint[0],y:textPoint[1],text:visualMapModel.formatValueText(this._dataInterval[handleIndex]),verticalAlign:"middle",align:"vertical"===this._orient?this._applyTransform("left",shapes.mainGroup):"center"})}),this)}},ContinuousView2.prototype._showIndicator=function(cursorValue,textValue,rangeSymbol,halfHoverLinkSize){var visualMapModel=this.visualMapModel,dataExtent=visualMapModel.getExtent(),itemSize=visualMapModel.itemSize,sizeExtent=[0,itemSize[1]],shapes=this._shapes,indicator=shapes.indicator;if(indicator){indicator.attr("invisible",!1);var color2=this.getControllerVisual(cursorValue,"color",{convertOpacityToAlpha:!0}),symbolSize=this.getControllerVisual(cursorValue,"symbolSize"),y=linearMap(cursorValue,dataExtent,sizeExtent,!0),x=itemSize[0]-symbolSize/2,oldIndicatorPos={x:indicator.x,y:indicator.y};indicator.y=y,indicator.x=x;var textPoint=applyTransform(shapes.indicatorLabelPoint,getTransform$1(indicator,this.group)),indicatorLabel=shapes.indicatorLabel;indicatorLabel.attr("invisible",!1);var align=this._applyTransform("left",shapes.mainGroup),isHorizontal="horizontal"===this._orient;indicatorLabel.setStyle({text:(rangeSymbol||"")+visualMapModel.formatValueText(textValue),verticalAlign:isHorizontal?align:"middle",align:isHorizontal?"center":align});var indicatorNewProps={x:x,y:y,style:{fill:color2}},labelNewProps={style:{x:textPoint[0],y:textPoint[1]}};if(visualMapModel.ecModel.isAnimationEnabled()&&!this._firstShowIndicator){var animationCfg={duration:100,easing:"cubicInOut",additive:!0};indicator.x=oldIndicatorPos.x,indicator.y=oldIndicatorPos.y,indicator.animateTo(indicatorNewProps,animationCfg),indicatorLabel.animateTo(labelNewProps,animationCfg)}else indicator.attr(indicatorNewProps),indicatorLabel.attr(labelNewProps);this._firstShowIndicator=!1;var handleLabels=this._shapes.handleLabels;if(handleLabels)for(var i=0;i<handleLabels.length;i++)this.api.enterBlur(handleLabels[i])}},ContinuousView2.prototype._enableHoverLinkToSeries=function(){var self2=this;this._shapes.mainGroup.on("mousemove",(function(e2){if(self2._hovering=!0,!self2._dragging){var itemSize=self2.visualMapModel.itemSize,pos=self2._applyTransform([e2.offsetX,e2.offsetY],self2._shapes.mainGroup,!0,!0);pos[1]=mathMin(mathMax(0,pos[1]),itemSize[1]),self2._doHoverLinkToSeries(pos[1],0<=pos[0]&&pos[0]<=itemSize[0])}})).on("mouseout",(function(){self2._hovering=!1,!self2._dragging&&self2._clearHoverLinkToSeries()}))},ContinuousView2.prototype._enableHoverLinkFromSeries=function(){var zr=this.api.getZr();this.visualMapModel.option.hoverLink?(zr.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),zr.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries()},ContinuousView2.prototype._doHoverLinkToSeries=function(cursorPos,hoverOnBar){var visualMapModel=this.visualMapModel,itemSize=visualMapModel.itemSize;if(visualMapModel.option.hoverLink){var sizeExtent=[0,itemSize[1]],dataExtent=visualMapModel.getExtent();cursorPos=mathMin(mathMax(sizeExtent[0],cursorPos),sizeExtent[1]);var halfHoverLinkSize=function(visualMapModel,dataExtent,sizeExtent){var halfHoverLinkSize=6,hoverLinkDataSize=visualMapModel.get("hoverLinkDataSize");hoverLinkDataSize&&(halfHoverLinkSize=linearMap(hoverLinkDataSize,dataExtent,sizeExtent,!0)/2);return halfHoverLinkSize}(visualMapModel,dataExtent,sizeExtent),hoverRange=[cursorPos-halfHoverLinkSize,cursorPos+halfHoverLinkSize],cursorValue=linearMap(cursorPos,sizeExtent,dataExtent,!0),valueRange=[linearMap(hoverRange[0],sizeExtent,dataExtent,!0),linearMap(hoverRange[1],sizeExtent,dataExtent,!0)];hoverRange[0]<sizeExtent[0]&&(valueRange[0]=-Infinity),hoverRange[1]>sizeExtent[1]&&(valueRange[1]=Infinity),hoverOnBar&&(-Infinity===valueRange[0]?this._showIndicator(cursorValue,valueRange[1],"< ",halfHoverLinkSize):Infinity===valueRange[1]?this._showIndicator(cursorValue,valueRange[0],"> ",halfHoverLinkSize):this._showIndicator(cursorValue,cursorValue,"≈ ",halfHoverLinkSize));var oldBatch=this._hoverLinkDataIndices,newBatch=[];(hoverOnBar||useHoverLinkOnHandle(visualMapModel))&&(newBatch=this._hoverLinkDataIndices=visualMapModel.findTargetDataIndices(valueRange));var resultBatches=function(batchA,batchB){var mapA={},mapB={};return makeMap(batchA||[],mapA),makeMap(batchB||[],mapB,mapA),[mapToArray(mapA),mapToArray(mapB)];function makeMap(sourceBatch,map2,otherMap){for(var i=0,len2=sourceBatch.length;i<len2;i++){var seriesId=convertOptionIdName(sourceBatch[i].seriesId,null);if(null==seriesId)return;for(var dataIndices=normalizeToArray(sourceBatch[i].dataIndex),otherDataIndices=otherMap&&otherMap[seriesId],j=0,lenj=dataIndices.length;j<lenj;j++){var dataIndex=dataIndices[j];otherDataIndices&&otherDataIndices[dataIndex]?otherDataIndices[dataIndex]=null:(map2[seriesId]||(map2[seriesId]={}))[dataIndex]=1}}}function mapToArray(map2,isData){var result=[];for(var i in map2)if(map2.hasOwnProperty(i)&&null!=map2[i])if(isData)result.push(+i);else{var dataIndices=mapToArray(map2[i],!0);dataIndices.length&&result.push({seriesId:i,dataIndex:dataIndices})}return result}}(oldBatch,newBatch);this._dispatchHighDown("downplay",makeHighDownBatch(resultBatches[0],visualMapModel)),this._dispatchHighDown("highlight",makeHighDownBatch(resultBatches[1],visualMapModel))}},ContinuousView2.prototype._hoverLinkFromSeriesMouseOver=function(e2){var ecData;if(findEventDispatcher(e2.target,(function(target){var currECData=getECData(target);if(null!=currECData.dataIndex)return ecData=currECData,!0}),!0),ecData){var dataModel=this.ecModel.getSeriesByIndex(ecData.seriesIndex),visualMapModel=this.visualMapModel;if(visualMapModel.isTargetSeries(dataModel)){var data=dataModel.getData(ecData.dataType),value=data.getStore().get(visualMapModel.getDataDimensionIndex(data),ecData.dataIndex);isNaN(value)||this._showIndicator(value,value)}}},ContinuousView2.prototype._hideIndicator=function(){var shapes=this._shapes;shapes.indicator&&shapes.indicator.attr("invisible",!0),shapes.indicatorLabel&&shapes.indicatorLabel.attr("invisible",!0);var handleLabels=this._shapes.handleLabels;if(handleLabels)for(var i=0;i<handleLabels.length;i++)this.api.leaveBlur(handleLabels[i])},ContinuousView2.prototype._clearHoverLinkToSeries=function(){this._hideIndicator();var indices=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",makeHighDownBatch(indices,this.visualMapModel)),indices.length=0},ContinuousView2.prototype._clearHoverLinkFromSeries=function(){this._hideIndicator();var zr=this.api.getZr();zr.off("mouseover",this._hoverLinkFromSeriesMouseOver),zr.off("mouseout",this._hideIndicator)},ContinuousView2.prototype._applyTransform=function(vertex,element,inverse,global){var transform=getTransform$1(element,global?null:this.group);return isArray$1(vertex)?applyTransform(vertex,transform,inverse):transformDirection(vertex,transform,inverse)},ContinuousView2.prototype._dispatchHighDown=function(type,batch){batch&&batch.length&&this.api.dispatchAction({type:type,batch:batch})},ContinuousView2.prototype.dispose=function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},ContinuousView2.type="visualMap.continuous",ContinuousView2}(VisualMapView);function createPolygon(points2,cursor,onDrift,onDragEnd){return new Polygon({shape:{points:points2},draggable:!!onDrift,cursor:cursor,drift:onDrift,onmousemove:function(e2){stop(e2.event)},ondragend:onDragEnd})}function useHoverLinkOnHandle(visualMapModel){var hoverLinkOnHandle=visualMapModel.get("hoverLinkOnHandle");return!!(null==hoverLinkOnHandle?visualMapModel.get("realtime"):hoverLinkOnHandle)}function getCursor(orient){return"vertical"===orient?"ns-resize":"ew-resize"}var visualMapActionInfo={type:"selectDataRange",event:"dataRangeSelected",update:"update"},visualMapActionHander=function(payload,ecModel){ecModel.eachComponent({mainType:"visualMap",query:payload},(function(model){model.setSelected(payload.selected)}))},visualMapEncodingHandlers=[{createOnAllSeries:!0,reset:function(seriesModel,ecModel){var resetDefines=[];return ecModel.eachComponent("visualMap",(function(visualMapModel){var stateList,visualMappings,getValueState,dim,visualTypesMap,pipelineContext=seriesModel.pipelineContext;!visualMapModel.isTargetSeries(seriesModel)||pipelineContext&&pipelineContext.large||resetDefines.push((stateList=visualMapModel.stateList,visualMappings=visualMapModel.targetVisuals,getValueState=bind$1(visualMapModel.getValueState,visualMapModel),dim=visualMapModel.getDataDimensionIndex(seriesModel.getData()),visualTypesMap={},each$d(stateList,(function(state){var visualTypes=VisualMapping.prepareVisualTypes(visualMappings[state]);visualTypesMap[state]=visualTypes})),{progress:function(params,data){var dimIndex,dataIndex;function getVisual(key){return getItemVisualFromData(data,dataIndex,key)}function setVisual(key,value2){!function(data,dataIndex,key,value){switch(key){case"color":data.ensureUniqueItemVisual(dataIndex,"style")[data.getVisual("drawType")]=value,data.setItemVisual(dataIndex,"colorFromPalette",!1);break;case"opacity":data.ensureUniqueItemVisual(dataIndex,"style").opacity=value;break;case"symbol":case"symbolSize":case"liftZ":data.setItemVisual(dataIndex,key,value)}}(data,dataIndex,key,value2)}null!=dim&&(dimIndex=data.getDimensionIndex(dim));for(var store=data.getStore();null!=(dataIndex=params.next());){var rawDataItem=data.getRawDataItem(dataIndex);if(!rawDataItem||!1!==rawDataItem.visualMap)for(var value=null!=dim?store.get(dimIndex,dataIndex):dataIndex,valueState=getValueState(value),mappings=visualMappings[valueState],visualTypes=visualTypesMap[valueState],i=0,len2=visualTypes.length;i<len2;i++){var type=visualTypes[i];mappings[type]&&mappings[type].applyVisual(value,getVisual,setVisual)}}}}))})),resetDefines}},{createOnAllSeries:!0,reset:function(seriesModel,ecModel){var data=seriesModel.getData(),visualMetaList=[];ecModel.eachComponent("visualMap",(function(visualMapModel){if(visualMapModel.isTargetSeries(seriesModel)){var visualMeta=visualMapModel.getVisualMeta(bind$1(getColorVisual,null,seriesModel,visualMapModel))||{stops:[],outerColors:[]},dimIdx=visualMapModel.getDataDimensionIndex(data);dimIdx>=0&&(visualMeta.dimension=dimIdx,visualMetaList.push(visualMeta))}})),seriesModel.getData().setVisual("visualMeta",visualMetaList)}}];function getColorVisual(seriesModel,visualMapModel,value,valueState){for(var mappings=visualMapModel.targetVisuals[valueState],visualTypes=VisualMapping.prepareVisualTypes(mappings),resultVisual={color:getVisualFromData(seriesModel.getData(),"color")},i=0,len2=visualTypes.length;i<len2;i++){var type=visualTypes[i],mapping=mappings["opacity"===type?"__alphaForOpacity":type];mapping&&mapping.applyVisual(value,getVisual,setVisual)}return resultVisual.color;function getVisual(key){return resultVisual[key]}function setVisual(key,value2){resultVisual[key]=value2}}var each=each$d;function visualMapPreprocessor(option){var visualMap=option&&option.visualMap;isArray$1(visualMap)||(visualMap=visualMap?[visualMap]:[]),each(visualMap,(function(opt){if(opt){has(opt,"splitList")&&!has(opt,"pieces")&&(opt.pieces=opt.splitList,delete opt.splitList);var pieces=opt.pieces;pieces&&isArray$1(pieces)&&each(pieces,(function(piece){isObject$3(piece)&&(has(piece,"start")&&!has(piece,"min")&&(piece.min=piece.start),has(piece,"end")&&!has(piece,"max")&&(piece.max=piece.end))}))}}))}function has(obj,name){return obj&&obj.hasOwnProperty&&obj.hasOwnProperty(name)}var installed=!1;function installCommon(registers){installed||(installed=!0,registers.registerSubTypeDefaulter("visualMap",(function(option){return option.categories||(option.pieces?option.pieces.length>0:option.splitNumber>0)&&!option.calculable?"piecewise":"continuous"})),registers.registerAction(visualMapActionInfo,visualMapActionHander),each$d(visualMapEncodingHandlers,(function(handler){registers.registerVisual(registers.PRIORITY.VISUAL.COMPONENT,handler)})),registers.registerPreprocessor(visualMapPreprocessor))}function install$4(registers){registers.registerComponentModel(ContinuousModel),registers.registerComponentView(ContinuousView),installCommon(registers)}var PiecewiseModel=function(_super){function PiecewiseModel2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=PiecewiseModel2.type,_this._pieceList=[],_this}return __extends(PiecewiseModel2,_super),PiecewiseModel2.prototype.optionUpdated=function(newOption,isInit){_super.prototype.optionUpdated.apply(this,arguments),this.resetExtent();var mode=this._mode=this._determineMode();this._pieceList=[],resetMethods[this._mode].call(this,this._pieceList),this._resetSelected(newOption,isInit);var categories=this.option.categories;this.resetVisual((function(mappingOption,state){"categories"===mode?(mappingOption.mappingMethod="category",mappingOption.categories=clone$3(categories)):(mappingOption.dataExtent=this.getExtent(),mappingOption.mappingMethod="piecewise",mappingOption.pieceList=map$1(this._pieceList,(function(piece){return piece=clone$3(piece),"inRange"!==state&&(piece.visual=null),piece})))}))},PiecewiseModel2.prototype.completeVisualOption=function(){var option=this.option,visualTypesInPieces={},visualTypes=VisualMapping.listVisualTypes(),isCategory2=this.isCategory();function has2(obj,state,visualType){return obj&&obj[state]&&obj[state].hasOwnProperty(visualType)}each$d(option.pieces,(function(piece){each$d(visualTypes,(function(visualType){piece.hasOwnProperty(visualType)&&(visualTypesInPieces[visualType]=1)}))})),each$d(visualTypesInPieces,(function(v,visualType){var exists=!1;each$d(this.stateList,(function(state){exists=exists||has2(option,state,visualType)||has2(option.target,state,visualType)}),this),!exists&&each$d(this.stateList,(function(state){(option[state]||(option[state]={}))[visualType]=visualDefault_get(visualType,"inRange"===state?"active":"inactive",isCategory2)}))}),this),_super.prototype.completeVisualOption.apply(this,arguments)},PiecewiseModel2.prototype._resetSelected=function(newOption,isInit){var thisOption=this.option,pieceList=this._pieceList,selected=(isInit?thisOption:newOption).selected||{};if(thisOption.selected=selected,each$d(pieceList,(function(piece,index){var key=this.getSelectedMapKey(piece);selected.hasOwnProperty(key)||(selected[key]=!0)}),this),"single"===thisOption.selectedMode){var hasSel_1=!1;each$d(pieceList,(function(piece,index){var key=this.getSelectedMapKey(piece);selected[key]&&(hasSel_1?selected[key]=!1:hasSel_1=!0)}),this)}},PiecewiseModel2.prototype.getItemSymbol=function(){return this.get("itemSymbol")},PiecewiseModel2.prototype.getSelectedMapKey=function(piece){return"categories"===this._mode?piece.value+"":piece.index+""},PiecewiseModel2.prototype.getPieceList=function(){return this._pieceList},PiecewiseModel2.prototype._determineMode=function(){var option=this.option;return option.pieces&&option.pieces.length>0?"pieces":this.option.categories?"categories":"splitNumber"},PiecewiseModel2.prototype.setSelected=function(selected){this.option.selected=clone$3(selected)},PiecewiseModel2.prototype.getValueState=function(value){var index=VisualMapping.findPieceIndex(value,this._pieceList);return null!=index&&this.option.selected[this.getSelectedMapKey(this._pieceList[index])]?"inRange":"outOfRange"},PiecewiseModel2.prototype.findTargetDataIndices=function(pieceIndex){var result=[],pieceList=this._pieceList;return this.eachTargetSeries((function(seriesModel){var dataIndices=[],data=seriesModel.getData();data.each(this.getDataDimensionIndex(data),(function(value,dataIndex){VisualMapping.findPieceIndex(value,pieceList)===pieceIndex&&dataIndices.push(dataIndex)}),this),result.push({seriesId:seriesModel.id,dataIndex:dataIndices})}),this),result},PiecewiseModel2.prototype.getRepresentValue=function(piece){var representValue;if(this.isCategory())representValue=piece.value;else if(null!=piece.value)representValue=piece.value;else{var pieceInterval=piece.interval||[];representValue=-Infinity===pieceInterval[0]&&Infinity===pieceInterval[1]?0:(pieceInterval[0]+pieceInterval[1])/2}return representValue},PiecewiseModel2.prototype.getVisualMeta=function(getColorVisual2){if(!this.isCategory()){var stops=[],outerColors=["",""],visualMapModel=this,pieceList=this._pieceList.slice();if(pieceList.length){var edge=pieceList[0].interval[0];-Infinity!==edge&&pieceList.unshift({interval:[-Infinity,edge]}),Infinity!==(edge=pieceList[pieceList.length-1].interval[1])&&pieceList.push({interval:[edge,Infinity]})}else pieceList.push({interval:[-Infinity,Infinity]});var curr=-Infinity;return each$d(pieceList,(function(piece){var interval=piece.interval;interval&&(interval[0]>curr&&setStop([curr,interval[0]],"outOfRange"),setStop(interval.slice()),curr=interval[1])}),this),{stops:stops,outerColors:outerColors}}function setStop(interval,valueState){var representValue=visualMapModel.getRepresentValue({interval:interval});valueState||(valueState=visualMapModel.getValueState(representValue));var color2=getColorVisual2(representValue,valueState);-Infinity===interval[0]?outerColors[0]=color2:Infinity===interval[1]?outerColors[1]=color2:stops.push({value:interval[0],color:color2},{value:interval[1],color:color2})}},PiecewiseModel2.type="visualMap.piecewise",PiecewiseModel2.defaultOption=inheritDefaultOption(VisualMapModel.defaultOption,{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieces:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0}),PiecewiseModel2}(VisualMapModel),resetMethods={splitNumber:function(outPieceList){var thisOption=this.option,precision=Math.min(thisOption.precision,20),dataExtent=this.getExtent(),splitNumber=thisOption.splitNumber;splitNumber=Math.max(parseInt(splitNumber,10),1),thisOption.splitNumber=splitNumber;for(var splitStep=(dataExtent[1]-dataExtent[0])/splitNumber;+splitStep.toFixed(precision)!==splitStep&&precision<5;)precision++;thisOption.precision=precision,splitStep=+splitStep.toFixed(precision),thisOption.minOpen&&outPieceList.push({interval:[-Infinity,dataExtent[0]],close:[0,0]});for(var index=0,curr=dataExtent[0];index<splitNumber;curr+=splitStep,index++){var max3=index===splitNumber-1?dataExtent[1]:curr+splitStep;outPieceList.push({interval:[curr,max3],close:[1,1]})}thisOption.maxOpen&&outPieceList.push({interval:[dataExtent[1],Infinity],close:[0,0]}),reformIntervals(outPieceList),each$d(outPieceList,(function(piece,index2){piece.index=index2,piece.text=this.formatValueText(piece.interval)}),this)},categories:function(outPieceList){var thisOption=this.option;each$d(thisOption.categories,(function(cate){outPieceList.push({text:this.formatValueText(cate,!0),value:cate})}),this),normalizeReverse(thisOption,outPieceList)},pieces:function(outPieceList){var thisOption=this.option;each$d(thisOption.pieces,(function(pieceListItem,index){isObject$3(pieceListItem)||(pieceListItem={value:pieceListItem});var item={text:"",index:index};if(null!=pieceListItem.label&&(item.text=pieceListItem.label),pieceListItem.hasOwnProperty("value")){var value=item.value=pieceListItem.value;item.interval=[value,value],item.close=[1,1]}else{for(var interval=item.interval=[],close_1=item.close=[0,0],closeList=[1,0,1],infinityList=[-Infinity,Infinity],useMinMax=[],lg=0;lg<2;lg++){for(var names=[["gte","gt","min"],["lte","lt","max"]][lg],i=0;i<3&&null==interval[lg];i++)interval[lg]=pieceListItem[names[i]],close_1[lg]=closeList[i],useMinMax[lg]=2===i;null==interval[lg]&&(interval[lg]=infinityList[lg])}useMinMax[0]&&Infinity===interval[1]&&(close_1[0]=0),useMinMax[1]&&-Infinity===interval[0]&&(close_1[1]=0),interval[0]===interval[1]&&close_1[0]&&close_1[1]&&(item.value=interval[0])}item.visual=VisualMapping.retrieveVisuals(pieceListItem),outPieceList.push(item)}),this),normalizeReverse(thisOption,outPieceList),reformIntervals(outPieceList),each$d(outPieceList,(function(piece){var close=piece.close,edgeSymbols=[["<","≤"][close[1]],[">","≥"][close[0]]];piece.text=piece.text||this.formatValueText(null!=piece.value?piece.value:piece.interval,!1,edgeSymbols)}),this)}};function normalizeReverse(thisOption,pieceList){var inverse=thisOption.inverse;("vertical"===thisOption.orient?!inverse:inverse)&&pieceList.reverse()}var PiecewiseVisualMapView=function(_super){function PiecewiseVisualMapView2(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.type=PiecewiseVisualMapView2.type,_this}return __extends(PiecewiseVisualMapView2,_super),PiecewiseVisualMapView2.prototype.doRender=function(){var thisGroup=this.group;thisGroup.removeAll();var visualMapModel=this.visualMapModel,textGap=visualMapModel.get("textGap"),textStyleModel=visualMapModel.textStyleModel,textFont=textStyleModel.getFont(),textFill=textStyleModel.getTextColor(),itemAlign=this._getItemAlign(),itemSize=visualMapModel.itemSize,viewData=this._getViewData(),endsText=viewData.endsText,showLabel=retrieve(visualMapModel.get("showLabel",!0),!endsText),silent=!visualMapModel.get("selectedMode");endsText&&this._renderEndsText(thisGroup,endsText[0],itemSize,showLabel,itemAlign),each$d(viewData.viewPieceList,(function(item){var piece=item.piece,itemGroup=new Group$2;itemGroup.onclick=bind$1(this._onItemClick,this,piece),this._enableHoverLink(itemGroup,item.indexInModelPieceList);var representValue=visualMapModel.getRepresentValue(piece);if(this._createItemSymbol(itemGroup,representValue,[0,0,itemSize[0],itemSize[1]],silent),showLabel){var visualState=this.visualMapModel.getValueState(representValue);itemGroup.add(new ZRText({style:{x:"right"===itemAlign?-textGap:itemSize[0]+textGap,y:itemSize[1]/2,text:piece.text,verticalAlign:"middle",align:itemAlign,font:textFont,fill:textFill,opacity:"outOfRange"===visualState?.5:1},silent:silent}))}thisGroup.add(itemGroup)}),this),endsText&&this._renderEndsText(thisGroup,endsText[1],itemSize,showLabel,itemAlign),box(visualMapModel.get("orient"),thisGroup,visualMapModel.get("itemGap")),this.renderBackground(thisGroup),this.positionGroup(thisGroup)},PiecewiseVisualMapView2.prototype._enableHoverLink=function(itemGroup,pieceIndex){var _this=this;itemGroup.on("mouseover",(function(){return onHoverLink("highlight")})).on("mouseout",(function(){return onHoverLink("downplay")}));var onHoverLink=function(method){var visualMapModel=_this.visualMapModel;visualMapModel.option.hoverLink&&_this.api.dispatchAction({type:method,batch:makeHighDownBatch(visualMapModel.findTargetDataIndices(pieceIndex),visualMapModel)})}},PiecewiseVisualMapView2.prototype._getItemAlign=function(){var visualMapModel=this.visualMapModel,modelOption=visualMapModel.option;if("vertical"===modelOption.orient)return getItemAlign(visualMapModel,this.api,visualMapModel.itemSize);var align=modelOption.align;return align&&"auto"!==align||(align="left"),align},PiecewiseVisualMapView2.prototype._renderEndsText=function(group,text,itemSize,showLabel,itemAlign){if(text){var itemGroup=new Group$2,textStyleModel=this.visualMapModel.textStyleModel;itemGroup.add(new ZRText({style:createTextStyle$1(textStyleModel,{x:showLabel?"right"===itemAlign?itemSize[0]:0:itemSize[0]/2,y:itemSize[1]/2,verticalAlign:"middle",align:showLabel?itemAlign:"center",text:text})})),group.add(itemGroup)}},PiecewiseVisualMapView2.prototype._getViewData=function(){var visualMapModel=this.visualMapModel,viewPieceList=map$1(visualMapModel.getPieceList(),(function(piece,index){return{piece:piece,indexInModelPieceList:index}})),endsText=visualMapModel.get("text"),orient=visualMapModel.get("orient"),inverse=visualMapModel.get("inverse");return("horizontal"===orient?inverse:!inverse)?viewPieceList.reverse():endsText&&(endsText=endsText.slice().reverse()),{viewPieceList:viewPieceList,endsText:endsText}},PiecewiseVisualMapView2.prototype._createItemSymbol=function(group,representValue,shapeParam,silent){var itemSymbol=createSymbol(this.getControllerVisual(representValue,"symbol"),shapeParam[0],shapeParam[1],shapeParam[2],shapeParam[3],this.getControllerVisual(representValue,"color"));itemSymbol.silent=silent,group.add(itemSymbol)},PiecewiseVisualMapView2.prototype._onItemClick=function(piece){var visualMapModel=this.visualMapModel,option=visualMapModel.option,selectedMode=option.selectedMode;if(selectedMode){var selected=clone$3(option.selected),newKey=visualMapModel.getSelectedMapKey(piece);"single"===selectedMode||!0===selectedMode?(selected[newKey]=!0,each$d(selected,(function(o,key){selected[key]=key===newKey}))):selected[newKey]=!selected[newKey],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:selected})}},PiecewiseVisualMapView2.type="visualMap.piecewise",PiecewiseVisualMapView2}(VisualMapView);function install$3(registers){registers.registerComponentModel(PiecewiseModel),registers.registerComponentView(PiecewiseVisualMapView),installCommon(registers)}var DEFAULT_OPTION={label:{enabled:!0},decal:{show:!1}},inner=makeInner(),decalPaletteScope={};function ariaVisual(ecModel,api){var ariaModel=ecModel.getModel("aria");if(ariaModel.get("enabled")){var defaultOption2=clone$3(DEFAULT_OPTION);merge(defaultOption2.label,ecModel.getLocaleModel().get("aria"),!1),merge(ariaModel.option,defaultOption2,!1),function(){if(ariaModel.getModel("decal").get("show")){var paletteScopeGroupByType_1=createHashMap();ecModel.eachSeries((function(seriesModel){if(!seriesModel.isColorBySeries()){var decalScope=paletteScopeGroupByType_1.get(seriesModel.type);decalScope||(decalScope={},paletteScopeGroupByType_1.set(seriesModel.type,decalScope)),inner(seriesModel).scope=decalScope}})),ecModel.eachRawSeries((function(seriesModel){if(!ecModel.isSeriesFiltered(seriesModel))if(isFunction(seriesModel.enableAriaDecal))seriesModel.enableAriaDecal();else{var data=seriesModel.getData();if(seriesModel.isColorBySeries()){var paletteDecal=getDecalFromPalette(seriesModel.ecModel,seriesModel.name,decalPaletteScope,ecModel.getSeriesCount()),specifiedDecal=data.getVisual("decal");data.setVisual("decal",mergeDecal(specifiedDecal,paletteDecal))}else{var dataAll_1=seriesModel.getRawData(),idxMap_1={},decalScope_1=inner(seriesModel).scope;data.each((function(idx){var rawIdx=data.getRawIndex(idx);idxMap_1[rawIdx]=idx}));var dataCount_1=dataAll_1.count();dataAll_1.each((function(rawIdx){var idx=idxMap_1[rawIdx],name=dataAll_1.getName(rawIdx)||rawIdx+"",paletteDecal2=getDecalFromPalette(seriesModel.ecModel,name,decalScope_1,dataCount_1),specifiedDecal2=data.getItemVisual(idx,"decal");data.setItemVisual(idx,"decal",mergeDecal(specifiedDecal2,paletteDecal2))}))}}function mergeDecal(specifiedDecal2,paletteDecal2){var resultDecal=specifiedDecal2?extend(extend({},paletteDecal2),specifiedDecal2):paletteDecal2;return resultDecal.dirty=!0,resultDecal}}))}}(),function(){var dom=api.getZr().dom;if(!dom)return;var labelLocale=ecModel.getLocaleModel().get("aria"),labelModel=ariaModel.getModel("label");if(labelModel.option=defaults(labelModel.option,labelLocale),!labelModel.get("enabled"))return;if(dom.setAttribute("role","img"),labelModel.get("description"))return void dom.setAttribute("aria-label",labelModel.get("description"));var ariaLabel,seriesCnt=ecModel.getSeriesCount(),maxDataCnt=labelModel.get(["data","maxCount"])||10,maxSeriesCnt=labelModel.get(["series","maxCount"])||10,displaySeriesCnt=Math.min(seriesCnt,maxSeriesCnt);if(seriesCnt<1)return;var title=function(){var title=ecModel.get("title");title&&title.length&&(title=title[0]);return title&&title.text}();ariaLabel=title?replace(labelModel.get(["general","withTitle"]),{title:title}):labelModel.get(["general","withoutTitle"]);var seriesLabels_1=[];ariaLabel+=replace(seriesCnt>1?labelModel.get(["series","multiple","prefix"]):labelModel.get(["series","single","prefix"]),{seriesCount:seriesCnt}),ecModel.eachSeries((function(seriesModel,idx){if(idx<displaySeriesCnt){var seriesLabel=void 0,withName=seriesModel.get("name")?"withName":"withoutName";seriesLabel=replace(seriesLabel=seriesCnt>1?labelModel.get(["series","multiple",withName]):labelModel.get(["series","single",withName]),{seriesId:seriesModel.seriesIndex,seriesName:seriesModel.get("name"),seriesType:(type=seriesModel.subType,typeNames=ecModel.getLocaleModel().get(["series","typeNames"]),typeNames[type]||typeNames.chart)});var data=seriesModel.getData();if(data.count()>maxDataCnt)seriesLabel+=replace(labelModel.get(["data","partialData"]),{displayCnt:maxDataCnt});else seriesLabel+=labelModel.get(["data","allData"]);for(var middleSeparator_1=labelModel.get(["data","separator","middle"]),endSeparator_1=labelModel.get(["data","separator","end"]),excludeDimensionId_1=labelModel.get(["data","excludeDimensionId"]),dataLabels=[],i=0;i<data.count();i++)if(i<maxDataCnt){var name_1=data.getName(i),value=excludeDimensionId_1?filter(data.getValues(i),(function(v,j){return-1===indexOf(excludeDimensionId_1,j)})):data.getValues(i),dataLabel=labelModel.get(["data",name_1?"withName":"withoutName"]);dataLabels.push(replace(dataLabel,{name:name_1,value:value.join(middleSeparator_1)}))}seriesLabel+=dataLabels.join(middleSeparator_1)+endSeparator_1,seriesLabels_1.push(seriesLabel)}var type,typeNames}));var separatorModel=labelModel.getModel(["series","multiple","separator"]),middleSeparator=separatorModel.get("middle"),endSeparator=separatorModel.get("end");ariaLabel+=seriesLabels_1.join(middleSeparator)+endSeparator,dom.setAttribute("aria-label",ariaLabel)}()}function replace(str,keyValues){if(!isString(str))return str;var result=str;return each$d(keyValues,(function(value,key){result=result.replace(new RegExp("\\{\\s*"+key+"\\s*\\}","g"),value)})),result}}function ariaPreprocessor(option){if(option&&option.aria){var aria=option.aria;null!=aria.show&&(aria.enabled=aria.show),aria.label=aria.label||{},each$d(["description","general","series","data"],(function(name){null!=aria[name]&&(aria.label[name]=aria[name])}))}}var mathSin=Math.sin,mathCos=Math.cos,PI=Math.PI,PI2=2*Math.PI,degree=180/PI,SVGPathRebuilder=function(){function SVGPathRebuilder2(){}return SVGPathRebuilder2.prototype.reset=function(precision){this._start=!0,this._d=[],this._str="",this._p=Math.pow(10,precision||4)},SVGPathRebuilder2.prototype.moveTo=function(x,y){this._add("M",x,y)},SVGPathRebuilder2.prototype.lineTo=function(x,y){this._add("L",x,y)},SVGPathRebuilder2.prototype.bezierCurveTo=function(x,y,x2,y2,x3,y3){this._add("C",x,y,x2,y2,x3,y3)},SVGPathRebuilder2.prototype.quadraticCurveTo=function(x,y,x2,y2){this._add("Q",x,y,x2,y2)},SVGPathRebuilder2.prototype.arc=function(cx,cy,r,startAngle,endAngle,anticlockwise){this.ellipse(cx,cy,r,r,0,startAngle,endAngle,anticlockwise)},SVGPathRebuilder2.prototype.ellipse=function(cx,cy,rx,ry,psi,startAngle,endAngle,anticlockwise){var dTheta=endAngle-startAngle,clockwise=!anticlockwise,dThetaPositive=Math.abs(dTheta),isCircle=isAroundZero(dThetaPositive-PI2)||(clockwise?dTheta>=PI2:-dTheta>=PI2),unifiedTheta=dTheta>0?dTheta%PI2:dTheta%PI2+PI2,large=!1;large=!!isCircle||!isAroundZero(dThetaPositive)&&unifiedTheta>=PI==!!clockwise;var x0=cx+rx*mathCos(startAngle),y0=cy+ry*mathSin(startAngle);this._start&&this._add("M",x0,y0);var xRot=Math.round(psi*degree);if(isCircle){var p=1/this._p,dTheta_1=(clockwise?1:-1)*(PI2-p);this._add("A",rx,ry,xRot,1,+clockwise,cx+rx*mathCos(startAngle+dTheta_1),cy+ry*mathSin(startAngle+dTheta_1)),p>.01&&this._add("A",rx,ry,xRot,0,+clockwise,x0,y0)}else{var x=cx+rx*mathCos(endAngle),y=cy+ry*mathSin(endAngle);this._add("A",rx,ry,xRot,+large,+clockwise,x,y)}},SVGPathRebuilder2.prototype.rect=function(x,y,w,h){this._add("M",x,y),this._add("l",w,0),this._add("l",0,h),this._add("l",-w,0),this._add("Z")},SVGPathRebuilder2.prototype.closePath=function(){this._d.length>0&&this._add("Z")},SVGPathRebuilder2.prototype._add=function(cmd,a,b,c,d,e2,f,g,h){for(var vals=[],p=this._p,i=1;i<arguments.length;i++){var val=arguments[i];if(isNaN(val))return void(this._invalid=!0);vals.push(Math.round(val*p)/p)}this._d.push(cmd+vals.join(" ")),this._start="Z"===cmd},SVGPathRebuilder2.prototype.generateStr=function(){this._str=this._invalid?"":this._d.join(""),this._d=[]},SVGPathRebuilder2.prototype.getStr=function(){return this._str},SVGPathRebuilder2}(),mathRound=Math.round;var strokeProps=["lineCap","miterLimit","lineJoin"],svgStrokeProps=map$1(strokeProps,(function(prop){return"stroke-"+prop.toLowerCase()}));var SVGNS="http://www.w3.org/2000/svg",XLINKNS="http://www.w3.org/1999/xlink";function createElement(name){return document.createElementNS(SVGNS,name)}function createVNode(tag,key,attrs,children,text){return{tag:tag,attrs:attrs||{},children:children,text:text,key:key}}function vNodeToString(el,opts){var S=(opts=opts||{}).newline?"\n":"";return function convertElToString(el2){var children=el2.children,tag=el2.tag,attrs=el2.attrs,text=el2.text;return function(name,attrs){var attrsStr=[];if(attrs)for(var key in attrs){var val=attrs[key],part=key;!1!==val&&(!0!==val&&null!=val&&(part+='="'+val+'"'),attrsStr.push(part))}return"<"+name+" "+attrsStr.join(" ")+">"}(tag,attrs)+("style"!==tag?encodeHTML(text):text||"")+(children?""+S+map$1(children,(function(child){return convertElToString(child)})).join(S)+S:"")+("</"+tag+">")}(el)}function createBrushScope(zrId){return{zrId:zrId,shadowCache:{},patternCache:{},gradientCache:{},clipPathCache:{},defs:{},cssNodes:{},cssAnims:{},cssStyleCache:{},cssAnimIdx:0,shadowIdx:0,gradientIdx:0,patternIdx:0,clipPathIdx:0}}function createSVGVNode(width,height,children,useViewBox){return createVNode("svg","root",{width:width,height:height,xmlns:SVGNS,"xmlns:xlink":XLINKNS,version:"1.1",baseProfile:"full",viewBox:!!useViewBox&&"0 0 "+width+" "+height},children)}var cssClassIdx=0;function getClassId(){return cssClassIdx++}var EASING_MAP={cubicIn:"0.32,0,0.67,0",cubicOut:"0.33,1,0.68,1",cubicInOut:"0.65,0,0.35,1",quadraticIn:"0.11,0,0.5,0",quadraticOut:"0.5,1,0.89,1",quadraticInOut:"0.45,0,0.55,1",quarticIn:"0.5,0,0.75,0",quarticOut:"0.25,1,0.5,1",quarticInOut:"0.76,0,0.24,1",quinticIn:"0.64,0,0.78,0",quinticOut:"0.22,1,0.36,1",quinticInOut:"0.83,0,0.17,1",sinusoidalIn:"0.12,0,0.39,0",sinusoidalOut:"0.61,1,0.88,1",sinusoidalInOut:"0.37,0,0.63,1",exponentialIn:"0.7,0,0.84,0",exponentialOut:"0.16,1,0.3,1",exponentialInOut:"0.87,0,0.13,1",circularIn:"0.55,0,1,0.45",circularOut:"0,0.55,0.45,1",circularInOut:"0.85,0,0.15,1"};function buildPathString(el,kfShape,path){var shape=extend({},el.shape);extend(shape,kfShape),el.buildPath(path,shape);var svgPathBuilder=new SVGPathRebuilder;return svgPathBuilder.reset(getPathPrecision(el)),path.rebuildPath(svgPathBuilder,1),svgPathBuilder.generateStr(),svgPathBuilder.getStr()}function setTransformOrigin(target,transform){var originX=transform.originX,originY=transform.originY;(originX||originY)&&(target["transform-origin"]=originX+"px "+originY+"px")}var ANIMATE_STYLE_MAP={fill:"fill",opacity:"opacity",lineWidth:"stroke-width",lineDashOffset:"stroke-dashoffset"};function addAnimation(cssAnim,scope){var animationName=scope.zrId+"-ani-"+scope.cssAnimIdx++;return scope.cssAnims[animationName]=cssAnim,animationName}function getEasingFunc(easing){return isString(easing)?EASING_MAP[easing]?"cubic-bezier("+EASING_MAP[easing]+")":createCubicEasingFunc(easing)?easing:"":""}function createCSSAnimation(el,attrs,scope,onlyShape){var animators=el.animators,len2=animators.length,cssAnimations=[];if(el instanceof CompoundPath){var animationCfg=function(el,attrs,scope){var cssAnimationCfg,cssAnimationName,paths=el.shape.paths,composedAnim={};if(each$d(paths,(function(path){var subScope=createBrushScope(scope.zrId);subScope.animation=!0,createCSSAnimation(path,{},subScope,!0);var cssAnims=subScope.cssAnims,cssNodes=subScope.cssNodes,animNames=keys(cssAnims),len2=animNames.length;if(len2){var lastAnim=cssAnims[cssAnimationName=animNames[len2-1]];for(var percent in lastAnim){var kf=lastAnim[percent];composedAnim[percent]=composedAnim[percent]||{d:""},composedAnim[percent].d+=kf.d||""}for(var className in cssNodes){var val=cssNodes[className].animation;val.indexOf(cssAnimationName)>=0&&(cssAnimationCfg=val)}}})),cssAnimationCfg){attrs.d=!1;var animationName=addAnimation(composedAnim,scope);return cssAnimationCfg.replace(cssAnimationName,animationName)}}(el,attrs,scope);if(animationCfg)cssAnimations.push(animationCfg);else if(!len2)return}else if(!len2)return;for(var groupAnimators={},i=0;i<len2;i++){var animator=animators[i],cfgArr=[animator.getMaxTime()/1e3+"s"],easing=getEasingFunc(animator.getClip().easing),delay=animator.getDelay();easing?cfgArr.push(easing):cfgArr.push("linear"),delay&&cfgArr.push(delay/1e3+"s"),animator.getLoop()&&cfgArr.push("infinite");var cfg=cfgArr.join(" ");groupAnimators[cfg]=groupAnimators[cfg]||[cfg,[]],groupAnimators[cfg][1].push(animator)}function createSingleCSSAnimation(groupAnimator){var path,animators2=groupAnimator[1],len3=animators2.length,transformKfs={},shapeKfs={},finalKfs={};function saveAnimatorTrackToCssKfs(animator3,cssKfs,toCssAttrName){for(var tracks=animator3.getTracks(),maxTime=animator3.getMaxTime(),k=0;k<tracks.length;k++){var track=tracks[k];if(track.needsAnimate()){var kfs=track.keyframes,attrName=track.propName;if(toCssAttrName&&(attrName=toCssAttrName(attrName)),attrName)for(var i3=0;i3<kfs.length;i3++){var kf=kfs[i3],percent2=Math.round(kf.time/maxTime*100)+"%",kfEasing=getEasingFunc(kf.easing),rawValue=kf.rawValue;(isString(rawValue)||isNumber(rawValue))&&(cssKfs[percent2]=cssKfs[percent2]||{},cssKfs[percent2][attrName]=kf.rawValue,kfEasing&&(cssKfs[percent2]["animation-timing-function"]=kfEasing))}}}}for(var i2=0;i2<len3;i2++){(targetProp=(animator2=animators2[i2]).targetName)?"shape"===targetProp&&saveAnimatorTrackToCssKfs(animator2,shapeKfs):!onlyShape&&saveAnimatorTrackToCssKfs(animator2,transformKfs)}for(var percent in transformKfs){var transform={};copyTransform(transform,el),extend(transform,transformKfs[percent]);var str=getSRTTransformString(transform),timingFunction=transformKfs[percent]["animation-timing-function"];finalKfs[percent]=str?{transform:str}:{},setTransformOrigin(finalKfs[percent],transform),timingFunction&&(finalKfs[percent]["animation-timing-function"]=timingFunction)}var canAnimateShape=!0;for(var percent in shapeKfs){finalKfs[percent]=finalKfs[percent]||{};var isFirst=!path;timingFunction=shapeKfs[percent]["animation-timing-function"];isFirst&&(path=new PathProxy);var len_1=path.len();path.reset(),finalKfs[percent].d=buildPathString(el,shapeKfs[percent],path);var newLen=path.len();if(!isFirst&&len_1!==newLen){canAnimateShape=!1;break}timingFunction&&(finalKfs[percent]["animation-timing-function"]=timingFunction)}if(!canAnimateShape)for(var percent in finalKfs)delete finalKfs[percent].d;if(!onlyShape)for(i2=0;i2<len3;i2++){var animator2,targetProp;"style"===(targetProp=(animator2=animators2[i2]).targetName)&&saveAnimatorTrackToCssKfs(animator2,finalKfs,(function(propName){return ANIMATE_STYLE_MAP[propName]}))}var transformOrigin,percents=keys(finalKfs),allTransformOriginSame=!0;for(i2=1;i2<percents.length;i2++){var p0=percents[i2-1],p1=percents[i2];if(finalKfs[p0]["transform-origin"]!==finalKfs[p1]["transform-origin"]){allTransformOriginSame=!1;break}transformOrigin=finalKfs[p0]["transform-origin"]}if(allTransformOriginSame&&transformOrigin){for(var percent in finalKfs)finalKfs[percent]["transform-origin"]&&delete finalKfs[percent]["transform-origin"];attrs["transform-origin"]=transformOrigin}if(filter(percents,(function(percent2){return keys(finalKfs[percent2]).length>0})).length)return addAnimation(finalKfs,scope)+" "+groupAnimator[0]+" both"}for(var key in groupAnimators){(animationCfg=createSingleCSSAnimation(groupAnimators[key]))&&cssAnimations.push(animationCfg)}if(cssAnimations.length){var className=scope.zrId+"-cls-"+getClassId();scope.cssNodes["."+className]={animation:cssAnimations.join(",")},attrs.class=className}}function setClassAttribute(style,attrs,scope,withHover){var styleKey=JSON.stringify(style),className=scope.cssStyleCache[styleKey];className||(className=scope.zrId+"-cls-"+getClassId(),scope.cssStyleCache[styleKey]=className,scope.cssNodes["."+className+":hover"]=style),attrs.class=attrs.class?attrs.class+" "+className:className}var round=Math.round;function isImageLike(val){return val&&isString(val.src)}function isCanvasLike(val){return val&&isFunction(val.toDataURL)}function setStyleAttrs(attrs,style,el,scope){!function(updateAttr2,style,el,forceUpdate){var opacity=null==style.opacity?1:style.opacity;if(el instanceof ZRImage)updateAttr2("opacity",opacity);else{if(function(style){var fill=style.fill;return null!=fill&&"none"!==fill}(style)){var fill=normalizeColor(style.fill);updateAttr2("fill",fill.color);var fillOpacity=null!=style.fillOpacity?style.fillOpacity*fill.opacity*opacity:fill.opacity*opacity;fillOpacity<1&&updateAttr2("fill-opacity",fillOpacity)}else updateAttr2("fill","none");if(function(style){var stroke=style.stroke;return null!=stroke&&"none"!==stroke}(style)){var stroke=normalizeColor(style.stroke);updateAttr2("stroke",stroke.color);var strokeScale=style.strokeNoScale?el.getLineScale():1,strokeWidth=strokeScale?(style.lineWidth||0)/strokeScale:0,strokeOpacity=null!=style.strokeOpacity?style.strokeOpacity*stroke.opacity*opacity:stroke.opacity*opacity,strokeFirst=style.strokeFirst;if(1!==strokeWidth&&updateAttr2("stroke-width",strokeWidth),strokeFirst&&updateAttr2("paint-order",strokeFirst?"stroke":"fill"),strokeOpacity<1&&updateAttr2("stroke-opacity",strokeOpacity),style.lineDash){var _a2=getLineDash(el),lineDash=_a2[0],lineDashOffset=_a2[1];lineDash&&(lineDashOffset=mathRound(lineDashOffset||0),updateAttr2("stroke-dasharray",lineDash.join(",")),(lineDashOffset||forceUpdate)&&updateAttr2("stroke-dashoffset",lineDashOffset))}for(var i=0;i<strokeProps.length;i++){var propName=strokeProps[i];if(style[propName]!==DEFAULT_PATH_STYLE[propName]){var val=style[propName]||DEFAULT_PATH_STYLE[propName];val&&updateAttr2(svgStrokeProps[i],val)}}}}}((function(key,val){var isFillStroke="fill"===key||"stroke"===key;isFillStroke&&isGradient(val)?setGradient(style,attrs,key,scope):isFillStroke&&isPattern(val)?setPattern(el,attrs,key,scope):attrs[key]=val,isFillStroke&&scope.ssr&&"none"===val&&(attrs["pointer-events"]="visible")}),style,el,!1),function(el,attrs,scope){var style=el.style;if(function(style){return style&&(style.shadowBlur||style.shadowOffsetX||style.shadowOffsetY)}(style)){var shadowKey=function(displayable){var style=displayable.style,globalScale=displayable.getGlobalScale();return[style.shadowColor,(style.shadowBlur||0).toFixed(2),(style.shadowOffsetX||0).toFixed(2),(style.shadowOffsetY||0).toFixed(2),globalScale[0],globalScale[1]].join(",")}(el),shadowCache=scope.shadowCache,shadowId=shadowCache[shadowKey];if(!shadowId){var globalScale=el.getGlobalScale(),scaleX=globalScale[0],scaleY=globalScale[1];if(!scaleX||!scaleY)return;var offsetX=style.shadowOffsetX||0,offsetY=style.shadowOffsetY||0,blur_1=style.shadowBlur,_a2=normalizeColor(style.shadowColor),opacity=_a2.opacity,color2=_a2.color,stdDeviation=blur_1/2/scaleX+" "+blur_1/2/scaleY;shadowId=scope.zrId+"-s"+scope.shadowIdx++,scope.defs[shadowId]=createVNode("filter",shadowId,{id:shadowId,x:"-100%",y:"-100%",width:"300%",height:"300%"},[createVNode("feDropShadow","",{dx:offsetX/scaleX,dy:offsetY/scaleY,stdDeviation:stdDeviation,"flood-color":color2,"flood-opacity":opacity})]),shadowCache[shadowKey]=shadowId}attrs.filter=getIdURL(shadowId)}}(el,attrs,scope)}function setMetaData(attrs,el){var metaData=getElementSSRData(el);metaData&&(metaData.each((function(val,key){null!=val&&(attrs[("ecmeta_"+key).toLowerCase()]=val+"")})),el.isSilent()&&(attrs.ecmeta_silent="true"))}function noRotateScale(m2){return isAroundZero(m2[0]-1)&&isAroundZero(m2[1])&&isAroundZero(m2[2])&&isAroundZero(m2[3]-1)}function setTransform(attrs,m2,compress){if(m2&&(!function(m2){return isAroundZero(m2[4])&&isAroundZero(m2[5])}(m2)||!noRotateScale(m2))){attrs.transform=noRotateScale(m2)?"translate("+round(1e4*m2[4])/1e4+" "+round(1e4*m2[5])/1e4+")":function(m2){return"matrix("+round3(m2[0])+","+round3(m2[1])+","+round3(m2[2])+","+round3(m2[3])+","+round4(m2[4])+","+round4(m2[5])+")"}(m2)}}function convertPolyShape(shape,attrs,mul2){for(var points2=shape.points,strArr=[],i=0;i<points2.length;i++)strArr.push(round(points2[i][0]*mul2)/mul2),strArr.push(round(points2[i][1]*mul2)/mul2);attrs.points=strArr.join(" ")}function validatePolyShape(shape){return!shape.smooth}var desc,normalizedDesc,builtinShapesDef={circle:[(desc=["cx","cy","r"],normalizedDesc=map$1(desc,(function(item){return"string"==typeof item?[item,item]:item})),function(shape,attrs,mul2){for(var i=0;i<normalizedDesc.length;i++){var item=normalizedDesc[i],val=shape[item[0]];null!=val&&(attrs[item[1]]=round(val*mul2)/mul2)}})],polyline:[convertPolyShape,validatePolyShape],polygon:[convertPolyShape,validatePolyShape]};function brushSVGPath(el,scope){var style=el.style,shape=el.shape,builtinShpDef=builtinShapesDef[el.type],attrs={},needsAnimate=scope.animation,svgElType="path",strokePercent=el.style.strokePercent,precision=scope.compress&&getPathPrecision(el)||4;if(!builtinShpDef||scope.willUpdate||builtinShpDef[1]&&!builtinShpDef[1](shape)||needsAnimate&&function(el){for(var animators=el.animators,i=0;i<animators.length;i++)if("shape"===animators[i].targetName)return!0;return!1}(el)||strokePercent<1){var needBuildPath=!el.path||el.shapeChanged();el.path||el.createPathProxy();var path=el.path;needBuildPath&&(path.beginPath(),el.buildPath(path,el.shape),el.pathUpdated());var pathVersion=path.getVersion(),elExt=el,svgPathBuilder=elExt.__svgPathBuilder;elExt.__svgPathVersion===pathVersion&&svgPathBuilder&&strokePercent===elExt.__svgPathStrokePercent||(svgPathBuilder||(svgPathBuilder=elExt.__svgPathBuilder=new SVGPathRebuilder),svgPathBuilder.reset(precision),path.rebuildPath(svgPathBuilder,strokePercent),svgPathBuilder.generateStr(),elExt.__svgPathVersion=pathVersion,elExt.__svgPathStrokePercent=strokePercent),attrs.d=svgPathBuilder.getStr()}else{svgElType=el.type;var mul2=Math.pow(10,precision);builtinShpDef[0](shape,attrs,mul2)}return setTransform(attrs,el.transform),setStyleAttrs(attrs,style,el,scope),setMetaData(attrs,el),scope.animation&&createCSSAnimation(el,attrs,scope),scope.emphasis&&function(el,attrs,scope){if(!el.ignore)if(el.isSilent())setClassAttribute(style={"pointer-events":"none"},attrs,scope);else{var emphasisStyle=el.states.emphasis&&el.states.emphasis.style?el.states.emphasis.style:{},fill=emphasisStyle.fill;if(!fill){var normalFill=el.style&&el.style.fill,selectFill=el.states.select&&el.states.select.style&&el.states.select.style.fill,fromFill=el.currentStates.indexOf("select")>=0&&selectFill||normalFill;fromFill&&(fill=liftColor(fromFill))}var lineWidth=emphasisStyle.lineWidth;lineWidth&&(lineWidth/=!emphasisStyle.strokeNoScale&&el.transform?el.transform[0]:1);var style={cursor:"pointer"};fill&&(style.fill=fill),emphasisStyle.stroke&&(style.stroke=emphasisStyle.stroke),lineWidth&&(style["stroke-width"]=lineWidth),setClassAttribute(style,attrs,scope)}}(el,attrs,scope),createVNode(svgElType,el.id+"",attrs)}function brush(el,scope){return el instanceof Path?brushSVGPath(el,scope):el instanceof ZRImage?function(el,scope){var style=el.style,image=style.image;if(image&&!isString(image)&&(isImageLike(image)?image=image.src:isCanvasLike(image)&&(image=image.toDataURL())),image){var x=style.x||0,y=style.y||0,attrs={href:image,width:style.width,height:style.height};return x&&(attrs.x=x),y&&(attrs.y=y),setTransform(attrs,el.transform),setStyleAttrs(attrs,style,el,scope),setMetaData(attrs,el),scope.animation&&createCSSAnimation(el,attrs,scope),createVNode("image",el.id+"",attrs)}}(el,scope):el instanceof TSpan?function(el,scope){var style=el.style,text=style.text;if(null!=text&&(text+=""),text&&!isNaN(style.x)&&!isNaN(style.y)){var font=style.font||DEFAULT_FONT,x=style.x||0,y=function(y,lineHeight,textBaseline){return"top"===textBaseline?y+=lineHeight/2:"bottom"===textBaseline&&(y-=lineHeight/2),y}(style.y||0,getLineHeight(font),style.textBaseline),attrs={"dominant-baseline":"central","text-anchor":TEXT_ALIGN_TO_ANCHOR[style.textAlign]||style.textAlign};if(hasSeparateFont(style)){var separatedFontStr="",fontStyle=style.fontStyle,fontSize=parseFontSize(style.fontSize);if(!parseFloat(fontSize))return;var fontFamily=style.fontFamily||"sans-serif",fontWeight=style.fontWeight;separatedFontStr+="font-size:"+fontSize+";font-family:"+fontFamily+";",fontStyle&&"normal"!==fontStyle&&(separatedFontStr+="font-style:"+fontStyle+";"),fontWeight&&"normal"!==fontWeight&&(separatedFontStr+="font-weight:"+fontWeight+";"),attrs.style=separatedFontStr}else attrs.style="font: "+font;return text.match(/\s/)&&(attrs["xml:space"]="preserve"),x&&(attrs.x=x),y&&(attrs.y=y),setTransform(attrs,el.transform),setStyleAttrs(attrs,style,el,scope),setMetaData(attrs,el),scope.animation&&createCSSAnimation(el,attrs,scope),createVNode("text",el.id+"",attrs,void 0,text)}}(el,scope):void 0}function setGradient(style,attrs,target,scope){var gradientTag,val=style[target],gradientAttrs={gradientUnits:val.global?"userSpaceOnUse":"objectBoundingBox"};if(isLinearGradient(val))gradientTag="linearGradient",gradientAttrs.x1=val.x,gradientAttrs.y1=val.y,gradientAttrs.x2=val.x2,gradientAttrs.y2=val.y2;else{if(!isRadialGradient(val))return;gradientTag="radialGradient",gradientAttrs.cx=retrieve2(val.x,.5),gradientAttrs.cy=retrieve2(val.y,.5),gradientAttrs.r=retrieve2(val.r,.5)}for(var colors=val.colorStops,colorStops=[],i=0,len2=colors.length;i<len2;++i){var offset=100*round4(colors[i].offset)+"%",_a2=normalizeColor(colors[i].color),color2=_a2.color,opacity=_a2.opacity,stopsAttrs={offset:offset};stopsAttrs["stop-color"]=color2,opacity<1&&(stopsAttrs["stop-opacity"]=opacity),colorStops.push(createVNode("stop",i+"",stopsAttrs))}var gradientKey=vNodeToString(createVNode(gradientTag,"",gradientAttrs,colorStops)),gradientCache=scope.gradientCache,gradientId=gradientCache[gradientKey];gradientId||(gradientId=scope.zrId+"-g"+scope.gradientIdx++,gradientCache[gradientKey]=gradientId,gradientAttrs.id=gradientId,scope.defs[gradientId]=createVNode(gradientTag,gradientId,gradientAttrs,colorStops)),attrs[target]=getIdURL(gradientId)}function setPattern(el,attrs,target,scope){var child,val=el.style[target],boundingRect=el.getBoundingRect(),patternAttrs={},repeat=val.repeat,noRepeat="no-repeat"===repeat,repeatX="repeat-x"===repeat,repeatY="repeat-y"===repeat;if(isImagePattern(val)){var imageWidth_1=val.imageWidth,imageHeight_1=val.imageHeight,imageSrc=void 0,patternImage=val.image;if(isString(patternImage)?imageSrc=patternImage:isImageLike(patternImage)?imageSrc=patternImage.src:isCanvasLike(patternImage)&&(imageSrc=patternImage.toDataURL()),"undefined"==typeof Image){var errMsg="Image width/height must been given explictly in svg-ssr renderer.";assert(imageWidth_1,errMsg),assert(imageHeight_1,errMsg)}else if(null==imageWidth_1||null==imageHeight_1){var setSizeToVNode_1=function(vNode,img){if(vNode){var svgEl=vNode.elm,width=imageWidth_1||img.width,height=imageHeight_1||img.height;"pattern"===vNode.tag&&(repeatX?(height=1,width/=boundingRect.width):repeatY&&(width=1,height/=boundingRect.height)),vNode.attrs.width=width,vNode.attrs.height=height,svgEl&&(svgEl.setAttribute("width",width),svgEl.setAttribute("height",height))}},createdImage=createOrUpdateImage(imageSrc,null,el,(function(img){noRepeat||setSizeToVNode_1(patternVNode,img),setSizeToVNode_1(child,img)}));createdImage&&createdImage.width&&createdImage.height&&(imageWidth_1=imageWidth_1||createdImage.width,imageHeight_1=imageHeight_1||createdImage.height)}child=createVNode("image","img",{href:imageSrc,width:imageWidth_1,height:imageHeight_1}),patternAttrs.width=imageWidth_1,patternAttrs.height=imageHeight_1}else val.svgElement&&(child=clone$3(val.svgElement),patternAttrs.width=val.svgWidth,patternAttrs.height=val.svgHeight);if(child){var patternWidth,patternHeight;noRepeat?patternWidth=patternHeight=1:repeatX?(patternHeight=1,patternWidth=patternAttrs.width/boundingRect.width):repeatY?(patternWidth=1,patternHeight=patternAttrs.height/boundingRect.height):patternAttrs.patternUnits="userSpaceOnUse",null==patternWidth||isNaN(patternWidth)||(patternAttrs.width=patternWidth),null==patternHeight||isNaN(patternHeight)||(patternAttrs.height=patternHeight);var patternTransform=getSRTTransformString(val);patternTransform&&(patternAttrs.patternTransform=patternTransform);var patternVNode=createVNode("pattern","",patternAttrs,[child]),patternKey=vNodeToString(patternVNode),patternCache=scope.patternCache,patternId=patternCache[patternKey];patternId||(patternId=scope.zrId+"-p"+scope.patternIdx++,patternCache[patternKey]=patternId,patternAttrs.id=patternId,patternVNode=scope.defs[patternId]=createVNode("pattern",patternId,patternAttrs,[child])),attrs[target]=getIdURL(patternId)}}function setClipPath(clipPath,attrs,scope){var clipPathCache=scope.clipPathCache,defs=scope.defs,clipPathId=clipPathCache[clipPath.id];if(!clipPathId){var clipPathAttrs={id:clipPathId=scope.zrId+"-c"+scope.clipPathIdx++};clipPathCache[clipPath.id]=clipPathId,defs[clipPathId]=createVNode("clipPath",clipPathId,clipPathAttrs,[brushSVGPath(clipPath,scope)])}attrs["clip-path"]=getIdURL(clipPathId)}function createTextNode(text){return document.createTextNode(text)}function insertBefore(parentNode2,newNode,referenceNode){parentNode2.insertBefore(newNode,referenceNode)}function removeChild(node,child){node.removeChild(child)}function appendChild(node,child){node.appendChild(child)}function parentNode(node){return node.parentNode}function nextSibling(node){return node.nextSibling}function setTextContent(node,text){node.textContent=text}var emptyNode=createVNode("","");function isUndef(s){return void 0===s}function isDef(s){return void 0!==s}function createKeyToOldIdx(children,beginIdx,endIdx){for(var map2={},i=beginIdx;i<=endIdx;++i){var key=children[i].key;void 0!==key&&(map2[key]=i)}return map2}function sameVnode(vnode1,vnode2){var isSameKey=vnode1.key===vnode2.key;return vnode1.tag===vnode2.tag&&isSameKey}function createElm(vnode){var i,children=vnode.children,tag=vnode.tag;if(isDef(tag)){var elm=vnode.elm=createElement(tag);if(updateAttrs(emptyNode,vnode),isArray$1(children))for(i=0;i<children.length;++i){var ch=children[i];null!=ch&&appendChild(elm,createElm(ch))}else isDef(vnode.text)&&!isObject$3(vnode.text)&&appendChild(elm,createTextNode(vnode.text))}else vnode.elm=createTextNode(vnode.text);return vnode.elm}function addVnodes(parentElm,before,vnodes,startIdx,endIdx){for(;startIdx<=endIdx;++startIdx){var ch=vnodes[startIdx];null!=ch&&insertBefore(parentElm,createElm(ch),before)}}function removeVnodes(parentElm,vnodes,startIdx,endIdx){for(;startIdx<=endIdx;++startIdx){var ch=vnodes[startIdx];if(null!=ch)if(isDef(ch.tag))removeChild(parentNode(ch.elm),ch.elm);else removeChild(parentElm,ch.elm)}}function updateAttrs(oldVnode,vnode){var key,elm=vnode.elm,oldAttrs=oldVnode&&oldVnode.attrs||{},attrs=vnode.attrs||{};if(oldAttrs!==attrs){for(key in attrs){var cur=attrs[key];oldAttrs[key]!==cur&&(!0===cur?elm.setAttribute(key,""):!1===cur?elm.removeAttribute(key):"style"===key?elm.style.cssText=cur:120!==key.charCodeAt(0)?elm.setAttribute(key,cur):"xmlns:xlink"===key||"xmlns"===key?elm.setAttributeNS("http://www.w3.org/2000/xmlns/",key,cur):58===key.charCodeAt(3)?elm.setAttributeNS("http://www.w3.org/XML/1998/namespace",key,cur):58===key.charCodeAt(5)?elm.setAttributeNS(XLINKNS,key,cur):elm.setAttribute(key,cur))}for(key in oldAttrs)key in attrs||elm.removeAttribute(key)}}function patchVnode(oldVnode,vnode){var elm=vnode.elm=oldVnode.elm,oldCh=oldVnode.children,ch=vnode.children;oldVnode!==vnode&&(updateAttrs(oldVnode,vnode),isUndef(vnode.text)?isDef(oldCh)&&isDef(ch)?oldCh!==ch&&function(parentElm,oldCh,newCh){for(var oldKeyToIdx,idxInOld,elmToMove,oldStartIdx=0,newStartIdx=0,oldEndIdx=oldCh.length-1,oldStartVnode=oldCh[0],oldEndVnode=oldCh[oldEndIdx],newEndIdx=newCh.length-1,newStartVnode=newCh[0],newEndVnode=newCh[newEndIdx];oldStartIdx<=oldEndIdx&&newStartIdx<=newEndIdx;)null==oldStartVnode?oldStartVnode=oldCh[++oldStartIdx]:null==oldEndVnode?oldEndVnode=oldCh[--oldEndIdx]:null==newStartVnode?newStartVnode=newCh[++newStartIdx]:null==newEndVnode?newEndVnode=newCh[--newEndIdx]:sameVnode(oldStartVnode,newStartVnode)?(patchVnode(oldStartVnode,newStartVnode),oldStartVnode=oldCh[++oldStartIdx],newStartVnode=newCh[++newStartIdx]):sameVnode(oldEndVnode,newEndVnode)?(patchVnode(oldEndVnode,newEndVnode),oldEndVnode=oldCh[--oldEndIdx],newEndVnode=newCh[--newEndIdx]):sameVnode(oldStartVnode,newEndVnode)?(patchVnode(oldStartVnode,newEndVnode),insertBefore(parentElm,oldStartVnode.elm,nextSibling(oldEndVnode.elm)),oldStartVnode=oldCh[++oldStartIdx],newEndVnode=newCh[--newEndIdx]):sameVnode(oldEndVnode,newStartVnode)?(patchVnode(oldEndVnode,newStartVnode),insertBefore(parentElm,oldEndVnode.elm,oldStartVnode.elm),oldEndVnode=oldCh[--oldEndIdx],newStartVnode=newCh[++newStartIdx]):(isUndef(oldKeyToIdx)&&(oldKeyToIdx=createKeyToOldIdx(oldCh,oldStartIdx,oldEndIdx)),isUndef(idxInOld=oldKeyToIdx[newStartVnode.key])||(elmToMove=oldCh[idxInOld]).tag!==newStartVnode.tag?insertBefore(parentElm,createElm(newStartVnode),oldStartVnode.elm):(patchVnode(elmToMove,newStartVnode),oldCh[idxInOld]=void 0,insertBefore(parentElm,elmToMove.elm,oldStartVnode.elm)),newStartVnode=newCh[++newStartIdx]);(oldStartIdx<=oldEndIdx||newStartIdx<=newEndIdx)&&(oldStartIdx>oldEndIdx?addVnodes(parentElm,null==newCh[newEndIdx+1]?null:newCh[newEndIdx+1].elm,newCh,newStartIdx,newEndIdx):removeVnodes(parentElm,oldCh,oldStartIdx,oldEndIdx))}(elm,oldCh,ch):isDef(ch)?(isDef(oldVnode.text)&&setTextContent(elm,""),addVnodes(elm,null,ch,0,ch.length-1)):isDef(oldCh)?removeVnodes(elm,oldCh,0,oldCh.length-1):isDef(oldVnode.text)&&setTextContent(elm,""):oldVnode.text!==vnode.text&&(isDef(oldCh)&&removeVnodes(elm,oldCh,0,oldCh.length-1),setTextContent(elm,vnode.text)))}var svgId=0,SVGPainter=function(){function SVGPainter2(root,storage2,opts){if(this.type="svg",this.refreshHover=function(){},this.configLayer=function(){},this.storage=storage2,this._opts=opts=extend({},opts),this.root=root,this._id="zr"+svgId++,this._oldVNode=createSVGVNode(opts.width,opts.height),root&&!opts.ssr){var viewport=this._viewport=document.createElement("div");viewport.style.cssText="position:relative;overflow:hidden";var svgDom=this._svgDom=this._oldVNode.elm=createElement("svg");updateAttrs(null,this._oldVNode),viewport.appendChild(svgDom),root.appendChild(viewport)}this.resize(opts.width,opts.height)}return SVGPainter2.prototype.getType=function(){return this.type},SVGPainter2.prototype.getViewportRoot=function(){return this._viewport},SVGPainter2.prototype.getViewportRootOffset=function(){var viewportRoot=this.getViewportRoot();if(viewportRoot)return{offsetLeft:viewportRoot.offsetLeft||0,offsetTop:viewportRoot.offsetTop||0}},SVGPainter2.prototype.getSvgDom=function(){return this._svgDom},SVGPainter2.prototype.refresh=function(){if(this.root){var vnode=this.renderToVNode({willUpdate:!0});vnode.attrs.style="position:absolute;left:0;top:0;user-select:none",function(oldVnode,vnode){if(sameVnode(oldVnode,vnode))patchVnode(oldVnode,vnode);else{var elm=oldVnode.elm,parent_2=parentNode(elm);createElm(vnode),null!==parent_2&&(insertBefore(parent_2,vnode.elm,nextSibling(elm)),removeVnodes(parent_2,[oldVnode],0,0))}}(this._oldVNode,vnode),this._oldVNode=vnode}},SVGPainter2.prototype.renderOneToVNode=function(el){return brush(el,createBrushScope(this._id))},SVGPainter2.prototype.renderToVNode=function(opts){opts=opts||{};var list=this.storage.getDisplayList(!0),width=this._width,height=this._height,scope=createBrushScope(this._id);scope.animation=opts.animation,scope.willUpdate=opts.willUpdate,scope.compress=opts.compress,scope.emphasis=opts.emphasis,scope.ssr=this._opts.ssr;var children=[],bgVNode=this._bgVNode=function(width,height,backgroundColor2,scope){var bgVNode;if(backgroundColor2&&"none"!==backgroundColor2)if(bgVNode=createVNode("rect","bg",{width:width,height:height,x:"0",y:"0"}),isGradient(backgroundColor2))setGradient({fill:backgroundColor2},bgVNode.attrs,"fill",scope);else if(isPattern(backgroundColor2))setPattern({style:{fill:backgroundColor2},dirty:noop,getBoundingRect:function(){return{width:width,height:height}}},bgVNode.attrs,"fill",scope);else{var _a2=normalizeColor(backgroundColor2),color2=_a2.color,opacity=_a2.opacity;bgVNode.attrs.fill=color2,opacity<1&&(bgVNode.attrs["fill-opacity"]=opacity)}return bgVNode}(width,height,this._backgroundColor,scope);bgVNode&&children.push(bgVNode);var mainVNode=opts.compress?null:this._mainVNode=createVNode("g","main",{},[]);this._paintList(list,scope,mainVNode?mainVNode.children:children),mainVNode&&children.push(mainVNode);var defs=map$1(keys(scope.defs),(function(id){return scope.defs[id]}));if(defs.length&&children.push(createVNode("defs","defs",{},defs)),opts.animation){var animationCssStr=function(selectorNodes,animationNodes,opts){var S=(opts=opts||{}).newline?"\n":"",bracketBegin=" {"+S,bracketEnd=S+"}",selectors=map$1(keys(selectorNodes),(function(className){return className+bracketBegin+map$1(keys(selectorNodes[className]),(function(attrName){return attrName+":"+selectorNodes[className][attrName]+";"})).join(S)+bracketEnd})).join(S),animations=map$1(keys(animationNodes),(function(animationName){return"@keyframes "+animationName+bracketBegin+map$1(keys(animationNodes[animationName]),(function(percent){return percent+bracketBegin+map$1(keys(animationNodes[animationName][percent]),(function(attrName){var val=animationNodes[animationName][percent][attrName];return"d"===attrName&&(val='path("'+val+'")'),attrName+":"+val+";"})).join(S)+bracketEnd})).join(S)+bracketEnd})).join(S);return selectors||animations?["<![CDATA[",selectors,animations,"]]>"].join(S):""}(scope.cssNodes,scope.cssAnims,{newline:!0});if(animationCssStr){var styleNode=createVNode("style","stl",{},[],animationCssStr);children.push(styleNode)}}return createSVGVNode(width,height,children,opts.useViewBox)},SVGPainter2.prototype.renderToString=function(opts){return opts=opts||{},vNodeToString(this.renderToVNode({animation:retrieve2(opts.cssAnimation,!0),emphasis:retrieve2(opts.cssEmphasis,!0),willUpdate:!1,compress:!0,useViewBox:retrieve2(opts.useViewBox,!0)}),{newline:!0})},SVGPainter2.prototype.setBackgroundColor=function(backgroundColor2){this._backgroundColor=backgroundColor2},SVGPainter2.prototype.getSvgRoot=function(){return this._mainVNode&&this._mainVNode.elm},SVGPainter2.prototype._paintList=function(list,scope,out2){for(var currentClipPathGroup,prevClipPaths,listLen=list.length,clipPathsGroupsStack=[],clipPathsGroupsStackDepth=0,clipGroupNodeIdx=0,i=0;i<listLen;i++){var displayable=list[i];if(!displayable.invisible){var clipPaths=displayable.__clipPaths,len2=clipPaths&&clipPaths.length||0,prevLen=prevClipPaths&&prevClipPaths.length||0,lca=void 0;for(lca=Math.max(len2-1,prevLen-1);lca>=0&&(!clipPaths||!prevClipPaths||clipPaths[lca]!==prevClipPaths[lca]);lca--);for(var i_1=prevLen-1;i_1>lca;i_1--)currentClipPathGroup=clipPathsGroupsStack[--clipPathsGroupsStackDepth-1];for(var i_2=lca+1;i_2<len2;i_2++){var groupAttrs={};setClipPath(clipPaths[i_2],groupAttrs,scope);var g=createVNode("g","clip-g-"+clipGroupNodeIdx++,groupAttrs,[]);(currentClipPathGroup?currentClipPathGroup.children:out2).push(g),clipPathsGroupsStack[clipPathsGroupsStackDepth++]=g,currentClipPathGroup=g}prevClipPaths=clipPaths;var ret=brush(displayable,scope);ret&&(currentClipPathGroup?currentClipPathGroup.children:out2).push(ret)}}},SVGPainter2.prototype.resize=function(width,height){var opts=this._opts,root=this.root,viewport=this._viewport;if(null!=width&&(opts.width=width),null!=height&&(opts.height=height),root&&viewport&&(viewport.style.display="none",width=getSize$1(root,0,opts),height=getSize$1(root,1,opts),viewport.style.display=""),this._width!==width||this._height!==height){if(this._width=width,this._height=height,viewport){var viewportStyle=viewport.style;viewportStyle.width=width+"px",viewportStyle.height=height+"px"}if(isPattern(this._backgroundColor))this.refresh();else{var svgDom=this._svgDom;svgDom&&(svgDom.setAttribute("width",width),svgDom.setAttribute("height",height));var bgEl=this._bgVNode&&this._bgVNode.elm;bgEl&&(bgEl.setAttribute("width",width),bgEl.setAttribute("height",height))}}},SVGPainter2.prototype.getWidth=function(){return this._width},SVGPainter2.prototype.getHeight=function(){return this._height},SVGPainter2.prototype.dispose=function(){this.root&&(this.root.innerHTML=""),this._svgDom=this._viewport=this.storage=this._oldVNode=this._bgVNode=this._mainVNode=null},SVGPainter2.prototype.clear=function(){this._svgDom&&(this._svgDom.innerHTML=null),this._oldVNode=null},SVGPainter2.prototype.toDataURL=function(base64){var str=this.renderToString(),prefix="data:image/svg+xml;";return base64?(str=encodeBase64(str))&&prefix+"base64,"+str:prefix+"charset=UTF-8,"+encodeURIComponent(str)},SVGPainter2}();function useECharts(elRef,theme2="default"){const{getDarkMode:getSysDarkMode}=useRootSetting(),getDarkMode=computed((()=>"default"===theme2?getSysDarkMode.value:theme2));let chartInstance=null,resizeFn=resize;const cacheOptions=ref({});let removeResizeFn=()=>{};resizeFn=useDebounceFn(resize,200);const getOptions=computed((()=>"dark"!==getDarkMode.value?cacheOptions.value:((a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a})({backgroundColor:"transparent"},cacheOptions.value)));function initCharts(t=theme2){const el=unref(elRef);if(!el||!unref(el))return;chartInstance=echarts.init(el,t);const{removeEvent:removeEvent}=useEventListener({el:window,name:"resize",listener:resizeFn});removeResizeFn=removeEvent;const{widthRef:widthRef,screenEnum:screenEnum}=useBreakpoint();(unref(widthRef)<=screenEnum.MD||0===el.offsetHeight)&&useTimeoutFn((()=>{resizeFn()}),30)}function setOptions(options,clear2=!0){var _a2;cacheOptions.value=options,0!==(null==(_a2=unref(elRef))?void 0:_a2.offsetHeight)?nextTick((()=>{useTimeoutFn((()=>{(chartInstance||(initCharts(getDarkMode.value),chartInstance))&&(clear2&&(null==chartInstance||chartInstance.clear()),null==chartInstance||chartInstance.setOption(unref(getOptions)))}),30)})):useTimeoutFn((()=>{setOptions(unref(getOptions))}),30)}function resize(){null==chartInstance||chartInstance.resize({animation:{duration:300,easing:"quadraticIn"}})}return watch((()=>getDarkMode.value),(theme22=>{chartInstance&&(chartInstance.dispose(),initCharts(theme22),setOptions(cacheOptions.value))})),tryOnUnmounted((()=>{chartInstance&&(removeResizeFn(),chartInstance.dispose(),chartInstance=null)})),{setOptions:setOptions,resize:resize,echarts:echarts,getInstance:function(){return chartInstance||initCharts(getDarkMode.value),chartInstance}}}use([function(registers){use(install$a),use(install$9)},function(registers){registers.registerComponentModel(TitleModel),registers.registerComponentView(TitleView)},function(registers){use(install$k),registers.registerComponentModel(TooltipModel),registers.registerComponentView(TooltipView),registers.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},noop),registers.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},noop)},function(registers){use(install$s),use(install$k)},function(registers){use(install$k),AxisView.registerAxisPointerClass("PolarAxisPointer",PolarAxisPointer),registers.registerCoordinateSystem("polar",polarCreator),registers.registerComponentModel(PolarModel),registers.registerComponentView(PolarView),axisModelCreator(registers,"angle",AngleAxisModel,angleAxisExtraOption),axisModelCreator(registers,"radius",RadiusAxisModel,radiusAxisExtraOption),registers.registerComponentView(AngleAxisView),registers.registerComponentView(RadiusAxisView),registers.registerLayout(curry$1(barLayoutPolar,"bar"))},function(registers){registers.registerPreprocessor(ariaPreprocessor),registers.registerVisual(registers.PRIORITY.VISUAL.ARIA,ariaVisual)},function(registers){registers.registerComponentView(ParallelView),registers.registerComponentModel(ParallelModel),registers.registerCoordinateSystem("parallel",parallelCoordSysCreator),registers.registerPreprocessor(parallelPreprocessor),registers.registerComponentModel(ParallelAxisModel),registers.registerComponentView(ParallelAxisView),axisModelCreator(registers,"parallel",ParallelAxisModel,defaultAxisOption),function(registers){registers.registerAction(actionInfo,(function(payload,ecModel){ecModel.eachComponent({mainType:"parallelAxis",query:payload},(function(parallelAxisModel){parallelAxisModel.axis.model.setActiveIntervals(payload.intervals)}))})),registers.registerAction("parallelAxisExpand",(function(payload,ecModel){ecModel.eachComponent({mainType:"parallel",query:payload},(function(parallelModel){parallelModel.setAxisExpand(payload)}))}))}(registers)},function(registers){registers.registerChartView(BarView),registers.registerSeriesModel(BarSeriesModel),registers.registerLayout(registers.PRIORITY.VISUAL.LAYOUT,curry$1(layout$2,"bar")),registers.registerLayout(registers.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,createProgressiveLayout("bar")),registers.registerProcessor(registers.PRIORITY.PROCESSOR.STATISTIC,dataSample("bar")),registers.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},(function(payload,ecModel){var componentType=payload.componentType||"series";ecModel.eachComponent({mainType:componentType,query:payload},(function(componentModel){payload.sortInfo&&componentModel.axis.setCategorySortInfo(payload.sortInfo)}))}))},function(registers){registers.registerChartView(LineView),registers.registerSeriesModel(LineSeriesModel),registers.registerLayout(pointsLayout("line",!0)),registers.registerVisual({seriesType:"line",reset:function(seriesModel){var data=seriesModel.getData(),lineStyle=seriesModel.getModel("lineStyle").getLineStyle();lineStyle&&!lineStyle.stroke&&(lineStyle.stroke=data.getVisual("style").fill),data.setVisual("legendLineStyle",lineStyle)}}),registers.registerProcessor(registers.PRIORITY.PROCESSOR.STATISTIC,dataSample("line"))},function(registers){registers.registerChartView(PieView),registers.registerSeriesModel(PieSeriesModel),createLegacyDataSelectAction("pie",registers.registerAction),registers.registerLayout(curry$1(pieLayout,"pie")),registers.registerProcessor(dataFilter("pie")),registers.registerProcessor({seriesType:"pie",reset:function(seriesModel,ecModel){var data=seriesModel.getData();data.filterSelf((function(idx){var valueDim=data.mapDimension("value"),curValue=data.get(valueDim,idx);return!(isNumber(curValue)&&!isNaN(curValue)&&curValue<0)}))}})},function(registers){use(install$o),registers.registerChartView(MapView),registers.registerSeriesModel(MapSeries),registers.registerLayout(mapSymbolLayout),registers.registerProcessor(registers.PRIORITY.PROCESSOR.STATISTIC,mapDataStatistic),createLegacyDataSelectAction("map",registers.registerAction)},function(registers){use(install$q),registers.registerChartView(RadarView$1),registers.registerSeriesModel(RadarSeriesModel),registers.registerLayout(radarLayout),registers.registerProcessor(dataFilter("radar")),registers.registerPreprocessor(radarBackwardCompat)},function(registers){registers.registerPainter("svg",SVGPainter)},function(registers){registers.registerChartView(PictorialBarView),registers.registerSeriesModel(PictorialBarSeriesModel),registers.registerLayout(registers.PRIORITY.VISUAL.LAYOUT,curry$1(layout$2,"pictorialBar")),registers.registerLayout(registers.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,createProgressiveLayout("pictorialBar"))},install$q,function(registers){registers.registerComponentModel(ToolboxModel),registers.registerComponentView(ToolboxView),registerFeature("saveAsImage",SaveAsImage),registerFeature("magicType",MagicType),registerFeature("dataView",DataView),registerFeature("dataZoom",DataZoomFeature),registerFeature("restore",RestoreOption),use(install$f)},function(registers){use(install$7),use(install$6)},function(registers){use(install$4),use(install$3)},function(registers){registers.registerComponentModel(SliderTimelineModel),registers.registerComponentView(SliderTimelineView),registers.registerSubTypeDefaulter("timeline",(function(){return"slider"})),function(registers){registers.registerAction({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},(function(payload,ecModel,api){var timelineModel=ecModel.getComponent("timeline");return timelineModel&&null!=payload.currentIndex&&(timelineModel.setCurrentIndex(payload.currentIndex),!timelineModel.get("loop",!0)&&timelineModel.isIndexMax()&&timelineModel.getPlayState()&&(timelineModel.setPlayState(!1),api.dispatchAction({type:"timelinePlayChange",playState:!1,from:payload.from}))),ecModel.resetOption("timeline",{replaceMerge:timelineModel.get("replaceMerge",!0)}),defaults({currentIndex:timelineModel.option.currentIndex},payload)})),registers.registerAction({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},(function(payload,ecModel){var timelineModel=ecModel.getComponent("timeline");timelineModel&&null!=payload.playState&&timelineModel.setPlayState(payload.playState)}))}(registers),registers.registerPreprocessor(timelinePreprocessor)},function(registers){registers.registerComponentModel(CalendarModel),registers.registerComponentView(CalendarView),registers.registerCoordinateSystem("calendar",Calendar)},function(registers){registers.registerComponentModel(GraphicComponentModel),registers.registerComponentView(GraphicComponentView),registers.registerPreprocessor((function(option){var graphicOption=option.graphic;isArray$1(graphicOption)?graphicOption[0]&&graphicOption[0].elements?option.graphic=[option.graphic[0]]:option.graphic=[{elements:graphicOption}]:graphicOption&&!graphicOption.elements&&(option.graphic=[{elements:[graphicOption]}])}))},function(registers){use(install$s),registers.registerSeriesModel(ScatterSeriesModel),registers.registerChartView(ScatterView),registers.registerLayout(pointsLayout("scatter"))}]);export{useECharts as u};
