var e=Object.defineProperty,t=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(t,l,o)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[l]=o,a=(e,t,l)=>new Promise(((o,n)=>{var a=e=>{try{s(l.next(e))}catch(t){n(t)}},r=e=>{try{s(l.throw(e))}catch(t){n(t)}},s=e=>e.done?o(e.value):Promise.resolve(e.value).then(a,r);s((l=l.apply(e,t)).next())}));import{k as r,aC as s,b as i,p as u,ad as d,r as c,e as p,o as m,f as v,F as f,h as y,v as b,m as g,V as j,s as h,W as k,aL as w,aM as O,I as P,i as R,j as x,X as _,l as A,U as C,w as F,ac as S}from"./index.js";import{u as M,B as I,a as B}from"./index2.js";import{B as U}from"./BasicForm.js";import"./useWindowSizeFn.js";import"./FullscreenOutlined.js";import"./index4.js";import"./find.js";import"./_baseIteratee.js";import"./get.js";import"./index5.js";import"./index6.js";import"./useFormItem.js";import"./index3.js";import"./DeleteOutlined.js";import"./transButton.js";import"./upperFirst.js";import"./download.js";import"./index7.js";import"./index8.js";import"./uniqBy.js";var z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm192 472c0 4.4-3.6 8-8 8H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h368c4.4 0 8 3.6 8 8v48z"}}]},name:"minus-circle",theme:"filled"};function D(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?Object(arguments[t]):{},o=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(l).filter((function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable})))),o.forEach((function(t){H(e,t,l[t])}))}return e}function H(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}var W=function(e,t){var l=D({},e,t.attrs);return r(s,D({},l,{icon:z}),null)};W.displayName="MinusCircleFilled",W.inheritAttrs=!1;var E=W;const G=Symbol(),L=Symbol();const V={key:0,class:"card-item"},$={class:"label"},q={class:"value"},N=i({__name:"SettingCard",props:{models:u.object.def((()=>({}))),allowRemove:u.bool.def(!1)},emits:["remove"],setup(e,{emit:t}){const l=t,o=d(L),n=d(G,c([])),{createConfirmSync:s}=w();function i(e){return a(this,null,(function*(){e.stopPropagation(),(yield s({title:"删除",content:"确定删除吗？"}))&&l("remove")}))}return(t,l)=>{const a=p("GSpan");return m(),v("div",{class:k([`${h(o)}-card`])},[(m(!0),v(f,null,y(h(n),(t=>(m(),v(f,null,["Divider"!==t.component?(m(),v("div",V,[b("div",$,g(t.label),1),b("div",q,[r(a,{value:e.models[t.field],password:"InputPassword"===t.component},null,8,["value","password"])])])):j("",!0)],64)))),256)),e.allowRemove?(m(),v("div",{key:0,class:"remove",onClick:i},[r(h(E))])):j("",!0)],2)}}}),X=i({__name:"SubFormModal",props:{modalProps:{type:Object,default:()=>({})}},emits:["register","ok"],setup(e,{emit:s}){const i=e,u=s,p=d(G,c([])),v=c(null),[f,y]=M((function(e){return a(this,null,(function*(){v.value=e.payload,yield g.resetFields(),yield g.setFieldsValue(e.models)}))})),[b,g]=O({labelWidth:120,schemas:p,labelAlign:"right",showActionButtonGroup:!1,baseColProps:{span:24}}),j=P((()=>((e,a)=>{for(var r in a||(a={}))l.call(a,r)&&n(e,r,a[r]);if(t)for(var r of t(a))o.call(a,r)&&n(e,r,a[r]);return e})({title:"子表单",width:800,minHeight:100,onOk:k},i.modalProps)));function k(){return a(this,null,(function*(){let e=yield g.validate();u("ok",{values:e,payload:v.value}),y.closeModal()}))}return(e,t)=>(m(),R(h(I),_(j.value,{onRegister:h(f)}),{default:x((()=>[r(h(U),{onRegister:h(b)},null,8,["onRegister"])])),_:1},16,["onRegister"]))}}),J={style:{padding:"10px"}},K=i({__name:"FormListModal",props:{modalProps:{type:Object,default:()=>({})}},emits:["register","ok"],setup(e,{emit:t}){const l=t,o=c([]),[n,s]=M((function(e){return a(this,null,(function*(){o.value=e.list}))})),[i,u]=B(),d=P((()=>({title:"填写列表",width:800,minHeight:400,onOk:k})));function g(){O({})}function k(){return a(this,null,(function*(){l("ok",o.value),s.closeModal()}))}function w(){s.closeModal()}function O(e,t){t=t||{isUpdate:!1},u.openModal(!0,{models:e,payload:t})}function C({values:e,payload:{isUpdate:t,modelIndex:n}}){t?o.value[n]=e:o.value.push(e),l("ok",o.value)}return(t,a)=>{const s=p("a-empty"),u=p("a-button"),c=p("a-col"),k=p("a-row");return m(),v(f,null,[r(h(I),_(d.value,{onRegister:h(n)}),{footer:x((()=>[r(k,{type:"flex",justify:"space-between"},{default:x((()=>[r(c,null,{default:x((()=>[r(u,{type:"primary",preIcon:"ant-design:plus",onClick:g},{default:x((()=>[A("新增")])),_:1})])),_:1}),r(c,null,{default:x((()=>[r(u,{onClick:w},{default:x((()=>[A("关闭")])),_:1})])),_:1})])),_:1})])),default:x((()=>[b("div",J,[0===o.value.length?(m(),R(s,{key:0,description:"暂无数据，请点击下方的“新增”按钮添加"})):j("",!0),(m(!0),v(f,null,y(o.value,((e,t)=>(m(),R(N,{models:e,allowRemove:"",onClick:l=>function(e,t){O(e,{modelIndex:t,isUpdate:!0})}(e,t),onRemove:e=>{return n=t,o.value.splice(n,1),void l("ok",o.value);var n}},null,8,["models","onClick","onRemove"])))),256))])])),_:1},16,["onRegister"]),r(X,{modalProps:e.modalProps,onRegister:h(i),onOk:C},null,8,["modalProps","onRegister"])],64)}}});const Q=i({__name:"SubForm",props:{value:{type:[Array,Object]},schemas:{type:Array,default:()=>[]},multiple:u.bool.def(!1),alwaysArray:u.bool.def(!1),modalProps:{type:Object,default:()=>({})}},emits:["change","update:value"],setup(e,{emit:t}){const l=e,o=t,{prefixCls:n}=C("g-sub-form"),a=c(),s=P((()=>l.schemas)),i=P((()=>l.alwaysArray||l.multiple)),u=P((()=>{const{value:e,multiple:t}=l;if(null==e||0===e.length)return i.value?[]:{};if(t){if(!Array.isArray(e))return[e]}else if(i.value&&!Array.isArray(e))return[e];return e})),d=P((()=>{var e;return null!=(e=Array.isArray(u.value)?u.value[0]:u.value)?e:{}})),f=P((()=>{var e,t;const{multiple:o}=l;return o?`已配置 ${null!=(t=null==(e=u.value)?void 0:e.length)?t:0} 项`:""}));F(a,(()=>{var e;const t=null==(e=a.value)?void 0:e.input;t&&t.setAttribute("readonly","readonly")}),{immediate:!0});const[y,b]=B();function g(){b.openModal(!0,{list:u.value})}function j(e){o("change",e)}const[w,O]=B();function R(){O.openModal(!0,{models:d.value})}function x({values:e}){i.value&&(e=[e]),o("change",e)}return S(L,n),S(G,s),(t,l)=>{const o=p("a-input");return m(),v("div",{class:k([h(n)])},[e.multiple?(m(),v("div",{key:0,class:"multiple-mode",onClick:g},[r(o,{ref_key:"inputRef",ref:a,value:f.value},null,8,["value"])])):(m(),v("div",{key:1,class:"single-mode",onClick:R},[r(N,{models:d.value},null,8,["models"])])),r(K,{modalProps:e.modalProps,onRegister:h(y),onOk:j},null,8,["modalProps","onRegister"]),r(X,{modalProps:e.modalProps,onRegister:h(w),onOk:x},null,8,["modalProps","onRegister"])],2)}}});export{Q as default};
