import{cm as e,cn as r,ag as n,_ as t,H as a,bx as i,G as u,b0 as o,E as l,bv as s,bu as c,co as f,ae as d,af as v,v as p,aV as h,ap as m,U as g,k as y,F as b,d as w,L as F,cp as x,b as q,D as O,r as k,w as j,bf as A,bz as E,bA as C,a1 as P,a4 as $,a3 as S,aN as M,ax as V,am as R,ay as T,c3 as _,cq as I,ak as B,aD as D,cr as W,R as N,a0 as z,bi as L,q as H,x as Y,c as J,bj as X,bE as Z,cs as G,ct as K,aG as U,cu as Q,cv as ee,C as re}from"./index.js";import{b as ne}from"./_baseIteratee.js";function te(r){var n=function(r){return r?Infinity===(r=e(r))||-Infinity===r?17976931348623157e292*(r<0?-1:1):r==r?r:0:0===r?r:0}(r),t=n%1;return n==n?t?n-t:n:0}function ae(){return ae=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},ae.apply(this,arguments)}function ie(e){return(ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ue(e,r){return(ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e})(e,r)}function oe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function le(e,r,n){return(le=oe()?Reflect.construct.bind():function(e,r,n){var t=[null];t.push.apply(t,r);var a=new(Function.bind.apply(e,t));return n&&ue(a,n.prototype),a}).apply(null,arguments)}function se(e){var r="function"==typeof Map?new Map:void 0;return se=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return le(e,arguments,ie(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),ue(t,e)},se(e)}var ce=/%[sdj%]/g,fe=function(){};function de(e){if(!e||!e.length)return null;var r={};return e.forEach((function(e){var n=e.field;r[n]=r[n]||[],r[n].push(e)})),r}function ve(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),t=1;t<r;t++)n[t-1]=arguments[t];var a=0,i=n.length;if("function"==typeof e)return e.apply(null,n);if("string"==typeof e){var u=e.replace(ce,(function(e){if("%%"===e)return"%";if(a>=i)return e;switch(e){case"%s":return String(n[a++]);case"%d":return Number(n[a++]);case"%j":try{return JSON.stringify(n[a++])}catch(r){return"[Circular]"}break;default:return e}}));return u}return e}function pe(e,r){return null==e||(!("array"!==r||!Array.isArray(e)||e.length)||!(!function(e){return"string"===e||"url"===e||"hex"===e||"email"===e||"date"===e||"pattern"===e}(r)||"string"!=typeof e||e))}function he(e,r,n){var t=0,a=e.length;!function i(u){if(u&&u.length)n(u);else{var o=t;t+=1,o<a?r(e[o],i):n([])}}([])}"undefined"!=typeof process&&process.env;var me=function(e){var r,n;function t(r,n){var t;return(t=e.call(this,"Async Validation Error")||this).errors=r,t.fields=n,t}return n=e,(r=t).prototype=Object.create(n.prototype),r.prototype.constructor=r,ue(r,n),t}(se(Error));function ge(e,r,n,t,a){if(r.first){var i=new Promise((function(r,i){var u=function(e){var r=[];return Object.keys(e).forEach((function(n){r.push.apply(r,e[n]||[])})),r}(e);he(u,n,(function(e){return t(e),e.length?i(new me(e,de(e))):r(a)}))}));return i.catch((function(e){return e})),i}var u=!0===r.firstFields?Object.keys(e):r.firstFields||[],o=Object.keys(e),l=o.length,s=0,c=[],f=new Promise((function(r,i){var f=function(e){if(c.push.apply(c,e),++s===l)return t(c),c.length?i(new me(c,de(c))):r(a)};o.length||(t(c),r(a)),o.forEach((function(r){var t=e[r];-1!==u.indexOf(r)?he(t,n,f):function(e,r,n){var t=[],a=0,i=e.length;function u(e){t.push.apply(t,e||[]),++a===i&&n(t)}e.forEach((function(e){r(e,u)}))}(t,n,f)}))}));return f.catch((function(e){return e})),f}function ye(e,r){return function(n){var t,a;return t=e.fullFields?function(e,r){for(var n=e,t=0;t<r.length;t++){if(null==n)return n;n=n[r[t]]}return n}(r,e.fullFields):r[n.field||e.fullField],(a=n)&&void 0!==a.message?(n.field=n.field||e.fullField,n.fieldValue=t,n):{message:"function"==typeof n?n():n,fieldValue:t,field:n.field||e.fullField}}}function be(e,r){if(r)for(var n in r)if(r.hasOwnProperty(n)){var t=r[n];"object"==typeof t&&"object"==typeof e[n]?e[n]=ae({},e[n],t):e[n]=t}return e}var we,Fe=function(e,r,n,t,a,i){!e.required||n.hasOwnProperty(e.field)&&!pe(r,i||e.type)||t.push(ve(a.messages.required,e.fullField))},xe=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,qe=/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i,Oe={integer:function(e){return Oe.number(e)&&parseInt(e,10)===e},float:function(e){return Oe.number(e)&&!Oe.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch(r){return!1}},date:function(e){return"function"==typeof e.getTime&&"function"==typeof e.getMonth&&"function"==typeof e.getYear&&!isNaN(e.getTime())},number:function(e){return!isNaN(e)&&"number"==typeof e},object:function(e){return"object"==typeof e&&!Oe.array(e)},method:function(e){return"function"==typeof e},email:function(e){return"string"==typeof e&&e.length<=320&&!!e.match(xe)},url:function(e){return"string"==typeof e&&e.length<=2048&&!!e.match(function(){if(we)return we;var e="[a-fA-F\\d:]",r=function(r){return r&&r.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},n="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",t="[a-fA-F\\d]{1,4}",a=("\n(?:\n(?:"+t+":){7}(?:"+t+"|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:"+t+":){6}(?:"+n+"|:"+t+"|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:"+t+":){5}(?::"+n+"|(?::"+t+"){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:"+t+":){4}(?:(?::"+t+"){0,1}:"+n+"|(?::"+t+"){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:"+t+":){3}(?:(?::"+t+"){0,2}:"+n+"|(?::"+t+"){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:"+t+":){2}(?:(?::"+t+"){0,3}:"+n+"|(?::"+t+"){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:"+t+":){1}(?:(?::"+t+"){0,4}:"+n+"|(?::"+t+"){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::"+t+"){0,5}:"+n+"|(?::"+t+"){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n").replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),i=new RegExp("(?:^"+n+"$)|(?:^"+a+"$)"),u=new RegExp("^"+n+"$"),o=new RegExp("^"+a+"$"),l=function(e){return e&&e.exact?i:new RegExp("(?:"+r(e)+n+r(e)+")|(?:"+r(e)+a+r(e)+")","g")};l.v4=function(e){return e&&e.exact?u:new RegExp(""+r(e)+n+r(e),"g")},l.v6=function(e){return e&&e.exact?o:new RegExp(""+r(e)+a+r(e),"g")};var s=l.v4().source,c=l.v6().source;return we=new RegExp("(?:^(?:(?:(?:[a-z]+:)?//)|www\\.)(?:\\S+(?::\\S*)?@)?(?:localhost|"+s+"|"+c+'|(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:[/?#][^\\s"]*)?$)',"i")}())},hex:function(e){return"string"==typeof e&&!!e.match(qe)}},ke={required:Fe,whitespace:function(e,r,n,t,a){(/^\s+$/.test(r)||""===r)&&t.push(ve(a.messages.whitespace,e.fullField))},type:function(e,r,n,t,a){if(e.required&&void 0===r)Fe(e,r,n,t,a);else{var i=e.type;["integer","float","array","regexp","object","method","email","number","date","url","hex"].indexOf(i)>-1?Oe[i](r)||t.push(ve(a.messages.types[i],e.fullField,e.type)):i&&typeof r!==e.type&&t.push(ve(a.messages.types[i],e.fullField,e.type))}},range:function(e,r,n,t,a){var i="number"==typeof e.len,u="number"==typeof e.min,o="number"==typeof e.max,l=r,s=null,c="number"==typeof r,f="string"==typeof r,d=Array.isArray(r);if(c?s="number":f?s="string":d&&(s="array"),!s)return!1;d&&(l=r.length),f&&(l=r.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length),i?l!==e.len&&t.push(ve(a.messages[s].len,e.fullField,e.len)):u&&!o&&l<e.min?t.push(ve(a.messages[s].min,e.fullField,e.min)):o&&!u&&l>e.max?t.push(ve(a.messages[s].max,e.fullField,e.max)):u&&o&&(l<e.min||l>e.max)&&t.push(ve(a.messages[s].range,e.fullField,e.min,e.max))},enum:function(e,r,n,t,a){e.enum=Array.isArray(e.enum)?e.enum:[],-1===e.enum.indexOf(r)&&t.push(ve(a.messages.enum,e.fullField,e.enum.join(", ")))},pattern:function(e,r,n,t,a){if(e.pattern)if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(r)||t.push(ve(a.messages.pattern.mismatch,e.fullField,r,e.pattern));else if("string"==typeof e.pattern){new RegExp(e.pattern).test(r)||t.push(ve(a.messages.pattern.mismatch,e.fullField,r,e.pattern))}}},je=function(e,r,n,t,a){var i=e.type,u=[];if(e.required||!e.required&&t.hasOwnProperty(e.field)){if(pe(r,i)&&!e.required)return n();ke.required(e,r,t,u,a,i),pe(r,i)||ke.type(e,r,t,u,a)}n(u)},Ae={string:function(e,r,n,t,a){var i=[];if(e.required||!e.required&&t.hasOwnProperty(e.field)){if(pe(r,"string")&&!e.required)return n();ke.required(e,r,t,i,a,"string"),pe(r,"string")||(ke.type(e,r,t,i,a),ke.range(e,r,t,i,a),ke.pattern(e,r,t,i,a),!0===e.whitespace&&ke.whitespace(e,r,t,i,a))}n(i)},method:function(e,r,n,t,a){var i=[];if(e.required||!e.required&&t.hasOwnProperty(e.field)){if(pe(r)&&!e.required)return n();ke.required(e,r,t,i,a),void 0!==r&&ke.type(e,r,t,i,a)}n(i)},number:function(e,r,n,t,a){var i=[];if(e.required||!e.required&&t.hasOwnProperty(e.field)){if(""===r&&(r=void 0),pe(r)&&!e.required)return n();ke.required(e,r,t,i,a),void 0!==r&&(ke.type(e,r,t,i,a),ke.range(e,r,t,i,a))}n(i)},boolean:function(e,r,n,t,a){var i=[];if(e.required||!e.required&&t.hasOwnProperty(e.field)){if(pe(r)&&!e.required)return n();ke.required(e,r,t,i,a),void 0!==r&&ke.type(e,r,t,i,a)}n(i)},regexp:function(e,r,n,t,a){var i=[];if(e.required||!e.required&&t.hasOwnProperty(e.field)){if(pe(r)&&!e.required)return n();ke.required(e,r,t,i,a),pe(r)||ke.type(e,r,t,i,a)}n(i)},integer:function(e,r,n,t,a){var i=[];if(e.required||!e.required&&t.hasOwnProperty(e.field)){if(pe(r)&&!e.required)return n();ke.required(e,r,t,i,a),void 0!==r&&(ke.type(e,r,t,i,a),ke.range(e,r,t,i,a))}n(i)},float:function(e,r,n,t,a){var i=[];if(e.required||!e.required&&t.hasOwnProperty(e.field)){if(pe(r)&&!e.required)return n();ke.required(e,r,t,i,a),void 0!==r&&(ke.type(e,r,t,i,a),ke.range(e,r,t,i,a))}n(i)},array:function(e,r,n,t,a){var i=[];if(e.required||!e.required&&t.hasOwnProperty(e.field)){if(null==r&&!e.required)return n();ke.required(e,r,t,i,a,"array"),null!=r&&(ke.type(e,r,t,i,a),ke.range(e,r,t,i,a))}n(i)},object:function(e,r,n,t,a){var i=[];if(e.required||!e.required&&t.hasOwnProperty(e.field)){if(pe(r)&&!e.required)return n();ke.required(e,r,t,i,a),void 0!==r&&ke.type(e,r,t,i,a)}n(i)},enum:function(e,r,n,t,a){var i=[];if(e.required||!e.required&&t.hasOwnProperty(e.field)){if(pe(r)&&!e.required)return n();ke.required(e,r,t,i,a),void 0!==r&&ke.enum(e,r,t,i,a)}n(i)},pattern:function(e,r,n,t,a){var i=[];if(e.required||!e.required&&t.hasOwnProperty(e.field)){if(pe(r,"string")&&!e.required)return n();ke.required(e,r,t,i,a),pe(r,"string")||ke.pattern(e,r,t,i,a)}n(i)},date:function(e,r,n,t,a){var i=[];if(e.required||!e.required&&t.hasOwnProperty(e.field)){if(pe(r,"date")&&!e.required)return n();var u;if(ke.required(e,r,t,i,a),!pe(r,"date"))u=r instanceof Date?r:new Date(r),ke.type(e,u,t,i,a),u&&ke.range(e,u.getTime(),t,i,a)}n(i)},url:je,hex:je,email:je,required:function(e,r,n,t,a){var i=[],u=Array.isArray(r)?"array":typeof r;ke.required(e,r,t,i,a,u),n(i)},any:function(e,r,n,t,a){var i=[];if(e.required||!e.required&&t.hasOwnProperty(e.field)){if(pe(r)&&!e.required)return n();ke.required(e,r,t,i,a)}n(i)}};function Ee(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var Ce=Ee(),Pe=function(){function e(e){this.rules=null,this._messages=Ce,this.define(e)}var r=e.prototype;return r.define=function(e){var r=this;if(!e)throw new Error("Cannot configure a schema with no rules");if("object"!=typeof e||Array.isArray(e))throw new Error("Rules must be an object");this.rules={},Object.keys(e).forEach((function(n){var t=e[n];r.rules[n]=Array.isArray(t)?t:[t]}))},r.messages=function(e){return e&&(this._messages=be(Ee(),e)),this._messages},r.validate=function(r,n,t){var a=this;void 0===n&&(n={}),void 0===t&&(t=function(){});var i=r,u=n,o=t;if("function"==typeof u&&(o=u,u={}),!this.rules||0===Object.keys(this.rules).length)return o&&o(null,i),Promise.resolve(i);if(u.messages){var l=this.messages();l===Ce&&(l=Ee()),be(l,u.messages),u.messages=l}else u.messages=this.messages();var s={};(u.keys||Object.keys(this.rules)).forEach((function(e){var n=a.rules[e],t=i[e];n.forEach((function(n){var u=n;"function"==typeof u.transform&&(i===r&&(i=ae({},i)),t=i[e]=u.transform(t)),(u="function"==typeof u?{validator:u}:ae({},u)).validator=a.getValidationMethod(u),u.validator&&(u.field=e,u.fullField=u.fullField||e,u.type=a.getType(u),s[e]=s[e]||[],s[e].push({rule:u,value:t,source:i,field:e}))}))}));var c={};return ge(s,u,(function(r,n){var t,a=r.rule,o=!("object"!==a.type&&"array"!==a.type||"object"!=typeof a.fields&&"object"!=typeof a.defaultField);function l(e,r){return ae({},r,{fullField:a.fullField+"."+e,fullFields:a.fullFields?[].concat(a.fullFields,[e]):[e]})}function s(t){void 0===t&&(t=[]);var s=Array.isArray(t)?t:[t];!u.suppressWarning&&s.length&&e.warning("async-validator:",s),s.length&&void 0!==a.message&&(s=[].concat(a.message));var f=s.map(ye(a,i));if(u.first&&f.length)return c[a.field]=1,n(f);if(o){if(a.required&&!r.value)return void 0!==a.message?f=[].concat(a.message).map(ye(a,i)):u.error&&(f=[u.error(a,ve(u.messages.required,a.field))]),n(f);var d={};a.defaultField&&Object.keys(r.value).map((function(e){d[e]=a.defaultField})),d=ae({},d,r.rule.fields);var v={};Object.keys(d).forEach((function(e){var r=d[e],n=Array.isArray(r)?r:[r];v[e]=n.map(l.bind(null,e))}));var p=new e(v);p.messages(u.messages),r.rule.options&&(r.rule.options.messages=u.messages,r.rule.options.error=u.error),p.validate(r.value,r.rule.options||u,(function(e){var r=[];f&&f.length&&r.push.apply(r,f),e&&e.length&&r.push.apply(r,e),n(r.length?r:null)}))}else n(f)}if(o=o&&(a.required||!a.required&&r.value),a.field=r.field,a.asyncValidator)t=a.asyncValidator(a,r.value,s,r.source,u);else if(a.validator){try{t=a.validator(a,r.value,s,r.source,u)}catch(f){console.error,u.suppressValidatorError||setTimeout((function(){throw f}),0),s(f.message)}!0===t?s():!1===t?s("function"==typeof a.message?a.message(a.fullField||a.field):a.message||(a.fullField||a.field)+" fails"):t instanceof Array?s(t):t instanceof Error&&s(t.message)}t&&t.then&&t.then((function(){return s()}),(function(e){return s(e)}))}),(function(e){!function(e){for(var r,n,t=[],a={},u=0;u<e.length;u++)r=e[u],n=void 0,Array.isArray(r)?t=(n=t).concat.apply(n,r):t.push(r);t.length?(a=de(t),o(t,a)):o(null,i)}(e)}),i)},r.getType=function(e){if(void 0===e.type&&e.pattern instanceof RegExp&&(e.type="pattern"),"function"!=typeof e.validator&&e.type&&!Ae.hasOwnProperty(e.type))throw new Error(ve("Unknown rule type %s",e.type));return e.type||"string"},r.getValidationMethod=function(e){if("function"==typeof e.validator)return e.validator;var r=Object.keys(e),n=r.indexOf("message");return-1!==n&&r.splice(n,1),1===r.length&&"required"===r[0]?Ae.required:Ae[this.getType(e)]||void 0},e}();function $e(e){return null==e?[]:Array.isArray(e)?e:[e]}function Se(e,r){for(var n=e,t=0;t<r.length;t+=1){if(null==n)return;n=n[r[t]]}return n}function Me(e,a,i,u){if(!a.length)return i;var o,l=r(a),s=l[0],c=l.slice(1);return o=e||"number"!=typeof s?Array.isArray(e)?n(e):t({},e):[],u&&void 0===i&&1===c.length?delete o[s][c[0]]:o[s]=Me(o[s],c,i,u),o}function Ve(e,r,n){var t=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return r.length&&t&&void 0===n&&!Se(e,r.slice(0,-1))?e:Me(e,r,n,t)}function Re(e){return $e(e)}function Te(e){return"object"===a(e)&&null!==e&&Object.getPrototypeOf(e)===Object.prototype}function _e(e,r){var a=Array.isArray(e)?n(e):t({},e);return r?(Object.keys(r).forEach((function(e){var n=a[e],t=r[e],i=Te(n)&&Te(t);a[e]=i?_e(n,t||{}):t})),a):a}function Ie(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),t=1;t<r;t++)n[t-1]=arguments[t];return n.reduce((function(e,r){return _e(e,r)}),e)}function Be(e,r){var n={};return r.forEach((function(r){var t=function(e,r){return Se(e,r)}(e,r);n=function(e,r,n){return Ve(e,r,n,arguments.length>3&&void 0!==arguments[3]&&arguments[3])}(n,r,t)})),n}Pe.register=function(e,r){if("function"!=typeof r)throw new Error("Cannot register a validator by type, validator is not a function");Ae[e]=r},Pe.warning=fe,Pe.messages=Ce,Pe.validators=Ae;var De="'${name}' is not a valid ${type}",We={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:De,method:De,array:De,object:De,number:De,date:De,boolean:De,integer:De,float:De,regexp:De,email:De,url:De,hex:De},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},Ne=globalThis&&globalThis.__awaiter||function(e,r,n,t){return new(n||(n=Promise))((function(a,i){function u(e){try{l(t.next(e))}catch(r){i(r)}}function o(e){try{l(t.throw(e))}catch(r){i(r)}}function l(e){var r;e.done?a(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(u,o)}l((t=t.apply(e,r||[])).next())}))},ze=Pe;function Le(e,r){return e.replace(/\$\{\w+\}/g,(function(e){var n=e.slice(2,-1);return r[n]}))}function He(e,r,a,s,c){return Ne(this,void 0,void 0,i.mark((function f(){var d,v,p,h,m,g,y,b;return i.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return delete(d=t({},a)).ruleIndex,delete d.trigger,v=null,d&&"array"===d.type&&d.defaultField&&(v=d.defaultField,delete d.defaultField),p=new ze(l({},e,[d])),h=Ie({},We,s.validateMessages),p.messages(h),m=[],i.prev=9,i.next=12,Promise.resolve(p.validate(l({},e,r),t({},s)));case 12:i.next=17;break;case 14:i.prev=14,i.t0=i.catch(9),m=i.t0.errors?i.t0.errors.map((function(e,r){var n=e.message;return u(n)?o(n,{key:"error_".concat(r)}):n})):[h.default()];case 17:if(m.length||!v){i.next=22;break}return i.next=20,Promise.all(r.map((function(r,n){return He("".concat(e,".").concat(n),r,v,s,c)})));case 20:return g=i.sent,i.abrupt("return",g.reduce((function(e,r){return[].concat(n(e),n(r))}),[]));case 22:return y=t(t(t({},a),{name:e,enum:(a.enum||[]).join(", ")}),c),b=m.map((function(e){return"string"==typeof e?Le(e,y):e})),i.abrupt("return",b);case 25:case"end":return i.stop()}}),f,null,[[9,14]])})))}function Ye(e,r,a,u,o,l){var s,c=this,f=e.join("."),d=a.map((function(e,r){var n=e.validator,a=t(t({},e),{ruleIndex:r});return n&&(a.validator=function(e,r,t){var a=!1,i=n(e,r,(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];Promise.resolve().then((function(){a||t.apply(void 0,r)}))}));(a=i&&"function"==typeof i.then&&"function"==typeof i.catch)&&i.then((function(){t()})).catch((function(e){t(e||" ")}))}),a})).sort((function(e,r){var n=e.warningOnly,t=e.ruleIndex,a=r.warningOnly,i=r.ruleIndex;return!!n==!!a?t-i:n?1:-1}));if(!0===o)s=new Promise((function(e,n){return Ne(c,void 0,void 0,i.mark((function t(){var a,o,s;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=0;case 1:if(!(a<d.length)){t.next=12;break}return o=d[a],t.next=5,He(f,r,o,u,l);case 5:if(!(s=t.sent).length){t.next=9;break}return n([{errors:s,rule:o}]),t.abrupt("return");case 9:a+=1,t.next=1;break;case 12:e([]);case 13:case"end":return t.stop()}}),t)})))}));else{var v=d.map((function(e){return He(f,r,e,u,l).then((function(r){return{errors:r,rule:e}}))}));s=(o?function(e){return Ne(this,void 0,void 0,i.mark((function r(){var n;return i.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=0,r.abrupt("return",new Promise((function(r){e.forEach((function(t){t.then((function(t){t.errors.length&&r([t]),(n+=1)===e.length&&r([])}))}))})));case 2:case"end":return r.stop()}}),r)})))}(v):function(e){return Ne(this,void 0,void 0,i.mark((function r(){return i.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Promise.all(e).then((function(e){var r;return(r=[]).concat.apply(r,n(e))})));case 1:case"end":return r.stop()}}),r)})))}(v)).then((function(e){return Promise.reject(e)}))}return s.catch((function(e){return e})),s}var Je=Math.max;var Xe,Ze=(Xe=function(e,r,n){var t=null==e?0:e.length;if(!t)return-1;var a=null==n?0:te(n);return a<0&&(a=Je(t+a,0)),f(e,ne(r),a)},function(e,r,n){var t=Object(e);if(!s(e)){var a=ne(r);e=c(e),r=function(e){return a(t[e],e,t)}}var i=Xe(e,r,n);return i>-1?t[a?e[i]:i]:void 0}),Ge=Symbol("formContextKey"),Ke=function(e){d(Ge,e)},Ue=function(){return v(Ge,{name:p((function(){})),labelAlign:p((function(){return"right"})),vertical:p((function(){return!1})),addField:function(e,r){},removeField:function(e){},model:p((function(){})),rules:p((function(){})),colon:p((function(){})),labelWrap:p((function(){})),labelCol:p((function(){})),requiredMark:p((function(){return!1})),validateTrigger:p((function(){})),onValidate:function(){},validateMessages:p((function(){return We}))})},Qe=Symbol("formItemPrefixContextKey"),er=function(e,r){var n,a,i,u,o,s,c=r.slots,f=r.emit,d=r.attrs,v=t(t({},e),d),p=v.prefixCls,q=v.htmlFor,O=v.labelCol,k=v.labelAlign,j=v.colon,A=v.required,E=v.requiredMark,C=h("Form"),P=m(C,1)[0],$=null!==(a=e.label)&&void 0!==a?a:null===(i=c.label)||void 0===i?void 0:i.call(c);if(!$)return null;var S=Ue(),M=S.vertical,V=S.labelAlign,R=S.labelCol,T=S.labelWrap,_=S.colon,I=O||(null==R?void 0:R.value)||{},B=k||(null==V?void 0:V.value),D="".concat(p,"-item-label"),W=g(D,"left"===B&&"".concat(D,"-left"),I.class,l({},"".concat(D,"-wrap"),!!T.value)),N=$,z=!0===j||!1!==(null==_?void 0:_.value)&&!1!==j;z&&!M.value&&"string"==typeof $&&""!==$.trim()&&(N=$.replace(/[:|ï¼š]\s*$/,"")),N=y(b,null,[N,null===(u=c.tooltip)||void 0===u?void 0:u.call(c,{class:"".concat(p,"-item-tooltip")})]),"optional"!==E||A||(N=y(b,null,[N,y("span",{class:"".concat(p,"-item-optional")},[(null===(o=P.value)||void 0===o?void 0:o.optional)||(null===(s=w.Form)||void 0===s?void 0:s.optional)])]));var L=g((l(n={},"".concat(p,"-item-required"),A),l(n,"".concat(p,"-item-required-mark-optional"),"optional"===E),l(n,"".concat(p,"-item-no-colon"),!z),n));return y(x,F(F({},I),{},{class:W}),{default:function(){return[y("label",{for:q,class:L,title:"string"==typeof $?$:"",onClick:function(e){return f("click",e)}},[N])]}})};er.displayName="FormItemLabel",er.inheritAttrs=!1;var rr=er,nr=q({name:"ErrorList",props:["errors","help","onDomErrorVisibleChange","helpStatus","warnings"],setup:function(e){var r=O("",e).prefixCls,n=v(Qe,{prefixCls:p((function(){return""}))}),t=n.prefixCls,a=n.status,i=p((function(){return"".concat(t.value,"-item-explain")})),u=p((function(){return!(!e.errors||!e.errors.length)})),o=k(a.value);return j([u,a],(function(){u.value&&(o.value=a.value)})),function(){var n,t,a=A("".concat(r.value,"-show-help-item")),u=E("".concat(r.value,"-show-help-item"),a);return u.class=i.value,(null===(n=e.errors)||void 0===n?void 0:n.length)?y(C,F(F({},u),{},{tag:"div"}),{default:function(){return[null===(t=e.errors)||void 0===t?void 0:t.map((function(e,r){return y("div",{key:r,role:"alert",class:o.value?"".concat(i.value,"-").concat(o.value):""},[e])}))]}}):null}}}),tr={success:P,warning:$,error:S,validating:M},ar=q({slots:["help","extra","errors"],inheritAttrs:!1,props:["prefixCls","errors","hasFeedback","onDomErrorVisibleChange","wrapperCol","help","extra","status"],setup:function(e,r){var n,a=r.slots,i=Ue(),u=i.wrapperCol,o=t({},i);return delete o.labelCol,delete o.wrapperCol,Ke(o),n={prefixCls:p((function(){return e.prefixCls})),status:p((function(){return e.status}))},d(Qe,n),function(){var r,n,t,i=e.prefixCls,o=e.wrapperCol,l=e.help,s=void 0===l?null===(r=a.help)||void 0===r?void 0:r.call(a):l,c=e.errors,f=void 0===c?null===(n=a.errors)||void 0===n?void 0:n.call(a):c,d=e.hasFeedback,v=e.status,p=e.extra,h=void 0===p?null===(t=a.extra)||void 0===t?void 0:t.call(a):p,m="".concat(i,"-item"),w=o||(null==u?void 0:u.value)||{},q=g("".concat(m,"-control"),w.class),O=v&&tr[v];return y(x,F(F({},w),{},{class:q}),{default:function(){var e;return y(b,null,[y("div",{class:"".concat(m,"-control-input")},[y("div",{class:"".concat(m,"-control-input-content")},[null===(e=a.default)||void 0===e?void 0:e.call(a)]),d&&O?y("span",{class:"".concat(m,"-children-icon")},[y(O,null,null)]):null]),y(nr,{errors:f,help:s,class:"".concat(m,"-explain-connected")},null),h?y("div",{class:"".concat(m,"-extra")},[h]):null])}})}}});function ir(e,r,n){var t=e,a=r,i=0;try{for(var u=a.length;i<u-1&&(t||n);++i){var o=a[i];if(!(o in t)){if(n)throw Error("please transfer a valid name path to form item!");break}t=t[o]}if(n&&!t)throw Error("please transfer a valid name path to form item!")}catch(l){}return{o:t,k:a[i],v:t?t[a[i]]:void 0}}N("success","warning","error","validating","");var ur=0,or=q({name:"AFormItem",inheritAttrs:!1,__ANT_NEW_FORM_ITEM:!0,props:{htmlFor:String,prefixCls:String,label:z.any,help:z.any,extra:z.any,labelCol:{type:Object},wrapperCol:{type:Object},hasFeedback:{type:Boolean,default:!1},colon:{type:Boolean,default:void 0},labelAlign:z.oneOf(N("left","right")),prop:{type:[String,Number,Array]},name:{type:[String,Number,Array]},rules:[Array,Object],autoLink:{type:Boolean,default:!0},required:{type:Boolean,default:void 0},validateFirst:{type:Boolean,default:void 0},validateStatus:z.oneOf(N("","success","warning","error","validating")),validateTrigger:{type:[String,Array]},messageVariables:{type:Object},hidden:Boolean,noStyle:Boolean},slots:["help","label","extra"],setup:function(e,r){var n=r.slots,a=r.attrs,i=r.expose;T(void 0===e.prop);var u="form-item-".concat(++ur),o=O("form",e).prefixCls,s=Ue(),c=p((function(){return e.name||e.prop})),f=k([]),d=k(!1),v=k(),h=p((function(){return Re(c.value)})),m=p((function(){if(h.value.length){var e=s.name.value,r=h.value.join("_");return e?"".concat(e,"_").concat(r):"".concat("form_item","_").concat(r)}})),g=p((function(){return(e=s.model.value)&&c.value?ir(e,h.value,!0).v:void 0;var e})),w=k(_(g.value)),x=p((function(){var r=void 0!==e.validateTrigger?e.validateTrigger:s.validateTrigger.value;return $e(r=void 0===r?"change":r)})),q=p((function(){var r=s.rules.value,n=e.rules,t=void 0!==e.required?{required:!!e.required,trigger:x.value}:[],a=ir(r,h.value);r=r?a.o[a.k]||a.v:[];var i=[].concat(n||r||[]);return Ze(i,(function(e){return e.required}))?i:i.concat(t)})),A=p((function(){var r=q.value,n=!1;return r&&r.length&&r.every((function(e){return!e.required||(n=!0,!1)})),n||e.required})),E=k();R((function(){E.value=e.validateStatus}));var C=p((function(){var r={};return"string"==typeof e.label?r.label=e.label:e.name&&(r.label=String(name)),e.messageVariables&&(r=t(t({},r),e.messageVariables)),r})),P=function(r){if(0!==h.value.length){var n=e.validateFirst,a=void 0!==n&&n,i=(r||{}).triggerName,u=q.value;if(i&&(u=u.filter((function(e){var r=e.trigger;return!r&&!x.value.length||$e(r||x.value).includes(i)}))),!u.length)return Promise.resolve();var o=Ye(h.value,g.value,u,t({validateMessages:s.validateMessages.value},r),a,C.value);return E.value="validating",f.value=[],o.catch((function(e){return e})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if("validating"===E.value){var r=e.filter((function(e){return e&&e.errors.length}));E.value=r.length?"error":"success",f.value=r.map((function(e){return e.errors})),s.onValidate(c.value,!f.value.length,f.value.length?L(f.value[0]):null)}})),o}},$=function(){P({triggerName:"blur"})},S=function(){d.value?d.value=!1:P({triggerName:"change"})},M=function(){E.value=e.validateStatus,d.value=!1,f.value=[]},N=function(){E.value=e.validateStatus,d.value=!0,f.value=[];var r=s.model.value||{},n=g.value,t=ir(r,h.value,!0);Array.isArray(n)?t.o[t.k]=[].concat(w.value):t.o[t.k]=w.value,H((function(){d.value=!1}))},z=p((function(){return void 0===e.htmlFor?m.value:e.htmlFor})),Y=function(){var e=z.value;if(e&&v.value){var r=v.value.$el.querySelector('[id="'.concat(e,'"]'));r&&r.focus&&r.focus()}};i({onFieldBlur:$,onFieldChange:S,clearValidate:M,resetField:N}),I({id:m,onFieldBlur:function(){e.autoLink&&$()},onFieldChange:function(){e.autoLink&&S()},clearValidate:M},p((function(){return!!(e.autoLink&&s.model.value&&c.value)})));var J=!1;j(c,(function(e){e?J||(J=!0,s.addField(u,{fieldValue:g,fieldId:m,fieldName:c,resetField:N,clearValidate:M,namePath:h,validateRules:P,rules:q})):(J=!1,s.removeField(u))}),{immediate:!0}),B((function(){s.removeField(u)}));var X,Z,G,K=(Z=V((X=f).value.slice()),G=null,R((function(){clearTimeout(G),G=setTimeout((function(){Z.value=X.value}),X.value.length?0:10)})),Z),U=p((function(){return void 0!==e.validateStatus?e.validateStatus:K.value.length?"error":E.value})),Q=p((function(){var r;return l(r={},"".concat(o.value,"-item"),!0),l(r,"".concat(o.value,"-item-has-feedback"),U.value&&e.hasFeedback),l(r,"".concat(o.value,"-item-has-success"),"success"===U.value),l(r,"".concat(o.value,"-item-has-warning"),"warning"===U.value),l(r,"".concat(o.value,"-item-has-error"),"error"===U.value),l(r,"".concat(o.value,"-item-is-validating"),"validating"===U.value),l(r,"".concat(o.value,"-item-hidden"),e.hidden),r}));return function(){var r,t;if(e.noStyle)return null===(r=n.default)||void 0===r?void 0:r.call(n);var i=null!==(t=e.help)&&void 0!==t?t:n.help?D(n.help()):null;return y(W,F(F({},a),{},{class:[Q.value,null!=i||K.value.length?"".concat(o.value,"-item-with-help"):"",a.class],key:"row"}),{default:function(){var r,t,a,u;return y(b,null,[y(rr,F(F({},e),{},{htmlFor:z.value,required:A.value,requiredMark:s.requiredMark.value,prefixCls:o.value,onClick:Y,label:null!==(r=e.label)&&void 0!==r?r:null===(t=n.label)||void 0===t?void 0:t.call(n)}),null),y(ar,F(F({},e),{},{errors:null!=i?$e(i):K.value,prefixCls:o.value,status:U.value,ref:v,help:i,extra:null!==(a=e.extra)&&void 0!==a?a:null===(u=n.extra)||void 0===u?void 0:u.call(n)}),{default:n.default})])}})}}});function lr(e){var r=!1,n=e.length,t=[];return e.length?new Promise((function(a,i){e.forEach((function(e,u){e.catch((function(e){return r=!0,e})).then((function(e){n-=1,t[u]=e,n>0||(r&&i(t),a(t))}))}))})):Promise.resolve([])}function sr(e){return"object"==typeof e&&null!=e&&1===e.nodeType}function cr(e,r){return(!r||"hidden"!==e)&&"visible"!==e&&"clip"!==e}function fr(e,r){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){var n=getComputedStyle(e,null);return cr(n.overflowY,r)||cr(n.overflowX,r)||!!(a=function(e){if(!e.ownerDocument||!e.ownerDocument.defaultView)return null;try{return e.ownerDocument.defaultView.frameElement}catch(r){return null}}(t=e))&&(a.clientHeight<t.scrollHeight||a.clientWidth<t.scrollWidth)}var t,a;return!1}function dr(e,r,n,t,a,i,u,o){return i<e&&u>r||i>e&&u<r?0:i<=e&&o<=n||u>=r&&o>=n?i-e-t:u>r&&o<n||i<e&&o>n?u-r+a:0}function vr(e,r){var n=window,t=r.scrollMode,a=r.block,i=r.inline,u=r.boundary,o=r.skipOverflowHiddenElements,l="function"==typeof u?u:function(e){return e!==u};if(!sr(e))throw new TypeError("Invalid target");for(var s=document.scrollingElement||document.documentElement,c=[],f=e;sr(f)&&l(f);){if((f=f.parentElement)===s){c.push(f);break}null!=f&&f===document.body&&fr(f)&&!fr(document.documentElement)||null!=f&&fr(f,o)&&c.push(f)}for(var d=n.visualViewport?n.visualViewport.width:innerWidth,v=n.visualViewport?n.visualViewport.height:innerHeight,p=window.scrollX||pageXOffset,h=window.scrollY||pageYOffset,m=e.getBoundingClientRect(),g=m.height,y=m.width,b=m.top,w=m.right,F=m.bottom,x=m.left,q="start"===a||"nearest"===a?b:"end"===a?F:b+g/2,O="center"===i?x+y/2:"end"===i?w:x,k=[],j=0;j<c.length;j++){var A=c[j],E=A.getBoundingClientRect(),C=E.height,P=E.width,$=E.top,S=E.right,M=E.bottom,V=E.left;if("if-needed"===t&&b>=0&&x>=0&&F<=v&&w<=d&&b>=$&&F<=M&&x>=V&&w<=S)return k;var R=getComputedStyle(A),T=parseInt(R.borderLeftWidth,10),_=parseInt(R.borderTopWidth,10),I=parseInt(R.borderRightWidth,10),B=parseInt(R.borderBottomWidth,10),D=0,W=0,N="offsetWidth"in A?A.offsetWidth-A.clientWidth-T-I:0,z="offsetHeight"in A?A.offsetHeight-A.clientHeight-_-B:0;if(s===A)D="start"===a?q:"end"===a?q-v:"nearest"===a?dr(h,h+v,v,_,B,h+q,h+q+g,g):q-v/2,W="start"===i?O:"center"===i?O-d/2:"end"===i?O-d:dr(p,p+d,d,T,I,p+O,p+O+y,y),D=Math.max(0,D+h),W=Math.max(0,W+p);else{D="start"===a?q-$-_:"end"===a?q-M+B+z:"nearest"===a?dr($,M,C,_,B+z,q,q+g,g):q-($+C/2)+z/2,W="start"===i?O-V-T:"center"===i?O-(V+P/2)+N/2:"end"===i?O-S+I+N:dr(V,S,P,T,I+N,O,O+y,y);var L=A.scrollLeft,H=A.scrollTop;q+=H-(D=Math.max(0,Math.min(H+D,A.scrollHeight-C+z))),O+=L-(W=Math.max(0,Math.min(L+W,A.scrollWidth-P+N)))}k.push({el:A,top:D,left:W})}return k}function pr(e){return e===Object(e)&&0!==Object.keys(e).length}function hr(e,r){var n=e.isConnected||e.ownerDocument.documentElement.contains(e);if(pr(r)&&"function"==typeof r.behavior)return r.behavior(n?vr(e,r):[]);if(n){var t=function(e){return!1===e?{block:"end",inline:"nearest"}:pr(e)?e:{block:"start",inline:"nearest"}}(r);return function(e,r){void 0===r&&(r="auto");var n="scrollBehavior"in document.body.style;e.forEach((function(e){var t=e.el,a=e.top,i=e.left;t.scroll&&n?t.scroll({top:a,left:i,behavior:r}):(t.scrollTop=a,t.scrollLeft=i)}))}(vr(e,t),t.behavior)}}function mr(e){var r=!1;return e&&e.length&&e.every((function(e){return!e.required||(r=!0,!1)})),r}function gr(e){return null==e?[]:Array.isArray(e)?e:[e]}function yr(e,r,n){for(var t=e,a=(r=(r=r.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),i=0,u=a.length;i<u-1&&(t||n);++i){var o=a[i];if(!(o in t)){if(n)throw new Error("please transfer a valid name path to validate!");break}t=t[o]}return{o:t,k:a[i],v:t?t[a[i]]:null,isValid:t&&a[i]in t}}var br=q({name:"AForm",inheritAttrs:!1,props:U({layout:z.oneOf(N("horizontal","inline","vertical")),labelCol:{type:Object},wrapperCol:{type:Object},colon:{type:Boolean,default:void 0},labelAlign:z.oneOf(N("left","right")),labelWrap:{type:Boolean,default:void 0},prefixCls:String,requiredMark:{type:[String,Boolean],default:void 0},hideRequiredMark:{type:Boolean,default:void 0},model:z.object,rules:{type:Object},validateMessages:{type:Object,default:void 0},validateOnRuleChange:{type:Boolean,default:void 0},scrollToFirstError:{type:[Boolean,Object]},onSubmit:Function,name:String,validateTrigger:{type:[String,Array]},size:{type:String},onValuesChange:{type:Function},onFieldsChange:{type:Function},onFinish:{type:Function},onFinishFailed:{type:Function},onValidate:{type:Function}},{layout:"horizontal",hideRequiredMark:!1,colon:!0}),Item:or,useForm:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k({}),a=arguments.length>2?arguments[2]:void 0,i=_(Y(e)),u=J({}),o=V([]),l=function(n){t(Y(e),t(t({},_(i)),n)),H((function(){Object.keys(u).forEach((function(e){u[e]={autoLink:!1,required:mr(Y(r)[e])}}))}))},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0;return r.length?e.filter((function(e){var n=gr(e.trigger||"change");return K(n,r).length})):e},c=null,f=function(t){for(var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,u=[],o={},l=function(l){var c=t[l],f=yr(Y(e),c,i);if(!f.isValid)return"continue";o[c]=f.v;var v=s(Y(r)[c],gr(a&&a.trigger));v.length&&u.push(d(c,f.v,v,a||{}).then((function(){return{name:c,errors:[],warnings:[]}})).catch((function(e){var r=[],t=[];return e.forEach((function(e){var a=e.rule.warningOnly,i=e.errors;a?t.push.apply(t,n(i)):r.push.apply(r,n(i))})),r.length?Promise.reject({name:c,errors:r,warnings:t}):{name:c,errors:r,warnings:t}})))},f=0;f<t.length;f++)l(f);var v=lr(u);c=v;var p=v.then((function(){return c===v?Promise.resolve(o):Promise.reject([])})).catch((function(e){var r=e.filter((function(e){return e&&e.errors.length}));return Promise.reject({values:o,errorFields:r,outOfDate:c!==v})}));return p.catch((function(e){return e})),p},d=function(e,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=Ye([e],r,n,t({validateMessages:We},i),!!i.validateFirst);return u[e]?(u[e].validateStatus="validating",o.catch((function(e){return e})).then((function(){var r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if("validating"===u[e].validateStatus){var t=n.filter((function(e){return e&&e.errors.length}));u[e].validateStatus=t.length?"error":"success",u[e].help=t.length?t.map((function(e){return e.errors})):null,null===(r=null==a?void 0:a.onValidate)||void 0===r||r.call(a,e,!t.length,t.length?L(u[e].help[0]):null)}})),o):o.catch((function(e){return e}))},v=function(e,r){var n=[],t=!0;e?n=Array.isArray(e)?e:[e]:(t=!1,n=o.value);var a=f(n,r||{},t);return a.catch((function(e){return e})),a},p=function(e){(e?Array.isArray(e)?e:[e]:o.value).forEach((function(e){u[e]&&t(u[e],{validateStatus:"",help:null})}))},h=function(e){for(var r={autoLink:!1},n=[],t=Array.isArray(e)?e:[e],a=0;a<t.length;a++){var i=t[a];"error"===(null==i?void 0:i.validateStatus)&&(r.validateStatus="error",i.help&&n.push(i.help)),r.required=r.required||(null==i?void 0:i.required)}return r.help=n,r},m=i,g=!0,y=function(e){var r=[];o.value.forEach((function(n){var t=yr(e,n,!1),i=yr(m,n,!1);!(g&&(null==a?void 0:a.immediate)&&t.isValid)&&G(t.v,i.v)||r.push(n)})),v(r,{trigger:"change"}),g=!1,m=_(L(e))},b=null==a?void 0:a.debounce,w=!0;return j(r,(function(){o.value=r?Object.keys(Y(r)):[],!w&&a&&a.validateOnRuleChange&&v(),w=!1}),{deep:!0,immediate:!0}),j(o,(function(){var e={};for(var n in o.value.forEach((function(n){e[n]=t({},u[n],{autoLink:!1,required:mr(Y(r)[n])}),delete u[n]})),u)Object.prototype.hasOwnProperty.call(u,n)&&delete u[n];t(u,e)}),{immediate:!0}),j(e,b&&b.wait?X(y,b.wait,Z(b,["wait"])):y,{immediate:a&&!!a.immediate,deep:!0}),{modelRef:e,rulesRef:r,initialModel:i,validateInfos:u,resetFields:l,validate:v,validateField:d,mergeValidateInfo:h,clearValidate:p}},setup:function(e,r){var i=r.emit,u=r.slots,o=r.expose,s=r.attrs,c=Q(e),f=O("form",e),d=f.prefixCls,v=f.direction,h=f.form,m=p((function(){return""===e.requiredMark||e.requiredMark})),b=p((function(){var r;return void 0!==m.value?m.value:h&&void 0!==(null===(r=h.value)||void 0===r?void 0:r.requiredMark)?h.value.requiredMark:!e.hideRequiredMark})),w=p((function(){var r,n;return null!==(r=e.colon)&&void 0!==r?r:null===(n=h.value)||void 0===n?void 0:n.colon})),x=ee().validateMessages,q=p((function(){return t(t(t({},We),x.value),e.validateMessages)})),A=p((function(){var r;return g(d.value,(l(r={},"".concat(d.value,"-").concat(e.layout),!0),l(r,"".concat(d.value,"-hide-required-mark"),!1===b.value),l(r,"".concat(d.value,"-rtl"),"rtl"===v.value),l(r,"".concat(d.value,"-").concat(c.value),c.value),r))})),E=k(),C={},P=function(e){var r=!!e,n=r?$e(e).map(Re):[];return r?Object.values(C).filter((function(e){return n.findIndex((function(r){return n=r,t=e.fieldName.value,G($e(n),$e(t));var n,t}))>-1})):Object.values(C)},$=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=P(e?[e]:void 0);if(n.length){var a=n[0].fieldId.value,i=a?document.getElementById(a):null;i&&hr(i,t({scrollMode:"if-needed",block:"nearest"},r))}},S=function(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===r){var n=[];return Object.values(C).forEach((function(e){var r=e.namePath;n.push(r.value)})),Be(e.model,n)}return Be(e.model,r)},M=function(r,a){if(re(!(r instanceof Function),"Form","validateFields/validateField/validate not support callback, please use promise instead"),!e.model)return re(!1,"Form","model is required for validateFields to work."),Promise.reject("Form `model` is required for validateFields to work.");var i=!!r,u=i?$e(r).map(Re):[],o=[];Object.values(C).forEach((function(e){var r;if(i||u.push(e.namePath.value),null===(r=e.rules)||void 0===r?void 0:r.value.length){var l=e.namePath.value;if(!i||function(e,r){return e&&e.some((function(e){return function(e,r){return!(!e||!r||e.length!==r.length)&&e.every((function(e,n){return r[n]===e}))}(e,r)}))}(u,l)){var s=e.validateRules(t({validateMessages:q.value},a));o.push(s.then((function(){return{name:l,errors:[],warnings:[]}})).catch((function(e){var r=[],t=[];return e.forEach((function(e){var a=e.rule.warningOnly,i=e.errors;a?t.push.apply(t,n(i)):r.push.apply(r,n(i))})),r.length?Promise.reject({name:l,errors:r,warnings:t}):{name:l,errors:r,warnings:t}})))}}}));var l=lr(o);E.value=l;var s=l.then((function(){return E.value===l?Promise.resolve(S(u)):Promise.reject([])})).catch((function(e){var r=e.filter((function(e){return e&&e.errors.length}));return Promise.reject({values:S(u),errorFields:r,outOfDate:E.value!==l})}));return s.catch((function(e){return e})),s},V=function(){return M.apply(void 0,arguments)},R=function(r){(r.preventDefault(),r.stopPropagation(),i("submit",r),e.model)&&M().then((function(e){i("finish",e)})).catch((function(r){!function(r){var n=e.scrollToFirstError;if(i("finishFailed",r),n&&r.errorFields.length){var t={};"object"===a(n)&&(t=n),$(r.errorFields[0].name,t)}}(r)}))};return o({resetFields:function(r){e.model?P(r).forEach((function(e){e.resetField()})):re(!1,"Form","model is required for resetFields to work.")},clearValidate:function(e){P(e).forEach((function(e){e.clearValidate()}))},validateFields:M,getFieldsValue:S,validate:function(){return V.apply(void 0,arguments)},scrollToField:$}),Ke({model:p((function(){return e.model})),name:p((function(){return e.name})),labelAlign:p((function(){return e.labelAlign})),labelCol:p((function(){return e.labelCol})),labelWrap:p((function(){return e.labelWrap})),wrapperCol:p((function(){return e.wrapperCol})),vertical:p((function(){return"vertical"===e.layout})),colon:w,requiredMark:b,validateTrigger:p((function(){return e.validateTrigger})),rules:p((function(){return e.rules})),addField:function(e,r){C[e]=r},removeField:function(e){delete C[e]},onValidate:function(e,r,n){i("validate",e,r,n)},validateMessages:q}),j((function(){return e.rules}),(function(){e.validateOnRuleChange&&M()})),function(){var e;return y("form",F(F({},s),{},{onSubmit:R,class:[A.value,s.class]}),[null===(e=u.default)||void 0===e?void 0:e.call(u)])}}});export{br as F};
