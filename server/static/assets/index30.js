var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value,__spreadValues=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a};import{j as createVNode,I as Icon,bX as withInstall,d as defineComponent,bP as useConfigInject,r as ref,fu as useDestroyed,A as computed,bW as flattenChildren,b_ as classNames,bQ as _defineProperty$1,fv as ResizeObserver,c1 as PropTypes,fw as Avatar,cA as filterEmpty,fx as isEmptyContent,d9 as LocaleReceiver,z as useDesign,ac as useMenuSetting,b as _export_sfc,o as openBlock,e as createElementBlock,E as createBaseVNode,ar as renderSlot,C as normalizeClass,Y as normalizeStyle,n as nextTick,w as watch,D as unref,fy as getViewportOffset,fz as isRef,bF as isString,bi as isNumber,p as propTypes,J as provide,br as omit,c as resolveComponent,h as createBlock,b0 as createSlots,f as renderList,i as withCtx,a2 as normalizeProps,a3 as guardReactiveProps,F as Fragment,k as createTextVNode,m as toDisplayString,H as mergeProps,B as createCommentVNode,bj as withInstall$1}from"./index.js";import{B as Breadcrumb}from"./index32.js";import{o as onMountedOrActivated}from"./onMountedOrActivated.js";import{u as useWindowSizeFn}from"./useWindowSizeFn.js";import{a as useLayoutHeight}from"./useContentViewHeight.js";import{A as ArrowLeftOutlined}from"./ArrowLeftOutlined.js";import{T as TransButton}from"./transButton.js";var ArrowRightOutlined$1={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-.7 5.2-2L869 536.2a32.07 32.07 0 000-48.4z"}}]},name:"arrow-right",theme:"outlined"};function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?Object(arguments[i]):{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){_defineProperty(target,key,source[key])}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var ArrowRightOutlined=function(props,context){var p=_objectSpread({},props,context.attrs);return createVNode(Icon,_objectSpread({},p,{icon:ArrowRightOutlined$1}),null)};ArrowRightOutlined.displayName="ArrowRightOutlined",ArrowRightOutlined.inheritAttrs=!1;const PageHeader$1=withInstall(defineComponent({compatConfig:{MODE:3},name:"APageHeader",props:{backIcon:PropTypes.any,prefixCls:String,title:PropTypes.any,subTitle:PropTypes.any,breadcrumb:PropTypes.object,tags:PropTypes.any,footer:PropTypes.any,extra:PropTypes.any,avatar:PropTypes.object,ghost:{type:Boolean,default:void 0},onBack:Function},slots:["backIcon","avatar","breadcrumb","title","subTitle","tags","extra","footer"],setup:function(props,_ref){var emit=_ref.emit,slots=_ref.slots,_useConfigInject=useConfigInject("page-header",props),prefixCls=_useConfigInject.prefixCls,direction=_useConfigInject.direction,pageHeader=_useConfigInject.pageHeader,compact=ref(!1),isDestroyed=useDestroyed(),onResize=function(_ref2){var width=_ref2.width;isDestroyed.value||(compact.value=width<768)},ghost=computed((function(){var _ref3,_props$ghost,_pageHeader$value;return null===(_ref3=null!==(_props$ghost=props.ghost)&&void 0!==_props$ghost?_props$ghost:null===(_pageHeader$value=pageHeader.value)||void 0===_pageHeader$value?void 0:_pageHeader$value.ghost)||void 0===_ref3||_ref3})),renderTitle=function(){var _props$title,_slots$title,_props$subTitle,_slots$subTitle,_props$tags,_slots$tags,_props$extra,_slots$extra,_slots$avatar,avatar=props.avatar,title=null!==(_props$title=props.title)&&void 0!==_props$title?_props$title:null===(_slots$title=slots.title)||void 0===_slots$title?void 0:_slots$title.call(slots),subTitle=null!==(_props$subTitle=props.subTitle)&&void 0!==_props$subTitle?_props$subTitle:null===(_slots$subTitle=slots.subTitle)||void 0===_slots$subTitle?void 0:_slots$subTitle.call(slots),tags=null!==(_props$tags=props.tags)&&void 0!==_props$tags?_props$tags:null===(_slots$tags=slots.tags)||void 0===_slots$tags?void 0:_slots$tags.call(slots),extra=null!==(_props$extra=props.extra)&&void 0!==_props$extra?_props$extra:null===(_slots$extra=slots.extra)||void 0===_slots$extra?void 0:_slots$extra.call(slots),headingPrefixCls="".concat(prefixCls.value,"-heading"),hasHeading=title||subTitle||tags||extra;if(!hasHeading)return null;var _ref4,_props$backIcon,_slots$backIcon,backIconDom=function(backIcon){return backIcon&&props.onBack?createVNode(LocaleReceiver,{componentName:"PageHeader",children:function(_ref5){var back=_ref5.back;return createVNode("div",{class:"".concat(prefixCls.value,"-back")},[createVNode(TransButton,{onClick:function(e){emit("back",e)},class:"".concat(prefixCls.value,"-back-button"),"aria-label":back},{default:function(){return[backIcon]}})])}},null):null}(null!==(_ref4=null!==(_props$backIcon=props.backIcon)&&void 0!==_props$backIcon?_props$backIcon:null===(_slots$backIcon=slots.backIcon)||void 0===_slots$backIcon?void 0:_slots$backIcon.call(slots))&&void 0!==_ref4?_ref4:"rtl"===direction.value?createVNode(ArrowRightOutlined,null,null):createVNode(ArrowLeftOutlined,null,null));return createVNode("div",{class:headingPrefixCls},[(backIconDom||avatar||hasHeading)&&createVNode("div",{class:"".concat(headingPrefixCls,"-left")},[backIconDom,avatar?createVNode(Avatar,avatar,null):null===(_slots$avatar=slots.avatar)||void 0===_slots$avatar?void 0:_slots$avatar.call(slots),title&&createVNode("span",{class:"".concat(headingPrefixCls,"-title"),title:"string"==typeof title?title:void 0},[title]),subTitle&&createVNode("span",{class:"".concat(headingPrefixCls,"-sub-title"),title:"string"==typeof subTitle?subTitle:void 0},[subTitle]),tags&&createVNode("span",{class:"".concat(headingPrefixCls,"-tags")},[tags])]),extra&&createVNode("span",{class:"".concat(headingPrefixCls,"-extra")},[extra])])},renderChildren=function(children){return createVNode("div",{class:"".concat(prefixCls.value,"-content")},[children])};return function(){var _props$breadcrumb,_slots$default,_classNames,hasBreadcrumb=(null===(_props$breadcrumb=props.breadcrumb)||void 0===_props$breadcrumb?void 0:_props$breadcrumb.routes)||slots.breadcrumb,hasFooter=props.footer||slots.footer,children=flattenChildren(null===(_slots$default=slots.default)||void 0===_slots$default?void 0:_slots$default.call(slots)),className=classNames(prefixCls.value,(_defineProperty$1(_classNames={"has-breadcrumb":hasBreadcrumb,"has-footer":hasFooter},"".concat(prefixCls.value,"-ghost"),ghost.value),_defineProperty$1(_classNames,"".concat(prefixCls.value,"-rtl"),"rtl"===direction.value),_defineProperty$1(_classNames,"".concat(prefixCls.value,"-compact"),compact.value),_classNames));return createVNode(ResizeObserver,{onResize:onResize},{default:function(){return[createVNode("div",{class:className},[props.breadcrumb?createVNode(Breadcrumb,props.breadcrumb,null):null===(_slots$breadcrumb=slots.breadcrumb)||void 0===_slots$breadcrumb?void 0:_slots$breadcrumb.call(slots),renderTitle(),children.length?renderChildren(children):null,(footer=null!==(_props$footer=props.footer)&&void 0!==_props$footer?_props$footer:filterEmpty(null===(_slots$footer=slots.footer)||void 0===_slots$footer?void 0:_slots$footer.call(slots)),isEmptyContent(footer)?null:createVNode("div",{class:"".concat(prefixCls.value,"-footer")},[footer]))])];var _props$footer,_slots$footer,footer,_slots$breadcrumb}})}}}));const pageFooter=_export_sfc(defineComponent({name:"PageFooter",inheritAttrs:!1,setup(){const{prefixCls:prefixCls}=useDesign("page-footer"),{getCalcContentWidth:getCalcContentWidth}=useMenuSetting();return{prefixCls:prefixCls,getCalcContentWidth:getCalcContentWidth}}}),[["render",function(_ctx,_cache,$props,$setup,$data,$options){return openBlock(),createElementBlock("div",{class:normalizeClass(_ctx.prefixCls),style:normalizeStyle({width:_ctx.getCalcContentWidth})},[createBaseVNode("div",{class:normalizeClass(`${_ctx.prefixCls}__left`)},[renderSlot(_ctx.$slots,"left",{},void 0,!0)],2),renderSlot(_ctx.$slots,"default",{},void 0,!0),createBaseVNode("div",{class:normalizeClass(`${_ctx.prefixCls}__right`)},[renderSlot(_ctx.$slots,"right",{},void 0,!0)],2)],6)}],["__scopeId","data-v-482361d0"]]);function useContentHeight(flag,anchorRef,subtractHeightRefs,substractSpaceRefs,upwardSpace=0,offsetHeightRef=ref(0)){const contentHeight=ref(null),{footerHeightRef:layoutFooterHeightRef}=useLayoutHeight();let compensationHeight={useLayoutFooter:!0};function calcSubtractSpace(element,direction="all"){var _a,_b,_c,_d;function numberPx(px){return Number(px.replace(/[^\d]/g,""))}let subtractHeight=0;if(element){const cssStyle=getComputedStyle(element),marginTop=numberPx(null!=(_a=null==cssStyle?void 0:cssStyle.marginTop)?_a:"0px"),marginBottom=numberPx(null!=(_b=null==cssStyle?void 0:cssStyle.marginBottom)?_b:"0px"),paddingTop=numberPx(null!=(_c=null==cssStyle?void 0:cssStyle.paddingTop)?_c:"0px"),paddingBottom=numberPx(null!=(_d=null==cssStyle?void 0:cssStyle.paddingBottom)?_d:"0px");"all"===direction?(subtractHeight+=marginTop,subtractHeight+=marginBottom,subtractHeight+=paddingTop,subtractHeight+=paddingBottom):"top"===direction?(subtractHeight+=marginTop,subtractHeight+=paddingTop):(subtractHeight+=marginBottom,subtractHeight+=paddingBottom)}return subtractHeight}function getEl(element){return null==element?null:element instanceof HTMLDivElement?element:element.$el}function calcContentHeight(){return __this=this,__arguments=null,generator=function*(){var _a;if(!flag.value)return;yield nextTick();const anchorEl=getEl(unref(anchorRef));if(!anchorEl)return;const{bottomIncludeBody:bottomIncludeBody}=getViewportOffset(anchorEl);let substractHeight=0;subtractHeightRefs.forEach((item=>{var _a2,_b;substractHeight+=null!=(_b=null==(_a2=getEl(unref(item)))?void 0:_a2.offsetHeight)?_b:0}));let substractSpaceHeight=null!=(_a=calcSubtractSpace(anchorEl))?_a:0;substractSpaceRefs.forEach((item=>{substractSpaceHeight+=calcSubtractSpace(getEl(unref(item)))}));let upwardSpaceHeight=0;function upward(element,upwardLvlOrClass){if(element&&upwardLvlOrClass){const parent=element.parentElement;parent&&(isString(upwardLvlOrClass)?parent.classList.contains(upwardLvlOrClass)?upwardSpaceHeight+=calcSubtractSpace(parent,"bottom"):(upwardSpaceHeight+=calcSubtractSpace(parent,"bottom"),upward(parent,upwardLvlOrClass)):isNumber(upwardLvlOrClass)&&upwardLvlOrClass>0&&(upwardSpaceHeight+=calcSubtractSpace(parent,"bottom"),upward(parent,--upwardLvlOrClass)))}}isRef(upwardSpace)?upward(anchorEl,unref(upwardSpace)):upward(anchorEl,upwardSpace);let height=bottomIncludeBody-unref(layoutFooterHeightRef)-unref(offsetHeightRef)-substractHeight-substractSpaceHeight-upwardSpaceHeight;const calcCompensationHeight=()=>{var _a2;null==(_a2=compensationHeight.elements)||_a2.forEach((item=>{var _a3,_b;height+=null!=(_b=null==(_a3=getEl(unref(item)))?void 0:_a3.offsetHeight)?_b:0}))};compensationHeight.useLayoutFooter&&unref(layoutFooterHeightRef),calcCompensationHeight(),contentHeight.value=height},new Promise(((resolve,reject)=>{var fulfilled=value=>{try{step(generator.next(value))}catch(e){reject(e)}},rejected=value=>{try{step(generator.throw(value))}catch(e){reject(e)}},step=x=>x.done?resolve(x.value):Promise.resolve(x.value).then(fulfilled,rejected);step((generator=generator.apply(__this,__arguments)).next())}));var __this,__arguments,generator}return onMountedOrActivated((()=>{nextTick((()=>{calcContentHeight()}))})),useWindowSizeFn((()=>{calcContentHeight()}),50,{immediate:!0}),watch((()=>[layoutFooterHeightRef.value]),(()=>{calcContentHeight()}),{flush:"post",immediate:!0}),{redoHeight:function(){nextTick((()=>{calcContentHeight()}))},setCompensation:params=>{compensationHeight=params},contentHeight:contentHeight}}const pageWrapper=_export_sfc(defineComponent({name:"PageWrapper",components:{PageFooter:pageFooter,PageHeader:PageHeader$1},inheritAttrs:!1,props:{title:propTypes.string,dense:propTypes.bool,ghost:propTypes.bool,content:propTypes.string,contentStyle:{type:Object},contentBackground:propTypes.bool,contentFullHeight:propTypes.bool,contentClass:propTypes.string,fixedHeight:propTypes.bool,upwardSpace:propTypes.oneOfType([propTypes.number,propTypes.string]).def(0),loading:propTypes.bool,sticky:propTypes.bool,stickyTop:propTypes.string},setup(props,{slots:slots,attrs:attrs}){const wrapperRef=ref(null),headerRef=ref(null),contentRef=ref(null),footerRef=ref(null),{prefixCls:prefixCls}=useDesign("page-wrapper");provide(PageWrapperFixedHeightKey,computed((()=>props.fixedHeight)));const getIsContentFullHeight=computed((()=>props.contentFullHeight)),getUpwardSpace=computed((()=>props.upwardSpace)),{redoHeight:redoHeight,setCompensation:setCompensation,contentHeight:contentHeight}=useContentHeight(getIsContentFullHeight,wrapperRef,[headerRef,footerRef],[contentRef],getUpwardSpace);setCompensation({useLayoutFooter:!0,elements:[footerRef]});const getClass=computed((()=>{var _a;return[prefixCls,{[`${prefixCls}--dense`]:props.dense},null!=(_a=attrs.class)?_a:{}]})),getShowHeader=computed((()=>props.content||(null==slots?void 0:slots.headerContent)||props.title||getHeaderSlots.value.length)),getHeaderStyle=computed((()=>{var _a;let style={};return props.sticky&&(style.position="sticky",style.zIndex=1,style.top=null!=(_a=props.stickyTop)?_a:"-60px",style.boxShadow="0 0 5px -2px"),style})),getShowFooter=computed((()=>(null==slots?void 0:slots.leftFooter)||(null==slots?void 0:slots.rightFooter))),getHeaderSlots=computed((()=>Object.keys(omit(slots,"default","leftFooter","rightFooter","headerContent")))),getContentStyle=computed((()=>{const{contentFullHeight:contentFullHeight,contentStyle:contentStyle,fixedHeight:fixedHeight}=props;if(!contentFullHeight)return __spreadValues({},contentStyle);const height=`${unref(contentHeight)}px`;return __spreadValues((a=__spreadValues({},contentStyle),__defProps(a,__getOwnPropDescs({minHeight:height}))),fixedHeight?{height:height}:{});var a})),getContentClass=computed((()=>{const{contentBackground:contentBackground,contentClass:contentClass}=props;return[`${prefixCls}-content`,contentClass,{[`${prefixCls}-content-bg`]:contentBackground}]}));return watch((()=>[getShowFooter.value]),(()=>{redoHeight()}),{flush:"post",immediate:!0}),{getContentStyle:getContentStyle,wrapperRef:wrapperRef,headerRef:headerRef,contentRef:contentRef,footerRef:footerRef,getClass:getClass,getHeaderSlots:getHeaderSlots,prefixCls:prefixCls,getShowHeader:getShowHeader,getHeaderStyle:getHeaderStyle,getShowFooter:getShowFooter,omit:omit,getContentClass:getContentClass}}}),[["render",function(_ctx,_cache,$props,$setup,$data,$options){const _component_PageHeader=resolveComponent("PageHeader"),_component_a_spin=resolveComponent("a-spin"),_component_PageFooter=resolveComponent("PageFooter");return openBlock(),createElementBlock("div",{class:normalizeClass(_ctx.getClass),ref:"wrapperRef"},[_ctx.getShowHeader?(openBlock(),createBlock(_component_PageHeader,mergeProps({key:0,ghost:_ctx.ghost,title:_ctx.title},_ctx.omit(_ctx.$attrs,"class"),{ref:"headerRef",style:_ctx.getHeaderStyle}),createSlots({default:withCtx((()=>[_ctx.content?(openBlock(),createElementBlock(Fragment,{key:0},[createTextVNode(toDisplayString(_ctx.content),1)],64)):renderSlot(_ctx.$slots,"headerContent",{key:1})])),_:2},[renderList(_ctx.getHeaderSlots,(item=>({name:item,fn:withCtx((data=>[renderSlot(_ctx.$slots,item,normalizeProps(guardReactiveProps(data||{})))]))})))]),1040,["ghost","title","style"])):createCommentVNode("",!0),createBaseVNode("div",{class:normalizeClass(["overflow-hidden",_ctx.getContentClass]),style:normalizeStyle(_ctx.getContentStyle),ref:"contentRef"},[createVNode(_component_a_spin,{spinning:_ctx.loading},{default:withCtx((()=>[renderSlot(_ctx.$slots,"default")])),_:3},8,["spinning"])],6),_ctx.getShowFooter?(openBlock(),createBlock(_component_PageFooter,{key:1,ref:"footerRef"},{left:withCtx((()=>[renderSlot(_ctx.$slots,"leftFooter")])),right:withCtx((()=>[renderSlot(_ctx.$slots,"rightFooter")])),_:3},512)):createCommentVNode("",!0)],2)}]]);withInstall$1(pageFooter);const PageWrapper=withInstall$1(pageWrapper),PageWrapperFixedHeightKey="PageWrapperFixedHeight";export{PageWrapper as P,PageWrapperFixedHeightKey as a};
